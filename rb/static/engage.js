(function(){function test_readrboard_extend(){if(!RDR_offline){return}window.readrboard_extend={blessed_tags:["Love It","Hate It","Heeeeeey"]};window.readrboard_extend_per_container={question1:{blessed_tags:["tag1","tag2","tag3"]},question2:{blessed_tags:["tag3","tag4","tag5","tag6"]}}}function findEngageScript(){var e=document.getElementsByTagName("script");for(var t=0;t<e.length;t++){var n=e[t];var r=n.src;var i=r.indexOf("readrboard")!=-1&&r.indexOf("engage")!=-1;if(i){return n}}}function readrBoard(e){var t=e;t.extend(RDR,{summaries:{},current:{},assetLoaders:{content_nodes:{}},content_nodes:{},containers:{},pages:{},group:{defaults:{img_selector:"img",img_container_selectors:"#primary-photo",anno_whitelist:"body p",media_selector:"embed, video, object, iframe",comment_length:300,initial_pin_limit:300,no_readr:"",img_blacklist:"",custom_css:"",call_to_action:"What do you think?",inline_selector:"img, embed, video, object, iframe",paragraph_helper:true,media_url_ignore_query:true,br_replace_scope_selector:null}},user:{img_url:"",readr_token:"",user_id:""},known_users:{},errors:{actionbar:{rating:"",commenting:""}},styles:{},events:{track:function(e,n){var r="",i=(new Date).getTime();RDR.user=RDR.user||{};if(RDR.user&&RDR.user.user_id)r+="||uid::"+RDR.user.user_id;if(n&&RDR.util.getPageProperty("id",n))r+="||pid::"+RDR.util.getPageProperty("id",n);if(RDR.group&&RDR.group.id)r+="||gid::"+RDR.group.id;if(RDR.engageScriptParams.bookmarklet)r+="||bookmarklet";var s=e+r,o=t('<img src="'+RDR_baseUrl+"/static/widget/images/event.png?"+i+"&"+s+'" />');t("#rdr_event_pixels").append(o)},trackEventToCloud:function(e){RDR.user=RDR.user||{};var n=t.toJSON({category:e.category,action:e.action,opt_label:e.opt_label||null,opt_value:e.opt_value||null,opt_noninteraction:e.opt_noninteraction||null,shareNetwork:e.shareNetwork||null,container_hash:e.container_hash||null,container_kind:e.container_kind||null,page_id:e.page_id||null,tag_body:e.tag_body||null,user_id:RDR.user.user_id||null,group_id:RDR.group.id||null});t.postMessage("register-event::"+n,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}},groupSettings:{getCustomSettings:function(){var e=window.readrboard_extend||{};return RDR.groupSettings._translate(e)},translators:{blessed_tags:function(e){return t.map(e,function(e,t){return{body:e}})}},_translate:function(e){var n={};var r=RDR.groupSettings.translators;t.each(e,function(e,t){n[e]=!!r[e]?r[e](t):t});return n},getBlessedTags:function(e){function o(e){var n=t('[rdr-hash="'+e+'"]');var r=n.attr("rdr-custom-display");return r}var n=window.readrboard_extend_per_container;if(e&&n){var r=o(e);var i=n[r];if(i&&i.blessed_tags){var s=RDR.groupSettings._translate(i);return s.blessed_tags}}return RDR.group.blessed_tags}},rindow:{defaults:{coords:{left:100,top:100},animTime:100,defaultHeight:260,minHeight:10,maxHeight:300,minWidth:100,maxWidth:600,forceHeight:false,rewritable:true},makeHeader:function(e,n){function c(){var e=t('<div class="rdr_linkWrap">'+"<ul>"+'<li class="rdr_link">'+'<a href="javascript:void(0);" class="rdr_undo_link">Remove reaction</a>'+"</li>"+'<li class="rdr_link">'+'<a target="_blank" href="'+RDR_baseUrl+"/interaction/"+n+'" class="rdr_seeit_link">View at ReadrBoard</a>'+"</li>"+"</ul>"+"</div>");return e}function h(){var e=t('<div class="rdr_linkWrap">'+"</div>");return e}var r=e||"";var i=t.mustache('<div class="rdr rdr_header">'+'<div class="rdr_header_arrow">'+'<img src="{{RDR_staticUrl}}widget/images/header_up_arrow.png" />'+"</div>"+'<div class="rdr_loader"></div>'+'<div class="rdr_indicator_stats">'+'<img class="no-rdr rdr_pin" src="{{RDR_staticUrl}}widget/images/blank.png">'+'<span class="rdr_count"></span>'+"</div>"+"<h1>{{headerText}}</h1>"+"</div>",{RDR_staticUrl:RDR_staticUrl,headerText:r});var s=t(i);if(!n){return s}var o=t('<div class="rdr_menuDropDown rdr_menu_actions">'+'<span class="rdr_icon-chevron-down rdr_menuTrigger"></span>'+"</div>");var u=c();o.append(u);var a=t('<div class="rdr_menuDropDown rdr_menu_share">'+'<span class="rdr_icon-share rdr_icon-share-override rdr_menuTrigger"></span>'+"</div>");var f=h();a.append(f);var l=t('<div class="rdr_rindowMenu"></div>').append(o,a);if(isTouchBrowser){l.on("click",".rdr_menuDropDown",function(){t(this).toggleClass("rdr_hover")})}s.append(l);return s},makeDefaultPanelMessage:function(e,n){var r=e.data("hash");var i=RDR.summaries[r];var s=n||(e.hasClass("rdr_indicator_details")?"media":"text");var o;if(s=="text"){if(e.data("mode")=="writeMode"){o="What do you think?"}else{if(s=="text"){o="Reactions"}else{o=i.counts.tags>0?i.counts.tags+" Reactions":"Reactions"}}}else{var u=t.browser.msie&&parseInt(t.browser.version,10)<9?20:0;o=i.counts.tags>0?i.counts.tags+" Reactions":e.width()>=175+u?"What do you think?":"React:"}return o},updateFooter:function(e,t){var n=e.find("div.rdr_footer");n.show(0);if(typeof t!="undefined")n.html(t)},hideFooter:function(e){e.find("div.rdr_footer").hide(0)},panelCreate:function(e,n){if(!e)return;var r=e.find("div.rdr_body_wrap"),i=r.find("div.rdr_body").eq(0);var s=r.find("div."+n);s.remove();var o=t('<div class="rdr_body '+n+'"/>'),u=r.find("div.rdr_body").length+1;return o},panelUpdate:function(e,t,n,r){if(!e)return;var i=e.find("div.rdr_body_wrap"),s=i.find("div."+t);if(r){s.append(n)}else{s.replaceWith(n)}return n},panelShow:function(e,t,n){var r=e.find(".rdr_body_wrap");var i=e.find(".rdr_visiblePanel");if(!i.length){i=e.find(".rdr_body").eq(0)}var s=i.width();t.show().addClass("rdr-visible").css({position:"relative",top:0,left:s});e.data("panelState",2);t.addClass("rdr_visiblePanel").removeClass("rdr_hiddenPanel");i.addClass("rdr_hiddenPanel").removeClass("rdr_visiblePanel");RDR.rindow.updateSizes(e);r.animate({left:-s},RDR.C.rindowAnimationSpeed,function(){if(n)n();if(e.data("jsp")){var t=e.data("jsp");t.reinitialise()}else{e.jScrollPane({showArrows:true})}})},panelHide:function(e,t){var n=e.find(".rdr_body_wrap");var r=e.hasClass("rdr_writemode"),i=RDR.actions.indicators.utils.makeTagsListForInline(e,r);var s="rdr_tags_list";var o=e.find(".rdr_visiblePanel");o.removeClass("rdr_visiblePanel").addClass("rdr_hiddenPanel");i.addClass("rdr_visiblePanel").removeClass("rdr_hiddenPanel");var u=i.width();o.css("left",u);n.css("left",-u);RDR.rindow.updateSizes(e);n.animate({left:0},RDR.C.rindowAnimationSpeed,function(){if(t)t();e.data("panelState",1);if(e.data("jsp")){var n=e.data("jsp");n.reinitialise()}else{e.jScrollPane({showArrows:true})}})},panelEnsureFloatWidths:function(e){return;var t=e.find(".rdr_body_wrap");var n=e.find(".rdr_visiblePanel");var r=e.find(".rdr_hiddenPanel");var i=r.width();t.css({left:-i});n.css({left:i})},updateTagPanel:function(e){var t=e.data("hash");RDR.rindow.panelHide(e);RDR.rindow.tagBox.setWidth(e,e.data("initialWidth"));RDR.rindow.tagBox.setHeight(e,e.data("initialHeight"))},mediaRindowShow:function(e){var n=e.data("hash"),r=t("#rdr_indicator_details_"+n);RDR.util.cssSuperImportant(r,{display:"block"});if(e.data("hover")&&!r.data("hover")&&!r.is(":animated")&&!r.closest("div.rdr_media_details").length){r.data("hover",true);RDR.rindow.updateSizes(r)}r.addClass("rdr_engaged")},mediaRindowHide:function(e){var n=e.data("hash"),r=t("#rdr_indicator_details_"+n);if(!e.data("hover")&&!r.is(":animated")&&!r.closest("div.rdr_media_details").length){r.data("hover",false).animate({height:"0px"},RDR.C.rindowAnimationSpeed,function(){RDR.util.cssSuperImportant(r,{display:"none"})})}r.removeClass("rdr_engaged");t("#rdr_indicator_"+n).hide()},updateSizes:function(e,t){var n=e.hasClass("rdr_indicator_details")?"media":"text";var r=t||{};var i=e.find(".rdr_visiblePanel");var s=e.data("initialWidth"),o=e.data("initialHeight");var u,a;var f=0;var l={h:200,w:200,duration:RDR.C.rindowAnimationSpeed};l.w=i.width();l.h=i.height()+32;u=r.setWidth||l.w;a=r.setHeight||l.h;if(r.noAnimate){e.css({width:u,height:a})}e.animate({width:u,height:a},{duration:l.duration,queue:false});RDR.rindow.jspUpdate(e)},updatePageTagMessage:function(e,n){if(n=="tagDeleted"){var r=t("div.rdr_window:eq(0)");RDR.rindow.hideFooter(r);r.find(".rdr_header h1").text("Reaction Undone");r.find(".rdr_body").css("height","auto").html('<div class="rdr_reactionMessage rdr_reactUndoSuccess">'+'<div class="rdr_label_icon"></div>'+"<em>"+"<span>Your Reaction: </span>"+"<strong> "+e.tag.body+" </strong>"+"<span>has been undone.</span>"+"</em>"+"</div>")}},updateTagMessage:function(e){if(e.scenario&&e.rindow){if(e.args){t.each(e.args,function(n,r){if(typeof r=="object"){e[n]=t.extend(true,{},r)}else{e[n]=r}})}var n=e.hash,r=e.rindow,i=e.kind,s=e.tag,o=RDR.summaries[n],u=e.sendData?e.sendData.content_node_data:{};RDR.rindow.tagBox.setWidth(r,320);if(e.scenario!="tagDeleted"){if(e.scenario=="reactionSuccess"||e.scenario=="reactionExists"){var a=t('<div class="rdr_view_success"></div>'),f=t('<div class="rdr_subheader rdr_clearfix"></div>').appendTo(a),l=s.body?s.body:s.tag_body,c=t("<h1>"+l+"</h1>").appendTo(f),h=t('<div class="rdr_nextActions"></div>').appendTo(a),p=RDR.actions.comments.makeCommentBox({content_node:u,summary:o,hash:n,tag:s,$rindow:r,selState:u.selState||null}).appendTo(h);var d=t('<div class="rdr_back">Close X</div>');a.prepend(d);d.click(function(){var e=RDR.rindow.safeClose(r);if(!e){return}RDR.rindow.updateTagPanel(r)});var v=true;RDR.rindow.panelUpdate(r,"rdr_view_more",a,v);RDR.user=RDR.user||{};r.find("a.rdr_undo_link").on("click.rdr",{args:e},function(e){var t=e.data.args;var n={hash:t.hash,int_id:t.response.data.interaction.id,tag:t.tag,rindow:r};RDR.actions.interactions.ajax(n,"react","remove")});a.find(".rdr_comment_input").append('<div class="rdr_commentBox rdr_inlineCommentBox">'+'<div class="rdr_label_icon"></div>'+'<textarea class="rdr_add_comment_field rdr_inlineComment">Add a comment or #hashtag</textarea>'+'<div class="rdr_clear"></div>'+"</div>");var m=a.find(".rdr_add_comment_field");m.focus(function(){t(this).addClass("rdr_adding_comment");if(t(this).val()=="Add a comment or #hashtag"){t(this).val("")}}).blur(function(){if(t(this).val()===""){t(this).val("Add a comment or #hashtag");t(this).removeClass("rdr_adding_comment")}}).on("keyup",{args:e},function(e){var t=m.val();if(e.keyCode=="27"){}else if(e.keyCode=="13"){g(e)}else if(t.length>RDR.group.comment_length){t=t.substr(0,RDR.group.comment_length);m.val(t)}});a.find("button.rdr_add_comment").on("click",{args:e},function(e){g(e)});function g(e){var t=e.data.args.args?e.data.args.args:e.data.args,n=t.sendData.content_node_data,r=t.hash,i=t.page_id,s=t.rindow,o=t.tag,u=m.val();if(u.length>RDR.group.comment_length){u=u.substr(0,RDR.group.comment_length);m.val(u)}if(u!="Add a comment or #hashtag"){var a=RDR.summaries[r];n.kind=a.kind;var f={hash:r,page_id:i,content_node_data:n,comment:u,content:n.body,tag:o,rindow:s};RDR.actions.interactions.ajax(f,"comment","create")}else{m.focus()}}function y(){var i=t('<ul class="rdr_shareLinks"></ul>'),o=["facebook","twitter","tumblr"];t.each(o,function(o,a){var f=t('<li><a href="http://'+a+'.com" ><img class="no-rdr" src="'+RDR_staticUrl+"widget/images/social-icons-loose/social-icon-"+a+'.png" /></a></li>');i.append(f);f.click(function(){var t=e.tag.tag_body||e.tag.body;if(e.hash.jquery){u.hash="page";n=e.hash="page"}RDR.events.trackEventToCloud({category:"share",action:"share_open_attempt",opt_label:"which: "+a+", kind: "+e.kind+", hash: "+n+", tag: "+t,container_hash:n,container_kind:e.kind,page_id:e.page_id,tag_body:t});var i=RDR.summaries[n];var o=e.kind||i.kind;RDR.shareWindow=window.open(RDR_staticUrl+"share.html","readr_share","menubar=1,resizable=1,width=626,height=436");RDR.actions.share_getLink({referring_int_id:e.response.data.interaction.id,hash:e.hash,kind:o,sns:a,rindow:r,tag:s,content_node:u});return false})});return i}var b=t(".rdr_menu_share .rdr_linkWrap");b.append(y())}RDR.actions.containers.media.onEngage(n)}else{var w=RDR.rindow.makeDefaultPanelMessage(r);var E=RDR.rindow.makeHeader(w);r.find(".rdr_header").replaceWith(E);r.removeClass("rdr_viewing_more").find("div.rdr_indicator_details_body").show();RDR.rindow.panelHide(r)}RDR.rindow.updateSizes(r)}},jspUpdate:function(e){if(!e.closest(".jspContainer").length&&!e.hasClass("jspScrollable")){e.find("div.rdr_body").each(function(){var e=t(this);if(!e.hasClass("jspScrollable")){t(this).jScrollPane({showArrows:true})}else{var n=t(this).data("jsp");n.reinitialise()}})}},tagBox:{setWidth:function(e,t){var n=RDR.group.max_rindow_width?RDR.group.max_rindow_width:t;e.removeClass("w160 w320 w480 w640").addClass("w"+n)},setHeight:function(e,t){e.find(".rdr_body, .jspContainer").height(t)},make:function(e){function M(e,t){if(!i.find(".rdr_view_more").length||!i.find(".rdr_view_more").hasClass("rdr_visiblePanel")){var n=RDR.rindow.panelCreate(i,"rdr_view_more");var r=i.find("div.rdr_body_wrap");r.append(n);n.append(e).addClass("rdr_page_reactions_summary");RDR.rindow.tagBox.setWidth(i,320);RDR.rindow.panelShow(i,n,function(){RDR.rindow.hideFooter(i)})}else{i.find(".rdr_body").html(e);RDR.rindow.jspUpdate(i)}var s=t.tag_count<=0?"no reactions":t.tag_count==1?"1 reaction":t.tag_count+" reactions";var o=RDR.rindow.makeHeader(s);i.find(".rdr_header").replaceWith(o)}function _(){var e=t('<div class="rdr_back">Close X</div>');e.click(function(){var e=!!i.attr("rdr-grid-for");if(!e){RDR.rindow.close(i);return}});return e}function D(e,r,i){t().selog("hilite",true,"off");t(".rdr_twtooltip").remove();var s=_(),o=t('<table cellpadding="0" cellspacing="0" border="0" class="reaction_summary_table"></table>').append('<tbody><tr class="rdr_page_reactions"></tr></tbody>');if(r&&r.page&&r.page>0){var u=r.page==1?"1 reaction":r.page+" reactions";o.find(".rdr_page_reactions").append('<td colspan="2"><strong>'+u+"</strong> to this <strong>page</strong></td>")}if(r.img>0||r.text>0||r.media>0){o.find(".rdr_page_reactions").addClass("has_other_reactions");t.each(RDR.interaction_data[n.id],function(e,r){var s=r.hash;var u=RDR.summaries[s];var a=t('[rdr-hash="'+s+'"]');var f=u.pageId;if(!f||!i||f!=i){return}if(!o.find("tr.rdr_int_summary_"+e).length){var l=t('<tr valign="middle" class="rdr_content_reaction rdr_int_summary_'+e+'"/>'),c=RDR.interaction_data[n.id][e];if(typeof c.interaction!="undefined"&&typeof c.content_node!="undefined"){var h=c.interaction.count>1?"reactions":"reaction";l.append('<td class="rdr_count"><h4>'+c.interaction.count+"</h4><h5>"+h+"</h5></td>").data("count",c.interaction.count).data("tag",n).data("int_id",e);if(c.kind=="text"){l.append('<td class="rdr_content">'+c.content_node.body+"</td>")}else if(c.kind=="img"){l.append('<td class="rdr_content"><img src="'+c.content_node.body+'" height="50"/></td>')}else if(c.kind=="media"){l.append('<td class="rdr_content"><img src="'+RDR_baseUrl+'/static/widget/images/video_icon.png" height="33" style="margin-bottom:-10px;"/> <div style="display:inline-block;margin-left:10px;">Video</div></td>')}l.click(function(e){e.preventDefault();var t={container_hash:c.hash,location:c.content_node.location};RDR.session.revealSharedContent(t)});if(!o.find("tr.rdr_content_reaction").length){o.find("tbody").append(l)}else{var p=0;t.each(o.find("tr.rdr_content_reaction"),function(e,n){if(parseInt(c.interaction.count)>parseInt(t(n).data("count"))){p=e;return false}});o.find("tr.rdr_content_reaction:eq("+p+")").before(l)}}}})}return t("<div/>").append(s,o)}var n=e.tag,r=e.boxSize?e.boxSize:"medium",i=e.$rindow?e.$rindow:null,s=e.$tagContainer?e.$tagContainer:e.$rindow?e.$rindow.find("div.rdr_body.rdr_tags_list"):null,o=n.tag_count?n.tag_count:"",u=e.colorInt?e.colorInt:1,a=e.isWriteMode?e.isWriteMode:false,f=i.data("kind"),l=i.data("hash")?i.data("hash"):i.data("container"),c=RDR.summaries[l],h=n.content_node_id?n.content_node_id:false,p=h?c.content_nodes[h]:"",d="";if(h){p.id=h}var r=r=="big"?"rdr_box_big":r=="medium"?"rdr_box_medium":"rdr_box_small",v="",m=a?"rdr_writeMode":"",g=n.body?n.body:n.tag_body,y="",b="";if(f=="page"){d=a?"+1 "+g:""}else if(o==""){d=""}else if(o==-101){d="+1 "+g}else{var d="+1 "+g}var w="";if(g.length<16){w="rdr_charCount"+g.length;y='<div class="rdr_tag_body rdr_tag_lineone">'+g+"</div>"}else{b="rdr_tag_split";if(g.indexOf(" ")==-1){w="rdr_charCount15";y='<div class="rdr_tag_body rdr_tag_lineone">'+g.substr(0,15)+"-<br>"+g.substr(15)+"</div>"}else{var E="",S="",x=true;tagBodyRawSplit=g.split(" ");while(x){E+=tagBodyRawSplit.shift()+" ";if(E.length+tagBodyRawSplit[0].length>=16)x=false}S=tagBodyRawSplit.join(" ");w="rdr_charCount"+E.length;y='<div class="rdr_tag_body rdr_tag_lineone">'+E+"<br>"+S+"</div>"}}var T=n.id;var N=n.parent_id;var C=h?"rdr_content_node_"+h:"";var o=o||0;var k=!a&&f=="page"?"":'<span class="rdr_plusOne">+1</span>';var L=a?"":'<span class="rdr_count">'+o+"</span>"+'<i class="rdr_icon-search rdr_tag_read_icon"></i>';var A='<div class="rdr_color'+u+" "+r+" rdr_box "+v+" "+m+'">'+"<div "+'class="rdr_tag '+b+" "+C+" "+w+'" '+'data-tag_id="'+T+'" '+'data-tag_count="'+o+'" '+'data-parent_id="'+N+'" '+'data-content_node_id="'+h+'" '+">"+y+L+k+"</div>"+"</div>";var O=t(A);s.append(O);if(f=="page"){if(a==false){var P=function(){RDR.rindow.hideFooter(i);i.removeClass("rdr_rewritable");var e=RDR.pages[RDR.util.getPageProperty("id",l)],r=n.tag_count,s={img:0,text:0,media:0,page:r=="+"?0:r};t.each(e.containers,function(e,t){if(RDR.summaries&&RDR.summaries[t.hash]&&RDR.summaries[t.hash].top_interactions){if(RDR.summaries[t.hash].top_interactions.tags&&RDR.summaries[t.hash].top_interactions.tags[n.id]){s[RDR.summaries[t.hash].kind]+=RDR.summaries[t.hash].top_interactions.tags[n.id].count;s.page-=RDR.summaries[t.hash].top_interactions.tags[n.id].count}}});var o=t(this),u=D(o,s,e.id);M(u,n);o.addClass("rdr_live_hover")};O.click(function(){P()})}else{O.click(function(){t(this).addClass("rdr_tagged");i.removeClass("rdr_rewritable");var e=i.data("container");args={tag:n,hash:e,uiMode:"writeMode",kind:i.data("kind"),rindow:i,content_node:p};RDR.actions.interactions.ajax(args,"react","create")})}}else{if(isTouchBrowser){O.bind("tap",function(){t(this).addClass("rdr_tagged");i.removeClass("rdr_rewritable");var e=i.data("container");args={tag:n,hash:e,uiMode:"writeMode",kind:i.data("kind"),rindow:i,content_node:p};RDR.actions.interactions.ajax(args,"react","create")})}else{O.click(function(){t(this).addClass("rdr_tagged");i.removeClass("rdr_rewritable");var e=i.data("container");args={tag:n,hash:e,uiMode:"writeMode",kind:i.data("kind"),rindow:i,content_node:p};RDR.actions.interactions.ajax(args,"react","create")})}}if(!isTouchBrowser){O.hover(function(){var e=t(this);if(!e.hasClass("rdr_tagged")){var n=e.find("span.rdr_tag_count");n.width(n.width());n.text("+")}},function(){var e=t(this);e.find("span.rdr_tag_count").text(e.find(".rdr_tag").data("tag_count"))})}var H={},B=0;if(!t.isEmptyObject(p)&&!t.isEmptyObject(p.top_interactions)&&!t.isEmptyObject(p.top_interactions.coms)){t.each(p.top_interactions.coms,function(e,r){if(r.tag_id==parseInt(n.tag_id)){B++;if(t.isEmptyObject(H))H=p.top_interactions.coms}})}var j=t.isEmptyObject(H)&&typeof c!="undefined"&&(c.kind=="img"||c.kind=="media"||c.kind=="med")&&!t.isEmptyObject(c.top_interactions)&&!t.isEmptyObject(c.top_interactions.coms);if(!n.id){n.id=n.tag_id}if(j){H=c.top_interactions.coms[n.id];if(!t.isEmptyObject(H)){B=H.length}}if(!t.isEmptyObject(H)&&!a){var F=t('<span class="rdr_comment_hover rdr_tooltip_this" title="view comments"></span>');F.append('<i class="rdr_icon-comment"></i> '+B);if(isTouchBrowser){F.bind("tap",function(){t(this).tooltip("hide");RDR.actions.viewCommentContent({tag:n,hash:l,rindow:i,content_node:p,selState:p.selState});return false})}else{F.click(function(){t(this).tooltip("hide");RDR.actions.viewCommentContent({tag:n,hash:l,rindow:i,content_node:p,selState:p.selState});return false})}O.append(F);F.tooltip()}return O}},writeCustomTag:function(e,n,r){var e=n.find(".rdr_footer");e.append('<div class="rdr_box"></div> ');if(e.find("div.rdr_custom_tag").not("div.rdr_custom_tag.rdr_tagged").length==0){var r=r?r:"react",i=r=="react"?"+ Add your own":"+ Add tag...";var s=t('<div class="rdr_click_overlay"></div>').appendTo(e);var o=t('<div class="rdr_tag rdr_custom_tag"></div>');var u=t('<input value="'+i+'" />').appendTo(o);var a=t('<button class="rdr_custom_tag_submit" name="rdr_custom_tag_submit">ok</button>').appendTo(o);a.click(function(){f(o,u)});s.click(function(){u.focus()});u.focus(function(){var e=t(this);e.removeClass("rdr_default");if(e.val()==i){e.val("")}s.hide();a.show()}).blur(function(){var e=t(this);if(e.val()===""){e.val(i);a.hide();s.show()}if(e.val()==i){e.addClass("rdr_default");a.hide();s.show()}e.closest("div.rdr_tag").removeClass("rdr_hover")}).keyup(function(e){var t=u;if(e.keyCode=="13"){f(o,u)}else if(e.keyCode=="27"){t.blur();return false}else if(t.val().length>25){var n=t.val();t.val(n.substr(0,25))}});e.find(".rdr_box").append(o," ");function f(e,t){var i={},s=n.data("container");var o=t.val();if(o===""){return}i.body=o;e.parent().addClass("rdr_tagged");args={tag:i,hash:s,uiMode:"writeMode",kind:n.data("kind"),rindow:n};RDR.actions.interactions.ajax(args,r,"create");t.blur()}t(document).on("keydown.rdr",function(n){keyCodes=[16,81,87,69,82,84,89,85,73,79,80,65,83,68,70,71,72,74,75,76,90,88,67,86,66,78,77,49,50,51,52,53,54,55,56,57,48,189,187,219,221,220,186,222,188,190,191,192];if(t.inArray(n.keyCode,keyCodes)!=-1){e.find("input").focus()}})}},_rindowTypes:{tagMode:{make:function(e){if(e.is_page==true){var n=e.page,r=t(".rdr-summary-"+n.id),i={top:r.offset().top,left:r.offset().left};if(t("div.rdr_page_key_"+r.data("page_key")).length){return}var s=RDR.rindow.draw({coords:i,container:r,content:"page",kind:"page",mode:e.mode})}else{var o=e.hash;var u=RDR.util.getPageProperty("id",o);var a=RDR.summaries[o],f=a.$container,l=a.kind,c=e.rewritable==false?false:true,i={};var h=e.actionType?e.actionType:"react";if(e.mode=="writeMode"){RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown_writemode",opt_label:"kind: text, hash: "+o,container_hash:o,container_kind:l,page_id:u});var p;if(l=="text"){p=f.selog("helpers","smartHilite");if(!p)return false;e.content=p.text;i.left=i.left+40;i.top=i.top+35;if(p){var d=p.hiliter,v=d.get$end();if(v){var m=t("<span />");m.insertAfter(v);var g=m.offset().right;var y=m.offset().bottom;m.remove();i.left=g-14;i.top=y+23}}}else{var b=!f.parents(RDR.group.img_container_selectors).length?f.offset().bottom-5:f.parents(RDR.group.img_container_selectors).first().offset().bottom+5;var i={top:b,left:f.offset().left}}}else{var w='[rdr-hash="'+o+'"]';var E=t("#rdr_indicator_"+o),S=t("#rdr_indicator_body_"+o),f=t('[rdr-hash="'+o+'"]');if(l=="text"){i={top:S.offset().top+22,left:S.offset().left-5}}else{var i={top:f.offset().bottom+5,left:f.offset().left};RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown_readmode",opt_label:"kind: "+l+", hash: "+o,container_hash:o,container_kind:l,page_id:u})}}if(typeof e.$custom_cta!="undefined"){i.top=e.$custom_cta.offset().top+parseInt(e.$custom_cta.attr("rdr-offset-y"));i.left=e.$custom_cta.offset().left+parseInt(e.$custom_cta.attr("rdr-offset-x"))}var s=RDR.rindow.draw({coords:i,container:o,content:e.content,kind:l,selState:p,rewritable:c,mode:e.mode});s.data("hash",o);a["$rindow_"+e.mode.toLowerCase()]=s}s.addClass("rdr_"+e.mode.toLowerCase());var x=RDR.rindow.makeDefaultPanelMessage(s);var T=RDR.rindow.makeHeader(x);s.find(".rdr_header").replaceWith(T);s.addClass("rdr_reactions");var N=s.find("div.rdr_body_wrap");var C=s.find("div.rdr_body");if(C.length){C.remove()}if(e.is_page==true){var k=RDR.actions.indicators.utils.makeTagsListForInline(s,e.mode=="writeMode",n)}else{var k=RDR.actions.indicators.utils.makeTagsListForInline(s,e.mode=="writeMode")}N.append(k);var L=N.width(),A=N.height();var O=RDR.util.stayInWindow({coords:i,width:L,ignoreWindowEdges:e.ignoreWindowEdges});s.css("left",O.left+"px").css("top",O.top+"px");s.animate({width:L},333,"swing");s.data("initialWidth",L).data("initialHeight",A);s.find("div.rdr_cell_wrapper div.rdr_tag").css({width:"100%"});return s},customOptions:{},setup:function(){}}},make:function(e,n){var r=n.hash,i=RDR.summaries[r],s=n.kind,o=n.is_page;if(!o&&!i){var i=RDR.util.makeEmptySummary(r);RDR.actions.containers.setup(i)}if(!e)e="readMode";var u=RDR.rindow.defaults,a=RDR.rindow._rindowTypes.customOptions,f=t.extend({},u,a,n,{mode:e});var l=RDR.rindow._rindowTypes.tagMode.make(f);return l},draw:function(e){RDR.rindow.closeAll();if(e.selector&&!e.container){e.container=e.selector.substr(5)}var n=t.extend({},this.defaults,e);var r=n.minHeight<60?60:n.minHeight,i=n.maxHeight;minWidth=n.minWidth,maxWidth=n.maxWidth,rdr_for=typeof n.container=="string"?"rdr_for_"+n.container:"rdr_for_page",$new_rindow=t('<div class="rdr rdr_window rdr_rewritable rdr_widget w160 '+rdr_for+'"></div>');if(n.id){t("#"+n.id).remove();$new_rindow.attr("id",n.id)}t("#rdr_sandbox").append($new_rindow);if(n.kind=="page"){$new_rindow.addClass("rdr_page_key_"+e.container.data("page_key")).addClass("rdr_page_summary")}$new_rindow.data(n);if($new_rindow.find("div.rdr_header").length===0){$new_rindow.html("");$new_rindow.append('<div class="rdr rdr_header">'+'<div class="rdr_header_arrow"><img src="'+RDR_staticUrl+'widget/images/header_up_arrow.png" /></div>'+'<div class="rdr_loader"></div>'+"</div>"+'<div class="rdr rdr_body_wrap rdr_clearfix"></div>'+'<div class="rdr rdr_footer"></div>');if(n.noHeader)$new_rindow.find("div.rdr_header").remove();$new_rindow.draggable({handle:".rdr_header",containment:"document",stack:".rdr_window",start:function(){t(this).removeClass("rdr_rewritable")}})}var s=n.coords;$new_rindow.css("left",s.left+"px");$new_rindow.css("top",s.top+"px");if(n.height){$new_rindow.height(n.height)}RDR.actionbar.closeAll();$new_rindow.settings=n;$new_rindow.on("resizestop",function(e,n){var r=t(this)});return $new_rindow},safeClose:function(e){var t=!!e.attr("rdr-grid-for");if(t){var n=RDR.rindow.makeHeader("Reactions");e.find(".rdr_header").replaceWith(n);RDR.rindow.updateFooter(e);var r=e.find(".rdr_body_wrap"),i=r.find(".rdr_visiblePanel"),s=r.find(".rdr_hiddenPanel");r.animate({left:0});i.removeClass("rdr_visiblePanel").addClass("rdr_hiddenPanel");s.removeClass("rdr_hiddenPanel").addClass("rdr_visiblePanel");return true}RDR.rindow.close(e);return true},close:function(e){RDR.rindow.clearHilites(e);e.each(function(e,n){t(n).remove()});t("#rdr_indicator_details_wrapper").find(".rdr_body_wrap").css({visibility:"visible"})},closeAll:function(){var e=t("div.rdr.rdr_window").not(".rdr_no_clear");RDR.rindow.close(e);t(".rdr_shared").removeClass("rdr_shared");t(document).unbind("keydown.rdr")},clearHilites:function(e){var n=[];e.each(function(e,r){var i=t(r).data("container");if(typeof i==="undefined")return;var s=RDR.summaries[i];var o=t(r).data("selState");if(typeof o!=="undefined"&&o!==""){n.push(o)}var u=[];if(s&&s.hasOwnProperty("content_nodes")){u=s.content_nodes}t.each(u,function(e,t){var r=t.selState;if(typeof r!=="undefined"){n.push(r)}})});t.each(n,function(e,n){try{t().selog("hilite",n,"off")}catch(r){}})},update:function(e,n){function a(e,n){var r,i;r=e.find(".rdr_tags");i=r.find(".rdr_tag_"+n.parent_interaction_node.id).filter(function(){return t(this).hasClass("rdr_content_node_"+n.content_id)});i.addClass("rdr_comment_indicator");l(n,i,e);f(e);c(n,i,e)}function f(e){var n=e.find("table.rdr_tags");if(n.find("tr:eq(0)").find("td").length==1){n.addClass("rdr-one-column");if(!isTouchBrowser){n.find("td.rdr_has_pillHover").on("mouseenter, mousemove",function(){var e=t(this),n=e.closest("div.rdr_window");thisWidth=n.data("initialWidth")}).on("mouseleave",function(){var e=t(this),n=e.closest("div.rdr_window");thisWidth=n.width()})}}}function l(n,i,s){var o=r.content_nodes;var u=o[n.content_id];if(u){var a=u.top_interactions.coms}else{var f=t.mustache('contentNode not found by id: {{id}}.  Figure out why nodeId was saved as "undefined".',{id:n.content_id});RDR.safeThrow(f)}var l=t.map(a,function(e){return e.tag_id===n.tag_id?e:null});var c=l.length;var h=i;var p=n.parent_interaction_node;var d=n.content_node;h.find(".rdr_comment_hover").remove();h.find(".rdr_comment_indicator").remove();var v=t('<span class="rdr_comment_hover"/>');v.append('<span class="rdr_icon"></span> '+c);v.click(function(){RDR.actions.viewCommentContent({tag:p,hash:e,rindow:s,content_node:d,selState:d.selState})});h.append(v);h.closest("td").addClass("rdr_has_pillHover")}function c(e,n,r){var i=e.parent_interaction_node;var s=e.content_node;var o=t('<span class="rdr_comment_feedback"/>');o.append('<span class="linkToComment">Thanks for your comment! <a href="javascript:void(0);">Close</a></span> ');o.click(function(e){e.preventDefault();RDR.rindow.safeClose(r)});r.find("div.rdr_commentBox").empty().append(o).show();r.find("button.rdr_add_comment").hide()}var r=RDR.summaries[e],i=r.$rindow_readmode,s=r.$rindow_writemode;if(n){if(n.int_type=="coms"){if(s&&s.length){$tags=s.find(".rdr_tags").find(".rdr_tag");$tags.addClass("rdr_content_node_"+n.content_id);a(s,n)}if(i&&i.length){a(i,n)}else{var o=t("#rdr_indicator_details_"+e);$tags=o.find(".rdr_tags").find(".rdr_tag");$tags.addClass("rdr_content_node_"+n.content_id);a(o,n)}}}else{var u=r.kind&&(r.kind=="img"||r.kind=="media"||r.kind=="med");if(!u){return}RDR.actions.indicators.utils.makeDetailsContent(e)}}},actionbar:{draw:function(e){function p(e){var r=t("#rdr_container_tracker_"+n),i=r.find(".rdr_mediaHilite_top");var s={top:i.offset().top,left:i.offset().right};return s}var n=e.hash,r=e.coords,i=e.kind,s=e.content,o=e.src_with_path||undefined,u=RDR.util.getPageProperty("id",n);var a="rdr_actionbar_"+n;var f=t("div.rdr_actionbar");if(t("#"+a).length>0)return t("#"+a);var l={IE:{top:"add this here",left:"add this here"},img:p,text:{top:r.top+8,left:r.left+3}};r=i=="text"?l.text:l.img(r);if(i=="text"){r=RDR.util.stayInWindow({coords:r,width:45,height:30,paddingY:40,paddingX:40,ignoreWindowEdges:e.ignoreWindowEdges})}var c=t('<div class="rdr rdr_actionbar rdr_widget rdr_widget_bar" id="'+a+'" ></div>');c.css({top:r.top,left:r.left});if(!n){RDR.safeThrow("There should always be a hash from hashNodes after hover on an unhashed image.");return}c.data("hash",n);c.append("<ul/>");var h=[{item:"reaction",tipText:"What do you think?",onclick:function(){RDR.rindow.make("writeMode",{hash:n,kind:i,content:s,src_with_path:o})}}];RDR.events.trackEventToCloud({category:"actonbar",action:"actionbar_shown",opt_label:"kind: "+i+", hash: "+n+", content: "+s,container_hash:n,container_kind:i,page_id:u});t.each(h,function(e,n){var r=t('<li class="rdr_icon_'+n.item+'" />'),i=t('<a href="javascript:void(0);" class="rdr_tooltip_this" title="'+n.tipText+'">'+'<span class="rdr rdr_react_icon">'+n.item+"</span>"+'<span class="rdr rdr_react_label">What do you think?</span>'+'<div class="rdr_clear"></div>'+"</a>");i.click(function(){n.onclick();return false});r.addClass("rdr_actionbar_first").append(i).appendTo(c.children("ul"))});t("#rdr_sandbox").append(c);if(i=="img"||i=="media"||i=="med"){c.addClass("rdr_actionbar_for_media");c.append('<div style="clear:both;" />').removeClass("rdr_widget rdr_widget_bar")}return c},close:function(e,n){function r(e,n){var r=e.data("timeoutCloseEvt");var i=e.data("timeoutCollapseEvt");clearTimeout(r);clearTimeout(i);var s=t('[rdr-hash="'+n+'"]'),o=t("#rdr_indicator_"+n);s.removeClass("rdr_engage_media");e.remove()}e.each(function(){var e=t(this),i=e.data("hash"),s=t("#rdr_container_tracker_"+i);if(typeof n!=="undefined"){e.fadeOut(200)}else{r(e,i);var o=t("#rdr_indicator_"+i)}})},closeSuggest:function(e){var n=t();if(!e){n=t("div.rdr_actionbar")}else if(typeof e=="string"){var r=e;n=t("#rdr_actionbar_"+r);n.data("hash",r)}else{t.each(e,function(e,t){n=n.add("#rdr_actionbar_"+t);n.data("hash",t)})}var i=this;n.each(function(){var e=t(this),r=n.data("hash"),s=t("#rdr_indicator_details_"+r),o=t('[rdr-hash="'+r+'"]'),u=t(this).data("timeoutCloseEvt");clearTimeout(u);u=setTimeout(function(){if(e.data("hover")||o.data("hover")||s.data("hover"))return;i.close(e,"fade")},300);t(this).data("timeoutCloseEvt",u)})},closeAll:function(){var e=t("div.rdr_actionbar");this.close(e)}},util:{checkForSelectedTextAndLaunchRindow:function(){var e=t("document").selog("save");if(!e)return;var n=e.range.commonAncestorContainer;var r=n.nodeType===3?t(n).parent():t(n);var i=RDR.actions.startSelect(r,null,function(e,t,n){RDR.rindow.make("writeMode",{hash:e,kind:t,content:n})})},initTouchBrowserSettings:function(){if(isTouchBrowser){}$RDR.dequeue("initAjax")},initPublicEvents:function(){window.readrboard.public_events=t("#rdr_sandbox");$RDR.dequeue("initAjax")},triggerPublicEvent:function(e,t){window.readrboard.public_events.trigger("event",t);window.readrboard.public_events.trigger(e,t)},makeEmptySummary:function(e,t){var n={};n={};n.hash=e;n.kind=t;n.top_interactions={};n.top_interactions.coms={};n.top_interactions.tags={};n.top_interactions.shr={};n.counts={};n.counts.tags=0;n.counts.interactions=0;n.counts.coms=0;return n},getPageProperty:function(e,n){if(!e){e="id"}var r;if(n=="page"){r=t(".rdr_window").data("container").attr("rdr-page-id");return parseInt(r,10)}if(typeof n=="object"){if(t(n).closest("[rdr-page-container]").length&&t(n).closest("[rdr-page-container]").data("page_id")){return parseInt(t(n).closest("[rdr-page-container]").data("page_id"))}}else if(!n){return false}if(typeof n=="string"){var i=n}var r=t('[rdr-hash="'+i+'"]').data("page_id")?t('[rdr-hash="'+i+'"]').data("page_id"):t('[rdr-hash="'+i+'"]').closest("[rdr-page-container]").data("page_id")?t('[rdr-hash="'+i+'"]').closest("[rdr-page-container]").data("page_id"):t("body").data("page_id");if(t('[rdr-hash="'+i+'"]').hasAttr("rdr-page-container")&&!t('[rdr-hash="'+i+'"]').data("page_id")){t('[rdr-hash="'+i+'"]').data("page_id",r)}return parseInt(r)},buildInteractionData:function(){t.each(RDR.summaries,function(e,n){t.each(n.top_interactions.tags,function(r,i){if(typeof RDR.summaries[e].content_nodes!="undefined"){t.each(RDR.summaries[e].content_nodes,function(t,i){if(typeof i.top_interactions.tags!="undefined"&&typeof i.top_interactions.tags[r]!="undefined"){var s=i.top_interactions.tags[r];if(typeof RDR.interaction_data[r]=="undefined"){RDR.interaction_data[r]={}}if(typeof RDR.interaction_data[r][s.parent_id]=="undefined"){RDR.interaction_data[r][s.parent_id]={}}RDR.interaction_data[r][s.parent_id].hash=e;RDR.interaction_data[r][s.parent_id].container_id=n.id;RDR.interaction_data[r][s.parent_id].tag={body:s.body,id:r};RDR.interaction_data[r][s.parent_id].kind=n.kind;RDR.interaction_data[r][s.parent_id].interaction={id:s.parent_id,count:s.count,body:s.body};RDR.interaction_data[r][s.parent_id].content_node={body:i.body,location:i.location,selState:i.selState}}})}})})},stayInWindow:function(e){var n=t(window),r=n.width(),i=n.height(),s=n.scrollTop(),o=e.width,u=e.height,a=e.coords,f=e.paddingY||10,l=e.paddingX||10,c=e.ignoreWindowEdges?e.ignoreWindowEdges:"";if(c.indexOf("r")==-1&&a.left+o+16>=r-l){a.left=r-o-l}if(c.indexOf("b")==-1&&a.top+u>i+s-f){a.top=i+s-u-f}if(c.indexOf("l")==-1&&a.left<l){a.left=l}if(c.indexOf("t")==-1&&a.top<s+f){a.top=s+f}return a},md5:{hexcase:0,b64pad:"",chrsz:8,hex_md5:function(e){return RDR.util.md5.binl2hex(RDR.util.md5.core_md5(RDR.util.md5.str2binl(e),e.length*RDR.util.md5.chrsz))},core_md5:function(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var n=1732584193;var r=-271733879;var i=-1732584194;var s=271733878;for(var o=0;o<e.length;o+=16){var u=n;var a=r;var f=i;var l=s;n=RDR.util.md5.md5_ff(n,r,i,s,e[o+0],7,-680876936);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+1],12,-389564586);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+2],17,606105819);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+3],22,-1044525330);n=RDR.util.md5.md5_ff(n,r,i,s,e[o+4],7,-176418897);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+5],12,1200080426);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+6],17,-1473231341);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+7],22,-45705983);n=RDR.util.md5.md5_ff(n,r,i,s,e[o+8],7,1770035416);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+9],12,-1958414417);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+10],17,-42063);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+11],22,-1990404162);n=RDR.util.md5.md5_ff(n,r,i,s,e[o+12],7,1804603682);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+13],12,-40341101);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+14],17,-1502002290);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+15],22,1236535329);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+1],5,-165796510);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+6],9,-1069501632);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+11],14,643717713);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+0],20,-373897302);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+5],5,-701558691);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+10],9,38016083);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+15],14,-660478335);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+4],20,-405537848);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+9],5,568446438);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+14],9,-1019803690);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+3],14,-187363961);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+8],20,1163531501);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+13],5,-1444681467);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+2],9,-51403784);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+7],14,1735328473);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+12],20,-1926607734);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+5],4,-378558);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+8],11,-2022574463);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+11],16,1839030562);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+14],23,-35309556);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+1],4,-1530992060);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+4],11,1272893353);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+7],16,-155497632);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+10],23,-1094730640);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+13],4,681279174);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+0],11,-358537222);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+3],16,-722521979);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+6],23,76029189);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+9],4,-640364487);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+12],11,-421815835);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+15],16,530742520);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+2],23,-995338651);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+0],6,-198630844);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+7],10,1126891415);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+14],15,-1416354905);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+5],21,-57434055);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+12],6,1700485571);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+3],10,-1894986606);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+10],15,-1051523);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+1],21,-2054922799);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+8],6,1873313359);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+15],10,-30611744);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+6],15,-1560198380);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+13],21,1309151649);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+4],6,-145523070);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+11],10,-1120210379);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+2],15,718787259);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+9],21,-343485551);n=RDR.util.md5.safe_add(n,u);r=RDR.util.md5.safe_add(r,a);i=RDR.util.md5.safe_add(i,f);s=RDR.util.md5.safe_add(s,l)}return Array(n,r,i,s)},md5_cmn:function(e,t,n,r,i,s){return RDR.util.md5.safe_add(RDR.util.md5.bit_rol(RDR.util.md5.safe_add(RDR.util.md5.safe_add(t,e),RDR.util.md5.safe_add(r,s)),i),n)},md5_ff:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(t&n|~t&r,e,t,i,s,o)},md5_gg:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(t&r|n&~r,e,t,i,s,o)},md5_hh:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(t^n^r,e,t,i,s,o)},md5_ii:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(n^(t|~r),e,t,i,s,o)},safe_add:function(e,t){var n=(e&65535)+(t&65535);var r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535},bit_rol:function(e,t){return e<<t|e>>>32-t},str2binl:function(e){var t=Array();var n=(1<<RDR.util.md5.chrsz)-1;for(var r=0;r<e.length*RDR.util.md5.chrsz;r+=RDR.util.md5.chrsz){t[r>>5]|=(e.charCodeAt(r/RDR.util.md5.chrsz)&n)<<r%32}return t},binl2hex:function(e){var t=RDR.util.md5.hexcase?"0123456789ABCDEF":"0123456789abcdef";var n="";for(var r=0;r<e.length*4;r++){n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15)}return n}},getCleanText:function(e){var n=t(e);var r=n.find(".rdr_indicator");if(r.length){return}var i=n.html().replace(/< *br *\/?>/gi,"\n");var s=t.trim(t("<div>"+i+"</div>").text().toLowerCase());if(s&&typeof s=="string"&&s!==""){var o=s.replace(/[\n\r\t]+/gi," ").replace().replace(/\s{2,}/g," ");return t.trim(o)}},trimToLastWord:function(e){var t=/\w+$/.exec(e);if(!t){return e}else{return e.slice(0,e.length-t[0].length)}},cssSuperImportant:function(e,n,r){var i="";t.each(n,function(e,r){r.replace("!important","");t.trim(r);r+=" !important";n[e]=r});var s=e.attr("style")||"";var o=r?n:t.extend(RDR.util.parseCssAttrToDict(s),n);t.each(o,function(e,t){i+=e+":"+t+";"});e.attr("style",i);return e},parseCssAttrToDict:function(e){var n={};var r=e.split(";");t.each(r,function(e,r){var i=r.split(":");var s=t.trim(i[0]);var o=t.trim(i[1]);if(s.length&&o.length){n[s]=o}});return n},fixBrTags:function(){var e=t(RDR.group.br_replace_scope_selector).find("br").parent();if(!e.length){return}var n="|rdr|br|/rdr|";e.each(function(){var e=t(this);var r=e.clone();var i=t("<p></p>");r.find("br").each(function(){t(this).replaceWith(n)});var s=r.html().split(n);for(var o=0;o<s.length;o++){var u=s[o];i.append("<rt>"+u+"</rt>")}e.addClass("rdr_br_replaced").html(i.html())})},fixBodyBorderOffsetIssue:function(){var e=t("body"),n=parseInt(e.css("border-top-width"),10),r=parseInt(e.css("border-left-width"),10),i=t("#rdr_sandbox");if(!n&&!r)return;RDR.util.cssSuperImportant(i,{top:n+"px",left:r+"px"})},throttledUpdateContainerTrackers:function(){return RDR.util._.throttle(RDR.actions.indicators.utils.updateContainerTrackers,100)},userLoginState:function(){if(!t("#rdr-user").length){t("#rdr-page-summary").find("div.rdr-summary").prepend('<div id="rdr-user" />')}if(RDR&&RDR.user&&RDR.user.full_name&&t("#rdr-page-summary.defaultSummaryBar").length){var e=RDR.user.user_type=="facebook"?RDR.user.full_name.split(" ")[0]:RDR.user.full_name;t("#rdr-user").html('Hi, <a href="'+RDR_baseUrl+"/user/"+RDR.user.user_id+'" target="_blank">'+e+"</a>")}else{t("#rdr-user").html('<a href="javascript:void(0);">Log in to ReadrBoard</a>');t("#rdr-user").find("a").click(function(){RDR.session.showLoginPanel()})}},objLength:function(e){var t=0,n;for(n in e){if(e.hasOwnProperty(n)){t++}}return t},_:{debounce:function(e,t){var n;return function(){var r=this,i=arguments;var s=function(){n=null;e.apply(r,i)};clearTimeout(n);n=setTimeout(s,t)}},throttle:function(e,t){var n={};n.debounce=RDR.util._.debounce;var r,i,s,o,u;var a=n.debounce(function(){u=o=false},t);return function(){r=this;i=arguments;var n=function(){s=null;if(u)e.apply(r,i);a()};if(!s)s=setTimeout(n,t);if(o){u=true}else{e.apply(r,i)}a();o=true}},once:function(e){var t=false,n;return function(){if(t)return n;t=true;n=e.apply(this,arguments);e=null;return n}}},getQueryParams:function(e){var t=e||window.location.search;var n={};var r,i=/\+/g,s=/([^&=]+)=?([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(i," "))},u=t.substring(1);while(r=s.exec(u))n[o(r[1])]=o(r[2]);return n},getQueryStrFromUrl:function(e){var t=e.indexOf("?"),n,r,i;if(t==-1){n=e;r=""}else{n=e.slice(0,t);r=e.slice(t)}return r}},debug:function(){window.RDR=window.READRBOARDCOM;window.$RDR=$RDR;window.$R=e},toggle:function(){e("body").toggle("no-rdr")},session:{alertBar:{make:function(e,n){var r,i,s;if(e=="fromShareLink"&&n.content!="undefined"){var o=unescape(t.evalJSON('"'+n.content+'"'));r=t("<h1>Shared with <span>ReadrBoard</span></h1>");if(t('img[rdr-hash="'+n.container_hash+'"]').length==1){i=t('<div><strong class="reactionText">Reaction: <em>'+n.reaction+"</em></strong>"+' <a class="rdr_showSelection" href="javascript:void(0);"><img src="'+n.content+'" style="max-width:100px !important;max-height:70px !important;margin:5px 0 !important;display:block !important;" />'+' <strong class="seeItLinkText rdr_blue">Show it on the page</strong></a></div>')}else{i=t('<div><strong class="reactionText">Reaction: <em>'+n.reaction+"</em></strong>"+'<strong>"</strong><em>'+o.substr(0,140)+'...</em><strong>"</strong>'+'<br /><strong class="seeItLinkText"><a class="rdr_showSelection" href="javascript:void(0);">Show it on the page</a></strong></div>')}i.find("a.rdr_showSelection").click(function(){setTimeout(function(){RDR.session.revealSharedContent(n)},200)})}if(e=="showMorePins"){r=t("<h1>See <span>more reactions</span> on this page.</h1>");i=t('<div>Readers like you are reacting to, sharing, and discussing content on this page.  <a class="rdr_show_more_pins" href="javascript:void(0);">Click here</a> to see what they\'re saying.<br><br><strong>Tip:</strong> Look for the <img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" /> icons.</div>');i.find("a.rdr_show_more_pins").click(function(){RDR.actions.summaries.showLessPopularIndicators();t(this).closest("div.rdr_alert_box").find("div.rdr_alert_box_x").click()})}if(typeof r!="undefined"){s=t('<img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" />');var u=t('<div class="rdr_alert_box rdr rdr_'+e+'" />');u.append(t('<div class="rdr_alert_box_1" />').append(s).append(r),t('<div class="rdr_alert_box_2" />').append(i),'<div class="rdr rdr_alert_box_x">x</div>');t("#rdr_sandbox").append(u);t("div.rdr_alert_box.rdr_"+e).find(".rdr_alert_box_x").click(function(){RDR.session.alertBar.close(e)});t("div.rdr_alert_box.rdr_"+e).animate({top:-5},1e3)}},close:function(e){t("div.rdr_alert_box.rdr_"+e).remove();t("div.rdr_indicator_for_media").hide();t.postMessage("close "+e,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}},revealSharedContent:function(e){var n=e.container_hash,r=t('[rdr-hash="'+n+'"]');var i=r.data("kind");if(i=="img"||i=="media"||i=="med"){r.addClass("rdr_shared");RDR.actions.indicators.utils.updateContainerTracker(n)}if(e.location&&e.location!="None"){var s=e.location;var o=t().selog("stack");var u=r.selog("save",{serialRange:s});t().selog("hilite",u,"on");t("div.rdr_page_summary").remove()}var a=r.offset().top,f=130,l=a-f||0;t("html,body").animate({scrollTop:l},1e3)},getSharedLinkInfo:function(e){if(t.cookie("content_type")!="pag"){var n=e.container_hash;var r=!!RDR.containers[n];if(!r){return}RDR.session.alertBar.make("fromShareLink",e);return true}},getUser:function(e,n){if(n&&e){RDR.session.receiveMessage(e,n)}else if(n){RDR.session.receiveMessage(false,n)}t.postMessage("getUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])},handleGetUserFail:function(e,n){var r=e.response;switch(r.message){case"Error getting user!":RDR.session.killUser();break;case"Temporary user interaction limit reached":RDR.session.showLoginPanel(e,n);break;case"Container specified does not exist":break;case"Token was invalid":case"Facebook token expired":case"FB graph error - token invalid":case"Social Auth does not exist for user":case"Data to create token is missing":if(typeof RDR.user.user_type!="undefined"&&RDR.user.user_type=="readrboard"){RDR.session.showLoginPanel(e,n)}else{RDR.session.receiveMessage(e,n);t.postMessage("reauthUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}break}},createXDMframe:function(){RDR.session.receiveMessage({},function(){RDR.util.userLoginState()});var e=RDR_baseUrl+"/static/xdm.html",n=window.location.href,r=window.location.protocol+"//"+window.location.host,i=RDR.engageScriptParams.bookmarklet?"bookmarklet=true":"",s=t('<iframe id="rdr-xdm-hidden" name="rdr-xdm-hidden" src="'+e+"?parentUrl="+n+"&parentHost="+r+"&group_id="+RDR.group.id+"&group_name="+encodeURIComponent(RDR.group.name)+"&"+i+'" width="1" height="1" style="position:absolute;top:-1000px;left:-1000px;" />');t("#rdr_sandbox").append(s);$RDR.dequeue("initAjax")},receiveMessage:function(e,n){t.receiveMessage(function(r){var i=t.evalJSON(r.data);if(i.status){if(i.status=="returning_user"||i.status=="got_temp_user"){for(var s in i.data){if(s=="user_boards"){RDR.user=RDR.user||{};RDR.user.user_boards=t.evalJSON(i.data[s])}else{RDR.user[s]=!isNaN(i.data[s])?parseInt(i.data[s],10):i.data[s]}}if(n&&e){if(!e.kind&&e.rindow){e.kind=t(e.rindow).data("kind")}e.user=RDR.user;n(e);n=null}else if(n){n();n=null}RDR.util.userLoginState()}else if(i.status=="board_created"){t("div.rdr-board-create-div").remove()}else if(i.status=="board_create_cancel"){clearInterval(RDR.checkingBoardWindow);t("div.rdr-board-create-div").remove()}else if(i.status=="getUserLoginState"){RDR.session.getUser();t("#rdr_loginPanel").remove()}else if(i.status=="fb_user_needs_to_login"){if(n&&e){RDR.session.showLoginPanel(e,n)}else{RDR.session.showLoginPanel(e)}}else if(i.status=="close login panel"){RDR.util.userLoginState();t("#rdr_loginPanel").remove();t("div.rdr-summary div.rdr_info").html("<em>You're logged in!  Try your last reaction again.")}else if(i.status=="already had user"){t("#rdr_loginPanel div.rdr_body").html('<div style="padding: 5px 0; margin:0 8px; border-top:1px solid #ccc;"><strong>Welcome!</strong> You\'re logged in.</div>')}else if(i.status.indexOf("sharedLink")!=-1){var o=i.status.split("|");if(o[5]){RDR.session.referring_int_id=parseInt(o[5],10)}RDR.session.getSharedLinkInfo({container_hash:o[1],location:o[2],reaction:o[3],content:o[4],page_hash:o[6]})}}},RDR_baseUrl)},login:function(){},checkForMaxInteractions:function(){RDR.user=RDR.user||{};var e=!RDR.user.user_type;if(e&&RDR.user.num_interactions&&RDR.user.num_interactions>=RDR.group.temp_interact){return true}return false},showLoginPanel:function(e,n){t(".rdr_rewritable").removeClass("rdr_rewritable");if(t("#rdr_loginPanel").length<1){var r;if(e&&e.rindow){var i=e.rindow;r=i.offset();r.left=r.left?r.left-34:100;r.top=r.top?r.top-25:100}else{r=[];r.left=t(window).width()/2-200;r.top=150+t(window).scrollTop()}var s=RDR.rindow.draw({coords:r,id:"rdr_loginPanel",pnls:1,height:175,ignoreWindowEdges:"bt"});RDR.rindow.tagBox.setWidth(s,480);if(e)s.data("args",e);if(n)s.data("callback",n);var o=RDR_baseUrl+"/static/fb_login.html",u=window.location.href,a=window.location.protocol+"//"+window.location.host,f=e&&e.response&&e.response.message.indexOf("Temporary user interaction")!=-1?"Log In to Continue Reacting":"Log In to ReadrBoard",l=t('<iframe id="rdr-xdm-login" src="'+o+"?parentUrl="+u+"&parentHost="+a+"&group_id="+RDR.group.id+"&group_name="+RDR.group.name+'" width="480" height="140" frameborder="0" style="overflow:hidden; width:480px !important;" />');if(e&&e.response&&e.response.message.indexOf("organic")!=-1){f="Signing in is required for custom reactions"}var c=RDR.rindow.makeHeader(f);s.find(".rdr_header").replaceWith(c);RDR.rindow.hideFooter(s);s.find("div.rdr_body_wrap").append('<div class="rdr_body" />').append(l)}},killUser:function(){RDR.user={};t.postMessage("killUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])},rindowUserMessage:{show:function(e){var n=e.rindow;var r=e.interactionInfo;if(n){var i=e.msgType||null,s=null,o;var u=45,a=10,f=n.height(),l=300;var c=n.find(".rdr_body_wrap");var h=n.find("div.rdr_rindow_message"),p=n.find(".rdr_rindow_message_innerwrap"),d=t("div.rdr_otherTagsWrap"),v=n.find(".rdr_rindow_message_tempUserMsg");h.show();switch(i){case"tempUser":var m=RDR.group.temp_interact-parseInt(e.num_interactions,10),g=t('<a href="javascript:void(0);">Connect with Facebook</a>.');g.click(function(){RDR.session.showLoginPanel(e)});var y="You can react or comment <strong>"+m+" more times</strong> before you must ";v.empty().append("<span>"+y+"</span>");v.append(g);break;case"existingInteraction":s="You have already given that reaction for this.";break;case"interactionSuccess":if(r.remove){s="The "+r.type+" <em>"+r.body+"</em><br />has been removed.";v.empty()}else{s=r.type=="tag"?"You have tagged this <em>"+r.body+"</em>.":r.type=="comment"?"You have left your comment.":"";s+=" See your "+r.type+"s on this page, and at <strong><a href='"+RDR_baseUrl+"' target='_blank'>readrboard.com</a></strong>"}var b=e;if(n.find("div.rdr_rindow_message_tempUserMsg").text().length>0){$inlineTempMsg=t("<div />");$inlineTempMsg.html('<h4 style="font-size:17px;">You can react '+n.find("div.rdr_rindow_message_tempUserMsg strong").text()+'.</h4><br/><p><a style="font-weight:bold;color:#008be4;" href="javascript:void(0);">Connect with Facebook</a> to react as much as you want & show other readers here what you think.</p><br/><p>Plus, you can share and comment in-line!</p><br/><a href="javascript:void(0);"><img src="'+RDR_staticUrl+'widget/images/fb-login_to_readrboard.png" alt="Connect with Facebook" /></a>');$inlineTempMsg.find("a").click(function(){RDR.session.showLoginPanel(b)})}break}if(s){h.find("span.rdr_userMsg").html(s)}p.hide();n.queue("userMessage",function(){if(h.height()>0){p.fadeIn(500);t(this).dequeue("userMessage")}else{n.animate({height:f+u},l);d.animate({bottom:0},l);c.animate({bottom:u},l);h.animate({height:u},l,function(){p.fadeIn(500);t(this).dequeue("userMessage")})}});n.dequeue("userMessage")}},hide:function(e){if(e){var n=t("div.rdr_rindow_message");$otherTagsWrap=t("div.rdr_otherTagsWrap");var r=e.find(".rdr_body_wrap");var i=n.height(),s=e.height(),o=300,u=10;e.queue("userMessage",function(){e.animate({height:s-i},o);$otherTagsWrap.animate({bottom:0-u},o);r.animate({bottom:u},o);n.animate({height:0},o,function(){n.hide();t(this).dequeue("userMessage")})});e.dequeue("userMessage")}}}},actions:{aboutReadrBoard:function(){},init:function(){var e=this;$RDR=t(RDR);$RDR.queue("initAjax",function(t){e.initGroupData(RDR.group.short_name)});$RDR.queue("initAjax",function(t){e.initEnvironment()});$RDR.queue("initAjax",function(t){e.initPageData()});$RDR.queue("initAjax",function(e){RDR.actions.runPostPageInit();RDR.session.createXDMframe()});$RDR.queue("initAjax",function(e){RDR.util.checkForSelectedTextAndLaunchRindow();RDR.util.initPublicEvents()});$RDR.queue("initAjax",function(e){RDR.util.initTouchBrowserSettings()});$RDR.dequeue("initAjax")},initGroupData:function(e){t.ajax({url:RDR_baseUrl+"/api/settings/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON({host_name:window.location.hostname})},success:function(e,n,r){var i=e.data;var s=RDR.groupSettings.getCustomSettings();RDR.group=t.extend({},RDR.group.defaults,i,s);t(RDR.group.no_readr).each(function(){t(this).addClass("no-rdr");t(this).find("img").addClass("no-rdr")});if(RDR.group.custom_css!==""){t("head").append(t('<style type="text/css">'+RDR.group.custom_css+"</style>"))}$RDR.dequeue("initAjax")},error:function(e){}})},initPageData:function(){var e=RDR.util.getQueryStrFromUrl(RDR.engageScriptSrc);RDR.engageScriptParams=RDR.util.getQueryParams(e);var n=RDR.engageScriptParams.bookmarklet&&!t("#rdr-page-summary").length&&!t(RDR.group.post_selector).length&&!t(RDR.group.summary_widget_selector).length;if(n){t('<div id="rdr-page-summary" class="rdr no-rdr defaultSummaryBar"/>').appendTo("body")}var r=[],i=[],s,o,u,a,f;var l={};if(RDR.group.post_selector!==""&&RDR.group.post_href_selector!==""&&RDR.group.summary_widget_selector!==""){t(RDR.group.post_selector).each(function(){var e=r.length;var n=t(this);var o=n.find(RDR.group.post_href_selector);var a=n.find(RDR.group.summary_widget_selector);if(o.attr("href")){u=o.attr("href");i.push(u);s={group_id:parseInt(RDR.group.id,10),url:u,canonical_url:"same",title:o.text()};r.push(s);l[e]=s;if(!n.hasAttr("rdr-page-container")){n.attr("rdr-page-container","true").attr("rdr-page-key",e)}a.attr("rdr-page-widget-key",e)}})}var c=window.location.href;if(t.inArray(c,i)==-1||i.length==0){a=t('link[rel="canonical"]').length>0?t('link[rel="canonical"]').attr("href"):c;f=t('meta[property="og:title"]').attr("content")?t('meta[property="og:title"]').attr("content"):t("title").text()?t("title").text():"";s={group_id:parseInt(RDR.group.id,10),url:c,canonical_url:c==a?"same":a,title:f};r.push(s);o=r.length-1;l[o]=s;if(!t("body").hasAttr("rdr-page-container")){t("body").attr("rdr-page-container","true").attr("rdr-page-key",o);if(t("#rdr-page-summary").length==1){t("#rdr-page-summary").attr("rdr-page-widget-key",o)}else{var h=t("body").find(RDR.group.summary_widget_selector).eq(0);if(h.attr("rdr-page-widget-key")!="0"){h.attr("rdr-page-widget-key",o)}}}}var p={pages:r};t.ajax({url:RDR_baseUrl+"/api/page/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(p)},success:function(e){t.each(e.data,function(e,t){t.key=e;t.url=l[e].url;RDR.actions.pages.save(t.id,t);RDR.actions.pages.initPageContainer(t.id)});$RDR.dequeue("initAjax")},error:function(e){}})},runPostPageInit:function(){function n(e){var n=t(e),r=n.data("hash");n.removeClass("rdr_live_hover");t("#rdr_indicator_"+r).hide()}var e=RDR.group.img_blacklist&&RDR.group.img_blacklist!=""?":not("+RDR.group.img_blacklist+")":"";if(isTouchBrowser){}else{t("body").on("mouseenter","embed, video, object, iframe, img"+e,function(){var e=t(this);var n=e.data("hash");RDR.actions.indicators.utils.updateContainerTrackers();if(e.closest(".no-rdr").length){return}var r=160;if(e.width()>=r){var i=e.hasAttr("rdr-hashed"),s=e.closest(".rdr, .no-rdr").length;e.addClass("rdr_live_hover");if(!i&&!s){var o=RDR.actions.hashNodes(t(this));var n;t.each(o,function(e,t){n=t[0]});if(!n){RDR.safeThrow("There should always be a hash from hashNodes after hover on an unhashed image.");return}RDR.actions.sendHashes(o,function(){if(e.hasClass("rdr_live_hover")){if(!t("#rdr_indicator_details_"+n).hasClass("rdr_engaged")){t("#rdr_indicator_"+n).show()}}})}else{var n=e.data("hash");e.addClass("rdr_live_hover");if(!t("#rdr_indicator_details_"+n).hasClass("rdr_engaged")){t("#rdr_indicator_"+n).show()}RDR.actions.content_nodes.init(n,function(){})}}}).on("mouseleave","embed, video, object, iframe, img"+e,function(e){var r=t(this);if(!r.parents(RDR.group.img_container_selectors).length){n(r)}})}},initEnvironment:function(){var e=t('<div id="rdr_sandbox" class="rdr rdr_sandbox"/>').appendTo("body");if(isTouchBrowser){t("#rdr_sandbox").addClass("isTouchBrowser")}RDR.util.fixBodyBorderOffsetIssue();if(!!RDR.group.br_replace_scope_selector){RDR.util.fixBrTags()}var n={paddingLeft:t("body").css("padding-left").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("padding-left"))/100):parseInt(t("body").css("padding-left")),marginLeft:t("body").css("margin-left").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("margin-left"))/100):parseInt(t("body").css("margin-left")),left:t("body").css("left").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("left"))/100):parseInt(t("body").css("left")),paddingLeft:t("body").css("padding-top").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("padding-top"))/100):parseInt(t("body").css("padding-top")),marginTop:t("body").css("margin-top").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("margin-top"))/100):parseInt(t("body").css("margin-top")),top:t("body").css("top").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("top"))/100):parseInt(t("body").css("top"))},r=-(n.marginLeft+n.left+n.paddingLeft),i=-(n.marginTop+n.top+n.paddingTop);r=isNaN(r)?0:r;i=isNaN(i)?0:i;var s=parseInt(e.css("top"),10);var o=parseInt(e.css("left"),10);RDR.util.cssSuperImportant(e,{left:o+r+"px",top:s+i+"px"},true);e.append("<style>.rdr_twtooltip { margin-left:"+r+"px !important; margin-top:"+i+"px !important; } </style>");t('<div id="rdr_container_tracker_wrap" /><div id="rdr_indicator_details_wrapper" /><div id="rdr_event_pixels" />').appendTo(e);t(document).on("mouseup.rdr",function(e){setTimeout(function(){RDR.actions.startSelectFromMouseUp(e)},1)});t(document).on("click.rdr",function(e){var n=t(e.target);if(n.closest(".rdr_inline").length||!n.parents().hasClass("rdr")&&!t("div.rdr-board-create-div").length){RDR.actions.UIClearState();t("div.rdr_indicator_details_for_media").each(function(){RDR.actions.containers.media.onDisengage(t(this).data("container"))})}});t(document).on("keyup.rdr",function(e){if(e.keyCode=="27"){RDR.actions.UIClearState()}});t(window).resize(RDR.util.throttledUpdateContainerTrackers());$RDR.dequeue("initAjax")},UIClearState:function(){t("div.rdr_twtooltip").remove();RDR.rindow.closeAll();RDR.actionbar.closeAll();RDR.actions.containers.media.disengageAll();t("div.rdr_indicator_for_media").hide();t("div.rdr.rdr_tag_details.rdr_sbRollover").remove();t().selog("hilite",true,"off");var e=t(".rdr_fromShareLink").length;if(e){RDR.session.alertBar.close("fromShareLink")}},catchRangyErrors:function(e){RDR.safeThrow(e)},hashNodes:function(e,n){if(typeof e==="undefined"){return}var r=t(),i=[{kind:"media",$group:null,whiteList:RDR.group.media_selector,filterParam:"embed, video, object, iframe",setupFunc:function(){var e=this.src;t(this).data({body:e})}},{kind:"img",$group:null,whiteList:RDR.group.img_selector,filterParam:"img",setupFunc:function(){var e=this.src;t(this).data({body:e})}},{kind:"text",$group:null,whiteList:RDR.group.anno_whitelist,filterParam:function(e,n){if(t(n).text()!=t(n).parent().text()){return!!t(n).text()}},setupFunc:function(){var e=RDR.util.getCleanText(this);t(this).data("body",e)}},{kind:"custom",$group:null,whiteList:"",filterParam:function(e,n){var r=t(this);return!!r.hasAttr("rdr-src")},setupFunc:function(){var e=t(this),n=e.attr("rdr-src");e.data({body:n})}}];t.each(i,function(n,i){var s=e.filter(i.filterParam);s=s.add(e.find(i.whiteList));if(!!RDR.group.br_replace_scope_selector&&i.kind=="text"){s=s.add(e.find(".rdr_br_replaced rt"))}s=s.not(r);if(i.kind=="text"){s=s.not(RDR.group.media_selector+", "+RDR.group.img_selector)}s=s.not("[rdr-hashed], .no-rdr, #rdr_sandbox");i.$nodes=s;s.each(function(){i.setupFunc.apply(this);t(this).data("kind",i.kind)});r=r.add(s);var o=r.filter(RDR.group.inline_selector);o.each(function(){t(this).data("inlineIndicator",true)})});if(!r.data("body")){return false}var s={};var o=[];r.each(function(){function y(e){return t(e).find(":not(iframe)").andSelf().contents().filter(function(){return this.nodeType==3})}var e=t(this),n=e.data("body"),r=e.data("kind"),i=e.get(0).nodeName.toLowerCase(),u=n,a,f,l;if(e.closest(".no-rdr").length){return}if((r=="img"||r=="media")&&n){l="rdr-"+r+"-"+u;f=RDR.util.md5.hex_md5(l);e.data("oldHash",f);var c=/[-\w]+\.(?:[-\w]+\.xn--[-\w]+|[-\w]{3,}|[-\w]+\.[-\w]{2})$/i;var h=u.split("/");h.splice(0,2);var p=h.shift();if(!p){return}var d=p.split(":")[0];var v=h.join("/");var m=c.exec(d);if(m==null){return}else{u=m[0]+"/"+v}if(RDR.group.media_url_ignore_query&&u.indexOf("?")){u=u.split("?")[0]}if(e.hasAttr("rdr-oldhash")){a=e.data("hash")}else{l="rdr-"+r+"-"+u;a=RDR.util.md5.hex_md5(l)}}else{if(!n){return}l="rdr-"+r+"-"+n;a=RDR.util.md5.hex_md5(l)}if(e.parents('[rdr-hash="'+a+'"]').length){var g=e.parents('[rdr-hash="'+a+'"]');RDR.actions.stripRdrNode(g)}if(e.get(0).nodeName.toLowerCase()=="img"&&e.parents("[rdr-hash]").length&&!y(e.parents("[rdr-hash]:first")).length){var g=e.parents("[rdr-hash]");RDR.actions.stripRdrNode(g)}RDR.actions.containers.save({body:n,kind:r,hash:a,HTMLkind:i,$this:e});e.attr("rdr-hash",a).attr("rdr-node","true");if(i!="body"&&!isTouchBrowser){e.on("mouseenter",function(){RDR.actions.indicators.init(a);t(this).addClass("rdr_live_hover")}).on("mouseleave",function(){t(this).removeClass("rdr_live_hover")})}var b=RDR.actions.summaries.init(a);RDR.actions.summaries.save(b);o.push(a);var w=RDR.util.getPageProperty("id",a);if(!s[w])s[w]=[];s[w].push(a);e.data("hash",a)});return s},sendHashes:function(e,n){t.each(e,function(e,r){if(!e||typeof r!="object"){RDR.safeThrow("No more messy hashes allowed!!");return}t.each(t("[rdr-custom-display]"),function(e,n){var i=t(n);if(typeof i.data("rdr-hashed")=="undefined"){var s=i.attr("rdr-hash");r=t.grep(r,function(e){return e!=s});r.push(s);RDR.actions.indicators.init(s);i.data("rdr-hashed",true)}});t.each(r,function(e,n){if(typeof n!="string"){RDR.safeThrow("why is your hash not a string!?");return}var r=t('[rdr-hash="'+n+'"]');if(r.length==1){r.attr("rdr-hashed","true")}});var i=parseInt(e,10);if(isNaN(i)){RDR.safeThrow("why is the pageID NAN ??: "+e+"-->"+i)}var s=[];t.each(t('[rdr-crossPageContent="true"]'),function(e,n){var i=t(n).attr("rdr-hash");s.push(i);r=t.grep(r,function(e){return e!=i});RDR.actions.indicators.init(i)});RDR.actions.sendHashesForSinglePage({short_name:RDR.group.short_name,pageID:i,hashes:r,crossPageHashes:s},n)})},sendHashesForSinglePage:function(e,n){var r=e.pageID;t.ajax({url:RDR_baseUrl+"/api/summary/containers/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(e)},success:function(e){if(typeof e!="undefined"&&typeof e.data!="undefined"){if(typeof e.data.known!="undefined"){RDR.known_hashes=e.data.known}if(typeof e.data.crossPageKnown!="undefined"){if(typeof e.data.known!="undefined"){RDR.known_hashes=t.extend(RDR.known_hashes,e.data.crossPageKnown)}RDR.crosspage_hashes=e.data.crossPageKnown}t.each(t('[rdr-crossPageContent="true"]'),function(e,n){var r=t(n).attr("rdr-hash");var i={hash:r,counts:{coms:0,tags:0,interactions:0},top_interactions:{coms:[],tags:{}}};if(typeof RDR.crosspage_hashes!="undefined"){RDR.crosspage_hashes={}}RDR.crosspage_hashes[r]=i});var i={};i[r]=e.data.known;t.each(e.data.unknown,function(e,n){if(typeof n!="string"){RDR.safeThrow("why would this not be a string?");return}var s;var o=t('[rdr-hash="'+n+'"]');var u=o.data("kind");if(!u){RDR.safeThrow("node should always have data: kind")}s=RDR.util.makeEmptySummary(n,u);i[r][n]=s});if(!t.isEmptyObject(i)){RDR.actions.containers.setup(i);if(typeof n!=="undefined"){n()}}var s=[];t.each(e.data.crossPageKnown,function(e,t){s.push(t.hash)});t.each(t("[rdr-custom-display]"),function(e,n){s.push(t(n).data("hash"))});RDR.actions.containers.initCustomDisplayHashes(s)}}})},comments:{makeCommentBox:function(e,n){var r=e.content_node,i=e.tag,s=e.summary,o=e.hash,u=e.$rindow,a=e.selState;n=n||{};var f=n.helpText||"Add comments or #hashtags";var l=n.cta||"Leave a comment";var c=t('<div class="rdr_commentBox rdr_clearfix"></div>');var h=t('<div class="rdr_comment">'),p=t('<textarea class="rdr_default_msg">'+f+"</textarea>"),d=t('<div class="rdr_charCount">'+RDR.group.comment_length+" characters left</div>"),v=t('<button class="rdr_commentSubmit">Comment</button>');h.append(p,d,v);p.focus(function(){RDR.events.track("start_comment_lg::"+r.id+"|"+i.id);t(this).removeClass("rdr_default_msg");if(t(this).val()==f){t(this).val("")}}).blur(function(){var e=t(this).val();if(e===""||e===f){t(this).addClass("rdr_default_msg");t(this).val(f)}}).keyup(function(e){var n=p.val();if(e.keyCode=="27"){t(this).blur();return false}else if(n.length>RDR.group.comment_length){n=n.substr(0,RDR.group.comment_length);p.val(n)}p.siblings("div.rdr_charCount").text(RDR.group.comment_length-n.length+" characters left")});v.click(function(n){t.extend(e,{$commentTextarea:p,helpText:f});RDR.actions.comments.submitComment(e)});c.append(h);return c},submitComment:function(e){var n=e.$commentTextarea,r=e.helpText,i=e.content_node,s=e.summary,o=e.hash,u=e.tag,a=e.$rindow,f=e.selState;var l=n.val();if(l.length>RDR.group.comment_length){l=l.substr(0,RDR.group.comment_length);n.val(l);n.siblings("div.rdr_charCount").text(RDR.group.comment_length-l.length+" characters left")}if(l!=r){if(t.isEmptyObject(i)&&s.kind=="img"){i={body:t("img.rdr-"+s.hash).get(0).src,kind:s.kind,hash:s.hash}}else{i.kind="text"}var c={hash:o,content_node_data:i,comment:l,content:i.body,tag:u,rindow:a,selState:f};RDR.actions.interactions.ajax(c,"comment","create")}else{n.focus()}return false}},containers:{updateCrossPageHash:function(e){var n=t('[rdr-hash="'+e+'"]').length>0;if(!n){return}RDR.actions.indicators.init(e);var r=t('[rdr-hash="'+e+'"]'),i=r.attr("rdr-custom-display"),s=t('[rdr-grid-for="'+i+'"]');if(s.length){RDR.actions.content_nodes.init(e,function(){RDR.actions.indicators.utils.makeTagsListForInline(s,false);s.jScrollPane({showArrows:true})})}},initCustomDisplayHashes:function(e){t.each(e,function(e,n){var r=t('[rdr-hash="'+n+'"]');if(typeof n!="undefined"&&typeof r.attr("rdr_summary_loaded")=="undefined"){RDR.actions.indicators.init(n);RDR.summaries[n].crossPage=true;var i=t('[rdr-hash="'+n+'"]'),s=i.attr("rdr-custom-display"),o=t('[rdr-grid-for="'+s+'"]'),u=o.width(),a=o.height();if(a<200){a=200;o.height(a)}RDR.util.cssSuperImportant(o,{height:a+"px"});if(o.length){var f=parseInt(u/160);u=f*160;if(u>960){u=960}if(!o.closest(".rdr_grid_wrapper").length){o.wrap('<div class="rdr_grid_wrapper" style="width:'+u+"px;height:"+a+'px;"></div>')}o.data("hash",n).data("container",n).addClass("w"+u).html('<div class="rdr rdr_window rdr_inline w'+u+' rdr_no_clear" style="position:relative !important;"><div class="rdr rdr_header"><div class="rdr_header_arrow"><img src="'+RDR_staticUrl+'widget/images/header_up_arrow.png"></div><div class="rdr_loader"></div><div class="rdr_indicator_stats"><img class="no-rdr rdr_pin" src="'+RDR_staticUrl+'widget/images/blank.png"><span class="rdr_count"></span></div><h1>Reactions</h1></div><div class="rdr rdr_body_wrap rdr_clearfix"></div></div>');RDR.actions.content_nodes.init(n,function(){RDR.actions.indicators.utils.makeTagsListForInline(o,false);o.jScrollPane({showArrows:true})})}else{RDR.actions.content_nodes.init(n)}}})},media:{onEngage:function(e){return;var n=t('img[rdr-hash="'+e+'"], iframe[rdr-hash="'+e+'"],embed[rdr-hash="'+e+'"],video[rdr-hash="'+e+'"],object[rdr-hash="'+e+'"]').eq(0),r=t("#rdr_indicator_"+e),i=t("#rdr_indicator_details_"+e);var s=n.hasAttr("rdr-hashed"),o=n.closest(".rdr, .no-rdr").length;var u=RDR.containers[e];if(u){var a=u.$this;a.data("hover",true).data("hash",e);RDR.actions.indicators.utils.updateContainerTracker(e);RDR.rindow.mediaRindowShow(a)}},onDisengage:function(e){return;var n=t('img[rdr-hash="'+e+'"], iframe[rdr-hash="'+e+'"],embed[rdr-hash="'+e+'"],video[rdr-hash="'+e+'"],object[rdr-hash="'+e+'"]').eq(0),r=t("#rdr_indicator_"+e),i=t("#rdr_indicator_details_"+e);var s=n.data("timeoutCloseEvt_"+e);clearTimeout(s);s=setTimeout(function(){var t=RDR.containers[e];if(t){n.data("hover",false).data("hash",e);RDR.rindow.mediaRindowHide(n)}},100);n.data("timeoutCloseEvt_"+e,s)},disengageAll:function(){var e=[];t(".rdr_live_hover").each(function(){var n=t(this).data("hash");e.push(n);RDR.actions.containers.media.onDisengage(n)})}},save:function(e){if(RDR.containers.hasOwnProperty(e.hash))return RDR.containers[e.hash];var t=typeof e.id==="undefined"||e.id===null?null:e.id;var n={id:t,body:e.body||null,kind:e.kind,hash:e.hash,HTMLkind:e.HTMLkind||null,$this:e.$this||null};RDR.containers[e.hash]=n;return n},setup:function(e){var n={img:function(e,t){var n=RDR.containers[e];var r=n.$this;var i=r[0].src;var s={body:i,kind:t.kind,container:e,hash:e};RDR.content_nodes[e]=s;RDR.rindow.update(e);if(isTouchBrowser){RDR.actions.content_nodes.init(e,function(){})}},media:function(e,t){this.img(e,t)},text:function(e,t){},custom:function(e,t){}};var r=[];t.each(e,function(e,i){if(!i||t.isArray(i)){RDR.safeThrow("For godsake no. This should not be an array of hashes and it should not be the bastard cruft of some frankenpage object.");return}t.each(i,function(i,s){s.hash=i;var o=RDR.containers[i];if(o){var u=o.$this;var a={},f=s.top_interactions.coms;t.each(f,function(e,t){if(s.kind=="text"){a[t.tag_id]=t}else{if(!a[t.tag_id])a[t.tag_id]=[];a[t.tag_id].push(t)}});s.top_interactions.coms=a;RDR.actions.summaries.save(s);var l=false;t.each(RDR.pages[e].containers,function(e,t){if(t.hash==i){l=true}});if(l==false){RDR.pages[e].containers.push({hash:i,id:s.id})}else{}var c=s.kind;if(c!="page"){n[c](i,s)}if(s.counts.tags>0){r.push(i)}}})});RDR.actions.summaries.sortPopularTextContainers();RDR.actions.summaries.displayPopularIndicators();t.each(RDR.known_hashes,function(e,n){var r=t('img[rdr-node="returnedHash"]');if(r.length){if(r.data("oldHash")==e){r.attr("rdr-hash",e).attr("rdr-oldhash","true").data("hash",e)}}RDR.actions.indicators.init(e)});RDR.actions.indicators.show(r)},send:function(e,n){function l(){r={};i=0;s=0}var r={},i=0,s=0,o,u,a=300,f=1400;t.each(e,function(e,n){var a=RDR.containers[n];var c={HTMLkind:a.HTMLkind,body:"",hash:a.hash,id:a.id,kind:a.kind};u=encodeURIComponent(t.toJSON(c));o=u.length;if(o>f){c=false}else{s+=o;if(s>f){RDR.actions.containers._ajaxSend(r);l()}r[n]=c;i+=o}});if(!t.isEmptyObject(r)){RDR.actions.containers._ajaxSend(r,n)}},_ajaxSend:function(e,n){var r=e;t.ajax({url:RDR_baseUrl+"/api/containers/create/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(r)},success:function(e){var r=e.data;var i={};t.each(r,function(e,t){if(!t){return}var n=RDR.containers[e];n.id=t;i[e]=RDR.actions.summaries.init(e)});RDR.actions.containers.setup(i);if(typeof n!=="undefined"){n()}}})}},content_nodes:{make:function(e){var t=e.hash;var n;if(e.location){n=e.container+"-"+e.location}else{n=e.container}if(RDR.content_nodes.hasOwnProperty(n))return RDR.content_nodes[n];var r={container:e.container,body:e.body,location:e.location,hash:t};RDR.content_nodes[n]=r;return r},quickFixReset:function(e){var t=RDR.summaries[e],n=typeof t!="undefined"?t.id:"";if(n){delete RDR.assetLoaders.content_nodes[n];RDR.actions.content_nodes.init(e)}},init:function(e,n){var r=RDR.summaries[e],i=typeof r!="undefined"?r.id:"";if(!i){return}var s=RDR.util.getPageProperty("id",e);r.pageId=s;var o={page_id:s,container_id:i,hash:e,cross_page:r.$container.hasAttr("rdr-crossPageContent")?true:false};var u=RDR.assetLoaders.content_nodes[i];if(!u){u=t.ajax({url:RDR_baseUrl+"/api/summary/container/content/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(o)}});RDR.assetLoaders.content_nodes[i]=u}u.then(function(i){if(i.status!=="success"){return false}var s=i.data;t.each(s,function(n,r){var i=t('[rdr-hash="'+e+'"]');try{r.selState=i.selog("save",{serialRange:r.location})}catch(s){r.selState=undefined}});RDR.content_nodes[e]=s;r.content_nodes=s;if(r.kind=="text"){}else{r.top_interactions.coms={};t.each(s,function(e,n){var i=n.top_interactions.coms;t.each(i,function(e,t){r.top_interactions.coms[t.tag_id]=r.top_interactions.coms[t.tag_id]||[];r.top_interactions.coms[t.tag_id].push(t)})})}t('[rdr-hash="'+e+'"]').attr("rdr_summary_loaded","true");if(n){n()}if(RDR.contentNodeQueue&&RDR.contentNodeQueue[e]&&RDR.contentNodeQueue[e].length){t.each(RDR.contentNodeQueue[e],function(){var t=RDR.contentNodeQueue[e].pop();t(e)})}})},utils:{getMediaDims:function(e){var t=e.height();var n=e.width();return!t||!n?{}:{height:t,width:n}},makeDictSortedByTag:function(e){var n={};t.each(e,function(e,r){t.each(r.top_interactions.tags,function(e,t){if(!n.hasOwnProperty(e)){n[e]=[]}n[e].push(r)})});return n},initHiliteStates:function(e,n){t.each(n,function(t,n){if(n.selState){e.data("selStates").push(n.selState)}});if(!isTouchBrowser){e.hover(function(){var e=t(this).data("selStates");var n=e.length?e[e.length-1]:null;if(n){t().selog("hilite",n,"on")}},function(){var e=t(this).data("selStates");var n=e.length?e[e.length-1]:null;if(n){t().selog("hilite",n,"off")}})}}}},interactions:{ajax:function(e,n,r){var i=e.hash,s=RDR.summaries[i],o=s?s.kind:"";if(!r)r="create";if(!RDR.actions.interactions.hasOwnProperty(n)){return false}var u={};RDR.actions.interactions[n].preAjax(e,r);RDR.session.getUser(e,function(e){var s=RDR.actions.interactions.defaultSendData(e),o=RDR.actions.interactions[n].customSendData(e),a=t.extend({},s,o,u);e.sendData=a;e.hash=i;e.sendData.hash=i;RDR.actions.interactions.send(e,n,r)})},send:function(e,n,r){var i=t.extend(true,{},e.sendData);if(i.rindow)delete i.rindow;if(i.settings)delete i.settings;if(i.selState)delete i.selState;if(i.content_node)delete i.content_node;if(i.content_node_data&&i.content_node_data.selState)delete i.content_node_data.selState;if(i.content_node_data&&i.content_node_data.counts)delete i.content_node_data.counts;if(i.content_node_data&&i.content_node_data.top_interactions)delete i.content_node_data.top_interactions;if(i.content_node_data&&i.content_node_data.$container)delete i.content_node_data.$container;if(i.content_node_data&&i.content_node_data.$indicator)delete i.content_node_data.$indicator;if(i.content_node_data&&i.content_node_data.$indicator_details)delete i.content_node_data.$indicator_details;if(i.content_node_data&&i.content_node_data.$rindow_readmode)delete i.content_node_data.$rindow_readmode;if(i.node)delete i.node;if(i.uiMode)delete i.uiMode;if(i.sendData)delete i.sendData;if(RDR.summaries[i.hash])i.container_kind=RDR.summaries[i.hash].kind;if(i.content_node_data&&i.content_node_data.container)delete i.content_node_data.container;var s=n=="react"?"tag":n;if(typeof i.tag!="undefined"){i.tag.body=i.tag.body?i.tag.body:i.tag.tag_body}if(i.kind=="page"){i.hash="page";i.container_kind="text";i.page_id=i.page_id||RDR.util.getPageProperty("id","page");delete i.content_node_data.hash}var o=RDR_baseUrl+"/api/"+s+"/"+r+"/";var u=RDR.session.checkForMaxInteractions(e);if(!u){t.ajax({url:o,type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(i)},success:function(t){e.response=t;if(t.data&&t.data.container){e.container_id=t.data.container.id;var i=e.hash=t.data.container.hash}if(t.data&&t.data.num_interactions){RDR.user.num_interactions=t.data.num_interactions}if(t.status=="success"){if(e.response.data.interaction){}else if(e.response.data.deleted_interaction){}if(e.response.data.deleted_interaction){e.deleted_interaction=e.response.data.deleted_interaction}e.scenario=e.response.data.existing?"reactionExists":e.response.data.deleted_interaction?"tagDeleted":"reactionSuccess";if(typeof e.tag.id=="undefined"){e.tag.id=t.data.interaction.interaction_node.id}RDR.actions.interactions[n].onSuccess[r](e)}else{if(n=="react"){if(t.message=="sign in required for organic reactions"){RDR.session.showLoginPanel(e)}else{RDR.actions.interactions[n].onFail(e)}}else{if(t.message.indexOf("Temporary user interaction limit reached")!=-1){RDR.session.showLoginPanel(e)}if(t.message=="existing interaction"){e.msgType="existingInteraction";RDR.session.rindowUserMessage.show(e)}else{RDR.session.handleGetUserFail(e,function(){RDR.actions.interactions.ajax(e,n,"create")})}}}RDR.util.userLoginState()}})}else{RDR.session.showLoginPanel(e,function(){RDR.actions.interactions.ajax(e,n,"create")})}},defaultSendData:function(e){e.user_id=RDR.user.user_id;e.readr_token=RDR.user.readr_token;e.group_id=RDR.group.id;e.page_id=e.page_id?e.page_id:RDR.util.getPageProperty("id",e.hash);return e},comment:{preAjax:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","visible")},customSendData:function(e){},onSuccess:{create:function(e){var n=e.rindow,r=e.hash,i=e.response,s=e.tag;if(n){n.find("div.rdr_loader").css("visibility","hidden");RDR.actions.content_nodes.quickFixReset(r);var o=n.hasClass("rdr_inline")||n.find(".rdr_inline").length;var u=t('<span class="success_msg" >Thanks for your comment! </span>');var a=t('<a class="rdr_doneButton" href="#">Close</a>').click(function(e){e.preventDefault();RDR.rindow.safeClose(n)});var f=t(".rdr_subheader").length;if(f){t(".rdr_nextActions").remove();n.find(".rdr_subheader").empty().append(u).append(a)}else{n.find(".rdr_commentBox").empty().append(u).append(a)}}var l=i.data.interaction,c=i.data.content_node?i.data.content_node:i.content_node_data?i.content_node_data:e.content_node_data,h=c&&c.id?c.id:"",p=i.data.num_interactions;var d=c.kind=="text"||c.kind=="txt";var v=i.data.existing;if(!d&&v){var m=RDR.content_nodes[r];t.each(m,function(e,t){if(e&&e!="undefined"){c=t;h=c.id}})}var g=parseInt(e.tag.id,10);var y={delta:1,num_interactions:p,id:l.id,body:l.interaction_node.body,content_node:c,content_id:h,tag_id:g,user:e.user,social_user:e.social_user,parent_id:null,parent_interaction_node:e.tag};var b={coms:{}};b.coms[g]=y;RDR.actions.content_nodes.init(r,function(){RDR.actions.summaries.update(r,b)});RDR.util.triggerPublicEvent("comment")},remove:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}},onFail:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}},share:{preAjax:function(){var e=args.rindow;if(e)e.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")},onFail:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}},boardadd:{preAjax:function(){var e=args.rindow;if(e)e.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:{create:function(e){var n=e.rindow?e.rindow:t("div.rdr_tag_details.rdr_reacted.rdr_live_hover");n.find("div.rdr_loader").css("visibility","hidden");var r=e.board_name.replace(/\s/g,"_"),i={board_id:e.board_id,int_id:e.int_id},s=t('<div class="rdr_success">Success!  See <a target="_blank" href="'+RDR_baseUrl+"/board/"+e.board_id+"/"+r+'" class="rdr_seeit_link">your board.</a> <a href="javascript:void(0);" class="rdr_seeit_link rdr_undo">Undo?</a></div>');n.find(".rdr_select_user_board").append(s).find("select").hide();s.find("a.rdr_undo").click(function(){e.rindow=n;RDR.actions.interactions.ajax(e,"boarddelete","create")})}}},boarddelete:{preAjax:function(){var e=args.rindow;if(e)e.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:{create:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}}},react:{preAjax:function(e,t){var n=e.rindow;if(n)n.find("div.rdr_loader").css("visibility","visible")},customSendData:function(e){var n=e.hash,r=RDR.summaries[n],i,s,o;var u=n=="page"||e.kind&&e.kind=="page";if(u){i="page";s=e.tag;c={container:n,body:"",kind:i,hash:n};o={tag:s,node:null,content_node_data:c,hash:n,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:e.page_id?e.page_id:RDR.util.getPageProperty("id",n)}}else{i=r.kind;var a=t('[rdr-hash="'+n+'"]');var f=e.rindow,l=e.tag;s=typeof e.tag.data=="function"?e.tag.data("tag"):e.tag;var c={};var h=e.content_node||null;if(i=="custom"){c={container:f.data("container"),body:a.attr("rdr-src"),kind:"media",location:a.get(0).nodeName.toLowerCase(),hash:n}}else if(i=="img"||i=="media"||i=="med"){var p=a[0].src;if(RDR.group.media_url_ignore_query&&p.indexOf("?")){p=p.split("?")[0]}c={container:f.data("container"),body:p,kind:i,hash:n};var d=RDR.actions.content_nodes.utils.getMediaDims(a);t.extend(c,d)}else{if(h){c={container:f.data("container"),body:h.body,location:h.location,kind:i,id:h.id}}else{var v=f.find("div.rdr_tag_"+s.id).data("content_node_id"),m=v?r.content_nodes[v].selState:f.data("selState");if(!m){RDR.safeThrow("selState not found:  I cannot figure out why this happens every once in a while");return}c={container:f.data("container"),body:m.text,location:m.serialRange,kind:i}}}o={tag:s,node:h,content_node_data:c,hash:c.container,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:RDR.util.getPageProperty("id",n),int_id:e.int_id}}return o},onSuccess:{create:function(e){function w(e){}function E(e){}function S(e){var t={hash:e.hash,kind:"page",page_id:e.page_id,int_id:e.response.data.interaction.id,tag:e.tag,rindow:e.rindow};RDR.actions.interactions.ajax(t,"react","remove")}function x(e){var t={kind:"page",page_id:e.page_id,id:e.response.data.interaction.interaction_node.id,parent_id:null,parent_interaction_node:null,content_id:null,body:e.response.data.interaction.interaction_node.body,delta:1,user:e.user,social_user:e.social_user};var n={tags:{}};n.tags[t.id]=t;RDR.actions.summaries.update(e.hash,n,true,e.page_id)}function T(e){var n=["facebook","twitter","tumblr"];var r=e.hash;var i=t('<div class="shareWrapper" ></div>');i.append('<strong class="rdr_share_it">Share It:</strong>');t.each(n,function(n,s){i.append('<a href="http://'+s+'.com" class="rdr_share_link"><img class="no-rdr" src="'+RDR_staticUrl+"widget/images/social-icons-loose/social-icon-"+s+'.png" /></a>');i.find("a.rdr_share_link:last").click(function(){RDR.events.trackEventToCloud({category:"share",action:"share_open_attempt",opt_label:"which: "+s+", kind: "+e.kind+", page: "+e.page_id+", tag: "+e.tag.body,shareNetwork:s,container_kind:e.kind,page_id:e.page_id});RDR.shareWindow=window.open(RDR_staticUrl+"share.html","readr_share","menubar=1,resizable=1,width=626,height=436");var n=t('meta[property="og:title"]').attr("content")?t('meta[property="og:title"]').attr("content"):t("title").text()?t("title").text():"";RDR.actions.share_getLink({hash:r,kind:e.kind,sns:s,rindow:{},tag:e.tag,content_node:{content:n,kind:"page"}});return false})});return i}var n=e.rindow,r=n.data("mode")||"writeMode",i=e.response,s=i.interaction,o=i.data.interaction.interaction_node,u=i.data.container,a=e.sendData,f=a.content_node_data,l=typeof e.tag.data=="function"?e.tag.data("tag"):e.tag,c=i.data.interaction.id;t("#rdr_loginPanel").remove();if(n)n.find("div.rdr_loader").css("visibility","hidden");t('[rdr-hash="'+p+'"]').removeAttr("rdr_summary_loaded");t(".rdr_twtooltip").remove();if(e.kind&&e.kind=="page"){var h=e.response.data.existing;if(!h){x(e)}else{}RDR.actions.viewReactionSuccess(e)}else{var p=e.hash,d=RDR.summaries[p],v=d.kind;e.settings=e.sendData.content_node_data;var m=a.content_node_data;m.hash=m.container;m.kind=a.kind;if(typeof d.content_nodes=="undefined"){d.content_nodes={}}var g=RDR.containers[p];if(g&&u&&u.id){g.id=u.id}if(typeof d.content_nodes[f.id]=="undefined"){d.content_nodes[f.id]={body:f.body,counts:{coms:0,tags:1,interactions:1},id:f.id,kind:f.kind,location:a.content_node_data.location,selState:false,top_interactions:{coms:{},tags:{}}}}else{if(e.scenario!="reactionExists"){d.content_nodes[f.id].counts.tags++;d.content_nodes[f.id].counts.interactions++}}if(typeof d.content_nodes[f.id].top_interactions.tags[l.id]=="undefined"){d.content_nodes[f.id].top_interactions.tags[l.id]={count:1,body:l.body,parent_id:null}}else{if(e.scenario!="reactionExists"){d.content_nodes[f.id].top_interactions.tags[l.id].count++}}m=e.content_node||RDR.actions.content_nodes.make(m);d.id=d.id||e.container_id;var y={id:o.id,parent_id:null,parent_interaction_node:l,content_id:null,body:o.body,delta:1,user:e.user,social_user:e.social_user};var b={tags:{}};b.tags[y.id]=y;if(e.scenario!="reactionExists"){RDR.actions.summaries.update(p,b)}RDR.actions.viewReactionSuccess(e)}RDR.util.triggerPublicEvent("tag",{body:e.tag.body,hash:e.hash,kind:e.kind})},remove:function(e){var t=e.sendData;var n=e.response.data.deleted_interaction.interaction_node;var r=e.rindow,i=e.tag,s=e.int_id;if(r)r.find("div.rdr_loader").css("visibility","hidden");var o=t.hash;var u={id:n.id,parent_id:null,content_id:null,body:n.body,delta:-1,user:e.user,social_user:e.social_user};var a={tags:{}};a.tags[u.id]=u;var f=e.kind=="page"||o=="page";if(f){RDR.actions.summaries.update(o,a,f,e.page_id)}else{RDR.actions.summaries.update(o,a)}var l={msgType:"interactionSuccess",interactionInfo:{type:"tag",body:n.body,remove:true},rindow:r};r.queue("userMessage",function(){RDR.session.rindowUserMessage.show(l)});if(f){RDR.rindow.updatePageTagMessage(e,"tagDeleted")}else{RDR.rindow.updateTagMessage({rindow:r,tag:e.tag,scenario:"tagDeleted",args:e})}}},onFail:function(e){var t=e.rindow,n=e.response;if(t)t.find("div.rdr_loader").css("visibility","hidden");if(n.message.indexOf("Temporary user interaction limit reached")!=-1){RDR.session.receiveMessage(e,function(){RDR.actions.interactions.ajax(e,"react","create")});RDR.session.showLoginPanel(e)}else if(n.message=="existing interaction"){e.msgType="existingInteraction";RDR.session.rindowUserMessage.show(e)}else{RDR.session.handleGetUserFail(e,function(){RDR.actions.interactions.ajax(e,"react","create")})}}}},indicators:{show:function(e,n){n=true;var r=this.fetch(e);if(r.length==1)r.removeClass("rdr_dont_show");var i=!t.browser.msie?RDR.C.indicatorOpacity:"1";if(!t.browser.msie||t.browser.msie&&parseInt(t.browser.version,10)>8){r.not(".rdr_dont_show").css({opacity:"0",visibility:"visible"});if(n){r.not(".rdr_dont_show").css({opacity:i});return}else{r.filter("div.rdr_indicator_for_text").not(".rdr_dont_show").stop().fadeTo(800,i)}}},hide:function(e){var t=this.fetch(e);t.css({opacity:"0",visibility:"hidden"})},fetch:function(e){var n=t();if(typeof e==="string"){var r=e;n=t("#rdr_indicator_"+r)}else{var i=e;t.each(i,function(e,r){n=n.add(t("#rdr_indicator_"+r))})}return n},init:function(e){function v(){var e=r.$indicator_body=t('<div class="rdr rdr_indicator_body " />').attr("id",u).appendTo(l).append('<img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" />','<span class="rdr_count" />');l.css("visibility","visible")}function m(){l.on("mouseover.showRindow",function(){g();var e=l.hasClass("rdr_helper")&&RDR.group.paragraph_helper;if(e){}})}function g(){if(l.$rindow){if(l.$rindow.data("container")==e){return}l.$rindow.remove()}var t=RDR.rindow.make("readMode",{hash:e});var n=RDR.util.getPageProperty("id",e);if(!t){return}l.$rindow=t;if(l.data("isZeroCountIndicator")){y();RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown_indicatorhelper",opt_label:"kind: text, hash: "+e,container_hash:e,container_kind:"text",page_id:n})}else{RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown_readmode",opt_label:"kind: text, hash: "+e,container_hash:e,container_kind:"text",page_id:n})}}function y(){var n=l.$rindow;var r=RDR.rindow.makeHeader("What do you think?");n.addClass("rdr_helper_rindow");n.find(".rdr_header").replaceWith(r);r.append('<div class="rdr_header_arrow"><img src="'+RDR_staticUrl+'widget/images/header_up_arrow.png" /></div>');$rindowBody=t('<div class="rdr_body rdr_visiblePanel" />');$rindowBody.html("");n.find("div.rdr_body_wrap").append($rindowBody);RDR.rindow.updateFooter(n,'<span class="rdr_cta_msg">Respond to this</span>');n.find(".rdr_footer").addClass("rdr_cta").find(".rdr_cta_msg").click(function(){n.remove();var r=t('[rdr-hash="'+e+'"]');var i=r[0];t("document").selog("selectEl",i);n=RDR.rindow.make("writeMode",{hash:e})})}function b(t){l.on("mouseover.contentNodeInit",function(){if(!l.hasAttr("rdr-custom-display")){RDR.actions.content_nodes.init(e,t)}})}function w(){l.unbind("mouseover.contentNodeInit");l.triggerHandler("mouseover.showRindow")}function E(e){e.each(function(){var e=t(this);e.on("mouseover.showRindow",function(){S(e);var t=l.hasClass("rdr_helper")&&RDR.group.paragraph_helper;if(t){}})})}function S(n){if(l.$rindow){if(l.$rindow.data("container")==e){return}l.$rindow.remove()}var r=n.attr("rdr-mode")=="write"?"writeMode":"readMode";if(r=="writeMode"){if(s.length){el=s[0]}else{var i='[rdr-hash="'+e+'"]';el=t(i)[0]}t("document").selog("selectEl",el)}var o=RDR.rindow.make(r,{hash:e,$custom_cta:n});var u=RDR.util.getPageProperty("id",e);if(!o){return}l.$rindow=o;RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown_"+n.attr("rdr-mode")+"mode",opt_label:"kind: text, hash: "+e,container_hash:e,container_kind:"text",page_id:u})}var n=this;var r=RDR.summaries[e];if(typeof r!="undefined"&&r.$container.hasAttr("rdr-node")){var i=r.kind,s=r.$container,o="rdr_indicator_"+e,u="rdr_indicator_body_"+e,a="rdr_indicator_details_"+e;if(s.hasAttr("rdr-page-container"))return;s.attr("rdr-hasIndicator","true");if(s.hasAttr("rdr-custom-display")){var f=s.attr("rdr-custom-display"),l=r.$indicator=s,c=t('[rdr-counter-for="'+f+'"]'),h=t('[rdr-grid-for="'+f+'"]'),p=t('[rdr-cta-for="'+f+'"]');b();if(c.length){c.addClass("rdr_count")}if(p.length){E(p);w()}if(h.length){}RDR.actions.indicators.update(e)}else{t("#rdr_indicator_"+e).remove();t("#rdr_container_tracker_"+e).remove();t("#rdr_indicator_details_"+e).remove();var l=r.$indicator=t('<div class="rdr_indicator" />').attr("id",o).data("hash",e);v();if(!i){return}RDR.actions.indicators.utils.kindSpecificSetup[i](e);if(i=="text"){s.unbind(".rdr_helper");if(!isTouchBrowser){s.bind("mouseenter.rdr_helper",function(){var e=l.hasClass("rdr_helper")&&RDR.group.paragraph_helper;if(e){RDR.actions.indicators.helpers.over(l)}});s.bind("mouseleave.rdr_helper",function(e){var t=l.hasClass("rdr_helper")&&RDR.group.paragraph_helper;if(t){RDR.actions.indicators.helpers.out(l)}})}var d=!(r.counts.tags>0);l.data("isZeroCountIndicator",d);if(d){l.addClass("rdr_helper");if(isTouchBrowser){l.addClass("isTouchBrowser")}m()}else{b(function(){m();w()})}}RDR.actions.indicators.update(e)}}},update:function(e,n){var r=this;var i=RDR.summaries[e],s=i.kind,o=i.$container,u=i.kind==="text";if(o.hasAttr("rdr-custom-display")){var a=o.attr("rdr-custom-display"),f=i.$indicator=o,l=t('[rdr-counter-for="'+a+'"]'),c=t('[rdr-grid-for="'+a+'"]'),h=t('[rdr-cta-for="'+a+'"]');if(l.length){if(i.counts.tags>0){l.html(RDR.commonUtil.prettyNumber(i.counts.tags))}else{l.html("No")}}if(h.length){}if(c.length){}}else{if(n){if(u){o.closest("[rdr-node]").find(".rdr_indicator").remove()}else{}RDR.actions.indicators.init(e);return}var f=i.$indicator,p=i.$indicator_body,d=i.$indicator_details;var v=p.find(".rdr_count"),m=d?d.find("div.rdr_header h1"):false,g=i.counts.tags>0;if(g){if(u){v.html(RDR.commonUtil.prettyNumber(i.counts.tags))}else{var y=i.counts.tags>1?" Reactions":" Reaction";v.html(RDR.commonUtil.prettyNumber(i.counts.tags)+y)}if(m)m.html(RDR.commonUtil.prettyNumber(i.counts.tags)+" Reactions");RDR.actions.indicators.show(e)}else{v.html('<span class="rdr_react_label">What do you think?</span>');if(u){if(RDR.group.paragraph_helper){RDR.actions.indicators.show(e);f.addClass("rdr_helper");if(isTouchBrowser){f.addClass("isTouchBrowser")}}else{RDR.actions.indicators.hide(e)}}}}},helpers:{over:function(e){var t=e.data("containerHover");if(t){return}if(isTouchBrowser){e.css({display:"inline"})}else{RDR.util.cssSuperImportant(e,{display:"inline"})}e.css("opacity",RDR.C.helperIndicators.opacity)},out:function(e){e.data("containerHover",false);var t=e.data("hoverTimeout");clearTimeout(t);if(isTouchBrowser){e.css({display:"none"})}else{RDR.util.cssSuperImportant(e,{display:"none"})}}},utils:{checkTrailingWhiteSpace:function(e){var n=e.children().get().reverse();var r=null;var i=true;t.each(n,function(e){if(!i){return}var n=t(this).text()=="";if(n){r=this}else{i=false}});return r},kindSpecificSetup:{img:function(e){function c(){if(t("div.rdr_media_details").not("rdr_loaded").length){var r=n.$indicator_details=t("<div />").attr("id",a).addClass("rdr rdr_indicator_details rdr_widget rdr_widget_bar");t("div.rdr_media_details").html(r);u.addClass("rdr_inline_video");t("div.rdr_media_details").addClass("rdr_sandbox")}else{var r=n.$indicator_details=t("<div />").attr("id",a).addClass("rdr rdr_indicator_details rdr_widget rdr_widget_bar").appendTo("#rdr_indicator_details_wrapper")}r.data("container",e);r.data("hash",e);r.data("summary",n);r.addClass("rdr_indicator_details_for_media").click(function(){r.addClass("rdr_live_hover");RDR.actions.containers.media.onEngage(e)});i.addClass("rdr_indicator_for_media rdr_indicator_for_media_inline").find(".rdr_indicator_body").append('<div class="rdr_chevron_cta"><i class="rdr_icon-chevron-down"></i></div>');if(isTouchBrowser){i.click(function(){t(this).toggleClass("rdr_hover")})}}var n=RDR.summaries[e],r=n.$container,i=n.$indicator,s=n.$indicator_body,o=t("#rdr_container_tracker_wrap"),u=t('<div class="rdr_container_tracker" />'),a="rdr_indicator_details_"+e,f=RDR.util.getPageProperty("id",e);var l=t("#rdr_container_tracker_"+e);if(l.length){RDR.safeThrow("Images are not expected to get re-inited.");return}u.attr("id","rdr_container_tracker_"+e).appendTo(o);c();i.appendTo(u);if(isTouchBrowser){i.click(function(){if(n.counts.interactions==0){var r=RDR.rindow.make("writeMode",{hash:e})}else{var r=RDR.rindow.make("readMode",{hash:e})}t(this).addClass("rdr_live_hover")})}else{i.on("mouseenter",function(){if(n.counts.interactions==0){var r=RDR.rindow.make("writeMode",{hash:e})}else{var r=RDR.rindow.make("readMode",{hash:e})}t(this).addClass("rdr_live_hover")}).on("mouseleave",function(){t(this).removeClass("rdr_live_hover")})}RDR.actions.indicators.utils.updateContainerTracker(e)},media:function(e){this.img(e)},text:function(e){var n=RDR.summaries[e],r=n.$container,i=n.$indicator,s=n.$indicator_body,o=t("rdr_actionbar_"+e);i.addClass("rdr_indicator_for_text").addClass("rdr_dont_show");var u=RDR.actions.indicators.utils.checkTrailingWhiteSpace(r);if(u){t(u).before(i)}else{i.appendTo(r)}}},makeDetailsContent:function(e){var n=this;var r=RDR.summaries[e],i=r.$container,s=r.$indicator,o=r.$indicator_body,u=r.$indicator_details,a=t("rdr_actionbar_"+e);if(typeof s!="undefined"){u.find("div.rdr_body_wrap").remove();var f=RDR.rindow.makeDefaultPanelMessage(u);var l=RDR.rindow.makeHeader(f);var c=t('<div class="rdr rdr_body_wrap rdr_clearfix" />');var h=r.kind;var p=h=="img"||h=="image"||h=="imgage"||h=="med"||h=="media";if(p&&!u.find("div.rdr_view_success").length){u.data("initialWidth",i.width())}var d=u;var v=RDR.actions.indicators.utils.makeTagsListForInline(d);c.append(v);u.empty().append(l,c)}},makeTagsListForInline:function(e,n,r){function p(e){function n(e,t){return t.tag_count-e.tag_count}t.each(e,function(e,t){if(!t.tag_count)t.tag_count=-101});e.sort(n);var r={big:[],medium:[],small:[]},i=e[0].tag_count,s=e[Math.floor(e.length/2)].tag_count,o=e[e.length-1].tag_count,u=function(e){var n=0;t.each(e,function(e,t){n+=t.tag_count});return Math.floor(n/e.length)}(e),a=s>u?s:u;t.each(e,function(e,t){var n=typeof t.tag_body!="undefined"?t.tag_body:t.body;if(i>15&&t.tag_count>=Math.floor(i*.8)){r.big.push(t);return}else if(t.tag_count>a){r.medium.push(t);return}else{r.small.push(t);return}});return r}function d(t){if(!t.length){return}var i=p(t),s=i.big.length+i.medium.length+i.small.length,o=1;if(s>6&&!n){if(isTouchBrowser){RDR.rindow.tagBox.setWidth(e,320)}else{RDR.rindow.tagBox.setWidth(e,480)}}else if(typeof r!="undefined"&&n){RDR.rindow.tagBox.setWidth(e,320)}else if(t.length>1){if(i.big.length){RDR.rindow.tagBox.setWidth(e,320)}if(i.medium.length){RDR.rindow.tagBox.setWidth(e,320)}if(i.small.length>=3){RDR.rindow.tagBox.setWidth(e,320)}}while(i.big.length||i.medium.length||i.small.length){if(i.big.length){var u=i.big.shift();RDR.rindow.tagBox.make({tag:u,boxSize:"big",$rindow:e,isWriteMode:n,colorInt:o});o++;if(o==6)o=1}else if(i.medium.length){var u=i.medium.shift();RDR.rindow.tagBox.make({tag:u,boxSize:"medium",$rindow:e,isWriteMode:n,colorInt:o});o++;if(o==6)o=1}else if(i.small.length){var u=i.small.shift();RDR.rindow.tagBox.make({tag:u,boxSize:"small",$rindow:e,isWriteMode:n,colorInt:o});o++;if(o==6)o=1}}}function v(e){e.isotope({masonry:{columnWidth:160}},function(){function i(){var i=e.find("div.rdr_box:eq("+n+")");i.addClass("rdr_animated");n++;if(n>t){clearInterval(r)}}var t=e.find("div.rdr_box").length,n=0;var r=setInterval(i,10)})}function m(e){var n=e.find(".rdr_box");var r=n.eq(-1);if(!r.length){return}var i=r.position();var s=false;r.addClass("rdr_clear_transform").css({height:"auto",width:"auto",top:i.top,left:i.left,bottom:0,right:0});t(n.get().reverse()).each(function(){if(s){return}var e=t(this);var n=e.position();var r=n.top==i.top;var o=n.top==i.top;var u=n.left==i.left;if(!o&&!u){s=true;return}if(o){e.addClass("rdr_clear_transform").css({height:"auto",top:n.top,left:n.left,bottom:0})}})}var i=e.data("hash");var s=!i||i=="page";var o=!s?RDR.summaries[i]:{};var u=RDR.groupSettings.getBlessedTags(i);if(!Date.now){Date.now=function(){return(new Date).valueOf()}}var a=t('<div class="rdr_body rdr_tags_list" />').data("now",Date.now()),f=t('<div class="rdr_body rdr_tags_list" />').data("now",Date.now());var l=e.find(".rdr_tags_list");e.find(".rdr_body_wrap").append(a);l.remove();if(typeof r!="undefined"){if(!n&&r.toptags.length){d(r.toptags);RDR.rindow.updateFooter(e,'<span class="rdr_cta_msg">What do you think?</span>');e.find(".rdr_footer").addClass("rdr_cta").find("span.rdr_cta_msg").click(function(){e.remove();e=RDR.rindow.make("writeMode",{hash:"page",page:r,is_page:true})})}else{var c=RDR.rindow.makeHeader("What do you think?"),n=true;e.find(".rdr_header").replaceWith(c);d(u);var h=RDR.rindow.writeCustomTag(a,e);e.removeClass("rdr_rewritable")}}else if(n){d(u)}else if(s){}else{if(!t.isEmptyObject(o.top_interactions.tags)){RDR.actions.summaries.sortInteractions(i);d(o.interaction_order);if(o.kind=="text"){if(!o.crossPage){RDR.rindow.updateFooter(e,'<span class="rdr_cta_msg">What do you think?</span>');e.find(".rdr_footer").addClass("rdr_cta").find(".rdr_cta_msg").click(function(){e.remove();var n=t('[rdr-hash="'+i+'"]');var r=n[0];t("document").selog("selectEl",r);e=RDR.rindow.make("writeMode",{hash:i})})}}else{RDR.rindow.updateFooter(e,'<span class="rdr_cta_msg">What do you think?</span>');e.find(".rdr_footer").addClass("rdr_cta").find(".rdr_cta_msg").click(function(){e.remove();e=RDR.rindow.make("writeMode",{hash:i})})}}else{RDR.rindow.updateFooter(e,'<span class="rdr_no_reactions_msg rdr_clearfix">No reactions yet!</span>')}}if(typeof r=="undefined"&&n){var h=RDR.rindow.writeCustomTag(a,e);e.removeClass("rdr_rewritable")}if(!n&&!isTouchBrowser){e.on("mouseleave",function(e){var n=t(this),r;r=setTimeout(function(){if(n.hasClass("rdr_rewritable")){n.remove()}},300);t(this).data("timeoutCloseEvt",r)}).on("mouseenter",function(){var e=t(this).data("timeoutCloseEvt");clearTimeout(e)});if(typeof o!="undefined"&&o.kind=="text"&&!t.isEmptyObject(o.content_nodes)){e.find("div.rdr_box").each(function(){t(this).hover(function(){var n=o.content_nodes[t(this).find("div.rdr_tag").data("content_node_id")].selState;var r=!e.data("panelState")||e.data("panelState")===1;if(r){t().selog("hilite",n,"on");e.data("selState",n)}},function(){var n=o.content_nodes[t(this).find("div.rdr_tag").data("content_node_id")].selState;var r=!e.data("panelState")||e.data("panelState")===1;if(r){t().selog("hilite",n,"off")}})})}}if(s){}v(a);m(a);return a},updateContainerTrackers:function(){t.each(RDR.containers,function(e,t){if(t.kind&&(t.kind=="img"||t.kind=="media"||t.kind=="med")){RDR.actions.indicators.utils.updateContainerTracker(t.hash)}})},updateContainerTracker:function(e){var n=RDR.summaries[e],r=n.$container,i=t("#rdr_container_tracker_"+e);var s=RDR.containers[e];if(s.kind&&(s.kind=="text"||s.kind=="txt"))return;var o={top:parseInt(r.css("padding-top"),10),right:parseInt(r.css("padding-right"),10),bottom:parseInt(r.css("padding-bottom"),10),left:parseInt(r.css("padding-left"),10)};var u=parseInt(r.css("border-top-width"),10)+parseInt(r.css("border-bottom-width"),10)+parseInt(r.css("border-left-width"),10)+parseInt(r.css("border-right-width"),10);var a={};a.top=!u?o.top:0;a.left=!u?o.left:0;RDR.util.cssSuperImportant(i,{top:r.offset().top+a.top+"px",left:r.offset().left+a.left+"px"},true);this.updateMediaTracker(e)},updateInlineIndicator:function(e){var t=RDR.summaries[e],n=t.$container,r=t.$indicator_details;r.css({top:n.offset().bottom,left:n.offset().left,width:n.outerWidth()})},updateMediaTracker:function(e){var n=RDR.summaries[e],r=n.$container,i=n.$indicator,s=n.$indicator_body,o=n.$indicator_details,u=t("#rdr_container_tracker_"+e);if(s){if(r.parents(RDR.group.img_container_selectors).length){r=r.parents(RDR.group.img_container_selectors).first()}var a,f;var l=parseInt(r.css("border-top-width"),10)+parseInt(r.css("border-bottom-width"),10)+parseInt(r.css("border-left-width"),10)+parseInt(r.css("border-right-width"),10);if(l){a=r.outerWidth();f=r.outerHeight()}else{a=r.width();f=r.height()}var c={top:parseInt(r.css("padding-top"),10),right:parseInt(r.css("padding-right"),10),bottom:parseInt(r.css("padding-bottom"),10),left:parseInt(r.css("padding-left"),10)};var h=0,p=s.width(),d=t.browser.msie&&parseInt(t.browser.version,10)<9?10:0;var v=n.kind=="media"?r.height()+d+36:r.height()+d+12;i.data("top",v);if(n.kind=="media"){i.addClass("rdr_indicator_not_img")}RDR.util.cssSuperImportant(i,{left:12+"px",top:v+"px"},true);var m=n.kind=="text"?false:true;if(m){RDR.actions.indicators.utils.updateInlineIndicator(e)}else{}}},borderHilites:{designVersion:2,makeAttempt:0,make:function(e){var n=t("#rdr_indicator_"+e),r=t('[rdr-hash="'+e+'"]'),i=t("#rdr_container_tracker_"+e),s=i.find(".rdr_media_border_wrap");if(!i.hasClass("rdr_inline_video")){if(!s.length){s=t('<div class="rdr_media_border_wrap" />').appendTo(i);s.addClass("designVersion_"+RDR.actions.indicators.utils.borderHilites.designVersion)}s.hide();var o={top:{$side:null,css:{}},right:{$side:null,css:{}},bottom:{$side:null,css:{}},left:{$side:null,css:{}}};s.data("borders",o)}},update:function(e){var n=RDR.actions.indicators.utils.borderHilites;var r=t("#rdr_indicator_"+e),i=t('[rdr-hash="'+e+'"]'),s=t("#rdr_container_tracker_"+e),o=s.find(".rdr_media_border_wrap");if(!o.length){if(this.makeAttempt>1)return;this.makeAttempt++;RDR.actions.indicators.utils.borderHilites.make(e);return}this.makeAttempt=0;o.hide();var u={top:{$side:null,css:{}},right:{$side:null,css:{}},bottom:{$side:null,css:{}},left:{$side:null,css:{}}};var a=n.designVersion===1?2:n.designVersion===2?3:2;var f,l;var c=false;t.each(u,function(e,n){var r="rdr_mediaHilite_"+e;n.$side=o.find("."+r);if(!n.$side.length){n.$side=t("<div />").addClass(r).appendTo(o)}if(parseInt(i.css("border-"+e+"-width"),10)){c=true}});if(c){f=i.outerWidth();l=i.outerHeight()}else{f=i.width();l=i.height()}var h=2*a;u.top.css={width:f+h+"px",height:0+"px",top:-a+"px",left:-a+"px"};u.right.css={width:0+"px",height:l+"px",top:0+"px",left:f+"px"};u.bottom.css={width:f+h+"px",height:0+"px",top:l+"px",left:-a+"px"};u.left.css={width:0+"px",height:l+"px",top:0+"px",left:-a+"px"};t.each(u,function(e,t){RDR.util.cssSuperImportant(t.$side,t.css,true)})},engage:function(e,n){var r=t("#rdr_container_tracker_"+e),i=r.find(".rdr_media_border_wrap");i.addClass("engaged");if(n){i.addClass("engagedForShareLink")}},disengage:function(e){var n=t("#rdr_container_tracker_"+e),r=n.find(".rdr_media_border_wrap");r.removeClass("engaged");r.removeClass("engagedForShareLink");t("#rdr_indicator_"+e).hide()},engageAll:function(){$mediaBorderWrap=t(".rdr_media_border_wrap");$mediaBorderWrap.addClass("engaged")},disengageAll:function(){$mediaBorderWrap=t(".rdr_media_border_wrap");$mediaBorderWrap.removeClass("engaged");$mediaBorderWrap.removeClass("engagedForShareLink");t("div.rdr_indicator_for_media").hide()}}}},summaries:{init:function(e){var t=RDR.containers[e];var n={hash:e,kind:t.kind,id:t.id,counts:{coms:0,tags:0,interactions:0},top_interactions:{coms:{},tags:{}}};return n},save:function(e){var n=e.hash;if(RDR.summaries.hasOwnProperty(n)){}RDR.summaries[n]=e;e.$container=t('[rdr-hash="'+n+'"]')},update:function(e,n,r,i){function o(e){var t=e.hash;var n=e.summary;var r=e.interaction_node_type;var i=e.id;var s=e.diffNode;var o=n.top_interactions[r];var u=o.hasOwnProperty(i)&&typeof o[i]!=="undefined";if(u){var a=o[i];a.count+=s.delta;if(r=="tags"){RDR.actions.summaries.updatePageSummaryTags(t,s);if(a.count<=0){delete o[i]}}}else{if(r=="tags"){o[i]={count:s.delta,body:s.body,id:i,parent_id:s.parent_id,parent_interaction_node:s.parent_interaction_node};RDR.actions.summaries.updatePageSummaryTags(t,s)}else{var f=s.user;o[s.tag_id]={body:s.body,content_node:s.content_node,content_id:s.content_id,id:s.id,social_user:s.social_user,tag_id:s.tag_id,user:s.user,parent_id:s.parent_id,parent_interaction_node:s.parent_interaction_node}}}}function u(e){return;var n=e.hash;var r=e.summary;var i=e.interaction_node_type;var s=e.id;var o=e.diffNode;var u=r.content_nodes;if(!u){return}t.each(u,function(e,n){if(i=="tags"){if(e===o.content_id){n.counts[i]+=o.delta;n.counts[interactions]+=o.delta;var r=o.id;var s=n.top_interactions.tags[r];if(s){s.count+=o.delta;if(s.count<=0){delete n.top_interactions.tags[r]}}}}else if(i=="coms"){if(n.id===o.content_id){n.counts[i]+=o.delta;n.counts[interactions]+=o.delta;var u=n.top_interactions.coms;if(o.delta===-1){t.each(u,function(e,t){})}else{}}}})}if(r){t.each(n,function(n,r){t.each(r,function(t,n){n.page_id=i;RDR.actions.summaries.updatePageSummaryTags(e,n)})});return}var s;if(!RDR.summaries.hasOwnProperty(e)){s=RDR.actions.summaries.init(e)}else{s=RDR.summaries[e]}t.each(n,function(n,r){t.each(r,function(t,r){o({hash:e,summary:s,interaction_node_type:n,id:t,diffNode:r});s.counts[n]+=r.delta;s.counts.interactions+=r.delta;r.int_type=n;RDR.rindow.update(e,r)})});RDR.actions.summaries.sortInteractions(e);if(e=="pageSummary"){makeSummaryWidget(RDR.page)}else{}},updatePageSummaryTags:function(e,n){var r=n.id;var i=n.page_id||RDR.util.getPageProperty("id",e);var s=RDR.pages[i];var o=s.toptags;var u;t.each(o,function(){if(this.id==r){s.count+=n.delta;this.tag_count+=n.delta;u=true}});if(!u){o.push({body:n.body,id:n.id,tag_count:1})}var a=s.summary;t.each(a,function(e,t){if(t.kind=="tag"){t.count=t.count+n.delta}});var f=t('[rdr-page-container="'+i+'"]');var l=f.find("[rdr-page-widget-key]");l.rdrWidgetSummary("update")},sortByTags:function(e){function t(e,t){return t.tag_count-e.tag_count}return e.sort(t)},sortInteractions:function(e){function n(e,t){return t.tag_count-e.tag_count}var r=RDR.summaries[e];r.interaction_order=[];var i=r.kind=="text"||r.kind=="txt";if(i){if(!t.isEmptyObject(r.content_nodes)){t.each(r.content_nodes,function(e,n){t.each(n.top_interactions.tags,function(t,n){r.interaction_order.push({tag_count:n.count,tag_id:t,tag_body:n.body,content_node_id:e,parent_id:n.parent_id})})})}else{t.each(r.top_interactions.tags,function(e,t){r.interaction_order.push({tag_count:t.count,tag_id:e,tag_body:t.body,content_node_id:s,parent_id:t.parent_id})})}}else if(!t.isEmptyObject(r.top_interactions)&&!t.isEmptyObject(r.content_nodes)){var s=t.map(r.content_nodes,function(e,t){return t})[0];t.each(r.top_interactions.tags,function(e,t){r.interaction_order.push({tag_count:t.count,tag_id:e,tag_body:t.body,content_node_id:s,parent_id:t.parent_id})})}r.interaction_order.sort(n)},sortPopularTextContainers:function(){function e(e,t){return t.interactions-e.interactions}RDR.text_container_popularity=[];t.each(RDR.summaries,function(e,t){if(t.kind=="text"&&t.counts.interactions>0){RDR.text_container_popularity.push({hash:e,interactions:t.counts.interactions})}});RDR.text_container_popularity.sort(e)},displayPopularIndicators:function(){for(var e=0;e<RDR.group.initial_pin_limit;e++){if(RDR.text_container_popularity[e])t("#rdr_indicator_"+RDR.text_container_popularity[e].hash).removeClass("rdr_dont_show")}},showLessPopularIndicators:function(){var e=[];for(var n=RDR.group.initial_pin_limit;n<RDR.text_container_popularity.length;n++){if(RDR.text_container_popularity[n]){if(RDR.text_container_popularity[n].interactions>0){t("#rdr_indicator_"+RDR.text_container_popularity[n].hash).removeClass("rdr_dont_show");e.push(RDR.text_container_popularity[n].hash)}}}RDR.actions.indicators.show(e)}},insertContainerIcon:function(e){},viewReactionSuccess:function(e){var n=e.tag,r=e.rindow,i=e.response.data.interaction,s=e.content_node==""?e.response.data.content_node:e.content_node;r.removeClass("rdr_rewritable").addClass("rdr_viewing_more").find(".rdr_footer").hide();var o=e.scenario=="reactionSuccess"?"Thanks for your reaction!":"You've already reacted to this";var u=e.kind=="page";if(u){var a=null,f="page"}else{var a=e.hash,l=RDR.summaries[a],f=l.kind}var c=RDR.rindow.makeHeader(o,e.response.data.interaction.id);r.find(".rdr_header").replaceWith(c);var h=RDR.rindow.panelCreate(r,"rdr_view_more");var p=r.find("div.rdr_body_wrap");p.append(h);RDR.rindow.updateTagMessage(e);RDR.rindow.panelShow(r,h,function(){if(f=="text"&&e.selState){var n=e.selState;t().selog("hilite",n,"on")}var i=RDR.actions.indicators.utils.makeTagsListForInline(r);RDR.actions.containers.updateCrossPageHash(a);i.addClass("rdr_hiddenPanel");var s="rdr_tags_list";RDR.rindow.hideFooter(r);RDR.rindow.panelUpdate(r,s,i);var o=t('[rdr-hash="'+a+'"]').length>0;if(!o){}})},viewCommentContent:function(e){function y(){var e=t('<div class="rdr_commentBox rdr_innerWrap"></div>').html('<div class="rdr_commentComplete"><div><h4>Leave a comment:</h4></div></div>');var u="Add a comment or #hashtag",a=t('<div class="rdr_comment rdr_clearfix">'),f=t('<textarea class="commentTextArea rdr_default_msg">'+u+"</textarea>"),l=t('<div class="rdr_charCount">'+RDR.group.comment_length+" characters left</div>"),c=t('<button class="rdr_commentSubmit">Comment</button>');a.append(f,l,c);f.focus(function(){if(t(this).val()==u){t(this).val("")}}).blur(function(){var e=t(this).val();if(e===""||e===u){t(this).addClass("rdr_default_msg");t(this).val(u)}}).keyup(function(e){var n=f.val();if(e.keyCode=="27"){t(this).blur();return false}else if(n.length>RDR.group.comment_length){n=n.substr(0,RDR.group.comment_length);f.val(n)}f.siblings("div.rdr_charCount").text(RDR.group.comment_length-n.length+" characters left")});c.click(function(e){var a=f.val();if(a.length>RDR.group.comment_length){a=a.substr(0,RDR.group.comment_length);f.val(a);f.siblings("div.rdr_charCount").text(RDR.group.comment_length-a.length+" characters left")}if(a!=u){if(t.isEmptyObject(i)&&o.kind=="img"){i={body:t('img[rdr-hash="'+o.hash+'"]').get(0).src,kind:o.kind,hash:o.hash}}else{i.kind="text"}var l=l||null;var c={hash:s,content_node_data:i,comment:a,content:i.body,tag:n,rindow:r,selState:l};RDR.actions.interactions.ajax(c,"comment","create")}else{f.focus()}return false});e.append(a);return e}function b(){var e=t('<div class="rdr_back">Close X</div>');e.click(function(){var e=!!r.attr("rdr-grid-for");if(!e){RDR.rindow.close(r);return}var t=RDR.rindow.makeHeader("Reactions");r.find(".rdr_header").replaceWith(t);RDR.rindow.updateTagPanel(r)});return e}function w(){var e,r=n.id?n.id:n.tag_id;if(a=="text"){e=o.content_nodes[i.id].top_interactions.coms}else{e=o.top_interactions.coms[r]}var s=0;if(!t.isArray(e)){e=[].push(e)}t.each(e,function(e,t){if(t.tag_id==r){s++}});var u=!t.isEmptyObject(e);if(!u)return;var f=t('<div class="rdr_otherCommentsBox"></div>');var l=t('<div class="rdr_comment_header rdr_innerWrap"><h4>(<span>'+s+"</span>) Comments:</h4></div>");f.append(l);t.each(e,function(e,n){if(n.tag_id!=r){return}f.show();var i=t('<div class="rdr_commentSet rdr_innerWrap" />'),s=t('<div class="rdr_commentBy" />'),o=t('<div class="rdr_comment" />'),u=t('<div class="rdr_commentReplies" />'),a=t('<div class="rdr_commentReply" />'),l=t('<a href="javascript:void(0);">Reply</a>');var c=n&&n.social_user&&n.social_user.img_url?n.social_user.img_url:RDR_staticUrl+"widget/images/anonymousplode.png";var h=!n||!n.user||n.user.first_name===""?"Anonymous":n.user.first_name+" "+n.user.last_name;s.html('<a href="'+RDR_baseUrl+"/user/"+n.user.id+'" target="_blank"><img src="'+c+'" class="no-rdr" /> '+h+"</a>").click(function(){});o.html('<div class="rdr_comment_body">'+n.body+"</div>");i.append(s,o);f.append(i)});f.find("div.rdr_commentSet:last-child").addClass("rdr_lastchild");return f}var n=e.tag,r=e.rindow,i=e.content_node;r.removeClass("rdr_rewritable").addClass("rdr_viewing_more");RDR.rindow.tagBox.setWidth(r,320);RDR.rindow.hideFooter(r);var s=e.hash,o=RDR.summaries[s],u=n.tag_body?n.tag_body:n.body,a=o.kind;var f=RDR.rindow.makeHeader(n.tag_body);r.find(".rdr_header").replaceWith(f);var l=RDR.rindow.panelCreate(r,"rdr_view_more");var c=r.find("div.rdr_body_wrap");c.append(l);var h=t('<div class="rdr_commentsWrap"></div>');var p=b();var d=b();var v=w();var m=y();h.append(p,v,m,d);l.append(h);var g=a=="img"||a=="imgage"||a=="med"||a=="media";RDR.rindow.panelShow(r,l,function(){if(a=="text"){var n=e.selState||o.content_nodes[i.id].selState;t().selog("hilite",n,"on");r.data("selState",n)}})},share_getLink:function(e){var n=e.hash,r=RDR.summaries[n],i=e.kind?e.kind:r.kind;RDR.session.getUser(e,function(r){var s=r.rindow,o=r.tag;var u=r.content_node_info?r.content_node_info:r.content_node;if(!u.hash)u.hash=u.container?u.container:r.hash;if(!u.content)u.content=u.body;var a={hash:n,body:u.content,location:u.location,kind:i};var f=RDR.actions.content_nodes.make(a);t.postMessage("page_hash|"+window.location.hash,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"]);if(typeof o.body=="undefined"){o.body=o.tag_body}var l={tag:o,hash:u.hash,content_node_data:a,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:RDR.util.getPageProperty("id",n),referring_int_id:e.referring_int_id,container_kind:e.kind=="page"?"page":RDR.summaries[n].kind};t.ajax({url:RDR_baseUrl+"/api/share/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(l)},success:function(t){e.response=t;if(t.status=="fail"){if(t.message.indexOf("Temporary user interaction limit reached")!=-1){RDR.session.showLoginPanel(e)}else{RDR.session.handleGetUserFail(e,function(){RDR.actions.share_getLink(e)})}}else{RDR.actions.shareContent({sns:r.sns,content_node_info:u,short_url:t.data.short_url,reaction:o.body,container_kind:n=="page"?"page":RDR.summaries[n].kind})}},error:function(e){}})})},shareContent:function(e){function p(){return RDR.group.name?RDR.group.name:document.domain.replace("www.","")}function d(e,t,n){var r=n?t?"&#124;":"|":t?"":"";return t?e+""+r+"":e+" "+r}function v(e,t,n){var r="...";var i=t-r.length;var s=e.length<=t?e:e.substr(0,i)+r;s=n?'"'+s+'"':s;return s}var t=p();var n=e.content_node_info.content,r="",i="",s=300;switch(e.sns){case"facebook":var o="";var u="";var a="";var f="A ReadrBoard Reaction on "+t;switch(e.container_kind){case"txt":case"text":s=300;i=v(n,s,true);a=d(e.reaction)+" "+i;break;case"img":case"image":i="[a picture on "+t+"] Check it out: ";if(RDR_offline){n=n.replace("local.readrboard.com:8080","www.readrboard.com");n=n.replace("localhost:8080","www.readrboard.com")}o="&p[images][0]="+encodeURI(n);a=d(e.reaction)+" "+i;break;case"media":case"med":case"video":i="[a video on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break;case"page":i="[an article on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break}r="http://www.facebook.com/sharer.php?s=100"+"&p[title]="+encodeURI(a)+"&p[url]="+e.short_url+"&p[summary]="+encodeURI(f)+o+u;break;case"twitter":var a="";var f="A ReadrBoard Reaction on "+t;var l=RDR.group.twitter?"&via="+RDR.group.twitter:"";switch(e.container_kind){case"txt":case"text":s=110-e.reaction.length;i=v(n,s,true);a=d(e.reaction)+" "+i;break;case"img":case"image":i="[a picture on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break;case"media":case"med":case"video":i="[a video on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break;case"page":i="[an article on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break}r="http://twitter.com/intent/tweet?"+"url="+e.short_url+l+"&text="+encodeURI(a);break;case"tumblr":var a="";switch(e.container_kind){case"txt":case"text":var f=d(e.reaction,true)+'[a <a href="'+e.short_url+'">quote</a> on '+t+" via ReadrBoard]";s=300;i=v(n,s);r="http://www.tumblr.com/share/quote?"+"quote="+encodeURIComponent(i)+"&source="+encodeURIComponent(f);break;case"img":case"image":if(RDR_offline){n=n.replace("local.readrboard.com:8080","www.readrboard.com");n=n.replace("localhost:8080","www.readrboard.com")}a=d(e.reaction,true);var f='[a <a href="'+e.short_url+'">picture</a> on '+t+" via ReadrBoard]";r="http://www.tumblr.com/share/photo?"+"source="+encodeURIComponent(n)+"&caption="+encodeURIComponent(a+f)+"&click_thru="+encodeURIComponent(e.short_url);break;case"media":case"med":case"video":var c='<iframe src=" '+e.content_node_info.body+' "></iframe>';a=d(e.reaction,true);var f='[a <a href="'+e.short_url+'">video</a> on '+t+" via ReadrBoard]";var h=a+f;r="http://www.tumblr.com/share/video?&embed="+encodeURIComponent(c)+"&caption="+encodeURIComponent(h);break;case"page":var f=d(e.reaction,true)+'[an <a href="'+e.short_url+'">article</a> on '+t+" via ReadrBoard]";s=300;i=v(n,s);r="http://www.tumblr.com/share/link?"+"url="+encodeURIComponent(e.short_url)+"&description="+encodeURIComponent(f);break}break;case"linkedin":break}if(r!==""){if(RDR.shareWindow){RDR.shareWindow.location=r}}else{if(RDR.shareWindow){RDR.shareWindow.close()}}},newUpdateData:function(e){var t=RDR.summaries[e],n=t.$rindow_readmode,r=t.$rindow_writemode},startSelect:function(e,n,r){function c(e){var n=null;var r=false;e.parents().each(function(){if(r){return}var e=t(this);if(d(e)){n=t(this);r=true}});return n}function h(r){var i=r.data("hash"),s=RDR.summaries[i]||"undefined";if(p(i))return false;if(s!="undefined"){var u=s.$indicator;RDR.actions.indicators.helpers.out(u)}RDR.rindow.close(t("div.rdr.rdr_window.rdr.rdr_rewritable"));var a=n?{top:parseInt(n.pageY,10),left:parseInt(n.pageX,10)}:{top:e.offset().top,left:e.offset().left};return RDR.actionbar.draw({coords:a,kind:"text",content:o.text,hash:r.data("hash")})}function p(e){var t=RDR.summaries[e]||"undefined";if(!t)return false;var n=t.$rindow_writemode;if(n&&n.filter(":visible").length){return n}else{return false}}function d(e){var t=(e.css("display")=="block"||e.css("display")=="list-item")&&!e.closest(".rdr_indicator").length&&!e.is("html, body");return t}if(e.hasAttr("rdr-custom-display")&&t('[rdr-cta-for="'+e.attr("rdr-custom-display")+'"]').length){return}RDR.actionbar.closeAll();var i=800;if(e.closest(".rdr, .no-rdr, #rdr_sandbox").length&&!e.closest(".rdr_indicator").length)return;var s=null;if(d(e)){s=e}else{s=c(e)}if(s===null)return;$rdrParent=s.closest("[rdr-hashed]");var o=s.selog("save");if(!o||!o.serialRange||!o.text||/^\s*$/g.test(o.text))return;if(o.text.length>i)return;var u="text";var a=o.text;if($rdrParent.length&&$rdrParent.hasAttr("rdr-hashed")&&!$rdrParent.hasAttr("rdr-page-container")){if(r){var f=$rdrParent.data("hash");r(f,u,a);return}return h($rdrParent)}else{var l=RDR.actions.hashNodes(s);if(l){RDR.actions.sendHashes(l,function(){if(r){var e=s.data("hash");r(e,u,a);return}return h(s)})}}},startSelectFromMouseUp:function(e){var n=t(e.target);RDR.actions.startSelect(n,e)},stripRdrNode:function(e){e.removeAttr("rdr-node rdr-hasIndicator rdr-hashed rdr_summary_loaded rdr-hash")},pages:{save:function(e,t){RDR.pages[t.id]=t},initPageContainer:function(e){var n=RDR.pages[e],r=n.key;var i=t(RDR.group.post_selector+'[rdr-page-key="'+r+'"]').length==1?t(RDR.group.post_selector+'[rdr-page-key="'+r+'"]'):t('body[rdr-page-key="'+r+'"]');if(i.length!==1)return;i.removeAttr("rdr-page-key");i.attr("rdr-page-container",e);var s=RDR.util.md5.hex_md5(String(n.id));var o=i.get(0).nodeName.toLowerCase();RDR.actions.containers.save({id:String(n.id),kind:"page",hash:s,HTMLkind:null});i.data("page_id",String(n.id));RDR.actions.hashNodes(i);if(n.containers.length>0){var u={};u[n.id]=[];t.each(n.containers,function(e,t){if(typeof t.hash!="undefined")u[n.id].push(t.hash)})}if(n&&t("[rdr-custom-display]").length){var u={};u[n.id]=[];t.each(t("[rdr-custom-display]"),function(e,r){RDR.actions.hashNodes(t(r));var i=t(r).attr("rdr-hash");u[n.id].push(i)})}RDR.actions.sendHashes(u);var a=n;a.jqFunc="append";a.key=r;if(i.find(RDR.group.summary_widget_selector).length==1&&i.find(RDR.group.summary_widget_selector+'[rdr-page-widget-key="'+r+'"]')){a.$anchor=i.find(RDR.group.summary_widget_selector);a.jqFunc="after"}else if(t("#rdr-page-summary").length==1){a.$anchor=t("#rdr-page-summary").eq(0)}else{var f=typeof RDR.engageScriptParams.bookmarklet=="undefined"?"top:-1000px !important":"";a.$anchor=t('<div id="rdr-page-summary" class="rdr no-rdr defaultSummaryBar" style="'+f+'"/>');a.$anchor.appendTo("body")}t("#rdr_sandbox").append('<div id="rdr_summary_tag_details" />');if(t("div.rdr-summary").length===0||t("div.rdr-summary").length<t(RDR.group.post_selector).length){a.$anchor.rdrWidgetSummary(a)}}},users:{save:function(e,t){}}}})}function rdr_loadScript(e,t){var n=document.getElementsByTagName("head")[0];if(n){var r=document.createElement("script");r.setAttribute("src",e.src);r.setAttribute("type","text/javascript");if(r.readyState){r.onreadystatechange=function(){if(r.readyState=="loaded"||r.readyState=="complete"){r.onreadystatechange=null;t()}}}else{r.onload=function(){t()}}n.appendChild(r)}}function load_jquery_mobile(e){!function(e,t,n){"function"==typeof define&&define.amd?define(["jquery"],function(r){return n(r,e,t),r.mobile}):n(e.jQuery,e,t)}(this,document,function(e,t,n,r){!function(e){e.mobile={}}(e),function(e,t,r){var i={};e.mobile=e.extend(e.mobile,{version:"1.3.2",ns:"",subPageUrlKey:"ui-page",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:250,touchOverflowEnabled:!1,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"e",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,orientationChangeEnabled:!0,buttonMarkup:{hoverDelay:200},window:e(t),document:e(n),keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},behaviors:{},silentScroll:function(n){"number"!==e.type(n)&&(n=e.mobile.defaultHomeScroll),e.event.special.scrollstart.enabled=!1,setTimeout(function(){t.scrollTo(0,n),e.mobile.document.trigger("silentscroll",{x:0,y:n})},20),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},nsNormalizeDict:i,nsNormalize:function(t){return t?i[t]||(i[t]=e.camelCase(e.mobile.ns+t)):void 0},getInheritedTheme:function(e,t){for(var n,r,i=e[0],s="",o=/ui-(bar|body|overlay)-([a-z])\b/;i&&(n=i.className||"",!(n&&(r=o.exec(n))&&(s=r[2])));)i=i.parentNode;return s||t||"a"},closestPageData:function(e){return e.closest(':jqmData(role="page"), :jqmData(role="dialog")').data("mobile-page")},enhanceable:function(e){return this.haveParents(e,"enhance")},hijackable:function(e){return this.haveParents(e,"ajax")},haveParents:function(t,n){if(!e.mobile.ignoreContentEnabled)return t;for(var r,i,s,o=t.length,u=e(),f=0;o>f;f++){for(i=t.eq(f),s=!1,r=t[f];r;){var l=r.getAttribute?r.getAttribute("data-"+e.mobile.ns+n):"";if("false"===l){s=!0;break}r=r.parentNode}s||(u=u.add(i))}return u},getScreenHeight:function(){return t.innerHeight||e.mobile.window.height()}},e.mobile),e.fn.jqmData=function(t,n){var i;return"undefined"!=typeof t&&(t&&(t=e.mobile.nsNormalize(t)),i=arguments.length<2||n===r?this.data(t):this.data(t,n)),i},e.jqmData=function(t,n,r){var i;return"undefined"!=typeof n&&(i=e.data(t,n?e.mobile.nsNormalize(n):n,r)),i},e.fn.jqmRemoveData=function(t){return this.removeData(e.mobile.nsNormalize(t))},e.jqmRemoveData=function(t,n){return e.removeData(t,e.mobile.nsNormalize(n))},e.fn.removeWithDependents=function(){e.removeWithDependents(this)},e.removeWithDependents=function(t){var n=e(t);(n.jqmData("dependents")||e()).remove(),n.remove()},e.fn.addDependents=function(t){e.addDependents(e(this),t)},e.addDependents=function(t,n){var r=e(t).jqmData("dependents")||e();e(t).jqmData("dependents",e.merge(r,n))},e.fn.getEncodedText=function(){return e("<div/>").text(e(this).text()).html()},e.fn.jqmEnhanceable=function(){return e.mobile.enhanceable(this)},e.fn.jqmHijackable=function(){return e.mobile.hijackable(this)};var s=e.find,o=/:jqmData\(([^)]*)\)/g;e.find=function(t,n,r,i){return t=t.replace(o,"[data-"+(e.mobile.ns||"")+"$1]"),s.call(this,t,n,r,i)},e.extend(e.find,s),e.find.matches=function(t,n){return e.find(t,null,null,n)},e.find.matchesSelector=function(t,n){return e.find(n,null,null,[t]).length>0}}(e,this),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n,r=0;null!=(n=t[r]);r++)try{e(n).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,i){e.isFunction(i)&&(r[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,s=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=s,t}}())}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},r,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){for(var i,s,o=r.call(arguments,1),u=0,f=o.length;f>u;u++)for(i in o[u])s=o[u][i],o[u].hasOwnProperty(i)&&s!==t&&(n[i]=e.isPlainObject(s)?e.isPlainObject(n[i])?e.widget.extend({},n[i],s):e.widget.extend({},s):s);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u="string"==typeof o,l=r.call(arguments,1),h=this;return o=!u&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,u?this.each(function(){var r,i=e.data(this,s);return i?e.isFunction(i[o])&&"_"!==o.charAt(0)?(r=i[o].apply(i,l),r!==i&&r!==t?(h=r&&r.jquery?h.pushStack(r.get()):r,!1):void 0):e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),h}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i,s,o,u=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(u={},i=n.split("."),n=i.shift(),i.length){for(s=u[n]=e.widget.extend({},this.options[n]),o=0;o<i.length-1;o++)s[i[o]]=s[i[o]]||{},s=s[i[o]];if(n=i.pop(),r===t)return s[n]===t?null:s[n];s[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];u[n]=r}return this._setOptions(u),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;"boolean"!=typeof t&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){return t||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var l=r.match(/^(\w+)\s*(.*)$/),h=l[1]+s.eventNamespace,p=l[2];p?i.delegate(p,h,u):n.bind(h,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(e),function(e,t){e.widget("mobile.widget",{_createWidget:function(){e.Widget.prototype._createWidget.apply(this,arguments),this._trigger("init")},_getCreateOptions:function(){var n=this.element,r={};return e.each(this.options,function(e){var i=n.jqmData(e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}));i!==t&&(r[e]=i)}),r},enhanceWithin:function(t,n){this.enhance(e(this.options.initSelector,e(t)),n)},enhance:function(t,n){var r,i,s=e(t);s=e.mobile.enhanceable(s),n&&s.length&&(r=e.mobile.closestPageData(s),i=r&&r.keepNativeSelector()||"",s=s.not(i)),s[this.widgetName]()},raise:function(e){throw"Widget ["+this.widgetName+"]: "+e}})}(e),function(e){e.extend(e.mobile,{loadingMessageTextVisible:r,loadingMessageTheme:r,loadingMessage:r,showPageLoadingMsg:function(t,n,r){e.mobile.loading("show",t,n,r)},hidePageLoadingMsg:function(){e.mobile.loading("hide")},loading:function(){this.loaderWidget.loader.apply(this.loaderWidget,arguments)}});var t="ui-loader",n=e("html"),i=e.mobile.window;e.widget("mobile.loader",{options:{theme:"a",textVisible:!1,html:"",text:"loading"},defaultHtml:"<div class='"+t+"'>"+"<span class='ui-icon ui-icon-loading'></span>"+"<h1></h1>"+"</div>",fakeFixLoader:function(){var t=e("."+e.mobile.activeBtnClass).first();this.element.css({top:e.support.scrollTop&&i.scrollTop()+i.height()/2||t.length&&t.offset().top||100})},checkLoaderPosition:function(){var t=this.element.offset(),n=i.scrollTop(),r=e.mobile.getScreenHeight();(t.top<n||t.top-n>r)&&(this.element.addClass("ui-loader-fakefix"),this.fakeFixLoader(),i.unbind("scroll",this.checkLoaderPosition).bind("scroll",e.proxy(this.fakeFixLoader,this)))},resetHtml:function(){this.element.html(e(this.defaultHtml).html())},show:function(s,o,u){var f,l,h;this.resetHtml(),"object"===e.type(s)?(h=e.extend({},this.options,s),s=h.theme||e.mobile.loadingMessageTheme):(h=this.options,s=s||e.mobile.loadingMessageTheme||h.theme),l=o||e.mobile.loadingMessage||h.text,n.addClass("ui-loading"),(e.mobile.loadingMessage!==!1||h.html)&&(f=e.mobile.loadingMessageTextVisible!==r?e.mobile.loadingMessageTextVisible:h.textVisible,this.element.attr("class",t+" ui-corner-all ui-body-"+s+" ui-loader-"+(f||o||s.text?"verbose":"default")+(h.textonly||u?" ui-loader-textonly":"")),h.html?this.element.html(h.html):this.element.find("h1").text(l),this.element.appendTo(e.mobile.pageContainer),this.checkLoaderPosition(),i.bind("scroll",e.proxy(this.checkLoaderPosition,this)))},hide:function(){n.removeClass("ui-loading"),e.mobile.loadingMessage&&this.element.removeClass("ui-loader-fakefix"),e.mobile.window.unbind("scroll",this.fakeFixLoader),e.mobile.window.unbind("scroll",this.checkLoaderPosition)}}),i.bind("pagecontainercreate",function(){e.mobile.loaderWidget=e.mobile.loaderWidget||e(e.mobile.loader.prototype.defaultHtml).loader()})}(e,this),function(e,t,r){function i(e){return e=e||location.href,"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var s,o="hashchange",u=n,a=e.event.special,f=u.documentMode,l="on"+o in t&&(f===r||f>7);e.fn[o]=function(e){return e?this.bind(o,e):this.trigger(o)},e.fn[o].delay=50,a[o]=e.extend(a[o],{setup:function(){return l?!1:(e(s.start),void 0)},teardown:function(){return l?!1:(e(s.stop),void 0)}}),s=function(){function n(){var r=i(),u=v(f);r!==f?(p(f=r,u),e(t).trigger(o)):u!==f&&(location.href=location.href.replace(/#.*/,"")+u),s=setTimeout(n,e.fn[o].delay)}var s,a={},f=i(),c=function(e){return e},p=c,v=c;return a.start=function(){s||n()},a.stop=function(){s&&clearTimeout(s),s=r},t.attachEvent&&!t.addEventListener&&!l&&function(){var t,r;a.start=function(){t||(r=e.fn[o].src,r=r&&r+i(),t=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){r||p(i()),n()}).attr("src",r||"javascript:0").insertAfter("body")[0].contentWindow,u.onpropertychange=function(){try{"title"===event.propertyName&&(t.document.title=u.title)}catch(e){}})},a.stop=c,v=function(){return i(t.location.href)},p=function(n,r){var i=t.document,s=e.fn[o].domain;n!==r&&(i.title=u.title,i.open(),s&&i.write('<script>document.domain="'+s+'"</script>'),i.close(),t.location.hash=n)}}(),a}()}(e,this),function(e){t.matchMedia=t.matchMedia||function(e){var t,n=e.documentElement,r=n.firstElementChild||n.firstChild,i=e.createElement("body"),s=e.createElement("div");return s.id="mq-test-1",s.style.cssText="position:absolute;top:-100em",i.style.background="none",i.appendChild(s),function(e){return s.innerHTML='<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',n.insertBefore(i,r),t=42===s.offsetWidth,n.removeChild(i),{matches:t,media:e}}}(n),e.mobile.media=function(e){return t.matchMedia(e).matches}}(e),function(e){var t={touch:"ontouchend"in n};e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t)}(e),function(e){e.extend(e.support,{orientation:"orientation"in t&&"onorientationchange"in t})}(e),function(e,r){function i(e){var t=e.charAt(0).toUpperCase()+e.substr(1),n=(e+" "+d.join(t+" ")+t).split(" ");for(var i in n)if(p[n[i]]!==r)return!0}function s(e,t,r){for(var i,s=n.createElement("div"),o=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},u=function(e){return""===e?"":"-"+e.charAt(0).toLowerCase()+e.substr(1)+"-"},a=function(n){var r=u(n)+e+": "+t+";",a=o(n),f=a+(""===a?e:o(e));s.setAttribute("style",r),s.style[f]&&(i=!0)},f=r?r:d,l=0;l<f.length;l++)a(f[l]);return!!i}function o(){var i="transform-3d",s=e.mobile.media("(-"+d.join("-"+i+"),(-")+"-"+i+"),("+i+")");if(s)return!!s;var o=n.createElement("div"),u={MozTransform:"-moz-transform",transform:"transform"};h.append(o);for(var a in u)o.style[a]!==r&&(o.style[a]="translate3d( 100px, 1px, 1px )",s=t.getComputedStyle(o).getPropertyValue(u[a]));return!!s&&"none"!==s}function u(){var t,n,r=location.protocol+"//"+location.host+location.pathname+"ui-dir/",i=e("head base"),s=null,o="";return i.length?o=i.attr("href"):i=s=e("<base>",{href:r}).appendTo("head"),t=e("<a href='testurl' />").prependTo(h),n=t[0].href,i[0].href=o||location.pathname,s&&s.remove(),0===n.indexOf(r)}function a(){var e,r=n.createElement("x"),i=n.documentElement,s=t.getComputedStyle;return"pointerEvents"in r.style?(r.style.pointerEvents="auto",r.style.pointerEvents="x",i.appendChild(r),e=s&&"auto"===s(r,"").pointerEvents,i.removeChild(r),!!e):!1}function f(){var e=n.createElement("div");return"undefined"!=typeof e.getBoundingClientRect}function l(){var e=t,n=navigator.userAgent,r=navigator.platform,i=n.match(/AppleWebKit\/([0-9]+)/),s=!!i&&i[1],o=n.match(/Fennec\/([0-9]+)/),u=!!o&&o[1],a=n.match(/Opera Mobi\/([0-9]+)/),f=!!a&&a[1];return(r.indexOf("iPhone")>-1||r.indexOf("iPad")>-1||r.indexOf("iPod")>-1)&&s&&534>s||e.operamini&&"[object OperaMini]"==={}.toString.call(e.operamini)||a&&7458>f||n.indexOf("Android")>-1&&s&&533>s||u&&6>u||"palmGetResource"in t&&s&&534>s||n.indexOf("MeeGo")>-1&&n.indexOf("NokiaBrowser/8.5.0")>-1?!1:!0}var h=e("<body>").prependTo("html"),p=h[0].style,d=["Webkit","Moz","O"],v="palmGetResource"in t,m=t.opera,g=t.operamini&&"[object OperaMini]"==={}.toString.call(t.operamini),y=t.blackberry&&!i("-webkit-transform");e.extend(e.mobile,{browser:{}}),e.mobile.browser.oldIE=function(){var e=3,t=n.createElement("div"),r=t.all||[];do t.innerHTML="<!--[if gt IE "+ ++e+"]><br><![endif]-->";while(r[0]);return e>4?e:!e}(),e.extend(e.support,{cssTransitions:"WebKitTransitionEvent"in t||s("transition","height 100ms linear",["Webkit","Moz",""])&&!e.mobile.browser.oldIE&&!m,pushState:"pushState"in history&&"replaceState"in history&&!(t.navigator.userAgent.indexOf("Firefox")>=0&&t.top!==t)&&-1===t.navigator.userAgent.search(/CriOS/),mediaquery:e.mobile.media("only all"),cssPseudoElement:!!i("content"),touchOverflow:!!i("overflowScrolling"),cssTransform3d:o(),boxShadow:!!i("boxShadow")&&!y,fixedPosition:l(),scrollTop:("pageXOffset"in t||"scrollTop"in n.documentElement||"scrollTop"in h[0])&&!v&&!g,dynamicBaseTag:u(),cssPointerEvents:a(),boundingRect:f()}),h.remove();var w=function(){var e=t.navigator.userAgent;return e.indexOf("Nokia")>-1&&(e.indexOf("Symbian/3")>-1||e.indexOf("Series60/5")>-1)&&e.indexOf("AppleWebKit")>-1&&e.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/)}();e.mobile.gradeA=function(){return(e.support.mediaquery||e.mobile.browser.oldIE&&e.mobile.browser.oldIE>=7)&&(e.support.boundingRect||null!==e.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/))},e.mobile.ajaxBlacklist=t.blackberry&&!t.WebKitPoint||g||w,w&&e(function(){e("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")}),e.support.boxShadow||e("html").addClass("ui-mobile-nosupport-boxshadow")}(e),function(e,t){var n,r=e.mobile.window;e.event.special.navigate=n={bound:!1,pushStateEnabled:!0,originalEventName:t,isPushStateEnabled:function(){return e.support.pushState&&e.mobile.pushStateEnabled===!0&&this.isHashChangeEnabled()},isHashChangeEnabled:function(){return e.mobile.hashListeningEnabled===!0},popstate:function(t){var n=new e.Event("navigate"),i=new e.Event("beforenavigate"),s=t.originalEvent.state||{};location.href,r.trigger(i),i.isDefaultPrevented()||(t.historyState&&e.extend(s,t.historyState),n.originalEvent=t,setTimeout(function(){r.trigger(n,{state:s})},0))},hashchange:function(t){var n=new e.Event("navigate"),i=new e.Event("beforenavigate");r.trigger(i),i.isDefaultPrevented()||(n.originalEvent=t,r.trigger(n,{state:t.hashchangeState||{}}))},setup:function(){n.bound||(n.bound=!0,n.isPushStateEnabled()?(n.originalEventName="popstate",r.bind("popstate.navigate",n.popstate)):n.isHashChangeEnabled()&&(n.originalEventName="hashchange",r.bind("hashchange.navigate",n.hashchange)))}}}(e),function(e,n){var r,i,s="&ui-state=dialog";e.mobile.path=r={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(e){var t=e?this.parseUrl(e):location,n=this.parseUrl(e||location.href).hash;return n="#"===n?"":n,t.protocol+"//"+t.host+t.pathname+t.search+n},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(t){if("object"===e.type(t))return t;var n=r.urlParseRE.exec(t||"")||[];return{href:n[0]||"",hrefNoHash:n[1]||"",hrefNoSearch:n[2]||"",domain:n[3]||"",protocol:n[4]||"",doubleSlash:n[5]||"",authority:n[6]||"",username:n[8]||"",password:n[9]||"",host:n[10]||"",hostname:n[11]||"",port:n[12]||"",pathname:n[13]||"",directory:n[14]||"",filename:n[15]||"",search:n[16]||"",hash:n[17]||""}},makePathAbsolute:function(e,t){if(e&&"/"===e.charAt(0))return e;e=e||"",t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"";for(var n=t?t.split("/"):[],r=e.split("/"),i=0;i<r.length;i++){var s=r[i];switch(s){case".":break;case"..":n.length&&n.pop();break;default:n.push(s)}}return"/"+n.join("/")},isSameDomain:function(e,t){return r.parseUrl(e).domain===r.parseUrl(t).domain},isRelativeUrl:function(e){return""===r.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==r.parseUrl(e).protocol},makeUrlAbsolute:function(e,t){if(!r.isRelativeUrl(e))return e;t===n&&(t=this.documentBase);var i=r.parseUrl(e),s=r.parseUrl(t),o=i.protocol||s.protocol,u=i.protocol?i.doubleSlash:i.doubleSlash||s.doubleSlash,a=i.authority||s.authority,f=""!==i.pathname,l=r.makePathAbsolute(i.pathname||s.filename,s.pathname),h=i.search||!f&&s.search||"",p=i.hash;return o+u+a+l+h+p},addSearchParams:function(t,n){var i=r.parseUrl(t),s="object"==typeof n?e.param(n):n,o=i.search||"?";return i.hrefNoSearch+o+("?"!==o.charAt(o.length-1)?"&":"")+s+(i.hash||"")},convertUrlToDataUrl:function(e){var n=r.parseUrl(e);return r.isEmbeddedPage(n)?n.hash.split(s)[0].replace(/^#/,"").replace(/\?.*$/,""):r.isSameDomain(n,this.documentBase)?n.hrefNoHash.replace(this.documentBase.domain,"").split(s)[0]:t.decodeURIComponent(e)},get:function(e){return e===n&&(e=r.parseLocation().hash),r.stripHash(e).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(e){location.hash=e},isPath:function(e){return/\//.test(e)},clean:function(e){return e.replace(this.documentBase.domain,"")},stripHash:function(e){return e.replace(/^#/,"")},stripQueryParams:function(e){return e.replace(/\?.*$/,"")},cleanHash:function(e){return r.stripHash(e.replace(/\?.*$/,"").replace(s,""))},isHashValid:function(e){return/^#[^#]+$/.test(e)},isExternal:function(e){var t=r.parseUrl(e);return t.protocol&&t.domain!==this.documentUrl.domain?!0:!1},hasProtocol:function(e){return/^(:?\w+:)/.test(e)},isEmbeddedPage:function(e){var t=r.parseUrl(e);return""!==t.protocol?!this.isPath(t.hash)&&t.hash&&(t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(t.href)},squash:function(e,t){var n,i,s,o,u=this.isPath(e),a=this.parseUrl(e),f=a.hash,l="";return t=t||(r.isPath(e)?r.getLocation():r.getDocumentUrl()),i=u?r.stripHash(e):e,i=r.isPath(a.hash)?r.stripHash(a.hash):i,o=i.indexOf(this.uiStateKey),o>-1&&(l=i.slice(o),i=i.slice(0,o)),n=r.makeUrlAbsolute(i,t),s=this.parseUrl(n).search,u?((r.isPath(f)||0===f.replace("#","").indexOf(this.uiStateKey))&&(f=""),l&&-1===f.indexOf(this.uiStateKey)&&(f+=l),-1===f.indexOf("#")&&""!==f&&(f="#"+f),n=r.parseUrl(n),n=n.protocol+"//"+n.host+n.pathname+s+f):n+=n.indexOf("#")>-1?l:"#"+l,n},isPreservableHash:function(e){return 0===e.replace("#","").indexOf(this.uiStateKey)}},r.documentUrl=r.parseLocation(),i=e("head").find("base"),r.documentBase=i.length?r.parseUrl(r.makeUrlAbsolute(i.attr("href"),r.documentUrl.href)):r.documentUrl,r.documentBaseDiffers=r.documentUrl.hrefNoHash!==r.documentBase.hrefNoHash,r.getDocumentUrl=function(t){return t?e.extend({},r.documentUrl):r.documentUrl.href},r.getDocumentBase=function(t){return t?e.extend({},r.documentBase):r.documentBase.href}}(e),function(e,t){e.mobile.path,e.mobile.History=function(e,t){this.stack=e||[],this.activeIndex=t||0},e.extend(e.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(e,t){t=t||{},this.getNext()&&this.clearForward(),t.hash&&-1===t.hash.indexOf("#")&&(t.hash="#"+t.hash),t.url=e,this.stack.push(t),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(e,t,n){t=t||this.stack;var r,i,s,o=t.length;for(i=0;o>i;i++)if(r=t[i],(decodeURIComponent(e)===decodeURIComponent(r.url)||decodeURIComponent(e)===decodeURIComponent(r.hash))&&(s=i,n))return s;return s},closest:function(e){var n,r=this.activeIndex;return n=this.find(e,this.stack.slice(0,r)),n===t&&(n=this.find(e,this.stack.slice(r),!0),n=n===t?n:n+r),n},direct:function(n){var r=this.closest(n.url),i=this.activeIndex;r!==t&&(this.activeIndex=r,this.previousIndex=i),i>r?(n.present||n.back||e.noop)(this.getActive(),"back"):r>i?(n.present||n.forward||e.noop)(this.getActive(),"forward"):r===t&&n.missing&&n.missing(this.getActive())}})}(e),function(e){var r=e.mobile.path,i=location.href;e.mobile.Navigator=function(t){this.history=t,this.ignoreInitialHashChange=!0,e.mobile.window.bind({"popstate.history":e.proxy(this.popstate,this),"hashchange.history":e.proxy(this.hashchange,this)})},e.extend(e.mobile.Navigator.prototype,{squash:function(i,s){var o,u,f=r.isPath(i)?r.stripHash(i):i;return u=r.squash(i),o=e.extend({hash:f,url:u},s),t.history.replaceState(o,o.title||n.title,u),o},hash:function(e,t){var n,i,s;if(n=r.parseUrl(e),i=r.parseLocation(),i.pathname+i.search===n.pathname+n.search)s=n.hash?n.hash:n.pathname+n.search;else if(r.isPath(e)){var o=r.parseUrl(t);s=o.pathname+o.search+(r.isPreservableHash(o.hash)?o.hash.replace("#",""):"")}else s=e;return s},go:function(i,s,o){var u,f,l,h,p=e.event.special.navigate.isPushStateEnabled();f=r.squash(i),l=this.hash(i,f),o&&l!==r.stripHash(r.parseLocation().hash)&&(this.preventNextHashChange=o),this.preventHashAssignPopState=!0,t.location.hash=l,this.preventHashAssignPopState=!1,u=e.extend({url:f,hash:l,title:n.title},s),p&&(h=new e.Event("popstate"),h.originalEvent={type:"popstate",state:null},this.squash(i,u),o||(this.ignorePopState=!0,e.mobile.window.trigger(h))),this.history.add(u.url,u)},popstate:function(t){var n,s;if(e.event.special.navigate.isPushStateEnabled())return this.preventHashAssignPopState?(this.preventHashAssignPopState=!1,t.stopImmediatePropagation(),void 0):this.ignorePopState?(this.ignorePopState=!1,void 0):!t.originalEvent.state&&1===this.history.stack.length&&this.ignoreInitialHashChange&&(this.ignoreInitialHashChange=!1,location.href===i)?(t.preventDefault(),void 0):(n=r.parseLocation().hash,!t.originalEvent.state&&n?(s=this.squash(n),this.history.add(s.url,s),t.historyState=s,void 0):(this.history.direct({url:(t.originalEvent.state||{}).url||n,present:function(n,r){t.historyState=e.extend({},n),t.historyState.direction=r}}),void 0))},hashchange:function(t){var i,s;if(e.event.special.navigate.isHashChangeEnabled()&&!e.event.special.navigate.isPushStateEnabled()){if(this.preventNextHashChange)return this.preventNextHashChange=!1,t.stopImmediatePropagation(),void 0;i=this.history,s=r.parseLocation().hash,this.history.direct({url:s,present:function(n,r){t.hashchangeState=e.extend({},n),t.hashchangeState.direction=r},missing:function(){i.add(s,{hash:s,title:n.title})}})}}})}(e),function(e){e.mobile.navigate=function(t,n,r){e.mobile.navigate.navigator.go(t,n,r)},e.mobile.navigate.history=new e.mobile.History,e.mobile.navigate.navigator=new e.mobile.Navigator(e.mobile.navigate.history);var t=e.mobile.path.parseLocation();e.mobile.navigate.history.add(t.href,{hash:t.hash})}(e),function(e,t,n,r){function i(e){for(;e&&"undefined"!=typeof e.originalEvent;)e=e.originalEvent;return e}function s(t,n){var s,o,u,a,f,l,c,h,p,d=t.type;if(t=e.Event(t),t.type=n,s=t.originalEvent,o=e.event.props,d.search(/^(mouse|click)/)>-1&&(o=A),s)for(c=o.length,a;c;)a=o[--c],t[a]=s[a];if(d.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==d.search(/^touch/)&&(u=i(s),d=u.touches,f=u.changedTouches,l=d&&d.length?d[0]:f&&f.length?f[0]:r))for(h=0,p=k.length;p>h;h++)a=k[h],t[a]=l[a];return t}function o(t){for(var n,r,i={};t;){n=e.data(t,T);for(r in n)n[r]&&(i[r]=i.hasVirtualBinding=!0);t=t.parentNode}return i}function u(t,n){for(var r;t;){if(r=e.data(t,T),r&&(!n||r[n]))return t;t=t.parentNode}return null}function a(){j=!1}function f(){j=!0}function l(){R=0,H.length=0,B=!1,f()}function c(){a()}function h(){p(),M=setTimeout(function(){M=0,l()},e.vmouse.resetTimerDuration)}function p(){M&&(clearTimeout(M),M=0)}function d(t,n,r){var i;return(r&&r[t]||!r&&u(n.target,t))&&(i=s(n,t),e(n.target).trigger(i)),i}function v(t){var n=e.data(t.target,N);if(!(B||R&&R===n)){var r=d("v"+t.type,t);r&&(r.isDefaultPrevented()&&t.preventDefault(),r.isPropagationStopped()&&t.stopPropagation(),r.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}}function m(t){var n,r,s=i(t).touches;if(s&&1===s.length&&(n=t.target,r=o(n),r.hasVirtualBinding)){R=q++,e.data(n,N,R),p(),c(),P=!1;var u=i(t).touches[0];_=u.pageX,D=u.pageY,d("vmouseover",t,r),d("vmousedown",t,r)}}function g(e){j||(P||d("vmousecancel",e,o(e.target)),P=!0,h())}function y(t){if(!j){var n=i(t).touches[0],r=P,s=e.vmouse.moveDistanceThreshold,u=o(t.target);P=P||Math.abs(n.pageX-_)>s||Math.abs(n.pageY-D)>s,P&&!r&&d("vmousecancel",t,u),d("vmousemove",t,u),h()}}function b(e){if(!j){f();var t,n=o(e.target);if(d("vmouseup",e,n),!P){var r=d("vclick",e,n);r&&r.isDefaultPrevented()&&(t=i(e).changedTouches[0],H.push({touchID:R,x:t.clientX,y:t.clientY}),B=!0)}d("vmouseout",e,n),P=!1,h()}}function w(t){var n,r=e.data(t,T);if(r)for(n in r)if(r[n])return!0;return!1}function E(){}function S(t){var n=t.substr(1);return{setup:function(){w(this)||e.data(this,T,{});var r=e.data(this,T);r[t]=!0,O[t]=(O[t]||0)+1,1===O[t]&&I.bind(n,v),e(this).bind(n,E),F&&(O.touchstart=(O.touchstart||0)+1,1===O.touchstart&&I.bind("touchstart",m).bind("touchend",b).bind("touchmove",y).bind("scroll",g))},teardown:function(){--O[t],O[t]||I.unbind(n,v),F&&(--O.touchstart,O.touchstart||I.unbind("touchstart",m).unbind("touchmove",y).unbind("touchend",b).unbind("scroll",g));var r=e(this),i=e.data(this,T);i&&(i[t]=!1),r.unbind(n,E),w(this)||r.removeData(T)}}}var x,T="virtualMouseBindings",N="virtualTouchID",C="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),k="clientX clientY pageX pageY screenX screenY".split(" "),L=e.event.mouseHooks?e.event.mouseHooks.props:[],A=e.event.props.concat(L),O={},M=0,_=0,D=0,P=!1,H=[],B=!1,j=!1,F="addEventListener"in n,I=e(n),q=1,R=0;e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(var U=0;U<C.length;U++)e.event.special[C[U]]=S(C[U]);F&&n.addEventListener("click",function(t){var n,r,i,s,o,u,a=H.length,f=t.target;if(a)for(n=t.clientX,r=t.clientY,x=e.vmouse.clickDistanceThreshold,i=f;i;){for(s=0;a>s;s++)if(o=H[s],u=0,i===f&&Math.abs(o.x-n)<x&&Math.abs(o.y-r)<x||e.data(i,N)===o.touchID)return t.preventDefault(),t.stopPropagation(),void 0;i=i.parentNode}},!0)}(e,t,n),function(e,t,r){function i(t,n,r){var i=r.type;r.type=n,e.event.dispatch.call(t,r),r.type=i}var s=e(n);e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)});var o=e.mobile.support.touch,u="touchmove scroll",a=o?"touchstart":"mousedown",f=o?"touchend":"mouseup",l=o?"touchmove":"mousemove";e.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){n=t,i(s,n?"scrollstart":"scrollstop",e)}var n,r,s=this,o=e(s);o.bind(u,function(i){e.event.special.scrollstart.enabled&&(n||t(i,!0),clearTimeout(r),r=setTimeout(function(){t(i,!1)},50))})}},e.event.special.tap={tapholdThreshold:750,setup:function(){var t=this,n=e(t);n.bind("vmousedown",function(r){function o(){clearTimeout(f)}function u(){o(),n.unbind("vclick",a).unbind("vmouseup",o),s.unbind("vmousecancel",u)}function a(e){u(),l===e.target&&i(t,"tap",e)}if(r.which&&1!==r.which)return!1;var f,l=r.target;r.originalEvent,n.bind("vmouseup",o).bind("vclick",a),s.bind("vmousecancel",u),f=setTimeout(function(){i(t,"taphold",e.Event("taphold",{target:l}))},e.event.special.tap.tapholdThreshold)})}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,start:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t;return{time:(new Date).getTime(),coords:[n.pageX,n.pageY],origin:e(t.target)}},stop:function(e){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[t.pageX,t.pageY]}},handleSwipe:function(t,n){n.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold&&t.origin.trigger("swipe").trigger(t.coords[0]>n.coords[0]?"swipeleft":"swiperight")},setup:function(){var t=this,n=e(t);n.bind(a,function(t){function i(t){o&&(s=e.event.special.swipe.stop(t),Math.abs(o.coords[0]-s.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())}var s,o=e.event.special.swipe.start(t);n.bind(l,i).one(f,function(){n.unbind(l,i),o&&s&&e.event.special.swipe.handleSwipe(o,s),o=s=r})})}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)}}})}(e,this),function(e){e.event.special.throttledresize={setup:function(){e(this).bind("resize",s)},teardown:function(){e(this).unbind("resize",s)}};var t,n,r,i=250,s=function(){n=(new Date).getTime(),r=n-o,r>=i?(o=n,e(this).trigger("throttledresize")):(t&&clearTimeout(t),t=setTimeout(s,i-r))},o=0}(e),function(e,t){function r(){var e=i();e!==s&&(s=e,a.trigger(f))}var i,s,o,u,a=e(t),f="orientationchange",l={0:!0,180:!0};if(e.support.orientation){var h=t.innerWidth||a.width(),p=t.innerHeight||a.height(),d=50;o=h>p&&h-p>d,u=l[t.orientation],(o&&u||!o&&!u)&&(l={"-90":!0,90:!0})}e.event.special.orientationchange=e.extend({},e.event.special.orientationchange,{setup:function(){return e.support.orientation&&!e.event.special.orientationchange.disabled?!1:(s=i(),a.bind("throttledresize",r),void 0)},teardown:function(){return e.support.orientation&&!e.event.special.orientationchange.disabled?!1:(a.unbind("throttledresize",r),void 0)},add:function(e){var t=e.handler;e.handler=function(e){return e.orientation=i(),t.apply(this,arguments)}}}),e.event.special.orientationchange.orientation=i=function(){var r=!0,i=n.documentElement;return r=e.support.orientation?l[t.orientation]:i&&i.clientWidth/i.clientHeight<1.1,r?"portrait":"landscape"},e.fn[f]=function(e){return e?this.bind(f,e):this.trigger(f)},e.attrFn&&(e.attrFn[f]=!0)}(e,this),function(e){e.widget("mobile.page",e.mobile.widget,{options:{theme:"c",domCache:!1,keepNativeDefault:":jqmData(role='none'), :jqmData(role='nojs')"},_create:function(){return this._trigger("beforecreate")===!1?!1:(this.element.attr("tabindex","0").addClass("ui-page ui-body-"+this.options.theme),this._on(this.element,{pagebeforehide:"removeContainerBackground",pagebeforeshow:"_handlePageBeforeShow"}),void 0)},_handlePageBeforeShow:function(){this.setContainerBackground()},removeContainerBackground:function(){e.mobile.pageContainer.removeClass("ui-overlay-"+e.mobile.getInheritedTheme(this.element.parent()))},setContainerBackground:function(t){this.options.theme&&e.mobile.pageContainer.addClass("ui-overlay-"+(t||this.options.theme))},keepNativeSelector:function(){var t=this.options,n=t.keepNative&&e.trim(t.keepNative);return n&&t.keepNative!==t.keepNativeDefault?[t.keepNative,t.keepNativeDefault].join(", "):t.keepNativeDefault}})}(e),function(e,t,n){var r=function(r){return r===n&&(r=!0),function(n,i,s,o){var u=new e.Deferred,f=i?" reverse":"",l=e.mobile.urlHistory.getActive(),c=l.lastScroll||e.mobile.defaultHomeScroll,h=e.mobile.getScreenHeight(),p=e.mobile.maxTransitionWidth!==!1&&e.mobile.window.width()>e.mobile.maxTransitionWidth,v=!e.support.cssTransitions||p||!n||"none"===n||Math.max(e.mobile.window.scrollTop(),c)>e.mobile.getMaxScrollForTransition(),m=" ui-page-pre-in",g=function(){e.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+n)},y=function(){e.event.special.scrollstart.enabled=!1,t.scrollTo(0,c),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},w=function(){o.removeClass(e.mobile.activePageClass+" out in reverse "+n).height("")},E=function(){r?o.animationComplete(S):S(),o.height(h+e.mobile.window.scrollTop()).addClass(n+" out"+f)},S=function(){o&&r&&w(),x()},x=function(){s.css("z-index",-10),s.addClass(e.mobile.activePageClass+m),e.mobile.focusPage(s),s.height(h+c),y(),s.css("z-index",""),v||s.animationComplete(T),s.removeClass(m).addClass(n+" in"+f),v&&T()},T=function(){r||o&&w(),s.removeClass("out in reverse "+n).height(""),g(),e.mobile.window.scrollTop()!==c&&y(),u.resolve(n,i,s,o,!0)};return g(),o&&!v?E():S(),u.promise()}},i=r(),s=r(!1),o=function(){return 3*e.mobile.getScreenHeight()};e.mobile.defaultTransitionHandler=i,e.mobile.transitionHandlers={"default":e.mobile.defaultTransitionHandler,sequential:i,simultaneous:s},e.mobile.transitionFallbacks={},e.mobile._maybeDegradeTransition=function(t){return t&&!e.support.cssTransform3d&&e.mobile.transitionFallbacks[t]&&(t=e.mobile.transitionFallbacks[t]),t},e.mobile.getMaxScrollForTransition=e.mobile.getMaxScrollForTransition||o}(e,this),function(e,r){function i(t){!m||m.closest("."+e.mobile.activePageClass).length&&!t||m.removeClass(e.mobile.activeBtnClass),m=null}function s(){E=!1,w.length>0&&e.mobile.changePage.apply(null,w.pop())}function o(t,n,r,i){n&&n.data("mobile-page")._trigger("beforehide",null,{nextPage:t}),t.data("mobile-page")._trigger("beforeshow",null,{prevPage:n||e("")}),e.mobile.hidePageLoadingMsg(),r=e.mobile._maybeDegradeTransition(r);var s=e.mobile.transitionHandlers[r||"default"]||e.mobile.defaultTransitionHandler,o=s(r,i,t,n);return o.done(function(){n&&n.data("mobile-page")._trigger("hide",null,{nextPage:t}),t.data("mobile-page")._trigger("show",null,{prevPage:n||e("")})}),o}function u(t,n){n&&t.attr("data-"+e.mobile.ns+"role",n),t.page()}function a(){var t=e.mobile.activePage&&l(e.mobile.activePage);return t||N.hrefNoHash}function f(e){for(;e&&("string"!=typeof e.nodeName||"a"!==e.nodeName.toLowerCase());)e=e.parentNode;return e}function l(t){var n=e(t).closest(".ui-page").jqmData("url"),r=N.hrefNoHash;return n&&d.isPath(n)||(n=r),d.makeUrlAbsolute(n,r)}var h=e.mobile.window,p=(e("html"),e("head")),d=e.extend(e.mobile.path,{getFilePath:function(t){var n="&"+e.mobile.subPageUrlKey;return t&&t.split(n)[0].split(S)[0]},isFirstPageUrl:function(t){var n=d.parseUrl(d.makeUrlAbsolute(t,this.documentBase)),i=n.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&n.hrefNoHash===this.documentBase.hrefNoHash,s=e.mobile.firstPage,o=s&&s[0]?s[0].id:r;return i&&(!n.hash||"#"===n.hash||o&&n.hash.replace(/^#/,"")===o)},isPermittedCrossDomainRequest:function(t,n){return e.mobile.allowCrossDomainPages&&"file:"===t.protocol&&-1!==n.search(/^https?:/)}}),v=null,m=null,g=e.Deferred(),y=e.mobile.navigate.history,w=[],E=!1,S="&ui-state=dialog",x=p.children("base"),T=d.documentUrl,N=d.documentBase,C=(d.documentBaseDiffers,e.mobile.getScreenHeight),k=e.support.dynamicBaseTag?{element:x.length?x:e("<base>",{href:N.hrefNoHash}).prependTo(p),set:function(e){e=d.parseUrl(e).hrefNoHash,k.element.attr("href",d.makeUrlAbsolute(e,N))},reset:function(){k.element.attr("href",N.hrefNoSearch)}}:r;e.mobile.getDocumentUrl=d.getDocumentUrl,e.mobile.getDocumentBase=d.getDocumentBase,e.mobile.back=function(){var e=t.navigator;this.phonegapNavigationEnabled&&e&&e.app&&e.app.backHistory?e.app.backHistory():t.history.back()},e.mobile.focusPage=function(e){var t=e.find("[autofocus]"),n=e.find(".ui-title:eq(0)");return t.length?(t.focus(),void 0):(n.length?n.focus():e.focus(),void 0)};var L,A,O=!0;L=function(){if(O){var t=e.mobile.urlHistory.getActive();if(t){var n=h.scrollTop();t.lastScroll=n<e.mobile.minScrollBack?e.mobile.defaultHomeScroll:n}}},A=function(){setTimeout(L,100)},h.bind(e.support.pushState?"popstate":"hashchange",function(){O=!1}),h.one(e.support.pushState?"popstate":"hashchange",function(){O=!0}),h.one("pagecontainercreate",function(){e.mobile.pageContainer.bind("pagechange",function(){O=!0,h.unbind("scrollstop",A),h.bind("scrollstop",A)})}),h.bind("scrollstop",A),e.mobile._maybeDegradeTransition=e.mobile._maybeDegradeTransition||function(e){return e},e.mobile.resetActivePageHeight=function(t){var n=e("."+e.mobile.activePageClass),r=parseFloat(n.css("padding-top")),i=parseFloat(n.css("padding-bottom")),s=parseFloat(n.css("border-top-width")),o=parseFloat(n.css("border-bottom-width"));t="number"==typeof t?t:C(),n.css("min-height",t-r-i-s-o)},e.fn.animationComplete=function(t){return e.support.cssTransitions?e(this).one("webkitAnimationEnd animationend",t):(setTimeout(t,0),e(this))},e.mobile.path=d,e.mobile.base=k,e.mobile.urlHistory=y,e.mobile.dialogHashKey=S,e.mobile.allowCrossDomainPages=!1,e.mobile._bindPageRemove=function(){var t=e(this);!t.data("mobile-page").options.domCache&&t.is(":jqmData(external-page='true')")&&t.bind("pagehide.remove",function(){var t=e(this),n=new e.Event("pageremove");t.trigger(n),n.isDefaultPrevented()||t.removeWithDependents()})},e.mobile.loadPage=function(t,n){var i=e.Deferred(),s=e.extend({},e.mobile.loadPage.defaults,n),o=null,f=null,l=d.makeUrlAbsolute(t,a());s.data&&"get"===s.type&&(l=d.addSearchParams(l,s.data),s.data=r),s.data&&"post"===s.type&&(s.reloadPage=!0);var c=d.getFilePath(l),h=d.convertUrlToDataUrl(l);if(s.pageContainer=s.pageContainer||e.mobile.pageContainer,o=s.pageContainer.children("[data-"+e.mobile.ns+"url='"+h+"']"),0===o.length&&h&&!d.isPath(h)&&(o=s.pageContainer.children("#"+h).attr("data-"+e.mobile.ns+"url",h).jqmData("url",h)),0===o.length)if(e.mobile.firstPage&&d.isFirstPageUrl(c))e.mobile.firstPage.parent().length&&(o=e(e.mobile.firstPage));else if(d.isEmbeddedPage(c))return i.reject(l,n),i.promise();if(o.length){if(!s.reloadPage)return u(o,s.role),i.resolve(l,n,o),k&&!n.prefetch&&k.set(t),i.promise();f=o}var p=s.pageContainer,v=new e.Event("pagebeforeload"),m={url:t,absUrl:l,dataUrl:h,deferred:i,options:s};if(p.trigger(v,m),v.isDefaultPrevented())return i.promise();if(s.showLoadMsg)var g=setTimeout(function(){e.mobile.showPageLoadingMsg()},s.loadMsgDelay),y=function(){clearTimeout(g),e.mobile.hidePageLoadingMsg()};return!k||"undefined"!=typeof n&&"undefined"!=typeof n.prefetch||k.reset(),e.mobile.allowCrossDomainPages||d.isSameDomain(T,l)?e.ajax({url:c,type:s.type,data:s.data,contentType:s.contentType,dataType:"html",success:function(r,a,p){var v=e("<div></div>"),g=r.match(/<title[^>]*>([^<]*)/)&&RegExp.$1,w=new RegExp("(<[^>]+\\bdata-"+e.mobile.ns+"role=[\"']?page[\"']?[^>]*>)"),E=new RegExp("\\bdata-"+e.mobile.ns+"url=[\"']?([^\"'>]*)[\"']?");if(w.test(r)&&RegExp.$1&&E.test(RegExp.$1)&&RegExp.$1&&(t=c=d.getFilePath(e("<div>"+RegExp.$1+"</div>").text())),!k||"undefined"!=typeof n&&"undefined"!=typeof n.prefetch||k.set(c),v.get(0).innerHTML=r,o=v.find(":jqmData(role='page'), :jqmData(role='dialog')").first(),o.length||(o=e("<div data-"+e.mobile.ns+"role='page'>"+(r.split(/<\/?body[^>]*>/gim)[1]||"")+"</div>")),g&&!o.jqmData("title")&&(~g.indexOf("&")&&(g=e("<div>"+g+"</div>").text()),o.jqmData("title",g)),!e.support.dynamicBaseTag){var S=d.get(c);o.find("[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]").each(function(){var t=e(this).is("[href]")?"href":e(this).is("[src]")?"src":"action",n=e(this).attr(t);n=n.replace(location.protocol+"//"+location.host+location.pathname,""),/^(\w+:|#|\/)/.test(n)||e(this).attr(t,S+n)})}o.attr("data-"+e.mobile.ns+"url",d.convertUrlToDataUrl(c)).attr("data-"+e.mobile.ns+"external-page",!0).appendTo(s.pageContainer),o.one("pagecreate",e.mobile._bindPageRemove),u(o,s.role),l.indexOf("&"+e.mobile.subPageUrlKey)>-1&&(o=s.pageContainer.children("[data-"+e.mobile.ns+"url='"+h+"']")),s.showLoadMsg&&y(),m.xhr=p,m.textStatus=a,m.page=o,s.pageContainer.trigger("pageload",m),i.resolve(l,n,o,f)},error:function(t,r,o){k&&k.set(d.get()),m.xhr=t,m.textStatus=r,m.errorThrown=o;var u=new e.Event("pageloadfailed");s.pageContainer.trigger(u,m),u.isDefaultPrevented()||(s.showLoadMsg&&(y(),e.mobile.showPageLoadingMsg(e.mobile.pageLoadErrorMessageTheme,e.mobile.pageLoadErrorMessage,!0),setTimeout(e.mobile.hidePageLoadingMsg,1500)),i.reject(l,n))}}):i.reject(l,n),i.promise()},e.mobile.loadPage.defaults={type:"get",data:r,reloadPage:!1,role:r,showLoadMsg:!1,pageContainer:r,loadMsgDelay:50},e.mobile.changePage=function(t,f){if(E)return w.unshift(arguments),void 0;var l,h=e.extend({},e.mobile.changePage.defaults,f);h.pageContainer=h.pageContainer||e.mobile.pageContainer,h.fromPage=h.fromPage||e.mobile.activePage,l="string"==typeof t;var p=h.pageContainer,v=new e.Event("pagebeforechange"),m={toPage:t,options:h};if(m.absUrl=l?d.makeUrlAbsolute(t,a()):t.data("absUrl"),p.trigger(v,m),!v.isDefaultPrevented()){if(t=m.toPage,l="string"==typeof t,E=!0,l)return h.target=t,e.mobile.loadPage(t,h).done(function(t,n,r,i){E=!1,n.duplicateCachedPage=i,r.data("absUrl",m.absUrl),e.mobile.changePage(r,n)}).fail(function(){i(!0),s(),h.pageContainer.trigger("pagechangefailed",m)}),void 0;t[0]!==e.mobile.firstPage[0]||h.dataUrl||(h.dataUrl=T.hrefNoHash);var g=h.fromPage,b=h.dataUrl&&d.convertUrlToDataUrl(h.dataUrl)||t.jqmData("url"),x=b,N=(d.getFilePath(b),y.getActive()),C=0===y.activeIndex,k=0,L=n.title,A="dialog"===h.role||"dialog"===t.jqmData("role");if(g&&g[0]===t[0]&&!h.allowSamePageTransition)return E=!1,p.trigger("pagechange",m),h.fromHashChange&&y.direct({url:b}),void 0;u(t,h.role),h.fromHashChange&&(k="back"===f.direction?-1:1);try{n.activeElement&&"body"!==n.activeElement.nodeName.toLowerCase()?e(n.activeElement).blur():e("input:focus, textarea:focus, select:focus").blur()}catch(O){}var M=!1;A&&N&&(N.url&&N.url.indexOf(S)>-1&&e.mobile.activePage&&!e.mobile.activePage.is(".ui-dialog")&&y.activeIndex>0&&(h.changeHash=!1,M=!0),b=N.url||"",b+=!M&&b.indexOf("#")>-1?S:"#"+S,0===y.activeIndex&&b===y.initialDst&&(b+=S));var _=N?t.jqmData("title")||t.children(":jqmData(role='header')").find(".ui-title").text():L;if(_&&L===n.title&&(L=_),t.jqmData("title")||t.jqmData("title",L),h.transition=h.transition||(k&&!C?N.transition:r)||(A?e.mobile.defaultDialogTransition:e.mobile.defaultPageTransition),!k&&M&&(y.getActive().pageUrl=x),b&&!h.fromHashChange){var D;!d.isPath(b)&&b.indexOf("#")<0&&(b="#"+b),D={transition:h.transition,title:L,pageUrl:x,role:h.role},h.changeHash!==!1&&e.mobile.hashListeningEnabled?e.mobile.navigate(b,D,!0):t[0]!==e.mobile.firstPage[0]&&e.mobile.navigate.history.add(b,D)}n.title=L,e.mobile.activePage=t,h.reverse=h.reverse||0>k,o(t,g,h.transition,h.reverse).done(function(n,r,o,u,a){i(),h.duplicateCachedPage&&h.duplicateCachedPage.remove(),a||e.mobile.focusPage(t),s(),p.trigger("pagechange",m)})}},e.mobile.changePage.defaults={transition:r,reverse:!1,changeHash:!0,fromHashChange:!1,role:r,duplicateCachedPage:r,pageContainer:r,showLoadMsg:!0,dataUrl:r,fromPage:r,allowSamePageTransition:!1},e.mobile.navreadyDeferred=e.Deferred(),e.mobile._registerInternalEvents=function(){var n=function(t,n){var r,i,s,o,u=!0;return!e.mobile.ajaxEnabled||t.is(":jqmData(ajax='false')")||!t.jqmHijackable().length||t.attr("target")?!1:(r=t.attr("action"),o=(t.attr("method")||"get").toLowerCase(),r||(r=l(t),"get"===o&&(r=d.parseUrl(r).hrefNoSearch),r===N.hrefNoHash&&(r=T.hrefNoSearch)),r=d.makeUrlAbsolute(r,l(t)),d.isExternal(r)&&!d.isPermittedCrossDomainRequest(T,r)?!1:(n||(i=t.serializeArray(),v&&v[0].form===t[0]&&(s=v.attr("name"),s&&(e.each(i,function(e,t){return t.name===s?(s="",!1):void 0}),s&&i.push({name:s,value:v.attr("value")}))),u={url:r,options:{type:o,data:e.param(i),transition:t.jqmData("transition"),reverse:"reverse"===t.jqmData("direction"),reloadPage:!0}}),u))};e.mobile.document.delegate("form","submit",function(t){var r=n(e(this));r&&(e.mobile.changePage(r.url,r.options),t.preventDefault())}),e.mobile.document.bind("vclick",function(t){var r,s,o=t.target,u=!1;if(!(t.which>1)&&e.mobile.linkBindingEnabled){if(v=e(o),e.data(o,"mobile-button")){if(!n(e(o).closest("form"),!0))return;o.parentNode&&(o=o.parentNode)}else{if(o=f(o),!o||"#"===d.parseUrl(o.getAttribute("href")||"#").hash)return;if(!e(o).jqmHijackable().length)return}~o.className.indexOf("ui-link-inherit")?o.parentNode&&(s=e.data(o.parentNode,"buttonElements")):s=e.data(o,"buttonElements"),s?o=s.outer:u=!0,r=e(o),u&&(r=r.closest(".ui-btn")),r.length>0&&!r.hasClass("ui-disabled")&&(i(!0),m=r,m.addClass(e.mobile.activeBtnClass))}}),e.mobile.document.bind("click",function(n){if(e.mobile.linkBindingEnabled&&!n.isDefaultPrevented()){var s,o=f(n.target),u=e(o);if(o&&!(n.which>1)&&u.jqmHijackable().length){if(s=function(){t.setTimeout(function(){i(!0)},200)},u.is(":jqmData(rel='back')"))return e.mobile.back(),!1;var a=l(u),c=d.makeUrlAbsolute(u.attr("href")||"#",a);if(!e.mobile.ajaxEnabled&&!d.isEmbeddedPage(c))return s(),void 0;if(-1!==c.search("#")){if(c=c.replace(/[^#]*#/,""),!c)return n.preventDefault(),void 0;c=d.isPath(c)?d.makeUrlAbsolute(c,a):d.makeUrlAbsolute("#"+c,T.hrefNoHash)}var h=u.is("[rel='external']")||u.is(":jqmData(ajax='false')")||u.is("[target]"),p=h||d.isExternal(c)&&!d.isPermittedCrossDomainRequest(T,c);if(p)return s(),void 0;var v=u.jqmData("transition"),m="reverse"===u.jqmData("direction")||u.jqmData("back"),g=u.attr("data-"+e.mobile.ns+"rel")||r;e.mobile.changePage(c,{transition:v,reverse:m,role:g,link:u}),n.preventDefault()}}}),e.mobile.document.delegate(".ui-page","pageshow.prefetch",function(){var t=[];e(this).find("a:jqmData(prefetch)").each(function(){var n=e(this),r=n.attr("href");r&&-1===e.inArray(r,t)&&(t.push(r),e.mobile.loadPage(r,{role:n.attr("data-"+e.mobile.ns+"rel"),prefetch:!0}))})}),e.mobile._handleHashChange=function(n,i){var s=d.stripHash(n),o=0===e.mobile.urlHistory.stack.length?"none":r,u={changeHash:!1,fromHashChange:!0,reverse:"back"===i.direction};if(e.extend(u,i,{transition:(y.getLast()||{}).transition||o}),y.activeIndex>0&&s.indexOf(S)>-1&&y.initialDst!==s){if(e.mobile.activePage&&!e.mobile.activePage.is(".ui-dialog"))return"back"===i.direction?e.mobile.back():t.history.forward(),void 0;s=i.pageUrl;var a=e.mobile.urlHistory.getActive();e.extend(u,{role:a.role,transition:a.transition,reverse:"back"===i.direction})}s?(s=d.isPath(s)?s:d.makeUrlAbsolute("#"+s,N),s===d.makeUrlAbsolute("#"+y.initialDst,N)&&y.stack.length&&y.stack[0].url!==y.initialDst.replace(S,"")&&(s=e.mobile.firstPage),e.mobile.changePage(s,u)):e.mobile.changePage(e.mobile.firstPage,u)},h.bind("navigate",function(t,n){var r;t.originalEvent&&t.originalEvent.isDefaultPrevented()||(r=e.event.special.navigate.originalEventName.indexOf("hashchange")>-1?n.state.hash:n.state.url,r||(r=e.mobile.path.parseLocation().hash),r&&"#"!==r&&0!==r.indexOf("#"+e.mobile.path.uiStateKey)||(r=location.href),e.mobile._handleHashChange(r,n.state))}),e.mobile.document.bind("pageshow",e.mobile.resetActivePageHeight),e.mobile.window.bind("throttledresize",e.mobile.resetActivePageHeight)},e(function(){g.resolve()}),e.when(g,e.mobile.navreadyDeferred).done(function(){e.mobile._registerInternalEvents()})}(e),function(e){e.mobile.transitionFallbacks.flip="fade"}(e,this),function(e){e.mobile.transitionFallbacks.flow="fade"}(e,this),function(e){e.mobile.transitionFallbacks.pop="fade"}(e,this),function(e){e.mobile.transitionHandlers.slide=e.mobile.transitionHandlers.simultaneous,e.mobile.transitionFallbacks.slide="fade"}(e,this),function(e){e.mobile.transitionFallbacks.slidedown="fade"}(e,this),function(e){e.mobile.transitionFallbacks.slidefade="fade"}(e,this),function(e){e.mobile.transitionFallbacks.slideup="fade"}(e,this),function(e){e.mobile.transitionFallbacks.turn="fade"}(e,this),function(e){e.mobile.page.prototype.options.degradeInputs={color:!1,date:!1,datetime:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:"number",search:"text",tel:!1,time:!1,url:!1,week:!1},e.mobile.document.bind("pagecreate create",function(t){var n,r=e.mobile.closestPageData(e(t.target));r&&(n=r.options,e(t.target).find("input").not(r.keepNativeSelector()).each(function(){var t=e(this),r=this.getAttribute("type"),i=n.degradeInputs[r]||"text";if(n.degradeInputs[r]){var s=e("<div>").html(t.clone()).html(),o=s.indexOf(" type=")>-1,u=o?/\s+type=["']?\w+['"]?/:/\/?>/,f=' type="'+i+'" data-'+e.mobile.ns+'type="'+r+'"'+(o?"":">");t.replaceWith(s.replace(u,f))}}))})}(e),function(e){e.widget("mobile.dialog",e.mobile.widget,{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0,initSelector:":jqmData(role='dialog')"},_handlePageBeforeShow:function(){this._isCloseable=!0,this.options.overlayTheme&&this.element.page("removeContainerBackground").page("setContainerBackground",this.options.overlayTheme)},_handlePageBeforeHide:function(){this._isCloseable=!1},_create:function(){var t=this.element,n=this.options.corners?" ui-corner-all":"",r=e("<div/>",{role:"dialog","class":"ui-dialog-contain ui-overlay-shadow"+n});t.addClass("ui-dialog ui-overlay-"+this.options.overlayTheme),t.wrapInner(r),t.bind("vclick submit",function(t){var n,r=e(t.target).closest("vclick"===t.type?"a":"form");r.length&&!r.jqmData("transition")&&(n=e.mobile.urlHistory.getActive()||{},r.attr("data-"+e.mobile.ns+"transition",n.transition||e.mobile.defaultDialogTransition).attr("data-"+e.mobile.ns+"direction","reverse"))}),this._on(t,{pagebeforeshow:"_handlePageBeforeShow",pagebeforehide:"_handlePageBeforeHide"}),e.extend(this,{_createComplete:!1}),this._setCloseBtn(this.options.closeBtn)},_setCloseBtn:function(t){var n,r,i=this;this._headerCloseButton&&(this._headerCloseButton.remove(),this._headerCloseButton=null),"none"!==t&&(r="left"===t?"left":"right",n=e("<a href='#' class='ui-btn-"+r+"' data-"+e.mobile.ns+"icon='delete' data-"+e.mobile.ns+"iconpos='notext'>"+this.options.closeBtnText+"</a>"),this.element.children().find(":jqmData(role='header')").first().prepend(n),this._createComplete&&e.fn.buttonMarkup&&n.buttonMarkup(),this._createComplete=!0,n.bind("click",function(){i.close()}),this._headerCloseButton=n)},_setOption:function(e,t){"closeBtn"===e&&this._setCloseBtn(t),this._super(e,t)},close:function(){var t,n,r=e.mobile.navigate.history;this._isCloseable&&(this._isCloseable=!1,e.mobile.hashListeningEnabled&&r.activeIndex>0?e.mobile.back():(t=Math.max(0,r.activeIndex-1),n=r.stack[t].pageUrl||r.stack[t].url,r.previousIndex=r.activeIndex,r.activeIndex=t,e.mobile.path.isPath(n)||(n=e.mobile.path.makeUrlAbsolute("#"+n)),e.mobile.changePage(n,{direction:"back",changeHash:!1,fromHashChange:!0})))}}),e.mobile.document.delegate(e.mobile.dialog.prototype.options.initSelector,"pagecreate",function(){e.mobile.dialog.prototype.enhance(this)})}(e,this),function(e){e.mobile.page.prototype.options.backBtnText="Back",e.mobile.page.prototype.options.addBackBtn=!1,e.mobile.page.prototype.options.backBtnTheme=null,e.mobile.page.prototype.options.headerTheme="a",e.mobile.page.prototype.options.footerTheme="a",e.mobile.page.prototype.options.contentTheme=null,e.mobile.document.bind("pagecreate",function(t){var n=e(t.target),r=n.data("mobile-page").options,i=n.jqmData("role"),s=r.theme;e(":jqmData(role='header'), :jqmData(role='footer'), :jqmData(role='content')",n).jqmEnhanceable().each(function(){var t,o,u,l,h=e(this),p=h.jqmData("role"),v=h.jqmData("theme"),m=v||r.contentTheme||"dialog"===i&&s;if(h.addClass("ui-"+p),"header"===p||"footer"===p){var g=v||("header"===p?r.headerTheme:r.footerTheme)||s;h.addClass("ui-bar-"+g).attr("role","header"===p?"banner":"contentinfo"),"header"===p&&(t=h.children("a, button"),o=t.hasClass("ui-btn-left"),u=t.hasClass("ui-btn-right"),o=o||t.eq(0).not(".ui-btn-right").addClass("ui-btn-left").length,u=u||t.eq(1).addClass("ui-btn-right").length),r.addBackBtn&&"header"===p&&e(".ui-page").length>1&&n.jqmData("url")!==e.mobile.path.stripHash(location.hash)&&!o&&(l=e("<a href='javascript:void(0);' class='ui-btn-left' data-"+e.mobile.ns+"rel='back' data-"+e.mobile.ns+"icon='arrow-l'>"+r.backBtnText+"</a>").attr("data-"+e.mobile.ns+"theme",r.backBtnTheme||g).prependTo(h)),h.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})}else"content"===p&&(m&&h.addClass("ui-body-"+m),h.attr("role","main"))})})}(e),function(e,t){function r(e){for(var t;e&&(t="string"==typeof e.className&&e.className+" ",!(t&&t.indexOf("ui-btn ")>-1&&t.indexOf("ui-disabled ")<0));)e=e.parentNode;return e}function i(r,i,s,o,u){var f=e.data(r[0],"buttonElements");r.removeClass(i).addClass(s),f&&(f.bcls=e(n.createElement("div")).addClass(f.bcls+" "+s).removeClass(i).attr("class"),o!==t&&(f.hover=o),f.state=u)}var s=function(e,n){var r=e.getAttribute(n);return"true"===r?!0:"false"===r?!1:null===r?t:r};e.fn.buttonMarkup=function(r){var i,u=this,l="data-"+e.mobile.ns;r=r&&"object"===e.type(r)?r:{};for(var h=0;h<u.length;h++){var p,d,v,m,y,w,E=u.eq(h),S=E[0],x=e.extend({},e.fn.buttonMarkup.defaults,{icon:r.icon!==t?r.icon:s(S,l+"icon"),iconpos:r.iconpos!==t?r.iconpos:s(S,l+"iconpos"),theme:r.theme!==t?r.theme:s(S,l+"theme")||e.mobile.getInheritedTheme(E,"c"),inline:r.inline!==t?r.inline:s(S,l+"inline"),shadow:r.shadow!==t?r.shadow:s(S,l+"shadow"),corners:r.corners!==t?r.corners:s(S,l+"corners"),iconshadow:r.iconshadow!==t?r.iconshadow:s(S,l+"iconshadow"),mini:r.mini!==t?r.mini:s(S,l+"mini")},r),T="ui-btn-inner",N="ui-btn-text",C=!1,k="up";for(i in x)x[i]===t||null===x[i]?E.removeAttr(l+i):S.setAttribute(l+i,x[i]);for(w=e.data("INPUT"===S.tagName||"BUTTON"===S.tagName?S.parentNode:S,"buttonElements"),w?(S=w.outer,E=e(S),v=w.inner,m=w.text,e(w.icon).remove(),w.icon=null,C=w.hover,k=w.state):(v=n.createElement(x.wrapperEls),m=n.createElement(x.wrapperEls)),y=x.icon?n.createElement("span"):null,o&&!w&&o(),x.theme||(x.theme=e.mobile.getInheritedTheme(E,"c")),p="ui-btn ",p+=C?"ui-btn-hover-"+x.theme:"",p+=k?" ui-btn-"+k+"-"+x.theme:"",p+=x.shadow?" ui-shadow":"",p+=x.corners?" ui-btn-corner-all":"",x.mini!==t&&(p+=x.mini===!0?" ui-mini":" ui-fullsize"),x.inline!==t&&(p+=x.inline===!0?" ui-btn-inline":" ui-btn-block"),x.icon&&(x.icon="ui-icon-"+x.icon,x.iconpos=x.iconpos||"left",d="ui-icon "+x.icon,x.iconshadow&&(d+=" ui-icon-shadow")),x.iconpos&&(p+=" ui-btn-icon-"+x.iconpos,"notext"!==x.iconpos||E.attr("title")||E.attr("title",E.getEncodedText())),w&&E.removeClass(w.bcls||""),E.removeClass("ui-link").addClass(p),v.className=T,m.className=N,w||v.appendChild(m),y&&(y.className=d,w&&w.icon||(y.innerHTML="&#160;",v.appendChild(y)));S.firstChild&&!w;)m.appendChild(S.firstChild);w||S.appendChild(v),w={hover:C,state:k,bcls:p,outer:S,inner:v,text:m,icon:y},e.data(S,"buttonElements",w),e.data(v,"buttonElements",w),e.data(m,"buttonElements",w),y&&e.data(y,"buttonElements",w)}return this},e.fn.buttonMarkup.defaults={corners:!0,shadow:!0,iconshadow:!0,wrapperEls:"span"};var o=function(){var n,s,u=e.mobile.buttonMarkup.hoverDelay;e.mobile.document.bind({"vmousedown vmousecancel vmouseup vmouseover vmouseout focus blur scrollstart":function(o){var l,p=e(r(o.target)),v=o.originalEvent&&/^touch/.test(o.originalEvent.type),m=o.type;p.length&&(l=p.attr("data-"+e.mobile.ns+"theme"),"vmousedown"===m?v?n=setTimeout(function(){i(p,"ui-btn-up-"+l,"ui-btn-down-"+l,t,"down")},u):i(p,"ui-btn-up-"+l,"ui-btn-down-"+l,t,"down"):"vmousecancel"===m||"vmouseup"===m?i(p,"ui-btn-down-"+l,"ui-btn-up-"+l,t,"up"):"vmouseover"===m||"focus"===m?v?s=setTimeout(function(){i(p,"ui-btn-up-"+l,"ui-btn-hover-"+l,!0,"")},u):i(p,"ui-btn-up-"+l,"ui-btn-hover-"+l,!0,""):("vmouseout"===m||"blur"===m||"scrollstart"===m)&&(i(p,"ui-btn-hover-"+l+" ui-btn-down-"+l,"ui-btn-up-"+l,!1,"up"),n&&clearTimeout(n),s&&clearTimeout(s)))},"focusin focus":function(t){e(r(t.target)).addClass(e.mobile.focusClass)},"focusout blur":function(t){e(r(t.target)).removeClass(e.mobile.focusClass)}}),o=null};e.mobile.document.bind("pagecreate create",function(t){e(":jqmData(role='button'), .ui-bar > a, .ui-header > a, .ui-footer > a, .ui-bar > :jqmData(role='controlgroup') > a",t.target).jqmEnhanceable().not("button, input, .ui-btn, :jqmData(role='none'), :jqmData(role='nojs')").buttonMarkup()})}(e),function(e,t){e.widget("mobile.collapsible",e.mobile.widget,{options:{expandCueText:" click to expand contents",collapseCueText:" click to collapse contents",collapsed:!0,heading:"h1,h2,h3,h4,h5,h6,legend",collapsedIcon:"plus",expandedIcon:"minus",iconpos:"left",theme:null,contentTheme:null,inset:!0,corners:!0,mini:!1,initSelector:":jqmData(role='collapsible')"},_create:function(){var n=this.element,r=this.options,i=n.addClass("ui-collapsible"),s=n.children(r.heading).first(),o=i.wrapInner("<div class='ui-collapsible-content'></div>").children(".ui-collapsible-content"),u=n.closest(":jqmData(role='collapsible-set')").addClass("ui-collapsible-set"),f="";s.is("legend")&&(s=e("<div role='heading'>"+s.html()+"</div>").insertBefore(s),s.next().remove()),u.length?(r.theme||(r.theme=u.jqmData("theme")||e.mobile.getInheritedTheme(u,"c")),r.contentTheme||(r.contentTheme=u.jqmData("content-theme")),r.collapsedIcon=n.jqmData("collapsed-icon")||u.jqmData("collapsed-icon")||r.collapsedIcon,r.expandedIcon=n.jqmData("expanded-icon")||u.jqmData("expanded-icon")||r.expandedIcon,r.iconpos=n.jqmData("iconpos")||u.jqmData("iconpos")||r.iconpos,r.inset=u.jqmData("inset")!==t?u.jqmData("inset"):!0,r.corners=!1,r.mini||(r.mini=u.jqmData("mini"))):r.theme||(r.theme=e.mobile.getInheritedTheme(n,"c")),r.inset&&(f+=" ui-collapsible-inset",r.corners&&(f+=" ui-corner-all")),r.contentTheme&&(f+=" ui-collapsible-themed-content",o.addClass("ui-body-"+r.contentTheme)),""!==f&&i.addClass(f),s.insertBefore(o).addClass("ui-collapsible-heading").append("<span class='ui-collapsible-heading-status'></span>").wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>").find("a").first().buttonMarkup({shadow:!1,corners:!1,iconpos:r.iconpos,icon:r.collapsedIcon,mini:r.mini,theme:r.theme}),i.bind("expand collapse",function(t){if(!t.isDefaultPrevented()){var n=e(this),i="collapse"===t.type;t.preventDefault(),s.toggleClass("ui-collapsible-heading-collapsed",i).find(".ui-collapsible-heading-status").text(i?r.expandCueText:r.collapseCueText).end().find(".ui-icon").toggleClass("ui-icon-"+r.expandedIcon,!i).toggleClass("ui-icon-"+r.collapsedIcon,i||r.expandedIcon===r.collapsedIcon).end().find("a").first().removeClass(e.mobile.activeBtnClass),n.toggleClass("ui-collapsible-collapsed",i),o.toggleClass("ui-collapsible-content-collapsed",i).attr("aria-hidden",i),o.trigger("updatelayout")}}).trigger(r.collapsed?"collapse":"expand"),s.bind("tap",function(){s.find("a").first().addClass(e.mobile.activeBtnClass)}).bind("click",function(e){var t=s.is(".ui-collapsible-heading-collapsed")?"expand":"collapse";i.trigger(t),e.preventDefault(),e.stopPropagation()})}}),e.mobile.document.bind("pagecreate create",function(t){e.mobile.collapsible.prototype.enhanceWithin(t.target)})}(e),function(e){e.mobile.behaviors.addFirstLastClasses={_getVisibles:function(e,t){var n;return t?n=e.not(".ui-screen-hidden"):(n=e.filter(":visible"),0===n.length&&(n=e.not(".ui-screen-hidden"))),n},_addFirstLastClasses:function(e,t,n){e.removeClass("ui-first-child ui-last-child"),t.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),n||this.element.trigger("updatelayout")}}}(e),function(e,t){e.widget("mobile.collapsibleset",e.mobile.widget,e.extend({options:{initSelector:":jqmData(role='collapsible-set')"},_create:function(){var n=this.element.addClass("ui-collapsible-set"),r=this.options;r.theme||(r.theme=e.mobile.getInheritedTheme(n,"c")),r.contentTheme||(r.contentTheme=n.jqmData("content-theme")),r.corners||(r.corners=n.jqmData("corners")),n.jqmData("inset")!==t&&(r.inset=n.jqmData("inset")),r.inset=r.inset!==t?r.inset:!0,r.corners=r.corners!==t?r.corners:!0,r.corners&&r.inset&&n.addClass("ui-corner-all"),n.jqmData("collapsiblebound")||n.jqmData("collapsiblebound",!0).bind("expand",function(t){var n=e(t.target).closest(".ui-collapsible");n.parent().is(":jqmData(role='collapsible-set')")&&n.siblings(".ui-collapsible").trigger("collapse")})},_init:function(){var e=this.element,t=e.children(":jqmData(role='collapsible')"),n=t.filter(":jqmData(collapsed='false')");this._refresh("true"),n.trigger("expand")},_refresh:function(t){var n=this.element.children(":jqmData(role='collapsible')");e.mobile.collapsible.prototype.enhance(n.not(".ui-collapsible")),this._addFirstLastClasses(n,this._getVisibles(n,t),t)},refresh:function(){this._refresh(!1)}},e.mobile.behaviors.addFirstLastClasses)),e.mobile.document.bind("pagecreate create",function(t){e.mobile.collapsibleset.prototype.enhanceWithin(t.target)})}(e),function(e){e.fn.fieldcontain=function(){return this.addClass("ui-field-contain ui-body ui-br").contents().filter(function(){return 3===this.nodeType&&!/\S/.test(this.nodeValue)}).remove()},e(n).bind("pagecreate create",function(t){e(":jqmData(role='fieldcontain')",t.target).jqmEnhanceable().fieldcontain()})}(e),function(e){e.fn.grid=function(t){return this.each(function(){var n,r=e(this),i=e.extend({grid:null},t),s=r.children(),o={solo:1,a:2,b:3,c:4,d:5},u=i.grid;if(!u)if(s.length<=5)for(var f in o)o[f]===s.length&&(u=f);else u="a",r.addClass("ui-grid-duo");n=o[u],r.addClass("ui-grid-"+u),s.filter(":nth-child("+n+"n+1)").addClass("ui-block-a"),n>1&&s.filter(":nth-child("+n+"n+2)").addClass("ui-block-b"),n>2&&s.filter(":nth-child("+n+"n+3)").addClass("ui-block-c"),n>3&&s.filter(":nth-child("+n+"n+4)").addClass("ui-block-d"),n>4&&s.filter(":nth-child("+n+"n+5)").addClass("ui-block-e")})}}(e),function(e,t){e.widget("mobile.navbar",e.mobile.widget,{options:{iconpos:"top",grid:null,initSelector:":jqmData(role='navbar')"},_create:function(){var r=this.element,i=r.find("a"),s=i.filter(":jqmData(icon)").length?this.options.iconpos:t;r.addClass("ui-navbar ui-mini").attr("role","navigation").find("ul").jqmEnhanceable().grid({grid:this.options.grid}),i.buttonMarkup({corners:!1,shadow:!1,inline:!0,iconpos:s}),r.delegate("a","vclick",function(t){var r=e(t.target).is("a")?e(this):e(this).parent("a");if(!r.is(".ui-disabled, .ui-btn-active")){i.removeClass(e.mobile.activeBtnClass),e(this).addClass(e.mobile.activeBtnClass);var s=e(this);e(n).one("pagehide",function(){s.removeClass(e.mobile.activeBtnClass)})}}),r.closest(".ui-page").bind("pagebeforeshow",function(){i.filter(".ui-state-persist").addClass(e.mobile.activeBtnClass)})}}),e.mobile.document.bind("pagecreate create",function(t){e.mobile.navbar.prototype.enhanceWithin(t.target)})}(e),function(e){var t={};e.widget("mobile.listview",e.mobile.widget,e.extend({options:{theme:null,countTheme:"c",headerTheme:"b",dividerTheme:"b",icon:"arrow-r",splitIcon:"arrow-r",splitTheme:"b",corners:!0,shadow:!0,inset:!1,initSelector:":jqmData(role='listview')"},_create:function(){var e=this,t="";t+=e.options.inset?" ui-listview-inset":"",e.options.inset&&(t+=e.options.corners?" ui-corner-all":"",t+=e.options.shadow?" ui-shadow":""),e.element.addClass(function(e,n){return n+" ui-listview"+t}),e.refresh(!0)},_findFirstElementByTagName:function(e,t,n,r){var i={};for(i[n]=i[r]=!0;e;){if(i[e.nodeName])return e;e=e[t]}return null},_getChildrenByTagName:function(t,n,r){var i=[],s={};for(s[n]=s[r]=!0,t=t.firstChild;t;)s[t.nodeName]&&i.push(t),t=t.nextSibling;return e(i)},_addThumbClasses:function(t){var n,r,i=t.length;for(n=0;i>n;n++)r=e(this._findFirstElementByTagName(t[n].firstChild,"nextSibling","img","IMG")),r.length&&(r.addClass("ui-li-thumb"),e(this._findFirstElementByTagName(r[0].parentNode,"parentNode","li","LI")).addClass(r.is(".ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb"))},refresh:function(t){this.parentPage=this.element.closest(".ui-page"),this._createSubPages();var r,i,s,o,u,f,l,h,p,d,v,m,g=this.options,y=this.element,b=y.jqmData("dividertheme")||g.dividerTheme,w=y.jqmData("splittheme"),E=y.jqmData("spliticon"),S=y.jqmData("icon"),x=this._getChildrenByTagName(y[0],"li","LI"),T=!!e.nodeName(y[0],"ol"),N=!e.support.cssPseudoElement,C=y.attr("start"),k={};T&&N&&y.find(".ui-li-dec").remove(),T&&(C||0===C?N?l=parseInt(C,10):(h=parseInt(C,10)-1,y.css("counter-reset","listnumbering "+h)):N&&(l=1)),g.theme||(g.theme=e.mobile.getInheritedTheme(this.element,"c"));for(var L=0,A=x.length;A>L;L++){if(r=x.eq(L),i="ui-li",t||!r.hasClass("ui-li")){s=r.jqmData("theme")||g.theme,o=this._getChildrenByTagName(r[0],"a","A");var O="list-divider"===r.jqmData("role");o.length&&!O?(v=r.jqmData("icon"),r.buttonMarkup({wrapperEls:"div",shadow:!1,corners:!1,iconpos:"right",icon:o.length>1||v===!1?!1:v||S||g.icon,theme:s}),v!==!1&&1===o.length&&r.addClass("ui-li-has-arrow"),o.first().removeClass("ui-link").addClass("ui-link-inherit"),o.length>1&&(i+=" ui-li-has-alt",u=o.last(),f=w||u.jqmData("theme")||g.splitTheme,m=u.jqmData("icon"),u.appendTo(r).attr("title",e.trim(u.getEncodedText())).addClass("ui-li-link-alt").empty().buttonMarkup({shadow:!1,corners:!1,theme:s,icon:!1,iconpos:"notext"}).find(".ui-btn-inner").append(e(n.createElement("span")).buttonMarkup({shadow:!0,corners:!0,theme:f,iconpos:"notext",icon:m||v||E||g.splitIcon})))):O?(i+=" ui-li-divider ui-bar-"+(r.jqmData("theme")||b),r.attr("role","heading"),T&&(C||0===C?N?l=parseInt(C,10):(p=parseInt(C,10)-1,r.css("counter-reset","listnumbering "+p)):N&&(l=1))):i+=" ui-li-static ui-btn-up-"+s}T&&N&&i.indexOf("ui-li-divider")<0&&(d=i.indexOf("ui-li-static")>0?r:r.find(".ui-link-inherit"),d.addClass("ui-li-jsnumbering").prepend("<span class='ui-li-dec'>"+l++ +". </span>")),k[i]||(k[i]=[]),k[i].push(r[0])}for(i in k)e(k[i]).addClass(i).children(".ui-btn-inner").addClass(i);y.find("h1, h2, h3, h4, h5, h6").addClass("ui-li-heading").end().find("p, dl").addClass("ui-li-desc").end().find(".ui-li-aside").each(function(){var t=e(this);t.prependTo(t.parent())}).end().find(".ui-li-count").each(function(){e(this).closest("li").addClass("ui-li-has-count")}).addClass("ui-btn-up-"+(y.jqmData("counttheme")||this.options.countTheme)+" ui-btn-corner-all"),this._addThumbClasses(x),this._addThumbClasses(y.find(".ui-link-inherit")),this._addFirstLastClasses(x,this._getVisibles(x,t),t),this._trigger("afterrefresh")},_idStringEscape:function(e){return e.replace(/[^a-zA-Z0-9]/g,"-")},_createSubPages:function(){var n,r=this.element,i=r.closest(".ui-page"),s=i.jqmData("url"),o=s||i[0][e.expando],u=r.attr("id"),f=this.options,l="data-"+e.mobile.ns,c=this,h=i.find(":jqmData(role='footer')").jqmData("id");if("undefined"==typeof t[o]&&(t[o]=-1),u=u||++t[o],e(r.find("li>ul, li>ol").toArray().reverse()).each(function(t){var i,o,c=e(this),p=c.attr("id")||u+"-"+t,v=c.parent(),m=e(c.prevAll().toArray().reverse()),g=m.length?m:e("<span>"+e.trim(v.contents()[0].nodeValue)+"</span>"),y=g.first().getEncodedText(),b=(s||"")+"&"+e.mobile.subPageUrlKey+"="+p,w=c.jqmData("theme")||f.theme,E=c.jqmData("counttheme")||r.jqmData("counttheme")||f.countTheme;n=!0,i=c.detach().wrap("<div "+l+"role='page' "+l+"url='"+b+"' "+l+"theme='"+w+"' "+l+"count-theme='"+E+"'><div "+l+"role='content'></div></div>").parent().before("<div "+l+"role='header' "+l+"theme='"+f.headerTheme+"'><div class='ui-title'>"+y+"</div></div>").after(h?e("<div "+l+"role='footer' "+l+"id='"+h+"'>"):"").parent().appendTo(e.mobile.pageContainer),i.page(),o=v.find("a:first"),o.length||(o=e("<a/>").html(g||y).prependTo(v.empty())),o.attr("href","#"+b)}).listview(),n&&i.is(":jqmData(external-page='true')")&&i.data("mobile-page").options.domCache===!1){var p=function(t,n){var r,o=n.nextPage,u=new e.Event("pageremove");n.nextPage&&(r=o.jqmData("url"),0!==r.indexOf(s+"&"+e.mobile.subPageUrlKey)&&(c.childPages().remove(),i.trigger(u),u.isDefaultPrevented()||i.removeWithDependents()))};i.unbind("pagehide.remove").bind("pagehide.remove",p)}},childPages:function(){var t=this.parentPage.jqmData("url");return e(":jqmData(url^='"+t+"&"+e.mobile.subPageUrlKey+"')")}},e.mobile.behaviors.addFirstLastClasses)),e.mobile.document.bind("pagecreate create",function(t){e.mobile.listview.prototype.enhanceWithin(t.target)})}(e),function(e){var t=e("meta[name=viewport]"),n=t.attr("content"),r=n+",maximum-scale=1, user-scalable=no",i=n+",maximum-scale=10, user-scalable=yes",s=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test(n);e.mobile.zoom=e.extend({},{enabled:!s,locked:!1,disable:function(n){s||e.mobile.zoom.locked||(t.attr("content",r),e.mobile.zoom.enabled=!1,e.mobile.zoom.locked=n||!1)},enable:function(n){s||e.mobile.zoom.locked&&n!==!0||(t.attr("content",i),e.mobile.zoom.enabled=!0,e.mobile.zoom.locked=!1)},restore:function(){s||(t.attr("content",n),e.mobile.zoom.enabled=!0)}})}(e),function(e){e.widget("mobile.textinput",e.mobile.widget,{options:{theme:null,mini:!1,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,initSelector:"input[type='text'], input[type='search'], :jqmData(type='search'), input[type='number'], :jqmData(type='number'), input[type='password'], input[type='email'], input[type='url'], input[type='tel'], textarea, input[type='time'], input[type='date'], input[type='month'], input[type='week'], input[type='datetime'], input[type='datetime-local'], input[type='color'], input:not([type]), input[type='file']",clearBtn:!1,clearSearchButtonText:null,clearBtnText:"clear text",disabled:!1},_create:function(){function t(){setTimeout(function(){r.toggleClass("ui-input-clear-hidden",!s.val())},0)}var n,r,i=this,s=this.element,o=this.options,u=o.theme||e.mobile.getInheritedTheme(this.element,"c"),f=" ui-body-"+u,l=o.mini?" ui-mini":"",c=s.is("[type='search'], :jqmData(type='search')"),h=o.clearSearchButtonText||o.clearBtnText,p=s.is("textarea, :jqmData(type='range')"),d=!!o.clearBtn&&!p,v=s.is("input")&&!s.is(":jqmData(type='range')");if(e("label[for='"+s.attr("id")+"']").addClass("ui-input-text"),n=s.addClass("ui-input-text ui-body-"+u),"undefined"==typeof s[0].autocorrect||e.support.touchOverflow||(s[0].setAttribute("autocorrect","off"),s[0].setAttribute("autocomplete","off")),c?n=s.wrap("<div class='ui-input-search ui-shadow-inset ui-btn-corner-all ui-btn-shadow ui-icon-searchfield"+f+l+"'></div>").parent():v&&(n=s.wrap("<div class='ui-input-text ui-shadow-inset ui-corner-all ui-btn-shadow"+f+l+"'></div>").parent()),d||c?(r=e("<a href='#' class='ui-input-clear' title='"+h+"'>"+h+"</a>").bind("click",function(e){s.val("").focus().trigger("change"),r.addClass("ui-input-clear-hidden"),e.preventDefault()}).appendTo(n).buttonMarkup({icon:"delete",iconpos:"notext",corners:!0,shadow:!0,mini:o.mini}),c||n.addClass("ui-input-has-clear"),t(),s.bind("paste cut keyup input focus change blur",t)):v||c||s.addClass("ui-corner-all ui-shadow-inset"+f+l),s.focus(function(){o.preventFocusZoom&&e.mobile.zoom.disable(!0),n.addClass(e.mobile.focusClass)}).blur(function(){n.removeClass(e.mobile.focusClass),o.preventFocusZoom&&e.mobile.zoom.enable(!0)}),s.is("textarea")){var m,g=15,y=100;this._keyup=function(){var e=s[0].scrollHeight,t=s[0].clientHeight;if(e>t){var n=parseFloat(s.css("padding-top")),r=parseFloat(s.css("padding-bottom")),i=n+r;s.height(e-i+g)}},s.on("keyup change input paste",function(){clearTimeout(m),m=setTimeout(i._keyup,y)}),this._on(!0,e.mobile.document,{pagechange:"_keyup"}),e.trim(s.val())&&this._on(!0,e.mobile.window,{load:"_keyup"})}s.attr("disabled")&&this.disable()},disable:function(){var e,t=this.element.is("[type='search'], :jqmData(type='search')"),n=this.element.is("input")&&!this.element.is(":jqmData(type='range')"),r=this.element.attr("disabled",!0)&&(n||t);return e=r?this.element.parent():this.element,e.addClass("ui-disabled"),this._setOption("disabled",!0)},enable:function(){var e,t=this.element.is("[type='search'], :jqmData(type='search')"),n=this.element.is("input")&&!this.element.is(":jqmData(type='range')"),r=this.element.attr("disabled",!1)&&(n||t);return e=r?this.element.parent():this.element,e.removeClass("ui-disabled"),this._setOption("disabled",!1)}}),e.mobile.document.bind("pagecreate create",function(t){e.mobile.textinput.prototype.enhanceWithin(t.target,!0)})}(e),function(e){e.mobile.listview.prototype.options.filter=!1,e.mobile.listview.prototype.options.filterPlaceholder="Filter items...",e.mobile.listview.prototype.options.filterTheme="c",e.mobile.listview.prototype.options.filterReveal=!1;var t=function(e,t){return-1===e.toString().toLowerCase().indexOf(t)};e.mobile.listview.prototype.options.filterCallback=t,e.mobile.document.delegate("ul, ol","listviewcreate",function(){var n=e(this),r=n.data("mobile-listview");if(r&&r.options.filter){r.options.filterReveal&&n.children().addClass("ui-screen-hidden");var i=e("<form>",{"class":"ui-listview-filter ui-bar-"+r.options.filterTheme,role:"search"}).submit(function(e){e.preventDefault(),o.blur()}),s=function(){var i,s=e(this),o=this.value.toLowerCase(),u=null,f=n.children(),l=s.jqmData("lastval")+"",h=!1,p="",v=r.options.filterCallback!==t;if(!l||l!==o){if(r._trigger("beforefilter","beforefilter",{input:this}),s.jqmData("lastval",o),v||o.length<l.length||0!==o.indexOf(l)?u=n.children():(u=n.children(":not(.ui-screen-hidden)"),!u.length&&r.options.filterReveal&&(u=n.children(".ui-screen-hidden"))),o){for(var m=u.length-1;m>=0;m--)i=e(u[m]),p=i.jqmData("filtertext")||i.text(),i.is("li:jqmData(role=list-divider)")?(i.toggleClass("ui-filter-hidequeue",!h),h=!1):r.options.filterCallback(p,o,i)?i.toggleClass("ui-filter-hidequeue",!0):h=!0;u.filter(":not(.ui-filter-hidequeue)").toggleClass("ui-screen-hidden",!1),u.filter(".ui-filter-hidequeue").toggleClass("ui-screen-hidden",!0).toggleClass("ui-filter-hidequeue",!1)}else u.toggleClass("ui-screen-hidden",!!r.options.filterReveal);r._addFirstLastClasses(f,r._getVisibles(f,!1),!1)}},o=e("<input>",{placeholder:r.options.filterPlaceholder}).attr("data-"+e.mobile.ns+"type","search").jqmData("lastval","").bind("keyup change input",s).appendTo(i).textinput();r.options.inset&&i.addClass("ui-listview-filter-inset"),i.bind("submit",function(){return!1}).insertBefore(n)}})}(e),function(e){e.mobile.listview.prototype.options.autodividers=!1,e.mobile.listview.prototype.options.autodividersSelector=function(t){var n=e.trim(t.text())||null;return n?n=n.slice(0,1).toUpperCase():null},e.mobile.document.delegate("ul,ol","listviewcreate",function(){var t=e(this),r=t.data("mobile-listview");if(r&&r.options.autodividers){var i=function(){t.find("li:jqmData(role='list-divider')").remove();for(var i,s,o=t.find("li"),u=null,f=0;f<o.length;f++){if(i=o[f],s=r.options.autodividersSelector(e(i)),s&&u!==s){var l=n.createElement("li");l.appendChild(n.createTextNode(s)),l.setAttribute("data-"+e.mobile.ns+"role","list-divider"),i.parentNode.insertBefore(l,i)}u=s}},s=function(){t.unbind("listviewafterrefresh",s),i(),r.refresh(),t.bind("listviewafterrefresh",s)};s()}})}(e),function(e){e(n).bind("pagecreate create",function(t){e(":jqmData(role='nojs')",t.target).addClass("ui-nojs")})}(e),function(e){e.mobile.behaviors.formReset={_handleFormReset:function(){this._on(this.element.closest("form"),{reset:function(){this._delay("_reset")}})}}}(e),function(e){e.widget("mobile.checkboxradio",e.mobile.widget,e.extend({options:{theme:null,mini:!1,initSelector:"input[type='checkbox'],input[type='radio']"},_create:function(){var t=this,r=this.element,i=this.options,s=function(e,t){return e.jqmData(t)||e.closest("form, fieldset").jqmData(t)},o=e(r).closest("label"),u=o.length?o:e(r).closest("form, fieldset, :jqmData(role='page'), :jqmData(role='dialog')").find("label").filter("[for='"+r[0].id+"']").first(),f=r[0].type,l=s(r,"mini")||i.mini,h=f+"-on",p=f+"-off",d=s(r,"iconpos"),v="ui-"+h,m="ui-"+p;if("checkbox"===f||"radio"===f){e.extend(this,{label:u,inputtype:f,checkedClass:v,uncheckedClass:m,checkedicon:h,uncheckedicon:p}),i.theme||(i.theme=e.mobile.getInheritedTheme(this.element,"c")),u.buttonMarkup({theme:i.theme,icon:p,shadow:!1,mini:l,iconpos:d});var g=n.createElement("div");g.className="ui-"+f,r.add(u).wrapAll(g),u.bind({vmouseover:function(t){e(this).parent().is(".ui-disabled")&&t.stopPropagation()},vclick:function(e){return r.is(":disabled")?(e.preventDefault(),void 0):(t._cacheVals(),r.prop("checked","radio"===f&&!0||!r.prop("checked")),r.triggerHandler("click"),t._getInputSet().not(r).prop("checked",!1),t._updateAll(),!1)}}),r.bind({vmousedown:function(){t._cacheVals()},vclick:function(){var n=e(this);n.is(":checked")?(n.prop("checked",!0),t._getInputSet().not(n).prop("checked",!1)):n.prop("checked",!1),t._updateAll()},focus:function(){u.addClass(e.mobile.focusClass)},blur:function(){u.removeClass(e.mobile.focusClass)}}),this._handleFormReset(),this.refresh()}},_cacheVals:function(){this._getInputSet().each(function(){e(this).jqmData("cacheVal",this.checked)})},_getInputSet:function(){return"checkbox"===this.inputtype?this.element:this.element.closest("form, :jqmData(role='page'), :jqmData(role='dialog')").find("input[name='"+this.element[0].name+"'][type='"+this.inputtype+"']")},_updateAll:function(){var t=this;this._getInputSet().each(function(){var n=e(this);(this.checked||"checkbox"===t.inputtype)&&n.trigger("change")}).checkboxradio("refresh")},_reset:function(){this.refresh()},refresh:function(){var t=this.element[0],n=" "+e.mobile.activeBtnClass,r=this.checkedClass+(this.element.parents(".ui-controlgroup-horizontal").length?n:""),i=this.label;t.checked?i.removeClass(this.uncheckedClass+n).addClass(r).buttonMarkup({icon:this.checkedicon}):i.removeClass(r).addClass(this.uncheckedClass).buttonMarkup({icon:this.uncheckedicon}),t.disabled?this.disable():this.enable()},disable:function(){this.element.prop("disabled",!0).parent().addClass("ui-disabled")},enable:function(){this.element.prop("disabled",!1).parent().removeClass("ui-disabled")}},e.mobile.behaviors.formReset)),e.mobile.document.bind("pagecreate create",function(t){e.mobile.checkboxradio.prototype.enhanceWithin(t.target,!0)})}(e),function(e){e.widget("mobile.button",e.mobile.widget,{options:{theme:null,icon:null,iconpos:null,corners:!0,shadow:!0,iconshadow:!0,inline:null,mini:null,initSelector:"button, [type='button'], [type='submit'], [type='reset']"},_create:function(){var t,n=this.element,r=function(e){var t,n={};for(t in e)null!==e[t]&&"initSelector"!==t&&(n[t]=e[t]);return n}(this.options),i="";return"A"===n[0].tagName?(n.hasClass("ui-btn")||n.buttonMarkup(),void 0):(this.options.theme||(this.options.theme=e.mobile.getInheritedTheme(this.element,"c")),~n[0].className.indexOf("ui-btn-left")&&(i="ui-btn-left"),~n[0].className.indexOf("ui-btn-right")&&(i="ui-btn-right"),("submit"===n.attr("type")||"reset"===n.attr("type"))&&(i?i+=" ui-submit":i="ui-submit"),e("label[for='"+n.attr("id")+"']").addClass("ui-submit"),this.button=e("<div></div>")[n.html()?"html":"text"](n.html()||n.val()).insertBefore(n).buttonMarkup(r).addClass(i).append(n.addClass("ui-btn-hidden")),t=this.button,n.bind({focus:function(){t.addClass(e.mobile.focusClass)},blur:function(){t.removeClass(e.mobile.focusClass)}}),this.refresh(),void 0)},_setOption:function(t,n){var r={};r[t]=n,"initSelector"!==t&&(this.button.buttonMarkup(r),this.element.attr("data-"+(e.mobile.ns||"")+t.replace(/([A-Z])/,"-$1").toLowerCase(),n)),this._super("_setOption",t,n)},enable:function(){return this.element.attr("disabled",!1),this.button.removeClass("ui-disabled").attr("aria-disabled",!1),this._setOption("disabled",!1)},disable:function(){return this.element.attr("disabled",!0),this.button.addClass("ui-disabled").attr("aria-disabled",!0),this._setOption("disabled",!0)},refresh:function(){var t=this.element;t.prop("disabled")?this.disable():this.enable(),e(this.button.data("buttonElements").text)[t.html()?"html":"text"](t.html()||t.val())}}),e.mobile.document.bind("pagecreate create",function(t){e.mobile.button.prototype.enhanceWithin(t.target,!0)})}(e),function(e,r){e.widget("mobile.slider",e.mobile.widget,e.extend({widgetEventPrefix:"slide",options:{theme:null,trackTheme:null,disabled:!1,initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",mini:!1,highlight:!1},_create:function(){var i,s,o=this,u=this.element,f=e.mobile.getInheritedTheme(u,"c"),l=this.options.theme||f,h=this.options.trackTheme||f,p=u[0].nodeName.toLowerCase(),v=(this.isToggleSwitch="select"===p,u.parent().is(":jqmData(role='rangeslider')")),m=this.isToggleSwitch?"ui-slider-switch":"",g=u.attr("id"),y=e("[for='"+g+"']"),w=y.attr("id")||g+"-label",E=y.attr("id",w),S=this.isToggleSwitch?0:parseFloat(u.attr("min")),x=this.isToggleSwitch?u.find("option").length-1:parseFloat(u.attr("max")),T=t.parseFloat(u.attr("step")||1),N=this.options.mini||u.jqmData("mini")?" ui-mini":"",C=n.createElement("a"),k=e(C),L=n.createElement("div"),A=e(L),O=this.options.highlight&&!this.isToggleSwitch?function(){var t=n.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass+" ui-btn-corner-all",e(t).prependTo(A)}():!1;if(C.setAttribute("href","#"),L.setAttribute("role","application"),L.className=[this.isToggleSwitch?"ui-slider ":"ui-slider-track ",m," ui-btn-down-",h," ui-btn-corner-all",N].join(""),C.className="ui-slider-handle",L.appendChild(C),k.buttonMarkup({corners:!0,theme:l,shadow:!0}).attr({role:"slider","aria-valuemin":S,"aria-valuemax":x,"aria-valuenow":this._value(),"aria-valuetext":this._value(),title:this._value(),"aria-labelledby":w}),e.extend(this,{slider:A,handle:k,type:p,step:T,max:x,min:S,valuebg:O,isRangeslider:v,dragging:!1,beforeStart:null,userModified:!1,mouseMoved:!1}),this.isToggleSwitch){s=n.createElement("div"),s.className="ui-slider-inneroffset";for(var M=0,_=L.childNodes.length;_>M;M++)s.appendChild(L.childNodes[M]);L.appendChild(s),k.addClass("ui-slider-handle-snapping"),i=u.find("option");for(var D=0,P=i.length;P>D;D++){var H=D?"a":"b",B=D?" "+e.mobile.activeBtnClass:" ui-btn-down-"+h,j=(n.createElement("div"),n.createElement("span"));j.className=["ui-slider-label ui-slider-label-",H,B," ui-btn-corner-all"].join(""),j.setAttribute("role","img"),j.appendChild(n.createTextNode(i[D].innerHTML)),e(j).prependTo(A)}o._labels=e(".ui-slider-label",A)}E.addClass("ui-slider"),u.addClass(this.isToggleSwitch?"ui-slider-switch":"ui-slider-input"),this._on(u,{change:"_controlChange",keyup:"_controlKeyup",blur:"_controlBlur",vmouseup:"_controlVMouseUp"}),A.bind("vmousedown",e.proxy(this._sliderVMouseDown,this)).bind("vclick",!1),this._on(n,{vmousemove:"_preventDocumentDrag"}),this._on(A.add(n),{vmouseup:"_sliderVMouseUp"}),A.insertAfter(u),this.isToggleSwitch||v||(s=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>",u.add(A).wrapAll(s)),this.isToggleSwitch&&this.handle.bind({focus:function(){A.addClass(e.mobile.focusClass)},blur:function(){A.removeClass(e.mobile.focusClass)}}),this._on(this.handle,{vmousedown:"_handleVMouseDown",keydown:"_handleKeydown",keyup:"_handleKeyup"}),this.handle.bind("vclick",!1),this._handleFormReset(),this.refresh(r,r,!0)},_controlChange:function(e){return this._trigger("controlchange",e)===!1?!1:(this.mouseMoved||this.refresh(this._value(),!0),void 0)},_controlKeyup:function(){this.refresh(this._value(),!0,!0)},_controlBlur:function(){this.refresh(this._value(),!0)},_controlVMouseUp:function(){this._checkedRefresh()},_handleVMouseDown:function(){this.handle.focus()},_handleKeydown:function(t){var n=this._value();if(!this.options.disabled){switch(t.keyCode){case e.mobile.keyCode.HOME:case e.mobile.keyCode.END:case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:t.preventDefault(),this._keySliding||(this._keySliding=!0,this.handle.addClass("ui-state-active"))}switch(t.keyCode){case e.mobile.keyCode.HOME:this.refresh(this.min);break;case e.mobile.keyCode.END:this.refresh(this.max);break;case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:this.refresh(n+this.step);break;case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:this.refresh(n-this.step)}}},_handleKeyup:function(){this._keySliding&&(this._keySliding=!1,this.handle.removeClass("ui-state-active"))},_sliderVMouseDown:function(e){return this.options.disabled||1!==e.which&&0!==e.which&&e.which!==r?!1:this._trigger("beforestart",e)===!1?!1:(this.dragging=!0,this.userModified=!1,this.mouseMoved=!1,this.isToggleSwitch&&(this.beforeStart=this.element[0].selectedIndex),this.refresh(e),this._trigger("start"),!1)},_sliderVMouseUp:function(){return this.dragging?(this.dragging=!1,this.isToggleSwitch&&(this.handle.addClass("ui-slider-handle-snapping"),this.mouseMoved?this.userModified?this.refresh(0===this.beforeStart?1:0):this.refresh(this.beforeStart):this.refresh(0===this.beforeStart?1:0)),this.mouseMoved=!1,this._trigger("stop"),!1):void 0},_preventDocumentDrag:function(e){return this._trigger("drag",e)===!1?!1:this.dragging&&!this.options.disabled?(this.mouseMoved=!0,this.isToggleSwitch&&this.handle.removeClass("ui-slider-handle-snapping"),this.refresh(e),this.userModified=this.beforeStart!==this.element[0].selectedIndex,!1):void 0},_checkedRefresh:function(){this.value!==this._value()&&this.refresh(this._value())},_value:function(){return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val())},_reset:function(){this.refresh(r,!1,!0)},refresh:function(t,r,i){var s,o,u,f,l=this,h=e.mobile.getInheritedTheme(this.element,"c"),p=this.options.theme||h,d=this.options.trackTheme||h;l.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch":"ui-slider-track"," ui-btn-down-"+d," ui-btn-corner-all",this.options.mini?" ui-mini":""].join(""),(this.options.disabled||this.element.attr("disabled"))&&this.disable(),this.value=this._value(),this.options.highlight&&!this.isToggleSwitch&&0===this.slider.find(".ui-slider-bg").length&&(this.valuebg=function(){var t=n.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass+" ui-btn-corner-all",e(t).prependTo(l.slider)}()),this.handle.buttonMarkup({corners:!0,theme:p,shadow:!0});var v,m,g=this.element,y=!this.isToggleSwitch,b=y?[]:g.find("option"),w=y?parseFloat(g.attr("min")):0,E=y?parseFloat(g.attr("max")):b.length-1,S=y&&parseFloat(g.attr("step"))>0?parseFloat(g.attr("step")):1;if("object"==typeof t){if(u=t,f=8,s=this.slider.offset().left,o=this.slider.width(),v=o/((E-w)/S),!this.dragging||u.pageX<s-f||u.pageX>s+o+f)return;m=v>1?100*((u.pageX-s)/o):Math.round(100*((u.pageX-s)/o))}else null==t&&(t=y?parseFloat(g.val()||0):g[0].selectedIndex),m=100*((parseFloat(t)-w)/(E-w));if(!isNaN(m)){var x=m/100*(E-w)+w,T=(x-w)%S,N=x-T;2*Math.abs(T)>=S&&(N+=T>0?S:-S);var C=100/((E-w)/S);if(x=parseFloat(N.toFixed(5)),"undefined"==typeof v&&(v=o/((E-w)/S)),v>1&&y&&(m=(x-w)*C*(1/S)),0>m&&(m=0),m>100&&(m=100),w>x&&(x=w),x>E&&(x=E),this.handle.css("left",m+"%"),this.handle[0].setAttribute("aria-valuenow",y?x:b.eq(x).attr("value")),this.handle[0].setAttribute("aria-valuetext",y?x:b.eq(x).getEncodedText()),this.handle[0].setAttribute("title",y?x:b.eq(x).getEncodedText()),this.valuebg&&this.valuebg.css("width",m+"%"),this._labels){var k=100*(this.handle.width()/this.slider.width()),L=m&&k+(100-k)*m/100,A=100===m?0:Math.min(k+100-L,100);this._labels.each(function(){var t=e(this).is(".ui-slider-label-a");e(this).width((t?L:A)+"%")})}if(!i){var O=!1;if(y?(O=g.val()!==x,g.val(x)):(O=g[0].selectedIndex!==x,g[0].selectedIndex=x),this._trigger("beforechange",t)===!1)return!1;!r&&O&&g.trigger("change")}}},enable:function(){return this.element.attr("disabled",!1),this.slider.removeClass("ui-disabled").attr("aria-disabled",!1),this._setOption("disabled",!1)},disable:function(){return this.element.attr("disabled",!0),this.slider.addClass("ui-disabled").attr("aria-disabled",!0),this._setOption("disabled",!0)}},e.mobile.behaviors.formReset)),e.mobile.document.bind("pagecreate create",function(t){e.mobile.slider.prototype.enhanceWithin(t.target,!0)})}(e),function(e){e.widget("mobile.rangeslider",e.mobile.widget,{options:{theme:null,trackTheme:null,disabled:!1,initSelector:":jqmData(role='rangeslider')",mini:!1,highlight:!0},_create:function(){var t,n=this.element,r=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",i=n.find("input").first(),s=n.find("input").last(),o=n.find("label").first(),u=e.data(i.get(0),"mobileSlider").slider,f=e.data(s.get(0),"mobileSlider").slider,l=e.data(i.get(0),"mobileSlider").handle,c=e('<div class="ui-rangeslider-sliders" />').appendTo(n);n.find("label").length>1&&(t=n.find("label").last().hide()),i.addClass("ui-rangeslider-first"),s.addClass("ui-rangeslider-last"),n.addClass(r),u.appendTo(c),f.appendTo(c),o.prependTo(n),l.prependTo(f),e.extend(this,{_inputFirst:i,_inputLast:s,_sliderFirst:u,_sliderLast:f,_targetVal:null,_sliderTarget:!1,_sliders:c,_proxy:!1}),this.refresh(),this._on(this.element.find("input.ui-slider-input"),{slidebeforestart:"_slidebeforestart",slidestop:"_slidestop",slidedrag:"_slidedrag",slidebeforechange:"_change",blur:"_change",keyup:"_change"}),this._on({mousedown:"_change"}),this._on(this.element.closest("form"),{reset:"_handleReset"}),this._on(l,{vmousedown:"_dragFirstHandle"})},_handleReset:function(){var e=this;setTimeout(function(){e._updateHighlight()},0)},_dragFirstHandle:function(t){return e.data(this._inputFirst.get(0),"mobileSlider").dragging=!0,e.data(this._inputFirst.get(0),"mobileSlider").refresh(t),!1},_slidedrag:function(t){var n=e(t.target).is(this._inputFirst),r=n?this._inputLast:this._inputFirst;return this._sliderTarget=!1,"first"===this._proxy&&n||"last"===this._proxy&&!n?(e.data(r.get(0),"mobileSlider").dragging=!0,e.data(r.get(0),"mobileSlider").refresh(t),!1):void 0},_slidestop:function(t){var n=e(t.target).is(this._inputFirst);this._proxy=!1,this.element.find("input").trigger("vmouseup"),this._sliderFirst.css("z-index",n?1:"")},_slidebeforestart:function(t){this._sliderTarget=!1,e(t.originalEvent.target).hasClass("ui-slider-track")&&(this._sliderTarget=!0,this._targetVal=e(t.target).val())},_setOption:function(e){this._superApply(e),this.refresh()},refresh:function(){var e=this.element,t=this.options;e.find("input").slider({theme:t.theme,trackTheme:t.trackTheme,disabled:t.disabled,mini:t.mini,highlight:t.highlight}).slider("refresh"),this._updateHighlight()},_change:function(t){if("keyup"===t.type)return this._updateHighlight(),!1;var n=this,r=parseFloat(this._inputFirst.val(),10),i=parseFloat(this._inputLast.val(),10),s=e(t.target).hasClass("ui-rangeslider-first"),o=s?this._inputFirst:this._inputLast,u=s?this._inputLast:this._inputFirst;if(this._inputFirst.val()>this._inputLast.val()&&"mousedown"===t.type&&!e(t.target).hasClass("ui-slider-handle"))o.blur();else if("mousedown"===t.type)return;return r>i&&!this._sliderTarget?(o.val(s?i:r).slider("refresh"),this._trigger("normalize")):r>i&&(o.val(this._targetVal).slider("refresh"),setTimeout(function(){u.val(s?r:i).slider("refresh"),e.data(u.get(0),"mobileSlider").handle.focus(),n._sliderFirst.css("z-index",s?"":1),n._trigger("normalize")},0),this._proxy=s?"first":"last"),r===i?(e.data(o.get(0),"mobileSlider").handle.css("z-index",1),e.data(u.get(0),"mobileSlider").handle.css("z-index",0)):(e.data(u.get(0),"mobileSlider").handle.css("z-index",""),e.data(o.get(0),"mobileSlider").handle.css("z-index","")),this._updateHighlight(),r>=i?!1:void 0},_updateHighlight:function(){var t=parseInt(e.data(this._inputFirst.get(0),"mobileSlider").handle.get(0).style.left,10),n=parseInt(e.data(this._inputLast.get(0),"mobileSlider").handle.get(0).style.left,10),r=n-t;this.element.find(".ui-slider-bg").css({"margin-left":t+"%",width:r+"%"})},_destroy:function(){this.element.removeClass("ui-rangeslider ui-mini").find("label").show(),this._inputFirst.after(this._sliderFirst),this._inputLast.after(this._sliderLast),this._sliders.remove(),this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy")}}),e.widget("mobile.rangeslider",e.mobile.rangeslider,e.mobile.behaviors.formReset),e(n).bind("pagecreate create",function(t){e.mobile.rangeslider.prototype.enhanceWithin(t.target,!0)})}(e),function(e){e.widget("mobile.selectmenu",e.mobile.widget,e.extend({options:{theme:null,disabled:!1,icon:"arrow-d",iconpos:"right",inline:!1,corners:!0,shadow:!0,iconshadow:!0,overlayTheme:"a",dividerTheme:"b",hidePlaceholderMenuItems:!0,closeText:"Close",nativeMenu:!0,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,initSelector:"select:not( :jqmData(role='slider') )",mini:!1},_button:function(){return e("<div/>")},_setDisabled:function(e){return this.element.attr("disabled",e),this.button.attr("aria-disabled",e),this._setOption("disabled",e)},_focusButton:function(){var e=this;setTimeout(function(){e.button.focus()},40)},_selectOptions:function(){return this.select.find("option")},_preExtension:function(){var t="";~this.element[0].className.indexOf("ui-btn-left")&&(t=" ui-btn-left"),~this.element[0].className.indexOf("ui-btn-right")&&(t=" ui-btn-right"),this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+t+"'>"),this.selectID=this.select.attr("id"),this.label=e("label[for='"+this.selectID+"']").addClass("ui-select"),this.isMultiple=this.select[0].multiple,this.options.theme||(this.options.theme=e.mobile.getInheritedTheme(this.select,"c"))},_destroy:function(){var e=this.element.parents(".ui-select");e.length>0&&(e.is(".ui-btn-left, .ui-btn-right")&&this.element.addClass(e.is(".ui-btn-left")?"ui-btn-left":"ui-btn-right"),this.element.insertAfter(e),e.remove())},_create:function(){this._preExtension(),this._trigger("beforeCreate"),this.button=this._button();var n=this,r=this.options,i=r.inline||this.select.jqmData("inline"),s=r.mini||this.select.jqmData("mini"),o=r.icon?r.iconpos||this.select.jqmData("iconpos"):!1,u=(-1===this.select[0].selectedIndex?0:this.select[0].selectedIndex,this.button.insertBefore(this.select).buttonMarkup({theme:r.theme,icon:r.icon,iconpos:o,inline:i,corners:r.corners,shadow:r.shadow,iconshadow:r.iconshadow,mini:s}));this.setButtonText(),r.nativeMenu&&t.opera&&t.opera.version&&u.addClass("ui-select-nativeonly"),this.isMultiple&&(this.buttonCount=e("<span>").addClass("ui-li-count ui-btn-up-c ui-btn-corner-all").hide().appendTo(u.addClass("ui-li-has-count"))),(r.disabled||this.element.attr("disabled"))&&this.disable(),this.select.change(function(){n.refresh(),r.nativeMenu&&this.blur()}),this._handleFormReset(),this.build()},build:function(){var t=this;this.select.appendTo(t.button).bind("vmousedown",function(){t.button.addClass(e.mobile.activeBtnClass)}).bind("focus",function(){t.button.addClass(e.mobile.focusClass)}).bind("blur",function(){t.button.removeClass(e.mobile.focusClass)}).bind("focus vmouseover",function(){t.button.trigger("vmouseover")}).bind("vmousemove",function(){t.button.removeClass(e.mobile.activeBtnClass)}).bind("change blur vmouseout",function(){t.button.trigger("vmouseout").removeClass(e.mobile.activeBtnClass)}).bind("change blur",function(){t.button.removeClass("ui-btn-down-"+t.options.theme)}),t.button.bind("vmousedown",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.label.bind("click focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.select.bind("focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.button.bind("mouseup",function(){t.options.preventFocusZoom&&setTimeout(function(){e.mobile.zoom.enable(!0)},0)}),t.select.bind("blur",function(){t.options.preventFocusZoom&&e.mobile.zoom.enable(!0)})},selected:function(){return this._selectOptions().filter(":selected")},selectedIndices:function(){var e=this;return this.selected().map(function(){return e._selectOptions().index(this)}).get()},setButtonText:function(){var t=this,r=this.selected(),i=this.placeholder,s=e(n.createElement("span"));this.button.find(".ui-btn-text").html(function(){return i=r.length?r.map(function(){return e(this).text()}).get().join(", "):t.placeholder,s.text(i).addClass(t.select.attr("class")).addClass(r.attr("class"))})},setButtonCount:function(){var e=this.selected();this.isMultiple&&this.buttonCount[e.length>1?"show":"hide"]().text(e.length)},_reset:function(){this.refresh()},refresh:function(){this.setButtonText(),this.setButtonCount()},open:e.noop,close:e.noop,disable:function(){this._setDisabled(!0),this.button.addClass("ui-disabled")},enable:function(){this._setDisabled(!1),this.button.removeClass("ui-disabled")}},e.mobile.behaviors.formReset)),e.mobile.document.bind("pagecreate create",function(t){e.mobile.selectmenu.prototype.enhanceWithin(t.target,!0)})}(e),function(e,r){function i(e,t,n,r){var i=r;return i=t>e?n+(e-t)/2:Math.min(Math.max(n,r-t/2),n+e-t)}function s(){var n=e.mobile.window;return{x:n.scrollLeft(),y:n.scrollTop(),cx:t.innerWidth||n.width(),cy:t.innerHeight||n.height()}}e.widget("mobile.popup",e.mobile.widget,{options:{theme:null,overlayTheme:null,shadow:!0,corners:!0,transition:"none",positionTo:"origin",tolerance:null,initSelector:":jqmData(role='popup')",closeLinkSelector:"a:jqmData(rel='back')",closeLinkEvents:"click.popup",navigateEvents:"navigate.popup",closeEvents:"navigate.popup pagebeforechange.popup",dismissible:!0,history:!e.mobile.browser.oldIE},_eatEventAndClose:function(e){return e.preventDefault(),e.stopImmediatePropagation(),this.options.dismissible&&this.close(),!1},_resizeScreen:function(){var e=this._ui.container.outerHeight(!0);this._ui.screen.removeAttr("style"),e>this._ui.screen.height()&&this._ui.screen.height(e)},_handleWindowKeyUp:function(t){return this._isOpen&&t.keyCode===e.mobile.keyCode.ESCAPE?this._eatEventAndClose(t):void 0},_expectResizeEvent:function(){var t=s();if(this._resizeData){if(t.x===this._resizeData.winCoords.x&&t.y===this._resizeData.winCoords.y&&t.cx===this._resizeData.winCoords.cx&&t.cy===this._resizeData.winCoords.cy)return!1;clearTimeout(this._resizeData.timeoutId)}return this._resizeData={timeoutId:setTimeout(e.proxy(this,"_resizeTimeout"),200),winCoords:t},!0},_resizeTimeout:function(){this._isOpen?this._expectResizeEvent()||(this._ui.container.hasClass("ui-popup-hidden")&&(this._ui.container.removeClass("ui-popup-hidden"),this.reposition({positionTo:"window"}),this._ignoreResizeEvents()),this._resizeScreen(),this._resizeData=null,this._orientationchangeInProgress=!1):(this._resizeData=null,this._orientationchangeInProgress=!1)},_ignoreResizeEvents:function(){var e=this;this._ignoreResizeTo&&clearTimeout(this._ignoreResizeTo),this._ignoreResizeTo=setTimeout(function(){e._ignoreResizeTo=0},1e3)},_handleWindowResize:function(){this._isOpen&&0===this._ignoreResizeTo&&(!this._expectResizeEvent()&&!this._orientationchangeInProgress||this._ui.container.hasClass("ui-popup-hidden")||this._ui.container.addClass("ui-popup-hidden").removeAttr("style"))},_handleWindowOrientationchange:function(){!this._orientationchangeInProgress&&this._isOpen&&0===this._ignoreResizeTo&&(this._expectResizeEvent(),this._orientationchangeInProgress=!0)},_handleDocumentFocusIn:function(t){var r,i=t.target,s=this._ui;if(this._isOpen){if(i!==s.container[0]){if(r=e(t.target),0===r.parents().filter(s.container[0]).length)return e(n.activeElement).one("focus",function(){r.blur()}),s.focusElement.focus(),t.preventDefault(),t.stopImmediatePropagation(),!1;s.focusElement[0]===s.container[0]&&(s.focusElement=r)}this._ignoreResizeEvents()}},_create:function(){var t={screen:e("<div class='ui-screen-hidden ui-popup-screen'></div>"),placeholder:e("<div style='display: none;'><!-- placeholder --></div>"),container:e("<div class='ui-popup-container ui-popup-hidden'></div>")},n=this.element.closest(".ui-page"),r=this.element.attr("id"),i=this.options;i.history=i.history&&e.mobile.ajaxEnabled&&e.mobile.hashListeningEnabled,0===n.length&&(n=e("body")),i.container=i.container||e.mobile.pageContainer||n,n.append(t.screen),t.container.insertAfter(t.screen),t.placeholder.insertAfter(this.element),r&&(t.screen.attr("id",r+"-screen"),t.container.attr("id",r+"-popup"),t.placeholder.html("<!-- placeholder for "+r+" -->")),t.container.append(this.element),t.focusElement=t.container,this.element.addClass("ui-popup"),e.extend(this,{_scrollTop:0,_page:n,_ui:t,_fallbackTransition:"",_currentTransition:!1,_prereqs:null,_isOpen:!1,_tolerance:null,_resizeData:null,_ignoreResizeTo:0,_orientationchangeInProgress:!1}),this._applyTheme(this.element,i.theme,"body"),this._applyTheme(this._ui.screen,i.overlayTheme,"overlay"),this._applyTransition(i.transition),this.element.toggleClass("ui-overlay-shadow",i.shadow).toggleClass("ui-corner-all",i.corners),this._setTolerance(i.tolerance),t.screen.bind("vclick",e.proxy(this,"_eatEventAndClose")),this._on(e.mobile.window,{orientationchange:e.proxy(this,"_handleWindowOrientationchange"),resize:e.proxy(this,"_handleWindowResize"),keyup:e.proxy(this,"_handleWindowKeyUp")}),this._on(e.mobile.document,{focusin:e.proxy(this,"_handleDocumentFocusIn")})},_applyTheme:function(e,t,n){for(var r,i=(e.attr("class")||"").split(" "),s=null,o=String(t);i.length>0;){if(s=i.pop(),r=(new RegExp("^ui-"+n+"-([a-z])$")).exec(s),r&&r.length>1){s=r[1];break}s=null}t!==s&&(e.removeClass("ui-"+n+"-"+s),null!==t&&"none"!==t&&e.addClass("ui-"+n+"-"+o))},_setTheme:function(e){this._applyTheme(this.element,e,"body")},_setOverlayTheme:function(e){this._applyTheme(this._ui.screen,e,"overlay"),this._isOpen&&this._ui.screen.addClass("in")},_setShadow:function(e){this.element.toggleClass("ui-overlay-shadow",e)},_setCorners:function(e){this.element.toggleClass("ui-corner-all",e)},_applyTransition:function(t){this._ui.container.removeClass(this._fallbackTransition),t&&"none"!==t&&(this._fallbackTransition=e.mobile._maybeDegradeTransition(t),"none"===this._fallbackTransition&&(this._fallbackTransition=""),this._ui.container.addClass(this._fallbackTransition))},_setTransition:function(e){this._currentTransition||this._applyTransition(e)},_setTolerance:function(t){var n={t:30,r:15,b:30,l:15};if(t!==r){var i=String(t).split(",");switch(e.each(i,function(e,t){i[e]=parseInt(t,10)}),i.length){case 1:isNaN(i[0])||(n.t=n.r=n.b=n.l=i[0]);break;case 2:isNaN(i[0])||(n.t=n.b=i[0]),isNaN(i[1])||(n.l=n.r=i[1]);break;case 4:isNaN(i[0])||(n.t=i[0]),isNaN(i[1])||(n.r=i[1]),isNaN(i[2])||(n.b=i[2]),isNaN(i[3])||(n.l=i[3])}}this._tolerance=n},_setOption:function(e,t){var n="_set"+e.charAt(0).toUpperCase()+e.slice(1);this[n]!==r&&this[n](t),this._super(e,t)},_placementCoords:function(e){var t,r,o=s(),u={x:this._tolerance.l,y:o.y+this._tolerance.t,cx:o.cx-this._tolerance.l-this._tolerance.r,cy:o.cy-this._tolerance.t-this._tolerance.b};this._ui.container.css("max-width",u.cx),t={cx:this._ui.container.outerWidth(!0),cy:this._ui.container.outerHeight(!0)},r={x:i(u.cx,t.cx,u.x,e.x),y:i(u.cy,t.cy,u.y,e.y)},r.y=Math.max(0,r.y);var a=n.documentElement,l=n.body,h=Math.max(a.clientHeight,l.scrollHeight,l.offsetHeight,a.scrollHeight,a.offsetHeight);return r.y-=Math.min(r.y,Math.max(0,r.y+t.cy-h)),{left:r.x,top:r.y}},_createPrereqs:function(t,n,r){var i,s=this;i={screen:e.Deferred(),container:e.Deferred()},i.screen.then(function(){i===s._prereqs&&t()}),i.container.then(function(){i===s._prereqs&&n()}),e.when(i.screen,i.container).done(function(){i===s._prereqs&&(s._prereqs=null,r())}),s._prereqs=i},_animate:function(t){return this._ui.screen.removeClass(t.classToRemove).addClass(t.screenClassToAdd),t.prereqs.screen.resolve(),t.transition&&"none"!==t.transition&&(t.applyTransition&&this._applyTransition(t.transition),this._fallbackTransition)?(this._ui.container.animationComplete(e.proxy(t.prereqs.container,"resolve")).addClass(t.containerClassToAdd).removeClass(t.classToRemove),void 0):(this._ui.container.removeClass(t.classToRemove),t.prereqs.container.resolve(),void 0)},_desiredCoords:function(t){var n,r=null,i=s(),o=t.x,u=t.y,l=t.positionTo;if(l&&"origin"!==l)if("window"===l)o=i.cx/2+i.x,u=i.cy/2+i.y;else{try{r=e(l)}catch(c){r=null}r&&(r.filter(":visible"),0===r.length&&(r=null))}return r&&(n=r.offset(),o=n.left+r.outerWidth()/2,u=n.top+r.outerHeight()/2),("number"!==e.type(o)||isNaN(o))&&(o=i.cx/2+i.x),("number"!==e.type(u)||isNaN(u))&&(u=i.cy/2+i.y),{x:o,y:u}},_reposition:function(e){e={x:e.x,y:e.y,positionTo:e.positionTo},this._trigger("beforeposition",r,e),this._ui.container.offset(this._placementCoords(this._desiredCoords(e)))},reposition:function(e){this._isOpen&&this._reposition(e)},_openPrereqsComplete:function(){this._ui.container.addClass("ui-popup-active"),this._isOpen=!0,this._resizeScreen(),this._ui.container.attr("tabindex","0").focus(),this._ignoreResizeEvents(),this._trigger("afteropen")},_open:function(t){var n=e.extend({},this.options,t),r=function(){var e=navigator.userAgent,t=e.match(/AppleWebKit\/([0-9\.]+)/),n=!!t&&t[1],r=e.match(/Android (\d+(?:\.\d+))/),i=!!r&&r[1],s=e.indexOf("Chrome")>-1;return null!==r&&"4.0"===i&&n&&n>534.13&&!s?!0:!1}();this._createPrereqs(e.noop,e.noop,e.proxy(this,"_openPrereqsComplete")),this._currentTransition=n.transition,this._applyTransition(n.transition),this.options.theme||this._setTheme(this._page.jqmData("theme")||e.mobile.getInheritedTheme(this._page,"c")),this._ui.screen.removeClass("ui-screen-hidden"),this._ui.container.removeClass("ui-popup-hidden"),this._reposition(n),this.options.overlayTheme&&r&&this.element.closest(".ui-page").addClass("ui-popup-open"),this._animate({additionalCondition:!0,transition:n.transition,classToRemove:"",screenClassToAdd:"in",containerClassToAdd:"in",applyTransition:!1,prereqs:this._prereqs})},_closePrereqScreen:function(){this._ui.screen.removeClass("out").addClass("ui-screen-hidden")},_closePrereqContainer:function(){this._ui.container.removeClass("reverse out").addClass("ui-popup-hidden").removeAttr("style")},_closePrereqsDone:function(){var t=this._ui.container;t.removeAttr("tabindex"),e.mobile.popup.active=r,e(":focus",t[0]).add(t[0]).blur(),this._trigger("afterclose")},_close:function(t){this._ui.container.removeClass("ui-popup-active"),this._page.removeClass("ui-popup-open"),this._isOpen=!1,this._createPrereqs(e.proxy(this,"_closePrereqScreen"),e.proxy(this,"_closePrereqContainer"),e.proxy(this,"_closePrereqsDone")),this._animate({additionalCondition:this._ui.screen.hasClass("in"),transition:t?"none":this._currentTransition,classToRemove:"in",screenClassToAdd:"out",containerClassToAdd:"reverse out",applyTransition:!0,prereqs:this._prereqs})},_unenhance:function(){this._setTheme("none"),this.element.detach().insertAfter(this._ui.placeholder).removeClass("ui-popup ui-overlay-shadow ui-corner-all"),this._ui.screen.remove(),this._ui.container.remove(),this._ui.placeholder.remove()},_destroy:function(){e.mobile.popup.active===this?(this.element.one("popupafterclose",e.proxy(this,"_unenhance")),this.close()):this._unenhance()},_closePopup:function(n,r){var i,s,o=this.options,u=!1;t.scrollTo(0,this._scrollTop),n&&"pagebeforechange"===n.type&&r&&(i="string"==typeof r.toPage?r.toPage:r.toPage.jqmData("url"),i=e.mobile.path.parseUrl(i),s=i.pathname+i.search+i.hash,this._myUrl!==e.mobile.path.makeUrlAbsolute(s)?u=!0:n.preventDefault()),o.container.unbind(o.closeEvents),this.element.undelegate(o.closeLinkSelector,o.closeLinkEvents),this._close(u)},_bindContainerClose:function(){this.options.container.one(this.options.closeEvents,e.proxy(this,"_closePopup"))},open:function(n){var r,i,s,o,u,f,l=this,c=this.options;if(!e.mobile.popup.active){if(e.mobile.popup.active=this,this._scrollTop=e.mobile.window.scrollTop(),!c.history)return l._open(n),l._bindContainerClose(),l.element.delegate(c.closeLinkSelector,c.closeLinkEvents,function(e){l.close(),e.preventDefault()}),void 0;if(f=e.mobile.urlHistory,i=e.mobile.dialogHashKey,s=e.mobile.activePage,o=s.is(".ui-dialog"),this._myUrl=r=f.getActive().url,u=r.indexOf(i)>-1&&!o&&f.activeIndex>0)return l._open(n),l._bindContainerClose(),void 0;-1!==r.indexOf(i)||o?r=e.mobile.path.parseLocation().hash+i:r+=r.indexOf("#")>-1?i:"#"+i,0===f.activeIndex&&r===f.initialDst&&(r+=i),e(t).one("beforenavigate",function(e){e.preventDefault(),l._open(n),l._bindContainerClose()}),this.urlAltered=!0,e.mobile.navigate(r,{role:"dialog"})}},close:function(){e.mobile.popup.active===this&&(this._scrollTop=e.mobile.window.scrollTop(),this.options.history&&this.urlAltered?(e.mobile.back(),this.urlAltered=!1):this._closePopup())}}),e.mobile.popup.handleLink=function(t){var n,r=t.closest(":jqmData(role='page')"),i=0===r.length?e("body"):r,s=e(e.mobile.path.parseUrl(t.attr("href")).hash,i[0]);s.data("mobile-popup")&&(n=t.offset(),s.popup("open",{x:n.left+t.outerWidth()/2,y:n.top+t.outerHeight()/2,transition:t.jqmData("transition"),positionTo:t.jqmData("position-to")})),setTimeout(function(){var n=t.parent().parent();n.hasClass("ui-li")&&(t=n.parent()),t.removeClass(e.mobile.activeBtnClass)},300)},e.mobile.document.bind("pagebeforechange",function(t,n){"popup"===n.options.role&&(e.mobile.popup.handleLink(n.options.link),t.preventDefault())}),e.mobile.document.bind("pagecreate create",function(t){e.mobile.popup.prototype.enhanceWithin(t.target,!0)})}(e),function(e,t){var r=function(r){var i,s,o,u=(r.select,r._destroy),f=r.selectID,l=f?f:(e.mobile.ns||"")+"uuid-"+r.uuid,h=l+"-listbox",p=l+"-dialog",d=r.label,v=r.select.closest(".ui-page"),m=r._selectOptions(),g=r.isMultiple=r.select[0].multiple,y=f+"-button",w=f+"-menu",E=e("<div data-"+e.mobile.ns+"role='dialog' id='"+p+"' data-"+e.mobile.ns+"theme='"+r.options.theme+"' data-"+e.mobile.ns+"overlay-theme='"+r.options.overlayTheme+"'>"+"<div data-"+e.mobile.ns+"role='header'>"+"<div class='ui-title'>"+d.getEncodedText()+"</div>"+"</div>"+"<div data-"+e.mobile.ns+"role='content'></div>"+"</div>"),S=e("<div id='"+h+"' class='ui-selectmenu'>").insertAfter(r.select).popup({theme:r.options.overlayTheme}),x=e("<ul>",{"class":"ui-selectmenu-list",id:w,role:"listbox","aria-labelledby":y}).attr("data-"+e.mobile.ns+"theme",r.options.theme).attr("data-"+e.mobile.ns+"divider-theme",r.options.dividerTheme).appendTo(S),T=e("<div>",{"class":"ui-header ui-bar-"+r.options.theme}).prependTo(S),N=e("<h1>",{"class":"ui-title"}).appendTo(T);r.isMultiple&&(o=e("<a>",{text:r.options.closeText,href:"#","class":"ui-btn-left"}).attr("data-"+e.mobile.ns+"iconpos","notext").attr("data-"+e.mobile.ns+"icon","delete").appendTo(T).buttonMarkup()),e.extend(r,{select:r.select,selectID:f,buttonId:y,menuId:w,popupID:h,dialogID:p,thisPage:v,menuPage:E,label:d,selectOptions:m,isMultiple:g,theme:r.options.theme,listbox:S,list:x,header:T,headerTitle:N,headerClose:o,menuPageContent:i,menuPageClose:s,placeholder:"",build:function(){var n=this,i=function(e){return e.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")};n.refresh(),n._origTabIndex===t&&(n._origTabIndex=null===n.select[0].getAttribute("tabindex")?!1:n.select.attr("tabindex")),n.select.attr("tabindex","-1").focus(function(){e(this).blur(),n.button.focus()}),n.button.bind("vclick keydown",function(t){n.options.disabled||n.isOpen||("vclick"===t.type||t.keyCode&&(t.keyCode===e.mobile.keyCode.ENTER||t.keyCode===e.mobile.keyCode.SPACE))&&(n._decideFormat(),"overlay"===n.menuType?n.button.attr("href","#"+i(n.popupID)).attr("data-"+(e.mobile.ns||"")+"rel","popup"):n.button.attr("href","#"+i(n.dialogID)).attr("data-"+(e.mobile.ns||"")+"rel","dialog"),n.isOpen=!0)}),n.list.attr("role","listbox").bind("focusin",function(t){e(t.target).attr("tabindex","0").trigger("vmouseover")}).bind("focusout",function(t){e(t.target).attr("tabindex","-1").trigger("vmouseout")}).delegate("li:not(.ui-disabled, .ui-li-divider)","click",function(t){var i=n.select[0].selectedIndex,s=n.list.find("li:not(.ui-li-divider)").index(this),o=n._selectOptions().eq(s)[0];o.selected=n.isMultiple?!o.selected:!0,n.isMultiple&&e(this).find(".ui-icon").toggleClass("ui-icon-checkbox-on",o.selected).toggleClass("ui-icon-checkbox-off",!o.selected),(n.isMultiple||i!==s)&&n.select.trigger("change"),n.isMultiple?n.list.find("li:not(.ui-li-divider)").eq(s).addClass("ui-btn-down-"+r.options.theme).find("a").first().focus():n.close(),t.preventDefault()}).keydown(function(t){var n,i,s=e(t.target),o=s.closest("li");switch(t.keyCode){case 38:return n=o.prev().not(".ui-selectmenu-placeholder"),n.is(".ui-li-divider")&&(n=n.prev()),n.length&&(s.blur().attr("tabindex","-1"),n.addClass("ui-btn-down-"+r.options.theme).find("a").first().focus()),!1;case 40:return i=o.next(),i.is(".ui-li-divider")&&(i=i.next()),i.length&&(s.blur().attr("tabindex","-1"),i.addClass("ui-btn-down-"+r.options.theme).find("a").first().focus()),!1;case 13:case 32:return s.trigger("click"),!1}}),n.menuPage.bind("pagehide",function(){e.mobile._bindPageRemove.call(n.thisPage)}),n.listbox.bind("popupafterclose",function(){n.close()}),n.isMultiple&&n.headerClose.click(function(){return"overlay"===n.menuType?(n.close(),!1):void 0}),n.thisPage.addDependents(this.menuPage)},_isRebuildRequired:function(){var e=this.list.find("li"),t=this._selectOptions();return t.text()!==e.text()},selected:function(){return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )")},refresh:function(t){var n,r=this;this.element,this.isMultiple,(t||this._isRebuildRequired())&&r._buildList(),n=this.selectedIndices(),r.setButtonText(),r.setButtonCount(),r.list.find("li:not(.ui-li-divider)").removeClass(e.mobile.activeBtnClass).attr("aria-selected",!1).each(function(t){if(e.inArray(t,n)>-1){var i=e(this);i.attr("aria-selected",!0),r.isMultiple?i.find(".ui-icon").removeClass("ui-icon-checkbox-off").addClass("ui-icon-checkbox-on"):i.is(".ui-selectmenu-placeholder")?i.next().addClass(e.mobile.activeBtnClass):i.addClass(e.mobile.activeBtnClass)}})},close:function(){if(!this.options.disabled&&this.isOpen){var e=this;"page"===e.menuType?(e.menuPage.dialog("close"),e.list.appendTo(e.listbox)):e.listbox.popup("close"),e._focusButton(),e.isOpen=!1}},open:function(){this.button.click()},_decideFormat:function(){function t(){var t=n.list.find("."+e.mobile.activeBtnClass+" a");0===t.length&&(t=n.list.find("li.ui-btn:not( :jqmData(placeholder='true') ) a")),t.first().focus().closest("li").addClass("ui-btn-down-"+r.options.theme)}var n=this,i=e.mobile.window,s=n.list.parent(),o=s.outerHeight(),u=(s.outerWidth(),e("."+e.mobile.activePageClass),i.scrollTop()),f=n.button.offset().top,l=i.height();i.width(),o>l-80||!e.support.scrollTop?(n.menuPage.appendTo(e.mobile.pageContainer).page(),n.menuPageContent=E.find(".ui-content"),n.menuPageClose=E.find(".ui-header a"),n.thisPage.unbind("pagehide.remove"),0===u&&f>l&&n.thisPage.one("pagehide",function(){e(this).jqmData("lastScroll",f)}),n.menuPage.one("pageshow",function(){t()}).one("pagehide",function(){n.close()}),n.menuType="page",n.menuPageContent.append(n.list),n.menuPage.find("div .ui-title").text(n.label.text())):(n.menuType="overlay",n.listbox.one("popupafteropen",t))},_buildList:function(){var t=this,r=this.options,i=this.placeholder,s=!0,o=t.isMultiple?"checkbox-off":"false";t.list.empty().filter(".ui-listview").listview("destroy");for(var u,f=t.select.find("option"),l=f.length,h=this.select[0],p="data-"+e.mobile.ns,d=p+"option-index",v=p+"icon",m=p+"role",g=p+"placeholder",y=n.createDocumentFragment(),b=!1,w=0;l>w;w++,b=!1){var E=f[w],S=e(E),x=E.parentNode,T=S.text(),N=n.createElement("a"),C=[];if(N.setAttribute("href","#"),N.appendChild(n.createTextNode(T)),x!==h&&"optgroup"===x.nodeName.toLowerCase()){var k=x.getAttribute("label");if(k!==u){var L=n.createElement("li");L.setAttribute(m,"list-divider"),L.setAttribute("role","option"),L.setAttribute("tabindex","-1"),L.appendChild(n.createTextNode(k)),y.appendChild(L),u=k}}!s||E.getAttribute("value")&&0!==T.length&&!S.jqmData("placeholder")||(s=!1,b=!0,null===E.getAttribute(g)&&(this._removePlaceholderAttr=!0),E.setAttribute(g,!0),r.hidePlaceholderMenuItems&&C.push("ui-selectmenu-placeholder"),i!==T&&(i=t.placeholder=T));var A=n.createElement("li");E.disabled&&(C.push("ui-disabled"),A.setAttribute("aria-disabled",!0)),A.setAttribute(d,w),A.setAttribute(v,o),b&&A.setAttribute(g,!0),A.className=C.join(" "),A.setAttribute("role","option"),N.setAttribute("tabindex","-1"),A.appendChild(N),y.appendChild(A)}t.list[0].appendChild(y),this.isMultiple||i.length?this.headerTitle.text(this.placeholder):this.header.hide(),t.list.listview()},_button:function(){return e("<a>",{href:"#",role:"button",id:this.buttonId,"aria-haspopup":"true","aria-owns":this.menuId})},_destroy:function(){this.close(),this._origTabIndex!==t&&(this._origTabIndex!==!1?this.select.attr("tabindex",this._origTabIndex):this.select.removeAttr("tabindex")),this._removePlaceholderAttr&&this._selectOptions().removeAttr("data-"+e.mobile.ns+"placeholder"),this.listbox.remove(),this.menuPage.remove(),u.apply(this,arguments)}})};e.mobile.document.bind("selectmenubeforecreate",function(t){var n=e(t.target).data("mobile-selectmenu");n.options.nativeMenu||0!==n.element.parents(":jqmData(role='popup')").length||r(n)})}(e),function(e,t){e.widget("mobile.controlgroup",e.mobile.widget,e.extend({options:{shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1,initSelector:":jqmData(role='controlgroup')"},_create:function(){var n=this.element,r={inner:e("<div class='ui-controlgroup-controls'></div>"),legend:e("<div role='heading' class='ui-controlgroup-label'></div>")},i=n.children("legend"),s=this;n.wrapInner(r.inner),i.length&&r.legend.append(i).insertBefore(n.children(0)),n.addClass("ui-corner-all ui-controlgroup"),e.extend(this,{_initialRefresh:!0}),e.each(this.options,function(e,n){s.options[e]=t,s._setOption(e,n,!0)})},_init:function(){this.refresh()},_setOption:function(n,r){var i="_set"+n.charAt(0).toUpperCase()+n.slice(1);this[i]!==t&&this[i](r),this._super(n,r),this.element.attr("data-"+(e.mobile.ns||"")+n.replace(/([A-Z])/,"-$1").toLowerCase(),r)},_setType:function(e){this.element.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+e),this.refresh()},_setCorners:function(e){this.element.toggleClass("ui-corner-all",e)},_setShadow:function(e){this.element.toggleClass("ui-shadow",e)},_setMini:function(e){this.element.toggleClass("ui-mini",e)},container:function(){return this.element.children(".ui-controlgroup-controls")},refresh:function(){var t=this.element.find(".ui-btn").not(".ui-slider-handle"),n=this._initialRefresh;e.mobile.checkboxradio&&this.element.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(t,this.options.excludeInvisible?this._getVisibles(t,n):t,n),this._initialRefresh=!1}},e.mobile.behaviors.addFirstLastClasses)),e(function(){e.mobile.document.bind("pagecreate create",function(t){e.mobile.controlgroup.prototype.enhanceWithin(t.target,!0)})})}(e),function(e){e(n).bind("pagecreate create",function(t){e(t.target).find("a").jqmEnhanceable().filter(":jqmData(rel='popup')[href][href!='']").each(function(){var t=this,r=e(this).attr("href"),i=r.substring(1);t.setAttribute("aria-haspopup",!0),t.setAttribute("aria-owns",i),t.setAttribute("aria-expanded",!1),e(n).on("popupafteropen",r,function(){t.setAttribute("aria-expanded",!0)}).on("popupafterclose",r,function(){t.setAttribute("aria-expanded",!1)})}).end().not(".ui-btn, .ui-link-inherit, :jqmData(role='none'), :jqmData(role='nojs')").addClass("ui-link")})}(e),function(e,t){e.widget("mobile.fixedtoolbar",e.mobile.widget,{options:{visibleOnPageShow:!0,disablePageZoom:!0,transition:"slide",fullscreen:!1,tapToggle:!0,tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-popup, .ui-panel, .ui-panel-dismiss-open",hideDuringFocus:"input, textarea, select",updatePagePadding:!0,trackPersistentToolbars:!0,supportBlacklist:function(){return!e.support.fixedPosition},initSelector:":jqmData(position='fixed')"},_create:function(){var t=this,n=t.options,r=t.element,i=r.is(":jqmData(role='header')")?"header":"footer",s=r.closest(".ui-page");return n.supportBlacklist()?(t.destroy(),void 0):(r.addClass("ui-"+i+"-fixed"),n.fullscreen?(r.addClass("ui-"+i+"-fullscreen"),s.addClass("ui-page-"+i+"-fullscreen")):s.addClass("ui-page-"+i+"-fixed"),e.extend(this,{_thisPage:null}),t._addTransitionClass(),t._bindPageEvents(),t._bindToggleHandlers(),void 0)},_addTransitionClass:function(){var e=this.options.transition;e&&"none"!==e&&("slide"===e&&(e=this.element.is(".ui-header")?"slidedown":"slideup"),this.element.addClass(e))},_bindPageEvents:function(){this._thisPage=this.element.closest(".ui-page"),this._on(this._thisPage,{pagebeforeshow:"_handlePageBeforeShow",webkitAnimationStart:"_handleAnimationStart",animationstart:"_handleAnimationStart",updatelayout:"_handleAnimationStart",pageshow:"_handlePageShow",pagebeforehide:"_handlePageBeforeHide"})},_handlePageBeforeShow:function(){var t=this.options;t.disablePageZoom&&e.mobile.zoom.disable(!0),t.visibleOnPageShow||this.hide(!0)},_handleAnimationStart:function(){this.options.updatePagePadding&&this.updatePagePadding(this._thisPage)},_handlePageShow:function(){this.updatePagePadding(this._thisPage),this.options.updatePagePadding&&this._on(e.mobile.window,{throttledresize:"updatePagePadding"})},_handlePageBeforeHide:function(t,n){var r=this.options;if(r.disablePageZoom&&e.mobile.zoom.enable(!0),r.updatePagePadding&&this._off(e.mobile.window,"throttledresize"),r.trackPersistentToolbars){var i=e(".ui-footer-fixed:jqmData(id)",this._thisPage),s=e(".ui-header-fixed:jqmData(id)",this._thisPage),o=i.length&&n.nextPage&&e(".ui-footer-fixed:jqmData(id='"+i.jqmData("id")+"')",n.nextPage)||e(),u=s.length&&n.nextPage&&e(".ui-header-fixed:jqmData(id='"+s.jqmData("id")+"')",n.nextPage)||e();(o.length||u.length)&&(o.add(u).appendTo(e.mobile.pageContainer),n.nextPage.one("pageshow",function(){u.prependTo(this),o.appendTo(this)}))}},_visible:!0,updatePagePadding:function(n){var r=this.element,i=r.is(".ui-header"),s=parseFloat(r.css(i?"top":"bottom"));this.options.fullscreen||(n=n&&n.type===t&&n||this._thisPage||r.closest(".ui-page"),e(n).css("padding-"+(i?"top":"bottom"),r.outerHeight()+s))},_useTransition:function(t){var n=e.mobile.window,r=this.element,i=n.scrollTop(),s=r.height(),o=r.closest(".ui-page").height(),u=e.mobile.getScreenHeight(),f=r.is(":jqmData(role='header')")?"header":"footer";return!t&&(this.options.transition&&"none"!==this.options.transition&&("header"===f&&!this.options.fullscreen&&i>s||"footer"===f&&!this.options.fullscreen&&o-s>i+u)||this.options.fullscreen)},show:function(e){var t="ui-fixed-hidden",n=this.element;this._useTransition(e)?n.removeClass("out "+t).addClass("in").animationComplete(function(){n.removeClass("in")}):n.removeClass(t),this._visible=!0},hide:function(e){var t="ui-fixed-hidden",n=this.element,r="out"+("slide"===this.options.transition?" reverse":"");this._useTransition(e)?n.addClass(r).removeClass("in").animationComplete(function(){n.addClass(t).removeClass(r)}):n.addClass(t).removeClass(r),this._visible=!1},toggle:function(){this[this._visible?"hide":"show"]()},_bindToggleHandlers:function(){var t,n,r=this,i=r.options,s=r.element,o=!0;s.closest(".ui-page").bind("vclick",function(t){i.tapToggle&&!e(t.target).closest(i.tapToggleBlacklist).length&&r.toggle()}).bind("focusin focusout",function(s){screen.width<1025&&e(s.target).is(i.hideDuringFocus)&&!e(s.target).closest(".ui-header-fixed, .ui-footer-fixed").length&&("focusout"!==s.type||o?"focusin"===s.type&&o&&(clearTimeout(t),o=!1,n=setTimeout(function(){r.hide()},0)):(o=!0,clearTimeout(n),t=setTimeout(function(){r.show()},0)))})},_destroy:function(){var e=this.element,t=e.is(".ui-header");e.closest(".ui-page").css("padding-"+(t?"top":"bottom"),""),e.removeClass("ui-header-fixed ui-footer-fixed ui-header-fullscreen ui-footer-fullscreen in out fade slidedown slideup ui-fixed-hidden"),e.closest(".ui-page").removeClass("ui-page-header-fixed ui-page-footer-fixed ui-page-header-fullscreen ui-page-footer-fullscreen")}}),e.mobile.document.bind("pagecreate create",function(t){e(t.target).jqmData("fullscreen")&&e(e.mobile.fixedtoolbar.prototype.options.initSelector,t.target).not(":jqmData(fullscreen)").jqmData("fullscreen",!0),e.mobile.fixedtoolbar.prototype.enhanceWithin(t.target)})}(e),function(e){e.widget("mobile.fixedtoolbar",e.mobile.fixedtoolbar,{_create:function(){this._super(),this._workarounds()},_workarounds:function(){var e=navigator.userAgent,t=navigator.platform,n=e.match(/AppleWebKit\/([0-9]+)/),r=!!n&&n[1],i=null,s=this;if(t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1||t.indexOf("iPod")>-1)i="ios";else{if(!(e.indexOf("Android")>-1))return;i="android"}if("ios"===i)s._bindScrollWorkaround();else{if(!("android"===i&&r&&534>r))return;s._bindScrollWorkaround(),s._bindListThumbWorkaround()}},_viewportOffset:function(){var t=this.element,n=t.is(".ui-header"),r=Math.abs(t.offset().top-e.mobile.window.scrollTop());return n||(r=Math.round(r-e.mobile.window.height()+t.outerHeight())-60),r},_bindScrollWorkaround:function(){var t=this;this._on(e.mobile.window,{scrollstop:function(){var e=t._viewportOffset();e>2&&t._visible&&t._triggerRedraw()}})},_bindListThumbWorkaround:function(){this.element.closest(".ui-page").addClass("ui-android-2x-fixed")},_triggerRedraw:function(){var t=parseFloat(e(".ui-page-active").css("padding-bottom"));e(".ui-page-active").css("padding-bottom",t+1+"px"),setTimeout(function(){e(".ui-page-active").css("padding-bottom",t+"px")},0)},destroy:function(){this._super(),this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix")}})}(e),function(e,r){e.widget("mobile.panel",e.mobile.widget,{options:{classes:{panel:"ui-panel",panelOpen:"ui-panel-open",panelClosed:"ui-panel-closed",panelFixed:"ui-panel-fixed",panelInner:"ui-panel-inner",modal:"ui-panel-dismiss",modalOpen:"ui-panel-dismiss-open",pagePanel:"ui-page-panel",pagePanelOpen:"ui-page-panel-open",contentWrap:"ui-panel-content-wrap",contentWrapOpen:"ui-panel-content-wrap-open",contentWrapClosed:"ui-panel-content-wrap-closed",contentFixedToolbar:"ui-panel-content-fixed-toolbar",contentFixedToolbarOpen:"ui-panel-content-fixed-toolbar-open",contentFixedToolbarClosed:"ui-panel-content-fixed-toolbar-closed",animate:"ui-panel-animate"},animate:!0,theme:"c",position:"left",dismissible:!0,display:"reveal",initSelector:":jqmData(role='panel')",swipeClose:!0,positionFixed:!1},_panelID:null,_closeLink:null,_page:null,_modal:null,_panelInner:null,_wrapper:null,_fixedToolbar:null,_create:function(){var t=this,n=t.element,r=n.closest(":jqmData(role='page')"),i=function(){var t=e.data(r[0],"mobilePage").options.theme,n="ui-body-"+t;return n},s=function(){var e=n.find("."+t.options.classes.panelInner);return 0===e.length&&(e=n.children().wrapAll('<div class="'+t.options.classes.panelInner+'" />').parent()),e},o=function(){var n=r.find("."+t.options.classes.contentWrap);return 0===n.length&&(n=r.children(".ui-header:not(:jqmData(position='fixed')), .ui-content:not(:jqmData(role='popup')), .ui-footer:not(:jqmData(position='fixed'))").wrapAll('<div class="'+t.options.classes.contentWrap+" "+i()+'" />').parent(),e.support.cssTransform3d&&t.options.animate&&n.addClass(t.options.classes.animate)),n},u=function(){var n=r.find("."+t.options.classes.contentFixedToolbar);return 0===n.length&&(n=r.find(".ui-header:jqmData(position='fixed'), .ui-footer:jqmData(position='fixed')").addClass(t.options.classes.contentFixedToolbar),e.support.cssTransform3d&&t.options.animate&&n.addClass(t.options.classes.animate)),n};e.extend(this,{_panelID:n.attr("id"),_closeLink:n.find(":jqmData(rel='close')"),_page:n.closest(":jqmData(role='page')"),_pageTheme:i(),_panelInner:s(),_wrapper:o(),_fixedToolbar:u()}),t._addPanelClasses(),t._wrapper.addClass(this.options.classes.contentWrapClosed),t._fixedToolbar.addClass(this.options.classes.contentFixedToolbarClosed),t._page.addClass(t.options.classes.pagePanel),e.support.cssTransform3d&&t.options.animate&&this.element.addClass(t.options.classes.animate),t._bindUpdateLayout(),t._bindCloseEvents(),t._bindLinkListeners(),t._bindPageEvents(),t.options.dismissible&&t._createModal(),t._bindSwipeEvents()},_createModal:function(){var t=this;t._modal=e("<div class='"+t.options.classes.modal+"' data-panelid='"+t._panelID+"'></div>").on("mousedown",function(){t.close()}).appendTo(this._page)},_getPosDisplayClasses:function(e){return e+"-position-"+this.options.position+" "+e+"-display-"+this.options.display},_getPanelClasses:function(){var e=this.options.classes.panel+" "+this._getPosDisplayClasses(this.options.classes.panel)+" "+this.options.classes.panelClosed;return this.options.theme&&(e+=" ui-body-"+this.options.theme),this.options.positionFixed&&(e+=" "+this.options.classes.panelFixed),e},_addPanelClasses:function(){this.element.addClass(this._getPanelClasses())},_bindCloseEvents:function(){var e=this;e._closeLink.on("click.panel",function(t){return t.preventDefault(),e.close(),!1}),e.element.on("click.panel","a:jqmData(ajax='false')",function(){e.close()})},_positionPanel:function(){var t=this,n=t._panelInner.outerHeight(),r=n>e.mobile.getScreenHeight();r||!t.options.positionFixed?(r&&(t._unfixPanel(),e.mobile.resetActivePageHeight(n)),t._scrollIntoView(n)):t._fixPanel()},_scrollIntoView:function(n){n<e(t).scrollTop()&&t.scrollTo(0,0)},_bindFixListener:function(){this._on(e(t),{throttledresize:"_positionPanel"})},_unbindFixListener:function(){this._off(e(t),"throttledresize")},_unfixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.removeClass(this.options.classes.panelFixed)},_fixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.addClass(this.options.classes.panelFixed)},_bindUpdateLayout:function(){var e=this;e.element.on("updatelayout",function(){e._open&&e._positionPanel()})},_bindLinkListeners:function(){var t=this;t._page.on("click.panel","a",function(n){if(this.href.split("#")[1]===t._panelID&&t._panelID!==r){n.preventDefault();var i,s=e(this);return s.hasClass("ui-link")||(i=s.parent().parent(),i.hasClass("ui-li")&&(s=i.parent()),s.addClass(e.mobile.activeBtnClass),t.element.one("panelopen panelclose",function(){s.removeClass(e.mobile.activeBtnClass)})),t.toggle(),!1}})},_bindSwipeEvents:function(){var e=this,t=e._modal?e.element.add(e._modal):e.element;e.options.swipeClose&&("left"===e.options.position?t.on("swipeleft.panel",function(){e.close()}):t.on("swiperight.panel",function(){e.close()}))},_bindPageEvents:function(){var e=this;e._page.on("panelbeforeopen",function(t){e._open&&t.target!==e.element[0]&&e.close()}).on("pagehide",function(){e._open&&e.close(!0)}).on("keyup.panel",function(t){27===t.keyCode&&e._open&&e.close()})},_open:!1,_contentWrapOpenClasses:null,_fixedToolbarOpenClasses:null,_modalOpenClasses:null,open:function(t){if(!this._open){var n=this,r=n.options,i=function(){n._page.off("panelclose"),n._page.jqmData("panel","open"),!t&&e.support.cssTransform3d&&r.animate?n.element.add(n._wrapper).on(n._transitionEndEvents,s):setTimeout(s,0),n.options.theme&&"overlay"!==n.options.display&&n._page.removeClass(n._pageTheme).addClass("ui-body-"+n.options.theme),n.element.removeClass(r.classes.panelClosed).addClass(r.classes.panelOpen),n._positionPanel(),n.options.theme&&"overlay"!==n.options.display&&n._wrapper.css("min-height",n._page.css("min-height")),n._contentWrapOpenClasses=n._getPosDisplayClasses(r.classes.contentWrap),n._wrapper.removeClass(r.classes.contentWrapClosed).addClass(n._contentWrapOpenClasses+" "+r.classes.contentWrapOpen),n._fixedToolbarOpenClasses=n._getPosDisplayClasses(r.classes.contentFixedToolbar),n._fixedToolbar.removeClass(r.classes.contentFixedToolbarClosed).addClass(n._fixedToolbarOpenClasses+" "+r.classes.contentFixedToolbarOpen),n._modalOpenClasses=n._getPosDisplayClasses(r.classes.modal)+" "+r.classes.modalOpen,n._modal&&n._modal.addClass(n._modalOpenClasses)},s=function(){n.element.add(n._wrapper).off(n._transitionEndEvents,s),n._page.addClass(r.classes.pagePanelOpen),n._bindFixListener(),n._trigger("open")};this.element.closest(".ui-page-active").length<0&&(t=!0),n._trigger("beforeopen"),"open"===n._page.jqmData("panel")?n._page.on("panelclose",function(){i()}):i(),n._open=!0}},close:function(t){if(this._open){var n=this.options,r=this,i=function(){!t&&e.support.cssTransform3d&&n.animate?r.element.add(r._wrapper).on(r._transitionEndEvents,s):setTimeout(s,0),r._page.removeClass(n.classes.pagePanelOpen),r.element.removeClass(n.classes.panelOpen),r._wrapper.removeClass(n.classes.contentWrapOpen),r._fixedToolbar.removeClass(n.classes.contentFixedToolbarOpen),r._modal&&r._modal.removeClass(r._modalOpenClasses)},s=function(){r.options.theme&&"overlay"!==r.options.display&&(r._page.removeClass("ui-body-"+r.options.theme).addClass(r._pageTheme),r._wrapper.css("min-height","")),r.element.add(r._wrapper).off(r._transitionEndEvents,s),r.element.addClass(n.classes.panelClosed),r._wrapper.removeClass(r._contentWrapOpenClasses).addClass(n.classes.contentWrapClosed),r._fixedToolbar.removeClass(r._fixedToolbarOpenClasses).addClass(n.classes.contentFixedToolbarClosed),r._fixPanel(),r._unbindFixListener(),e.mobile.resetActivePageHeight(),r._page.jqmRemoveData("panel"),r._trigger("close")};this.element.closest(".ui-page-active").length<0&&(t=!0),r._trigger("beforeclose"),i(),r._open=!1}},toggle:function(){this[this._open?"close":"open"]()},_transitionEndEvents:"webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",_destroy:function(){var t=this.options.classes,n=this.options.theme,r=this.element.siblings("."+t.panel).length;r?this._open&&(this._wrapper.removeClass(t.contentWrapOpen),this._fixedToolbar.removeClass(t.contentFixedToolbarOpen),this._page.jqmRemoveData("panel"),this._page.removeClass(t.pagePanelOpen),n&&this._page.removeClass("ui-body-"+n).addClass(this._pageTheme)):(this._wrapper.children().unwrap(),this._page.find("a").unbind("panelopen panelclose"),this._page.removeClass(t.pagePanel),this._open&&(this._page.jqmRemoveData("panel"),this._page.removeClass(t.pagePanelOpen),n&&this._page.removeClass("ui-body-"+n).addClass(this._pageTheme),e.mobile.resetActivePageHeight())),this._panelInner.children().unwrap(),this.element.removeClass([this._getPanelClasses(),t.panelAnimate].join(" ")).off("swipeleft.panel swiperight.panel").off("panelbeforeopen").off("panelhide").off("keyup.panel").off("updatelayout"),this._closeLink.off("click.panel"),this._modal&&this._modal.remove(),this.element.off(this._transitionEndEvents).removeClass([t.panelUnfixed,t.panelClosed,t.panelOpen].join(" "))}}),e(n).bind("pagecreate create",function(t){e.mobile.panel.prototype.enhanceWithin(t.target)})}(e),function(e,t){e.widget("mobile.table",e.mobile.widget,{options:{classes:{table:"ui-table"},initSelector:":jqmData(role='table')"},_create:function(){var e=this;e.refresh(!0)},refresh:function(n){var r=this,i=this.element.find("thead tr");n&&this.element.addClass(this.options.classes.table),r.headers=this.element.find("tr:eq(0)").children(),r.allHeaders=r.headers.add(i.children()),i.each(function(){var s=0;e(this).children().each(function(){var o=parseInt(e(this).attr("colspan"),10),u=":nth-child("+(s+1)+")";if(e(this).jqmData("colstart",s+1),o)for(var l=0;o-1>l;l++)s++,u+=", :nth-child("+(s+1)+")";n===t&&e(this).jqmData("cells",""),e(this).jqmData("cells",r.element.find("tr").not(i.eq(0)).not(this).children(u)),s++})}),n===t&&this.element.trigger("refresh")}}),e.mobile.document.bind("pagecreate create",function(t){e.mobile.table.prototype.enhanceWithin(t.target)})}(e),function(e,t){e.mobile.table.prototype.options.mode="columntoggle",e.mobile.table.prototype.options.columnBtnTheme=null,e.mobile.table.prototype.options.columnPopupTheme=null,e.mobile.table.prototype.options.columnBtnText="Columns...",e.mobile.table.prototype.options.classes=e.extend(e.mobile.table.prototype.options.classes,{popup:"ui-table-columntoggle-popup",columnBtn:"ui-table-columntoggle-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle"}),e.mobile.document.delegate(":jqmData(role='table')","tablecreate refresh",function(n){var r,i,s,o,u=e(this),f=u.data("mobile-table"),l=n.type,c=f.options,h=e.mobile.ns,p=(u.attr("id")||c.classes.popup)+"-popup";"columntoggle"===c.mode&&("refresh"!==l&&(f.element.addClass(c.classes.columnToggleTable),r=e("<a href='#"+p+"' class='"+c.classes.columnBtn+"' data-"+h+"rel='popup' data-"+h+"mini='true'>"+c.columnBtnText+"</a>"),i=e("<div data-"+h+"role='popup' data-"+h+"role='fieldcontain' class='"+c.classes.popup+"' id='"+p+"'></div>"),s=e("<fieldset data-"+h+"role='controlgroup'></fieldset>")),f.headers.not("td").each(function(t){var n=e(this).jqmData("priority"),r=e(this).add(e(this).jqmData("cells"));n&&(r.addClass(c.classes.priorityPrefix+n),"refresh"!==l?e("<label><input type='checkbox' checked />"+e(this).text()+"</label>").appendTo(s).children(0).jqmData("cells",r).checkboxradio({theme:c.columnPopupTheme}):e("#"+p+" fieldset div:eq("+t+")").find("input").jqmData("cells",r))}),"refresh"!==l&&s.appendTo(i),o=s===t?e("#"+p+" fieldset"):s,"refresh"!==l&&(o.on("change","input",function(){this.checked?e(this).jqmData("cells").removeClass("ui-table-cell-hidden").addClass("ui-table-cell-visible"):e(this).jqmData("cells").removeClass("ui-table-cell-visible").addClass("ui-table-cell-hidden")}),r.insertBefore(u).buttonMarkup({theme:c.columnBtnTheme}),i.insertBefore(u).popup()),f.update=function(){o.find("input").each(function(){this.checked?(this.checked="table-cell"===e(this).jqmData("cells").eq(0).css("display"),"refresh"===l&&e(this).jqmData("cells").addClass("ui-table-cell-visible")):e(this).jqmData("cells").addClass("ui-table-cell-hidden"),e(this).checkboxradio("refresh")})},e.mobile.window.on("throttledresize",f.update),f.update())})}(e),function(e){e.mobile.table.prototype.options.mode="reflow",e.mobile.table.prototype.options.classes=e.extend(e.mobile.table.prototype.options.classes,{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label"}),e.mobile.document.delegate(":jqmData(role='table')","tablecreate refresh",function(t){var n=e(this),r=t.type,i=n.data("mobile-table"),s=i.options;if("reflow"===s.mode){"refresh"!==r&&i.element.addClass(s.classes.reflowTable);var o=e(i.allHeaders.get().reverse());o.each(function(){var t=e(this).jqmData("cells"),n=e(this).jqmData("colstart"),r=t.not(this).filter("thead th").length&&" ui-table-cell-label-top",i=e(this).text();if(""!==i)if(r){var o=parseInt(e(this).attr("colspan"),10),u="";o&&(u="td:nth-child("+o+"n + "+n+")"),t.filter(u).prepend("<b class='"+s.classes.cellLabels+r+"'>"+i+"</b>")}else t.prepend("<b class='"+s.classes.cellLabels+"'>"+i+"</b>")})}})}(e),function(e,t){function n(e){i=e.originalEvent,a=i.accelerationIncludingGravity,s=Math.abs(a.x),o=Math.abs(a.y),u=Math.abs(a.z),!t.orientation&&(s>7||(u>6&&8>o||8>u&&o>6)&&s>5)?f.enabled&&f.disable():f.enabled||f.enable()}e.mobile.iosorientationfixEnabled=!0;var r=navigator.userAgent;if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(r)&&r.indexOf("AppleWebKit")>-1))return e.mobile.iosorientationfixEnabled=!1,void 0;var i,s,o,u,a,f=e.mobile.zoom;e.mobile.document.on("mobileinit",function(){e.mobile.iosorientationfixEnabled&&e.mobile.window.bind("orientationchange.iosorientationfix",f.enable).bind("devicemotion.iosorientationfix",n)})}(e,this),function(e,t){function r(){i.removeClass("ui-mobile-rendering")}var i=e("html"),s=(e("head"),e.mobile.window);e(t.document).trigger("mobileinit"),e.mobile.gradeA()&&(e.mobile.ajaxBlacklist&&(e.mobile.ajaxEnabled=!1),i.addClass("ui-mobile ui-mobile-rendering"),setTimeout(r,5e3),e.extend(e.mobile,{initializePage:function(){var t=e.mobile.path,i=e(":jqmData(role='page'), :jqmData(role='dialog')"),o=t.stripHash(t.stripQueryParams(t.parseLocation().hash)),u=n.getElementById(o);i.length||(i=e("body").wrapInner("<div data-"+e.mobile.ns+"role='page'></div>").children(0)),i.each(function(){var t=e(this);t.jqmData("url")||t.attr("data-"+e.mobile.ns+"url",t.attr("id")||location.pathname+location.search)}),e.mobile.firstPage=i.first(),e.mobile.pageContainer=e.mobile.firstPage.parent().addClass("ui-mobile-viewport"),e.mobile.navreadyDeferred.resolve(),s.trigger("pagecontainercreate"),e.mobile.showPageLoadingMsg(),r(),e.mobile.hashListeningEnabled&&e.mobile.path.isHashValid(location.hash)&&(e(u).is(':jqmData(role="page")')||e.mobile.path.isPath(o)||o===e.mobile.dialogHashKey)?e.event.special.navigate.isPushStateEnabled()?(e.mobile.navigate.history.stack=[],e.mobile.navigate(e.mobile.path.isPath(location.hash)?location.hash:location.href)):s.trigger("hashchange",[!0]):(e.mobile.path.isHashValid(location.hash)&&(e.mobile.urlHistory.initialDst=o.replace("#","")),e.event.special.navigate.isPushStateEnabled()&&e.mobile.navigate.navigator.squash(t.parseLocation().href),e.mobile.changePage(e.mobile.firstPage,{transition:"none",reverse:!0,changeHash:!1,fromHashChange:!0}))}}),e(function(){t.scrollTo(0,1),e.mobile.defaultHomeScroll=e.support.scrollTop&&1!==e.mobile.window.scrollTop()?1:0,e.mobile.autoInitializePage&&e.mobile.initializePage(),s.load(e.mobile.silentScroll),e.support.cssPointerEvents||e.mobile.document.delegate(".ui-disabled","vclick",function(e){e.preventDefault(),e.stopImmediatePropagation()})}))}(e,this)})}function load_jquery_ui_partial(e){(function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,t.href&&s&&"map"===i.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o)):!1):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var i=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var r,i,s=e(this[0]);s.length&&s[0]!==document;){if(r=s.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(i=parseInt(s.css("zIndex"),10),!isNaN(i)&&0!==i))return i;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){return e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),i&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var s="Width"===r?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return"number"!=typeof t?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(i&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(r=0;i.length>r;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})})(e);(function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n,r=0;null!=(n=t[r]);r++)try{e(n).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(n,r,i){var s,o,u,a,f={},l=n.split(".")[0];n=n.split(".")[1],s=l+"-"+n,i||(i=r,r=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[l]=e[l]||{},o=e[l][n],u=e[l][n]=function(e,n){return this._createWidget?(arguments.length&&this._createWidget(e,n),t):new u(e,n)},e.extend(u,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new r,a.options=e.widget.extend({},a.options),e.each(i,function(n,i){return e.isFunction(i)?(f[n]=function(){var e=function(){return r.prototype[n].apply(this,arguments)},t=function(e){return r.prototype[n].apply(this,e)};return function(){var n,r=this._super,s=this._superApply;return this._super=e,this._superApply=t,n=i.apply(this,arguments),this._super=r,this._superApply=s,n}}(),t):(f[n]=i,t)}),u.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix:n},f,{constructor:u,namespace:l,widgetName:n,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,u,n._proto)}),delete o._childConstructors):r._childConstructors.push(u),e.widget.bridge(n,u)},e.widget.extend=function(n){for(var i,o,u=r.call(arguments,1),a=0,f=u.length;f>a;a++)for(i in u[a])o=u[a][i],u[a].hasOwnProperty(i)&&o!==t&&(n[i]=e.isPlainObject(o)?e.isPlainObject(n[i])?e.widget.extend({},n[i],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,i){var o=i.prototype.widgetFullName||n;e.fn[n]=function(u){var f="string"==typeof u,l=r.call(arguments,1),c=this;return u=!f&&l.length?e.widget.extend.apply(null,[u].concat(l)):u,f?this.each(function(){var r,i=e.data(this,o);return i?e.isFunction(i[u])&&"_"!==u.charAt(0)?(r=i[u].apply(i,l),r!==i&&r!==t?(c=r&&r.jquery?c.pushStack(r.get()):r,!1):t):e.error("no such method '"+u+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+u+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(u||{})._init():e.data(this,o,new i(u,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i,s,o,u=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(u={},i=n.split("."),n=i.shift(),i.length){for(s=u[n]=e.widget.extend({},this.options[n]),o=0;i.length-1>o;o++)s[i[o]]=s[i[o]]||{},s=s[i[o]];if(n=i.pop(),r===t)return s[n]===t?null:s[n];s[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];u[n]=r}return this._setOptions(u),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(n,r,i){var s,o=this;"boolean"!=typeof n&&(i=r,r=n,n=!1),i?(r=s=e(r),this.bindings=this.bindings.add(r)):(i=r,r=this.element,s=this.widget()),e.each(i,function(i,u){function a(){return n||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof u?o[u]:u).apply(o,arguments):t}"string"!=typeof u&&(a.guid=u.guid=u.guid||a.guid||e.guid++);var f=i.match(/^(\w+)\s*(.*)$/),l=f[1]+o.eventNamespace,c=f[2];c?s.delegate(c,l,a):r.bind(l,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})})(e);(function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var r=this,i=1===n.which,s="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return i&&!s&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(e);(function(e,t){function n(e,t,n){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?n/100:1)]}function r(t,n){return parseInt(e.css(t,n),10)||0}function i(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var s,o=Math.max,u=Math.abs,a=Math.round,f=/left|center|right/,l=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,d=e.fn.position;e.position={scrollbarWidth:function(){if(s!==t)return s;var n,r,i=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=i.children()[0];return e("body").append(i),n=o.offsetWidth,i.css("overflow","scroll"),r=o.offsetWidth,n===r&&(r=i[0].clientWidth),i.remove(),s=n-r},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,s="scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:i?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return d.apply(this,arguments);t=e.extend({},t);var s,p,v,m,g,y,b=e(t.of),w=e.position.getWithinInfo(t.within),E=e.position.getScrollInfo(w),S=(t.collision||"flip").split(" "),x={};return y=i(b),b[0].preventDefault&&(t.at="left top"),p=y.width,v=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],function(){var e,n,r=(t[this]||"").split(" ");1===r.length&&(r=f.test(r[0])?r.concat(["center"]):l.test(r[0])?["center"].concat(r):["center","center"]),r[0]=f.test(r[0])?r[0]:"center",r[1]=l.test(r[1])?r[1]:"center",e=c.exec(r[0]),n=c.exec(r[1]),x[this]=[e?e[0]:0,n?n[0]:0],t[this]=[h.exec(r[0])[0],h.exec(r[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===t.at[0]?g.left+=p:"center"===t.at[0]&&(g.left+=p/2),"bottom"===t.at[1]?g.top+=v:"center"===t.at[1]&&(g.top+=v/2),s=n(x.at,p,v),g.left+=s[0],g.top+=s[1],this.each(function(){var i,f,l=e(this),c=l.outerWidth(),h=l.outerHeight(),d=r(this,"marginLeft"),y=r(this,"marginTop"),T=c+d+r(this,"marginRight")+E.width,N=h+y+r(this,"marginBottom")+E.height,C=e.extend({},g),L=n(x.my,l.outerWidth(),l.outerHeight());"right"===t.my[0]?C.left-=c:"center"===t.my[0]&&(C.left-=c/2),"bottom"===t.my[1]?C.top-=h:"center"===t.my[1]&&(C.top-=h/2),C.left+=L[0],C.top+=L[1],e.support.offsetFractions||(C.left=a(C.left),C.top=a(C.top)),i={marginLeft:d,marginTop:y},e.each(["left","top"],function(n,r){e.ui.position[S[n]]&&e.ui.position[S[n]][r](C,{targetWidth:p,targetHeight:v,elemWidth:c,elemHeight:h,collisionPosition:i,collisionWidth:T,collisionHeight:N,offset:[s[0]+L[0],s[1]+L[1]],my:t.my,at:t.at,within:w,elem:l})}),t.using&&(f=function(e){var n=m.left-C.left,r=n+p-c,i=m.top-C.top,s=i+v-h,a={target:{element:b,left:m.left,top:m.top,width:p,height:v},element:{element:l,left:C.left,top:C.top,width:c,height:h},horizontal:0>r?"left":n>0?"right":"center",vertical:0>s?"top":i>0?"bottom":"middle"};c>p&&p>u(n+r)&&(a.horizontal="center"),h>v&&v>u(i+s)&&(a.vertical="middle"),a.important=o(u(n),u(r))>o(u(i),u(s))?"horizontal":"vertical",t.using.call(this,e,a)}),l.offset(e.extend(C,{using:f}))})},e.ui.position={fit:{left:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollLeft:r.offset.left,s=r.width,u=e.left-t.collisionPosition.marginLeft,a=i-u,f=u+t.collisionWidth-s-i;t.collisionWidth>s?a>0&&0>=f?(n=e.left+a+t.collisionWidth-s-i,e.left+=a-n):e.left=f>0&&0>=a?i:a>f?i+s-t.collisionWidth:i:a>0?e.left+=a:f>0?e.left-=f:e.left=o(e.left-u,e.left)},top:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollTop:r.offset.top,s=t.within.height,u=e.top-t.collisionPosition.marginTop,a=i-u,f=u+t.collisionHeight-s-i;t.collisionHeight>s?a>0&&0>=f?(n=e.top+a+t.collisionHeight-s-i,e.top+=a-n):e.top=f>0&&0>=a?i:a>f?i+s-t.collisionHeight:i:a>0?e.top+=a:f>0?e.top-=f:e.top=o(e.top-u,e.top)}},flip:{left:function(e,t){var n,r,i=t.within,s=i.offset.left+i.scrollLeft,o=i.width,a=i.isWindow?i.scrollLeft:i.offset.left,f=e.left-t.collisionPosition.marginLeft,l=f-a,c=f+t.collisionWidth-o-a,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,d=-2*t.offset[0];0>l?(n=e.left+h+p+d+t.collisionWidth-o-s,(0>n||u(l)>n)&&(e.left+=h+p+d)):c>0&&(r=e.left-t.collisionPosition.marginLeft+h+p+d-a,(r>0||c>u(r))&&(e.left+=h+p+d))},top:function(e,t){var n,r,i=t.within,s=i.offset.top+i.scrollTop,o=i.height,a=i.isWindow?i.scrollTop:i.offset.top,f=e.top-t.collisionPosition.marginTop,l=f-a,c=f+t.collisionHeight-o-a,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,d="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,v=-2*t.offset[1];0>l?(r=e.top+p+d+v+t.collisionHeight-o-s,e.top+p+d+v>l&&(0>r||u(l)>r)&&(e.top+=p+d+v)):c>0&&(n=e.top-t.collisionPosition.marginTop+p+d+v-a,e.top+p+d+v>c&&(n>0||c>u(n))&&(e.top+=p+d+v))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&11>i,t.innerHTML="",n.removeChild(t)}()})(e);(function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;return i.containment?"window"===i.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):"document"===i.containment?(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):i.containment.constructor===Array?(this.containment=i.containment,undefined):("parent"===i.containment&&(i.containment=this.helper[0].parentNode),n=e(i.containment),r=n[0],r&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n),undefined):(this.containment=null,undefined)},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:i.scrollTop(),left:i.scrollLeft()}),{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*r}},_generatePosition:function(t){var n,r,i,s,o=this.options,u="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=t.pageX,f=t.pageY;return this.offset.scroll||(this.offset.scroll={top:u.scrollTop(),left:u.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(a=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(f=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(a=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(f=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,f=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((a-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,a=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("ui-draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("ui-draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("ui-draggable"),i=this;e.each(r.sortables,function(){var o=!1,u=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==u&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(u.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),r=n.options,i=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(document).scrollTop()<r.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(document).scrollLeft()<r.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed)))),i!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),r=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(t,n){var r,i,s,o,u,a,f,l,c,h,p=e(this).data("ui-draggable"),d=p.options,v=d.snapTolerance,m=n.offset.left,g=m+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(c=p.snapElements.length-1;c>=0;c--)u=p.snapElements[c].left,a=u+p.snapElements[c].width,f=p.snapElements[c].top,l=f+p.snapElements[c].height,u-v>g||m>a+v||f-v>b||y>l+v||!e.contains(p.snapElements[c].item.ownerDocument,p.snapElements[c].item)?(p.snapElements[c].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=!1):("inner"!==d.snapMode&&(r=v>=Math.abs(f-b),i=v>=Math.abs(l-y),s=v>=Math.abs(u-g),o=v>=Math.abs(a-m),r&&(n.position.top=p._convertPositionTo("relative",{top:f-p.helperProportions.height,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u-p.helperProportions.width}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left)),h=r||i||s||o,"outer"!==d.snapMode&&(r=v>=Math.abs(f-y),i=v>=Math.abs(l-b),s=v>=Math.abs(u-m),o=v>=Math.abs(a-g),r&&(n.position.top=p._convertPositionTo("relative",{top:f,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[c].snapping&&(r||i||s||o||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=r||i||s||o||h)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,r=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});r.length&&(t=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+r.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})})(e)}function $RFunctions($R){function loadCSS(e){$R.each(e,function(e,t){$R("<link>").attr({href:t,rel:"stylesheet"}).appendTo("body")})}function initCommonUtils(e){e.extend(RDR,{commonUtil:{prettyNumber:function(e){var t=parseInt(e,10);if(isNaN(t)||t<0)return false;var n=["","K","M","B","T"];for(var r=0;r<n.length;r++){var i=Math.pow(10,3*r);var s=Math.pow(10,3*(r+1));if(t<s){return""+Math.floor(t/i)+n[r]}}}}})}function initPlugins($R){function plugin_jquery_log(e){var t=e;e.clog=function(){if(window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,arguments)}};e.fn.clog=function(){var t=arguments||this;e.clog(t);return this};if(typeof clog==="undefined"){clog=function(){e.clog(arguments)}}if(typeof t!=="undefined"){t.clog=e.clog;t.fn.clog=e.fn.clog}}function plugin_jquery_hasAttr(e){e.fn.hasAttr=function(e){return this.attr(e)!==undefined}}function plugin_jquery_json($){$.toJSON=function(e){var t=typeof e;if(e===null)return"null";if(t=="undefined")return undefined;if(t=="number"||t=="boolean")return e+"";if(t=="string")return $.quoteString(e);if(t=="object"){if(e.constructor===Date){var n=e.getUTCMonth()+1;if(n<10)n="0"+n;var r=e.getUTCDate();if(r<10)r="0"+r;var i=e.getUTCFullYear();var s=e.getUTCHours();if(s<10)s="0"+s;var o=e.getUTCMinutes();if(o<10)o="0"+o;var u=e.getUTCSeconds();if(u<10)u="0"+u;var a=e.getUTCMilliseconds();if(a<100)a="0"+a;if(a<10)a="0"+a;return'"'+i+"-"+n+"-"+r+"T"+s+":"+o+":"+u+"."+a+'Z"'}if(e.constructor===Array){var f=[];for(var l=0;l<e.length;l++)f.push($.toJSON(e[l])||"null");return"["+f.join(",")+"]"}var c=[];for(var h in e){var p;var t=typeof h;if(t=="number")p='"'+h+'"';else if(t=="string")p=$.quoteString(h);else continue;if(typeof e[h]=="function")continue;var d=$.toJSON(e[h]);if(typeof d!="undefined")c.push(p+":"+d)}return"{"+c.join(", ")+"}"}};$.evalJSON=function(src){return eval("("+src+")")};$.secureEvalJSON=function(src){var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@");filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");else throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(e){if(e.match(_escapeable)){return'"'+e.replace(_escapeable,function(e){var t=_meta[e];if(typeof t==="string")return t;t=e.charCodeAt();return"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)})+'"'}return'"'+e+'"'};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var _meta={"\b":"\\b","    ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}}function plugin_jquery_cookie(e){e.cookie=function(t,n,r){if(arguments.length>1&&String(n)!=="[object Object]"){r=e.extend({},r);if(n===null||n===undefined){r.expires=-1}if(typeof r.expires==="number"){var i=r.expires,s=r.expires=new Date;s.setDate(s.getDate()+i)}n=String(n);return document.cookie=[encodeURIComponent(t),"=",r.raw?n:encodeURIComponent(n),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}r=n||{};var o,u=r.raw?function(e){return e}:decodeURIComponent;return(o=(new RegExp("(?:^|; )"+encodeURIComponent(t)+"=([^;]*)")).exec(document.cookie))?u(o[1]):null}}function plugin_jquery_postMessage(e){var t,n,r=1,i,s=this,o=!1,u="postMessage",a="addEventListener",f,l=s[u]&&!e.browser.opera;e[u]=function(t,n,i){if(!n){return}t=typeof t==="string"?t:e.param(t);i=i||parent;if(l){i[u](t,n.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(n){i.location=n.replace(/#.*$/,"")+"#"+ +(new Date)+r++ +"&"+t}}};e.receiveMessage=f=function(r,u,h){if(l){if(r){i&&f();i=function(t){if(typeof u==="string"&&t.origin!==u||e.isFunction(u)&&u(t.origin)===o){return o}r(t)}}if(s[a]){s[r?a:"removeEventListener"]("message",i,o)}else{s[r?"attachEvent":"detachEvent"]("onmessage",i)}}else{t&&clearInterval(t);t=null;if(r){h=typeof u==="number"?u:typeof h==="number"?h:100;t=setInterval(function(){var e=document.location.hash,t=/^#?\d+&/;if(e!==n&&t.test(e)){n=e;r({data:e.replace(t,"")})}},h)}}}}function plugin_jquery_enhancedOffset(e){var t=e.fn.offset;e.fn.offset=function(){var n=t.call(this),r=n?n.top+this.outerHeight():0,i=n?n.left+this.outerWidth():0,s=arguments;return s.length?this.animate({top:s[0].top||s[0],left:s[0].left||s[1]},(s[0].top?s[1]:s[2])||1):e.extend(n,{bottom:r,right:i})}}function plugin_jquery_rdrWidgetSummary(e){function r(t){var n=t;var r="rdr-summary-key-"+n.key;e("."+r).remove();var s=e(n.parentContainer),o=e('<div class="rdr rdr-summary rdr-summary-'+n.id+' rdr-border-box" rdr-page-id="'+n.id+'"></div>').addClass(r);if(RDR.engageScriptParams.bookmarklet=="true"){o.addClass("rdr_bookmarklet")}o.data({page_id:n.id,page_key:n.key});s[n.jqFunc](o);var u=s.hasClass("defaultSummaryBar")?"top":"top";o.find("img.rdr_tooltip_this").tooltip({placement:u});o.append('<div class="rdr_chevron_cta"><i class="rdr_icon-chevron-down"></i></div>'+'<a href="'+RDR_baseUrl+'" target="_blank" class="rdr_logo">'+'<span class="no-rdr rdr-logo" title="This is <strong style=\'color:#4d92da;\'>ReadrBoard</strong>. Click to visit our site and learn more!" src="'+RDR_staticUrl+'widget/images/blank.png" ></span>'+"</a>");o.find(".rdr-logo").click(function(){});o.find(".rdr-logo").tooltip({});var a=function(){i();var t=e(this).data("page_id");var r=RDR.rindow.make("readMode",{is_page:true,page:n,tags:n.toptags});RDR.events.trackEventToCloud({category:"summarybar",action:"rindow_shown_summarybar",opt_label:"page: "+t,page_id:t})};if(isTouchBrowser){o.click(function(){a.call(this);e(this).toggleClass("rdr_hover")})}else{o.hover(a,function(){})}var f;if(t.summary){e.each(t.summary,function(){if(this.kind=="tag"){f=this.count}})}var l=0;if(f){l=f}else{e.each(n.toptags,function(e,t){l+=t.tag_count})}var c=l>1?l+" Reactions":l>0?l+" Reaction":"Reactions";o.append('<a class="rdr_reactions_label">'+c+"</a>")}function i(t){if(typeof RDR.interaction_data=="undefined"){RDR.interaction_data={}}e.each(RDR.summaries,function(t,n){e.each(n.top_interactions.tags,function(e,n){if(typeof n!="undefined"){if(typeof RDR.summaries[t].content_nodes!="undefined"){RDR.util.buildInteractionData()}else{RDR.actions.content_nodes.init(t,function(){RDR.util.buildInteractionData()})}}})})}e.fn.rdrWidgetSummary=function(t){if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist.")}};var t={};var n={init:function(n){var i=this[0]===document?e(".rdr-summary"):this,s;return i.each(function(){s=n?e.extend({},t,n):t;s.parentContainer=this;e(this).data("settings",s);r(s)})},update:function(){var t=this[0]===document?e(".rdr-summary"):this;return t.each(function(t){var n=e(this).data("settings");n.summary=RDR.pages[n.id].summary;r(n)})}}}function plugin_jquery_selectionographer(e,t){function f(){return t.getSelection()}function l(n){var r=this,i=o,s,u,a=n||{},l={styleName:"rdr_hilite",container:document,serialRange:null,range:null},c={idx:i.length,timestamp:e.now(),interactionID:null,hiliter:null,revisionParent:null,text:""},p=e.extend({},l,a,c);if(!p.range&&!p.serialRange){var d=f();if(d.isCollapsed)return false;s=d.getRangeAt(0);try{u=t.serializeRange(s,true,p.container)}catch(v){u=false}}else if(p.range){s=p.range;try{u=t.serializeRange(s,true,p.container)}catch(m){u=false}}else if(p.serialRange){u=p.serialRange;s=t.deserializeRange(u,p.container)}else{}p.serialRange=u;p.range=s.cloneRange();p.text=p.range.toString();if(p.text.length===0)return false;p.hiliter=h(p);return p}function c(e){if(e===false)return false;if(typeof e==="object")return e;var t=o,n=typeof e=="string"||typeof e=="number"?e:t.length-1,r=t[n];if(r)return r;return false}function h(n){if(n.hiliter){return n.hiliter}var r=n.range,i=n.styleName,s;var o=i+"_"+n.idx;s=t.createCssClassApplier(o,true);s["class"]=o;s["get$start"]=function(){return e(r.startContainer).closest("."+s["class"])};s["get$end"]=function(){return e(r.endContainer).closest("."+s["class"])};s["isActive"]=function(){var e=false;try{e=s["isAppliedToRange"](r)}catch(t){e=null}return e};return s}function p(t,n){var i=t.range,s=t.styleName,o=t.hiliter,u=o["isActive"]();if(u==null){return}if(!u&&(n==="on"||n==="toggle")){o.applyToRange(i);e("."+o["class"]).addClass(s);o["get$start"]().addClass(s+"_start");o["get$end"]().addClass(s+"_end");r.clear()}else if(u&&(n==="off"||n==="toggle")){o["get$start"]().removeClass(s+"_start");o["get$end"]().removeClass(s+"_end");e("."+o["class"]).removeClass(s);if(o.isAppliedToRange(i)){o.undoToRange(i)}else{}}return t}function d(t,n){var r={start:true,offset:undefined,relOffset:undefined},i=e.extend({},r,n),s=i.start?t.startOffset:t.endOffset;if(typeof i.offset==="undefined"){if(typeof i.relOffset==="undefined"){return s}i.offset=s+i.relOffset}try{if(i.start){t.setStart(t.startContainer,i.offset)}else{t.setEnd(t.endContainer,i.offset)}return t}catch(o){return false}}function v(t,n){var r=this,i=u,s={};if(typeof n==="undefined"||n===null){e.each(i,function(e,t){s[e]=[]})}else if(typeof n==="string"){s[n]=[]}else{e.each(n,function(e,t){if(typeof t==="string"){s[t]=[]}else{var n=t[0];var r=t.length>1?t.slice(1):[];s[n]=r}})}e.each(s,function(e,n){var r=i[e]||function(){};t=r(t,n)});return t}e.fn.selectionographer=function(t){if(r[t]){return r[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist.")}};e.fn.selog=e.fn.selectionographer;var n={};var r={init:function(t){var r=this;t=t||{};return r.each(function(){i=e.extend(n,t)})},save:function(e){var t=this,n=o,r=e||{},i;r.container=r.container||t[0]||document;i=l(r);if(!i)return false;n[i.idx]=i;return i},selectEl:function(e){var n=t.createRange();n.selectNodeContents(e);var r=t.getSelection();r.setSingleRange(n)},activate:function(e){var t=c(e);if(!t)return false;r.clear();f().setSingleRange(t.range);return t},clear:function(){f().removeAllRanges()},modify:function(e,t){if(e instanceof Array){t=e;e=undefined}var n=c(e),i,s,o;if(!n)return false;s=n.range.cloneRange();s=v(s,t);i={range:s,container:n.container};o=r.save(i);return o},hilite:function(e,t){var n=t;if(typeof e==="string"&&isNaN(e)){n=e;e=undefined}n=n||"on";var r=c(e);if(!r){return false}if(typeof r.serialRange!=="undefined"&&r.serialRange===false){return false}p(r,n);return r},helpers:function(e){var t=s[e];return t?t.apply(this,Array.prototype.slice.call(arguments,1)):false},find:function(t){var n=[],r=this,i;if(!t)return false;RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};t=RegExp.escape(t);i=new RegExp(t,"gim");return r.each(function(){var t=e(this).text(),n=0,r=0,s=[];while((n=i.exec(t))&&r<5){s.push(n.index);r++}return s})},stack:function(){return o},data:function(e){return a[e]}};var i={},s={smartHilite:function(){return r.hilite(r.modify(r.save.apply(this)))},activateRange:function(e){var t={};if(!e)return false;if(typeof e==="string"){t.serialRange=e}else{t.range=e}return r.activate(r.save(t))}},o=[],u={filterOutRDRIndicator:function(t,n){var r=t.commonAncestorContainer;var i=e(r).find(".rdr_indicator");if(i.length){var s=t.containsNode(i[0],true);if(s){t.setEndBefore(i[0])}}return t},stripWhiteSpace:function(e){var t=e.toString(),n={},r={};n.textnode=e.startContainer;n.offset=e.startOffset;n.regx=/^\s+/;n.result=n.regx.exec(t);r.textnode=e.endContainer;r.offset=e.endOffset;r.regx=/\s+$/;r.result=r.regx.exec(t);if(n.result){n.resultStrLen=n.result[0].length;d(e,{relOffset:n.resultStrLen})}if(r.result){r.resultStrLen=r.result[0].length;d(e,{relOffset:-r.resultStrLen,start:false})}return e},firstWordSnap:function(e){var n=e.startContainer,r=e.startOffset,i;if(r===0)return e;var s={range:t.createRange()};s.range.setStart(n,0);s.range.setEnd(n,r);s.str0=s.range.toString();s.regx1=/\s*\S+$/;s.result1=s.regx1.exec(s.str0);if(s.result1===null)return e;s.str1=s.result1[0];s.str2=s.str1.replace(/\s*/,"");s.extraWordChars=s.str2.length;d(e,{relOffset:-s.extraWordChars});return e},lastWordSnap:function(e){var n=e.endContainer,r=e.endOffset,i;if(r===0)return e;var s={range:t.createRange()};s.range.setStart(n,r);s.range.setEnd(n,n.length);s.str0=s.range.toString();s.regx1=/^\S+(?=(\s|$))/;s.result1=s.regx1.exec(s.str0);if(s.result1===null)return e;s.str1=s.result1[0];s.extraWordChars=s.str1.length;d(e,{relOffset:s.extraWordChars,start:false});return e}},a={stack:o};e(document).selog()}function plugin_jquery_mustache(e){var t=e;var n=undefined;(function(e){(function(e,t){"object"==typeof exports&&exports?module.exports=t:"function"==typeof n&&n.amd?n(t):e.Mustache=t})(this,function(){function e(e,t){return y.call(e,t)}function t(t){return!e(d,t)}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e){return(e+"").replace(/[&<>"'\/]/g,function(e){return E[e]})}function i(e){this.string=e,this.tail=e,this.pos=0}function s(e,t){this.view=e,this.parent=t,this._cache={}}function o(){this.clearCache()}function u(e,t,n,r){for(var i,s,o,a="",f=0,l=e.length;l>f;++f)switch(i=e[f],s=i[1],i[0]){case"#":if(o=n.lookup(s),"object"==typeof o)if(w(o))for(var h=0,p=o.length;p>h;++h)a+=u(i[4],t,n.push(o[h]),r);else o&&(a+=u(i[4],t,n.push(o),r));else if("function"==typeof o){var d=null==r?null:r.slice(i[3],i[5]);o=o.call(n.view,d,function(e){return t.render(e,n)}),null!=o&&(a+=o)}else o&&(a+=u(i[4],t,n,r));break;case"^":o=n.lookup(s),(!o||w(o)&&0===o.length)&&(a+=u(i[4],t,n,r));break;case">":o=t.getPartial(s),"function"==typeof o&&(a+=o(n));break;case"&":o=n.lookup(s),null!=o&&(a+=o);break;case"name":o=n.lookup(s),null!=o&&(a+=c.escape(o));break;case"text":a+=s}return a}function a(e){for(var t,n=[],r=n,i=[],s=0,o=e.length;o>s;++s)switch(t=e[s],t[0]){case"#":case"^":i.push(t),r.push(t),r=t[4]=[];break;case"/":var u=i.pop();u[5]=t[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(t)}return n}function f(e){for(var t,n,r=[],i=0,s=e.length;s>i;++i)t=e[i],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(n=t,r.push(t)));return r}function l(e){return[RegExp(n(e[0])+"\\s*"),RegExp("\\s*"+n(e[1]))]}var c={};c.name="mustache.js",c.version="0.7.2",c.tags=["{{","}}"],c.Scanner=i,c.Context=s,c.Writer=o;var h=/\s*/,p=/\s+/,d=/\S/,v=/\s*=/,m=/\s*\}/,g=/#|\^|\/|>|\{|&|=|!/,y=RegExp.prototype.test,b=Object.prototype.toString,w=Array.isArray||function(e){return"[object Array]"===b.call(e)},E={"&":"&","<":"<",">":">",'"':""","'":"&#39;","/":"&#x2F;"};c.escape=r,i.prototype.eos=function(){return""===this.tail},i.prototype.scan=function(e){var t=this.tail.match(e);return t&&0===t.index?(this.tail=this.tail.substring(t[0].length),this.pos+=t[0].length,t[0]):""},i.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return t},s.make=function(e){return e instanceof s?e:new s(e)},s.prototype.push=function(e){return new s(e,this)},s.prototype.lookup=function(e){var t=this._cache[e];if(!t){if("."==e)t=this.view;else for(var n=this;n;){if(e.indexOf(".")>0){t=n.view;for(var r=e.split("."),i=0;t&&r.length>i;)t=t[r[i++]]}else t=n.view[e];if(null!=t)break;n=n.parent}this._cache[e]=t}return"function"==typeof t&&(t=t.call(this.view)),t},o.prototype.clearCache=function(){this._cache={},this._partialCache={}},o.prototype.compile=function(e,t){var n=this._cache[e];if(!n){var r=c.parse(e,t);n=this._cache[e]=this.compileTokens(r,e)}return n},o.prototype.compilePartial=function(e,t,n){var r=this.compile(t,n);return this._partialCache[e]=r,r},o.prototype.getPartial=function(e){return e in this._partialCache||!this._loadPartial||this.compilePartial(e,this._loadPartial(e)),this._partialCache[e]},o.prototype.compileTokens=function(e,t){var n=this;return function(r,i){if(i)if("function"==typeof i)n._loadPartial=i;else for(var o in i)n.compilePartial(o,i[o]);return u(e,n,s.make(r),t)}},o.prototype.render=function(e,t,n){return this.compile(e)(t,n)},c.parse=function(e,r){function s(){if(N&&!C)for(;T.length;)delete x[T.pop()];else T=[];N=!1,C=!1}if(e=e||"",r=r||c.tags,"string"==typeof r&&(r=r.split(p)),2!==r.length)throw Error("Invalid tags: "+r.join(", "));for(var o,u,d,y,b,w=l(r),E=new i(e),S=[],x=[],T=[],N=!1,C=!1;!E.eos();){if(o=E.pos,d=E.scanUntil(w[0]))for(var L=0,A=d.length;A>L;++L)y=d.charAt(L),t(y)?T.push(x.length):C=!0,x.push(["text",y,o,o+1]),o+=1,"\n"==y&&s();if(!E.scan(w[0]))break;if(N=!0,u=E.scan(g)||"name",E.scan(h),"="===u?(d=E.scanUntil(v),E.scan(v),E.scanUntil(w[1])):"{"===u?(d=E.scanUntil(RegExp("\\s*"+n("}"+r[1]))),E.scan(m),E.scanUntil(w[1]),u="&"):d=E.scanUntil(w[1]),!E.scan(w[1]))throw Error("Unclosed tag at "+E.pos);if(b=[u,d,o,E.pos],x.push(b),"#"===u||"^"===u)S.push(b);else if("/"===u){if(0===S.length)throw Error('Unopened section "'+d+'" at '+o);var O=S.pop();if(O[1]!==d)throw Error('Unclosed section "'+O[1]+'" at '+o)}else if("name"===u||"{"===u||"&"===u)C=!0;else if("="===u){if(r=d.split(p),2!==r.length)throw Error("Invalid tags at "+o+": "+r.join(", "));w=l(r)}}var O=S.pop();if(O)throw Error('Unclosed section "'+O[1]+'" at '+E.pos);return x=f(x),a(x)};var S=new o;return c.clearCache=function(){return S.clearCache()},c.compile=function(e,t){return S.compile(e,t)},c.compilePartial=function(e,t,n){return S.compilePartial(e,t,n)},c.compileTokens=function(e,t){return S.compileTokens(e,t)},c.render=function(e,t,n){return S.render(e,t,n)},c.to_html=function(e,t,n,r){var i=c.render(e,t,n);return"function"!=typeof r?i:(r(i),void 0)},c}()),e.mustache=function(e,t,n){return Mustache.render(e,t,n)},e.fn.mustache=function(t,n){return e(this).map(function(r,i){var s=e.trim(e(i).html()),o=e.mustache(s,t,n);return e(o).get()})}})(e)}function plugin_jquery_improvedCSS(e){e.fn.css2=e.fn.css;e.fn.css=function(){if(arguments.length)return e.fn.css2.apply(this,arguments);var t=["font-family","font-size","font-weight","font-style","color","text-transform","text-decoration","letter-spacing","word-spacing","lineHeight","text-align","vertical-align","direction","background-color","background-image","background-repeat","background-position","background-attachment","opacity","width","height","top","right","bottom","left","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","position","display","visibility","z-index","overflow-x","overflow-y","white-space","clip","float","clear","cursor","list-style-image","list-style-position","list-style-type","marker-offset"];var n=t.length,r={},i;for(var s=0;s<n;s++){i=t[s];r[i]=e.fn.css2.call(this,i);if(i=="lineHeight"){r[i]=e.fn.css2.call(this,"auto")}i=typeof i==="undefined"?"auto":i}return r}}function plugin_jquery_mousewheel(e){function r(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=true,o=0,u=0;t=e.event.fix(n);t.type="mousewheel";if(n.wheelDelta){i=n.wheelDelta/120}if(n.detail){i=-n.detail/3}u=i;if(n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS){u=0;o=-1*i}if(n.wheelDeltaY!==undefined){u=n.wheelDeltaY/120}if(n.wheelDeltaX!==undefined){o=-1*n.wheelDeltaX/120}r.unshift(t,i,o,u);return(e.event.dispatch||e.event.handle).apply(this,r)}var t=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks){for(var n=t.length;n;){e.event.fixHooks[t[--n]]=e.event.mouseHooks}}e.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var e=t.length;e;){this.addEventListener(t[--e],r,false)}}else{this.onmousewheel=r}},teardown:function(){if(this.removeEventListener){for(var e=t.length;e;){this.removeEventListener(t[--e],r,false)}}else{this.onmousewheel=null}}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}function plugin_jquery_scrollStartAndStop(e){var t=e;var n=e.event.special,r="D"+ +(new Date),i="D"+(+(new Date)+1);n.scrollstart={setup:function(){var t,i=function(r){var i=this,s=arguments;if(t){clearTimeout(t)}else{r.type="scrollstart";e.event.handle.apply(i,s)}t=setTimeout(function(){t=null},n.scrollstop.latency)};e(this).bind("scroll",i).data(r,i)},teardown:function(){e(this).unbind("scroll",e(this).data(r))}};n.scrollstop={latency:300,setup:function(){var t,r=function(r){var i=this,s=arguments;if(t){clearTimeout(t)}t=setTimeout(function(){t=null;r.type="scrollstop";e.event.handle.apply(i,s)},n.scrollstop.latency)};e(this).bind("scroll",r).data(i,r)},teardown:function(){e(this).unbind("scroll",e(this).data(i))}}}function plugin_jquery_isotope(e){var t=e,n=window,r=undefined;"use strict";var i=n.document,s=n.Modernizr,o=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},u="Moz Webkit O Ms".split(" "),a=function(e){var t=i.documentElement.style,n;if(typeof t[e]=="string")return e;e=o(e);for(var r=0,s=u.length;r<s;r++){n=u[r]+e;if(typeof t[n]=="string")return n}},f=a("transform"),l=a("transitionProperty"),c={csstransforms:function(){return!!f},csstransforms3d:function(){var e=!!a("perspective");if(e){var n=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),r="@media ("+n.join("transform-3d),(")+"modernizr)",i=t("<style>"+r+"{#modernizr{height:3px}}"+"</style>").appendTo("head"),s=t('<div id="modernizr" />').appendTo("html");e=s.height()===3,s.remove(),i.remove()}return e},csstransitions:function(){return!!l}},h;if(s)for(h in c)s.hasOwnProperty(h)||s.addTest(h,c[h]);else{s=n.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var p=" ",d;for(h in c)d=c[h](),s[h]=d,p+=" "+(d?"":"no-")+h;t("html").addClass(p)}if(s.csstransforms){var v=s.csstransforms3d?{translate:function(e){return"translate3d("+e[0]+"px, "+e[1]+"px, 0) "},scale:function(e){return"scale3d("+e+", "+e+", 1) "}}:{translate:function(e){return"translate("+e[0]+"px, "+e[1]+"px) "},scale:function(e){return"scale("+e+") "}},m=function(e,n,r){var i=t.data(e,"isoTransform")||{},s={},o,u={},a;s[n]=r,t.extend(i,s);for(o in i)a=i[o],u[o]=v[o](a);var l=u.translate||"",c=u.scale||"",h=l+c;t.data(e,"isoTransform",i),e.style[f]=h};t.cssNumber.scale=!0,t.cssHooks.scale={set:function(e,t){m(e,"scale",t)},get:function(e,n){var r=t.data(e,"isoTransform");return r&&r.scale?r.scale:1}},t.fx.step.scale=function(e){t.cssHooks.scale.set(e.elem,e.now+e.unit)},t.cssNumber.translate=!0,t.cssHooks.translate={set:function(e,t){m(e,"translate",t)},get:function(e,n){var r=t.data(e,"isoTransform");return r&&r.translate?r.translate:[0,0]}}}var g,y;s.csstransitions&&(g={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[l],y=a("transitionDuration"));var b=t.event,w=t.event.handle?"handle":"dispatch",E;b.special.smartresize={setup:function(){t(this).bind("resize",b.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",b.special.smartresize.handler)},handler:function(e,t){var n=this,r=arguments;e.type="smartresize",E&&clearTimeout(E),E=setTimeout(function(){b[w].apply(n,r)},t==="execAsap"?0:100)}},t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])},t.Isotope=function(e,n,r){this.element=t(n),this._create(e),this._init(r)};var S=["width","height"],x=t(n);t.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!0,itemPositionDataEnabled:!1},t.Isotope.prototype={_create:function(e){this.options=t.extend({},t.Isotope.settings,e),this.styleQueue=[],this.elemCount=0;var n=this.element[0].style;this.originalStyle={};var r=S.slice(0);for(var i in this.options.containerStyle)r.push(i);for(var s=0,o=r.length;s<o;s++)i=r[s],this.originalStyle[i]=n[i]||"";this.element.css(this.options.containerStyle),this._updateAnimationEngine(),this._updateUsingTransforms();var u={"original-order":function(e,t){return t.elemCount++,t.elemCount},random:function(){return Math.random()}};this.options.getSortData=t.extend(this.options.getSortData,u),this.reloadItems(),this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var a=this;setTimeout(function(){a.element.addClass(a.options.containerClass)},0),this.options.resizable&&x.bind("smartresize.isotope",function(){a.resize()}),this.element.delegate("."+this.options.hiddenClass,"click",function(){return!1})},_getAtoms:function(e){var t=this.options.itemSelector,n=t?e.filter(t).add(e.find(t)):e,r={position:"absolute"};return n=n.filter(function(e,t){return t.nodeType===1}),this.usingTransforms&&(r.left=0,r.top=0),n.css(r).addClass(this.options.itemClass),this.updateSortData(n,!0),n},_init:function(e){this.$filteredAtoms=this._filter(this.$allAtoms),this._sort(),this.reLayout(e)},option:function(e){if(t.isPlainObject(e)){this.options=t.extend(!0,this.options,e);var n;for(var r in e)n="_update"+o(r),this[n]&&this[n]()}},_updateAnimationEngine:function(){var e=this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,""),t;switch(e){case"css":case"none":t=!1;break;case"jquery":t=!0;break;default:t=!s.csstransitions}this.isUsingJQueryAnimation=t,this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var e=this.usingTransforms=this.options.transformsEnabled&&s.csstransforms&&s.csstransitions&&!this.isUsingJQueryAnimation;e||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale),this.getPositionStyles=e?this._translate:this._positionAbs},_filter:function(e){var t=this.options.filter===""?"*":this.options.filter;if(!t)return e;var n=this.options.hiddenClass,r="."+n,i=e.filter(r),s=i;if(t!=="*"){s=i.filter(t);var o=e.not(r).not(t).addClass(n);this.styleQueue.push({$el:o,style:this.options.hiddenStyle})}return this.styleQueue.push({$el:s,style:this.options.visibleStyle}),s.removeClass(n),e.filter(t)},updateSortData:function(e,n){var r=this,i=this.options.getSortData,s,o;e.each(function(){s=t(this),o={};for(var e in i)!n&&e==="original-order"?o[e]=t.data(this,"isotope-sort-data")[e]:o[e]=i[e](s,r);t.data(this,"isotope-sort-data",o)})},_sort:function(){var e=this.options.sortBy,t=this._getSorter,n=this.options.sortAscending?1:-1,r=function(r,i){var s=t(r,e),o=t(i,e);return s===o&&e!=="original-order"&&(s=t(r,"original-order"),o=t(i,"original-order")),(s>o?1:s<o?-1:0)*n};this.$filteredAtoms.sort(r)},_getSorter:function(e,n){return t.data(e,"isotope-sort-data")[n]},_translate:function(e,t){return{translate:[e,t]}},_positionAbs:function(e,t){return{left:e,top:t}},_pushPosition:function(e,t,n){t=Math.round(t+this.offset.left),n=Math.round(n+this.offset.top);var r=this.getPositionStyles(t,n);this.styleQueue.push({$el:e,style:r}),this.options.itemPositionDataEnabled&&e.data("isotope-item-position",{x:t,y:n})},layout:function(e,t){var n=this.options.layoutMode;this["_"+n+"Layout"](e);if(this.options.resizesContainer){var r=this["_"+n+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:r})}this._processStyleQueue(e,t),this.isLaidOut=!0},_processStyleQueue:function(e,n){var r=this.isLaidOut?this.isUsingJQueryAnimation?"animate":"css":"css",i=this.options.animationOptions,o=this.options.onLayout,u,a,f,l;a=function(e,t){t.$el[r](t.style,i)};if(this._isInserting&&this.isUsingJQueryAnimation)a=function(e,t){u=t.$el.hasClass("no-transition")?"css":r,t.$el[u](t.style,i)};else if(n||o||i.complete){var c=!1,h=[n,o,i.complete],p=this;f=!0,l=function(){if(c)return;var t;for(var n=0,r=h.length;n<r;n++)t=h[n],typeof t=="function"&&t.call(p.element,e,p);c=!0};if(this.isUsingJQueryAnimation&&r==="animate")i.complete=l,f=!1;else if(s.csstransitions){var d=0,v=this.styleQueue[0],m=v&&v.$el,b;while(!m||!m.length){b=this.styleQueue[d++];if(!b)return;m=b.$el}var w=parseFloat(getComputedStyle(m[0])[y]);w>0&&(a=function(e,t){t.$el[r](t.style,i).one(g,l)},f=!1)}}t.each(this.styleQueue,a),f&&l(),this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(e){this["_"+this.options.layoutMode+"Reset"](),this.layout(this.$filteredAtoms,e)},addItems:function(e,t){var n=this._getAtoms(e);this.$allAtoms=this.$allAtoms.add(n),t&&t(n)},insert:function(e,t){this.element.append(e);var n=this;this.addItems(e,function(e){var r=n._filter(e);n._addHideAppended(r),n._sort(),n.reLayout(),n._revealAppended(r,t)})},appended:function(e,t){var n=this;this.addItems(e,function(e){n._addHideAppended(e),n.layout(e),n._revealAppended(e,t)})},_addHideAppended:function(e){this.$filteredAtoms=this.$filteredAtoms.add(e),e.addClass("no-transition"),this._isInserting=!0,this.styleQueue.push({$el:e,style:this.options.hiddenStyle})},_revealAppended:function(e,t){var n=this;setTimeout(function(){e.removeClass("no-transition"),n.styleQueue.push({$el:e,style:n.options.visibleStyle}),n._isInserting=!1,n._processStyleQueue(e,t)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(e,t){this.$allAtoms=this.$allAtoms.not(e),this.$filteredAtoms=this.$filteredAtoms.not(e);var n=this,r=function(){e.remove(),t&&t.call(n.element)};e.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:e,style:this.options.hiddenStyle}),this._sort(),this.reLayout(r)):r()},shuffle:function(e){this.updateSortData(this.$allAtoms),this.options.sortBy="random",this._sort(),this.reLayout(e)},destroy:function(){var e=this.usingTransforms,t=this.options;this.$allAtoms.removeClass(t.hiddenClass+" "+t.itemClass).each(function(){var t=this.style;t.position="",t.top="",t.left="",t.opacity="",e&&(t[f]="")});var n=this.element[0].style;for(var r in this.originalStyle)n[r]=this.originalStyle[r];this.element.unbind(".isotope").undelegate("."+t.hiddenClass,"click").removeClass(t.containerClass).removeData("isotope"),x.unbind(".isotope")},_getSegments:function(e){var t=this.options.layoutMode,n=e?"rowHeight":"columnWidth",r=e?"height":"width",i=e?"rows":"cols",s=this.element[r](),u,a=this.options[t]&&this.options[t][n]||this.$filteredAtoms["outer"+o(r)](!0)||s;u=Math.floor(s/a),u=Math.max(u,1),this[t][i]=u,this[t][n]=a},_checkIfSegmentsChanged:function(e){var t=this.options.layoutMode,n=e?"rows":"cols",r=this[t][n];return this._getSegments(e),this[t][n]!==r},_masonryReset:function(){this.masonry={},this._getSegments();var e=this.masonry.cols;this.masonry.colYs=[];while(e--)this.masonry.colYs.push(0)},_masonryLayout:function(e){var n=this,r=n.masonry;e.each(function(){var e=t(this),i=Math.ceil(e.outerWidth(!0)/r.columnWidth);i=Math.min(i,r.cols);if(i===1)n._masonryPlaceBrick(e,r.colYs);else{var s=r.cols+1-i,o=[],u,a;for(a=0;a<s;a++)u=r.colYs.slice(a,a+i),o[a]=Math.max.apply(Math,u);n._masonryPlaceBrick(e,o)}})},_masonryPlaceBrick:function(e,t){var n=Math.min.apply(Math,t),r=0;for(var i=0,s=t.length;i<s;i++)if(t[i]===n){r=i;break}var o=this.masonry.columnWidth*r,u=n;this._pushPosition(e,o,u);var a=n+e.outerHeight(!0),f=this.masonry.cols+1-s;for(i=0;i<f;i++)this.masonry.colYs[r+i]=a},_masonryGetContainerSize:function(){var e=Math.max.apply(Math,this.masonry.colYs);return{height:e}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(e){var n=this,r=this.element.width(),i=this.fitRows;e.each(function(){var e=t(this),s=e.outerWidth(!0),o=e.outerHeight(!0);i.x!==0&&s+i.x>r&&(i.x=0,i.y=i.height),n._pushPosition(e,i.x,i.y),i.height=Math.max(i.y+o,i.height),i.x+=s})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return!0},_cellsByRowReset:function(){this.cellsByRow={index:0},this._getSegments(),this._getSegments(!0)},_cellsByRowLayout:function(e){var n=this,r=this.cellsByRow;e.each(function(){var e=t(this),i=r.index%r.cols,s=Math.floor(r.index/r.cols),o=(i+.5)*r.columnWidth-e.outerWidth(!0)/2,u=(s+.5)*r.rowHeight-e.outerHeight(!0)/2;n._pushPosition(e,o,u),r.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function(e){var n=this;e.each(function(e){var r=t(this);n._pushPosition(r,0,n.straightDown.y),n.straightDown.y+=r.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return!0},_masonryHorizontalReset:function(){this.masonryHorizontal={},this._getSegments(!0);var e=this.masonryHorizontal.rows;this.masonryHorizontal.rowXs=[];while(e--)this.masonryHorizontal.rowXs.push(0)},_masonryHorizontalLayout:function(e){var n=this,r=n.masonryHorizontal;e.each(function(){var e=t(this),i=Math.ceil(e.outerHeight(!0)/r.rowHeight);i=Math.min(i,r.rows);if(i===1)n._masonryHorizontalPlaceBrick(e,r.rowXs);else{var s=r.rows+1-i,o=[],u,a;for(a=0;a<s;a++)u=r.rowXs.slice(a,a+i),o[a]=Math.max.apply(Math,u);n._masonryHorizontalPlaceBrick(e,o)}})},_masonryHorizontalPlaceBrick:function(e,t){var n=Math.min.apply(Math,t),r=0;for(var i=0,s=t.length;i<s;i++)if(t[i]===n){r=i;break}var o=n,u=this.masonryHorizontal.rowHeight*r;this._pushPosition(e,o,u);var a=n+e.outerWidth(!0),f=this.masonryHorizontal.rows+1-s;for(i=0;i<f;i++)this.masonryHorizontal.rowXs[r+i]=a},_masonryHorizontalGetContainerSize:function(){var e=Math.max.apply(Math,this.masonryHorizontal.rowXs);return{width:e}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function(e){var n=this,r=this.element.height(),i=this.fitColumns;e.each(function(){var e=t(this),s=e.outerWidth(!0),o=e.outerHeight(!0);i.y!==0&&o+i.y>r&&(i.x=i.width,i.y=0),n._pushPosition(e,i.x,i.y),i.width=Math.max(i.x+s,i.width),i.y+=o})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return!0},_cellsByColumnReset:function(){this.cellsByColumn={index:0},this._getSegments(),this._getSegments(!0)},_cellsByColumnLayout:function(e){var n=this,r=this.cellsByColumn;e.each(function(){var e=t(this),i=Math.floor(r.index/r.rows),s=r.index%r.rows,o=(i+.5)*r.columnWidth-e.outerWidth(!0)/2,u=(s+.5)*r.rowHeight-e.outerHeight(!0)/2;n._pushPosition(e,o,u),r.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function(e){var n=this;e.each(function(e){var r=t(this);n._pushPosition(r,n.straightAcross.x,0),n.straightAcross.x+=r.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return!0}},t.fn.imagesLoaded=function(e){function n(){e.call(i,s)}function r(e){var i=e.target;i.src!==u&&t.inArray(i,a)===-1&&(a.push(i),--o<=0&&(setTimeout(n),s.unbind(".imagesLoaded",r)))}var i=this,s=i.find("img").add(i.filter("img")),o=s.length,u="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",a=[];return o||n(),s.bind("load.imagesLoaded error.imagesLoaded",r).each(function(){var e=this.src;this.src=u,this.src=e}),i};var T=function(e){n.console&&n.console.error(e)};t.fn.isotope=function(e,n){if(typeof e=="string"){var r=Array.prototype.slice.call(arguments,1);this.each(function(){var n=t.data(this,"isotope");if(!n){T("cannot call methods on isotope prior to initialization; attempted to call method '"+e+"'");return}if(!t.isFunction(n[e])||e.charAt(0)==="_"){T("no such method '"+e+"' for isotope instance");return}n[e].apply(n,r)})}else this.each(function(){var r=t.data(this,"isotope");r?(r.option(e),r._init(n)):t.data(this,"isotope",new t.Isotope(e,this,n))});return this}}function plugin_jquery_jScrollPane(e){var t=e,n=window,r=undefined;t.fn.jScrollPane=function(e){function n(e,n){function $(n){var s,g,y,E,S,T,N=false,C=false;i=n;if(o===r){S=e.scrollTop();T=e.scrollLeft();e.css({overflow:"hidden",padding:0});u=e.innerWidth()+I;a=e.innerHeight();e.width(u);o=t('<div class="jspPane" />').css("padding",F).append(e.children());f=t('<div class="jspContainer" />').css({width:u+"px",height:a+"px"}).append(o).appendTo(e)}else{e.css("width","");N=i.stickToBottom&&mt();C=i.stickToRight&&gt();E=e.innerWidth()+I!=u||e.outerHeight()!=a;if(E){u=e.innerWidth()+I;a=e.innerHeight();f.css({width:u+"px",height:a+"px"})}if(!E&&q==l&&o.outerHeight()==h){e.width(u);return}q=l;o.css("width","");e.width(u);f.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}o.css("overflow","auto");if(n.contentWidth){l=n.contentWidth}else{l=o[0].scrollWidth}h=o[0].scrollHeight;o.css("overflow","");p=l/u;d=h/a;v=d>1;m=p>1;if(!(m||v)){e.removeClass("jspScrollable");o.css({top:0,width:f.width()-I});bt();St();Tt();rt();Ct()}else{e.addClass("jspScrollable");s=i.maintainPosition&&(w||x);if(s){g=dt();y=vt()}J();Q();Y();if(s){ht(C?l-u:g,false);ct(N?h-a:y,false)}Et();yt();Lt();if(i.enableKeyboardNavigation){xt()}if(i.clickOnTrack){nt()}Nt();if(i.hijackInternalLinks){kt()}}if(i.autoReinitialise&&!j){j=setInterval(function(){$(i)},i.autoReinitialiseDelay)}else{if(!i.autoReinitialise&&j){clearInterval(j)}}S&&e.scrollTop(0)&&ct(S,false);T&&e.scrollLeft(0)&&ht(T,false);e.trigger("jsp-initialised",[m||v])}function J(){if(v){f.append(t('<div class="jspVerticalBar" />').append(t('<div class="jspCap jspCapTop" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragTop" />'),t('<div class="jspDragBottom" />'))),t('<div class="jspCap jspCapBottom" />')));T=f.find(">.jspVerticalBar");N=T.find(">.jspTrack");g=N.find(">.jspDrag");if(i.showArrows){A=t('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",et(0,-1)).bind("click.jsp",wt);O=t('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",et(0,1)).bind("click.jsp",wt);if(i.arrowScrollOnHover){A.bind("mouseover.jsp",et(0,-1,A));O.bind("mouseover.jsp",et(0,1,O))}Z(N,i.verticalArrowPositions,A,O)}k=a;f.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){k-=t(this).outerHeight()});g.hover(function(){g.addClass("jspHover")},function(){g.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",wt);g.addClass("jspActive");var n=e.pageY-g.position().top;t("html").bind("mousemove.jsp",function(e){st(e.pageY-n,false)}).bind("mouseup.jsp mouseleave.jsp",it);return false});K()}}function K(){N.height(k+"px");w=0;C=i.verticalGutter+N.outerWidth();o.width(u-C-I);try{if(T.position().left===0){o.css("margin-left",C+"px")}}catch(e){}}function Q(){if(m){f.append(t('<div class="jspHorizontalBar" />').append(t('<div class="jspCap jspCapLeft" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragLeft" />'),t('<div class="jspDragRight" />'))),t('<div class="jspCap jspCapRight" />')));M=f.find(">.jspHorizontalBar");_=M.find(">.jspTrack");E=_.find(">.jspDrag");if(i.showArrows){H=t('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",et(-1,0)).bind("click.jsp",wt);B=t('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",et(1,0)).bind("click.jsp",wt);if(i.arrowScrollOnHover){H.bind("mouseover.jsp",et(-1,0,H));B.bind("mouseover.jsp",et(1,0,B))}Z(_,i.horizontalArrowPositions,H,B)}E.hover(function(){E.addClass("jspHover")},function(){E.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",wt);E.addClass("jspActive");var n=e.pageX-E.position().left;t("html").bind("mousemove.jsp",function(e){ut(e.pageX-n,false)}).bind("mouseup.jsp mouseleave.jsp",it);return false});D=f.innerWidth();G()}}function G(){f.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){D-=t(this).outerWidth()});_.width(D+"px");x=0}function Y(){if(m&&v){var e=_.outerHeight(),n=N.outerWidth();k-=e;t(M).find(">.jspCap:visible,>.jspArrow").each(function(){D+=t(this).outerWidth()});D-=n;a-=n;u-=e;_.parent().append(t('<div class="jspCorner" />').css("width",e+"px"));K();G()}if(m){o.width(f.outerWidth()-I+"px")}h=o.outerHeight();d=h/a;if(m){P=Math.ceil(1/p*D);if(P>i.horizontalDragMaxWidth){P=i.horizontalDragMaxWidth}else{if(P<i.horizontalDragMinWidth){P=i.horizontalDragMinWidth}}E.width(P+"px");S=D-P;at(x)}if(v){L=Math.ceil(1/d*k);if(L>i.verticalDragMaxHeight){L=i.verticalDragMaxHeight}else{if(L<i.verticalDragMinHeight){L=i.verticalDragMinHeight}}g.height(L+"px");y=k-L;ot(w)}}function Z(e,t,n,r){var i="before",s="after",o;if(t=="os"){t=/Mac/.test(navigator.platform)?"after":"split"}if(t==i){s=t}else{if(t==s){i=t;o=n;n=r;r=o}}e[i](n)[s](r)}function et(e,t,n){return function(){tt(e,t,this,n);this.blur();return false}}function tt(e,n,r,o){r=t(r).addClass("jspActive");var u,a,f=true,l=function(){if(e!==0){s.scrollByX(e*i.arrowButtonSpeed)}if(n!==0){s.scrollByY(n*i.arrowButtonSpeed)}a=setTimeout(l,f?i.initialDelay:i.arrowRepeatFreq);f=false};l();u=o?"mouseout.jsp":"mouseup.jsp";o=o||t("html");o.bind(u,function(){r.removeClass("jspActive");a&&clearTimeout(a);a=null;o.unbind(u)})}function nt(){rt();if(v){N.bind("mousedown.jsp",function(e){if(e.originalTarget===r||e.originalTarget==e.currentTarget){var n=t(this),o=n.offset(),u=e.pageY-o.top-w,f,l=true,p=function(){var t=n.offset(),r=e.pageY-t.top-L/2,o=a*i.scrollPagePercent,c=y*o/(h-a);if(u<0){if(w-c>r){s.scrollByY(-o)}else{st(r)}}else{if(u>0){if(w+c<r){s.scrollByY(o)}else{st(r)}}else{d();return}}f=setTimeout(p,l?i.initialDelay:i.trackClickRepeatFreq);l=false},d=function(){f&&clearTimeout(f);f=null;t(document).unbind("mouseup.jsp",d)};p();t(document).bind("mouseup.jsp",d);return false}})}if(m){_.bind("mousedown.jsp",function(e){if(e.originalTarget===r||e.originalTarget==e.currentTarget){var n=t(this),o=n.offset(),a=e.pageX-o.left-x,f,h=true,p=function(){var t=n.offset(),r=e.pageX-t.left-P/2,o=u*i.scrollPagePercent,c=S*o/(l-u);if(a<0){if(x-c>r){s.scrollByX(-o)}else{ut(r)}}else{if(a>0){if(x+c<r){s.scrollByX(o)}else{ut(r)}}else{d();return}}f=setTimeout(p,h?i.initialDelay:i.trackClickRepeatFreq);h=false},d=function(){f&&clearTimeout(f);f=null;t(document).unbind("mouseup.jsp",d)};p();t(document).bind("mouseup.jsp",d);return false}})}}function rt(){if(_){_.unbind("mousedown.jsp")}if(N){N.unbind("mousedown.jsp")}}function it(){t("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(g){g.removeClass("jspActive")}if(E){E.removeClass("jspActive")}}function st(e,t){if(!v){return}if(e<0){e=0}else{if(e>y){e=y}}if(t===r){t=i.animateScroll}if(t){s.animate(g,"top",e,ot)}else{g.css("top",e);ot(e)}}function ot(t){if(t===r){t=g.position().top}f.scrollTop(0);w=t;var n=w===0,i=w==y,s=t/y,u=-s*(h-a);if(R!=n||z!=i){R=n;z=i;e.trigger("jsp-arrow-change",[R,z,U,W])}ft(n,i);o.css("top",u);e.trigger("jsp-scroll-y",[-u,n,i]).trigger("scroll")}function ut(e,t){if(!m){return}if(e<0){e=0}else{if(e>S){e=S}}if(t===r){t=i.animateScroll}if(t){s.animate(E,"left",e,at)}else{E.css("left",e);at(e)}}function at(t){if(t===r){t=E.position().left}f.scrollTop(0);x=t;var n=x===0,i=x==S,s=t/S,a=-s*(l-u);if(U!=n||W!=i){U=n;W=i;e.trigger("jsp-arrow-change",[R,z,U,W])}lt(n,i);o.css("left",a);e.trigger("jsp-scroll-x",[-a,n,i]).trigger("scroll")}function ft(e,t){if(i.showArrows){A[e?"addClass":"removeClass"]("jspDisabled");O[t?"addClass":"removeClass"]("jspDisabled")}}function lt(e,t){if(i.showArrows){H[e?"addClass":"removeClass"]("jspDisabled");B[t?"addClass":"removeClass"]("jspDisabled")}}function ct(e,t){var n=e/(h-a);st(n*y,t)}function ht(e,t){var n=e/(l-u);ut(n*S,t)}function pt(e,n,r){var s,o,l,c=0,h=0,p,d,v,m,g,y;try{s=t(e)}catch(w){return}o=s.outerHeight();l=s.outerWidth();f.scrollTop(0);f.scrollLeft(0);while(!s.is(".jspPane")){c+=s.position().top;h+=s.position().left;s=s.offsetParent();if(/^body|html$/i.test(s[0].nodeName)){return}}p=vt();v=p+a;if(c<p||n){g=c-i.verticalGutter}else{if(c+o>v){g=c-a+o+i.verticalGutter}}if(g){ct(g,r)}d=dt();m=d+u;if(h<d||n){y=h-i.horizontalGutter}else{if(h+l>m){y=h-u+l+i.horizontalGutter}}if(y){ht(y,r)}}function dt(){return-o.position().left}function vt(){return-o.position().top}function mt(){var e=h-a;return e>20&&e-vt()<10}function gt(){var e=l-u;return e>20&&e-dt()<10}function yt(){f.unbind(V).bind(V,function(e,t,n,r){var o=x,u=w;s.scrollBy(n*i.mouseWheelSpeed,-r*i.mouseWheelSpeed,false);return o==x&&u==w})}function bt(){f.unbind(V)}function wt(){return false}function Et(){o.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){pt(e.target,false)})}function St(){o.find(":input,a").unbind("focus.jsp")}function xt(){function l(){var e=x,t=w;switch(n){case 40:s.scrollByY(i.keyboardSpeed,false);break;case 38:s.scrollByY(-i.keyboardSpeed,false);break;case 34:case 32:s.scrollByY(a*i.scrollPagePercent,false);break;case 33:s.scrollByY(-a*i.scrollPagePercent,false);break;case 39:s.scrollByX(i.keyboardSpeed,false);break;case 37:s.scrollByX(-i.keyboardSpeed,false);break}r=e!=x||t!=w;return r}var n,r,u=[];m&&u.push(M[0]);v&&u.push(T[0]);o.focus(function(){e.focus()});e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target!==this&&!(u.length&&t(e.target).closest(u).length)){return}var i=x,s=w;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=e.keyCode;l();break;case 35:ct(h-a);n=null;break;case 36:ct(0);n=null;break}r=e.keyCode==n&&i!=x||s!=w;return!r}).bind("keypress.jsp",function(e){if(e.keyCode==n){l()}return!r});if(i.hideFocus){e.css("outline","none");if("hideFocus"in f[0]){e.attr("hideFocus",true)}}else{e.css("outline","");if("hideFocus"in f[0]){e.attr("hideFocus",false)}}}function Tt(){e.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function Nt(){if(location.hash&&location.hash.length>1){var e,n;try{e=t(location.hash)}catch(r){return}if(e.length&&o.find(location.hash)){if(f.scrollTop()===0){n=setInterval(function(){if(f.scrollTop()>0){pt(location.hash,true);t(document).scrollTop(f.position().top);clearInterval(n)}},50)}else{pt(location.hash,true);t(document).scrollTop(f.position().top)}}}}function Ct(){t("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function kt(){Ct();t("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var e=this.href.split("#"),t;if(e.length>1){t=e[1];if(t.length>0&&o.find("#"+t).length>0){pt("#"+t,true);return false}}})}function Lt(){var e,t,n,r,i,o=false;f.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(s){var u=s.originalEvent.touches[0];e=dt();t=vt();n=u.pageX;r=u.pageY;i=false;o=true}).bind("touchmove.jsp",function(u){if(!o){return}var a=u.originalEvent.touches[0],f=x,l=w;s.scrollTo(e+n-a.pageX,t+r-a.pageY);i=i||Math.abs(n-a.pageX)>5||Math.abs(r-a.pageY)>5;return f==x&&l==w}).bind("touchend.jsp",function(e){o=false}).bind("click.jsp-touchclick",function(e){if(i){i=false;return false}})}function At(){var t=vt(),n=dt();e.removeClass("jspScrollable").unbind(".jsp");e.replaceWith(X.append(o.children()));X.scrollTop(t);X.scrollLeft(n)}var i,s=this,o,u,a,f,l,h,p,d,v,m,g,y,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R=true,U=true,z=false,W=false,X=e.clone(false,false).empty(),V=t.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";F=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft");I=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0);t.extend(s,{reinitialise:function(e){e=t.extend({},i,e);$(e)},scrollToElement:function(e,t,n){pt(e,t,n)},scrollTo:function(e,t,n){ht(e,n);ct(t,n)},scrollToX:function(e,t){ht(e,t)},scrollToY:function(e,t){ct(e,t)},scrollToPercentX:function(e,t){ht(e*(l-u),t)},scrollToPercentY:function(e,t){ct(e*(h-a),t)},scrollBy:function(e,t,n){s.scrollByX(e,n);s.scrollByY(t,n)},scrollByX:function(e,t){e=e>=0?Math.max(e,1):Math.min(e,-1);var n=dt()+e,r=n/(l-u);ut(r*S,t)},scrollByY:function(e,t){e=e>=0?Math.max(e,1):Math.min(e,-1);var n=vt()+e,r=n/(h-a);st(r*y,t)},positionDragX:function(e,t){ut(e,t)},positionDragY:function(e,t){st(e,t)},animate:function(e,t,n,r){var s={};s[t]=n;e.animate(s,{duration:i.animateDuration,ease:i.animateEase,queue:false,step:r})},getContentPositionX:function(){return dt()},getContentPositionY:function(){return vt()},getContentWidth:function(){return l},getContentHeight:function(){return h},getPercentScrolledX:function(){return dt()/(l-u)},getPercentScrolledY:function(){return vt()/(h-a)},getIsScrollableH:function(){return m},getIsScrollableV:function(){return v},getContentPane:function(){return o},scrollToBottom:function(e){st(y,e)},hijackInternalLinks:function(){kt()},destroy:function(){At()}});$(n)}e=t.extend({},t.fn.jScrollPane.defaults,e);t.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed});return this.each(function(){var r=t(this),i=r.data("jsp");if(i){i.reinitialise(e)}else{i=new n(r,e);r.data("jsp",i)}})};t.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:r,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}function plugin_jquery_twitterTip(e){!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t;this.$element=e(n);this.options=this.getOptions(r);this.enabled=true;if(this.options.trigger!="manual"){i=this.options.trigger=="hover"?"mouseenter":"focus";s=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.bind(i,this.options.selector,e.proxy(this.enter,this));this.$element.bind(s,this.options.selector,e.proxy(this.leave,this))}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){t=e.extend({},e.fn[this.type].defaults,t,this.$element.data());if(t.delay&&typeof t.delay=="number"){t.delay={show:t.delay,hide:t.delay}}return t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show){n.show()}else{n.hoverState="in";setTimeout(function(){if(n.hoverState=="in"){n.show()}},n.options.delay.show)}},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.hide){n.hide()}else{n.hoverState="out";setTimeout(function(){if(n.hoverState=="out"){n.hide()}},n.options.delay.hide)}},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip();this.setContent();if(this.options.animation){e.addClass("rdr_tw_fade")}s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement;t=/rdr_tw_in/.test(s);e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body);n=this.getPosition(t);r=e[0].offsetWidth;i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i-5,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width};break}e.css(o).addClass("rdr_tw_"+s).addClass("rdr_tw_in")}},setContent:function(){var e=this.tip();e.find(".rdr_twtooltip-inner").html(this.getTitle());e.removeClass("rdr_tw_fade rdr_tw_in rdr_tw_top rdr_tw_bottom rdr_tw_left rdr_tw_right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t);n.remove()})}var t=this,n=this.tip();n.removeClass("rdr_tw_in");e.support.transition&&this.$tip.hasClass("rdr_tw_fade")?r():n.remove();if(e.support.transition&&this.$tip.hasClass("rdr_tw_fade")){}else{}},fixTitle:function(){var e=this.$element;if(e.attr("title")||typeof e.attr("data-original-title")!="string"){e.attr("data-original-title",e.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title);e=(e||"").toString().replace(/(^\s*|\s*$)/,"");return e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("rdr_tw_in")?"hide":"show"]()}};e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;if(!i)r.data("tooltip",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.tooltip.Constructor=t;e.fn.tooltip.defaults={animation:true,delay:0,selector:false,placement:"top",trigger:"hover",title:"",template:'<div class="rdr rdr_twtooltip"><div class="rdr_twtooltip-arrow"></div><div class="rdr_twtooltip-inner"></div></div>'}}(e)}function plugin_rangy(){var e="ins";var t=function(){function e(e,t){var n=typeof e[t];return n=="function"||!!(n=="object"&&e[t])||n=="unknown"}function t(e,t){return!!(typeof e[t]=="object"&&e[t])}function n(e,t){return typeof e[t]!="undefined"}function r(e){return function(t,n){for(var r=n.length;r--;)if(!e(t,n[r]))return false;return true}}function i(e){return e&&h(e,c)&&d(e,l)}function s(e){window.alert("Rangy not supported in your browser. Reason: "+e);v.initialized=true;v.supported=false}function o(){if(!v.initialized){var n,r=false,o=false;if(e(document,"createRange")){n=document.createRange();if(h(n,f)&&d(n,a))r=true;n.detach()}if((n=t(document,"body")?document.body:document.getElementsByTagName("body")[0])&&e(n,"createTextRange")){n=n.createTextRange();if(i(n))o=true}!r&&!o&&s("Neither Range nor TextRange are implemented");v.initialized=true;v.features={implementsDomRange:r,implementsTextRange:o};r=g.concat(m);o=0;for(n=r.length;o<n;++o)try{r[o](v)}catch(u){t(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",u)}}}function u(e){this.name=e;this.supported=this.initialized=false}var a=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],f=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],l=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],c=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint"],h=r(e),p=r(t),d=r(n),v={version:"1.2beta2",initialized:false,supported:true,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:h,areHostObjects:p,areHostProperties:d,isTextRange:i},features:{},modules:{},config:{alertOnWarn:false,preferTextRange:false}};v.fail=s;v.warn=function(e){e="Rangy warning: "+e;if(v.config.alertOnWarn)window.alert(e);else typeof window.console!="undefined"&&typeof window.console.log!="undefined"&&window.console.log(e)};if({}.hasOwnProperty)v.util.extend=function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};else s("hasOwnProperty not supported");var m=[],g=[];v.init=o;v.addInitListener=function(e){v.initialized?e(v):m.push(e)};var y=[];v.addCreateMissingNativeApiListener=function(e){y.push(e)};v.createMissingNativeApi=function(e){e=e||window;o();for(var t=0,n=y.length;t<n;++t)y[t](e)};u.prototype.fail=function(e){this.initialized=true;this.supported=false;throw Error("Module '"+this.name+"' failed to load: "+e)};u.prototype.warn=function(e){v.warn("Module "+this.name+": "+e)};u.prototype.createError=function(e){return Error("Error in Rangy "+this.name+" module: "+e)};v.createModule=function(e,t){var n=new u(e);v.modules[e]=n;g.push(function(e){t(e,n);n.initialized=true;n.supported=true})};v.requireModules=function(e){for(var t=0,n=e.length,r,i;t<n;++t){i=e[t];r=v.modules[i];if(!r||!(r instanceof u))throw Error("Module '"+i+"' not found");if(!r.supported)throw Error("Module '"+i+"' not supported")}};var b=false;p=function(){if(!b){b=true;v.initialized||o()}};if(typeof window=="undefined")s("No window found");else if(typeof document=="undefined")s("No document found");else{e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",p,false);if(e(window,"addEventListener"))window.addEventListener("load",p,false);else e(window,"attachEvent")?window.attachEvent("onload",p):s("Window does not have required addEventListener or attachEvent method");return v}}();t.createModule("DomUtil",function(e,t){function n(e){for(var t=0;e=e.previousSibling;)t++;return t}function r(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(d(n,r))return r;return null}function i(e,t,n){for(n=n?e:e.parentNode;n;){e=n.parentNode;if(e===t)return n;n=e}return null}function s(e){e=e.nodeType;return e==3||e==4||e==8}function o(e,t){var n=t.nextSibling,r=t.parentNode;n?r.insertBefore(e,n):r.appendChild(e);return e}function u(e){if(e.nodeType==9)return e;else if(typeof e.ownerDocument!="undefined")return e.ownerDocument;else if(typeof e.document!="undefined")return e.document;else if(e.parentNode)return u(e.parentNode);else throw Error("getDocument: no document found for node")}function a(e){if(!e)return"[No node]";return s(e)?'"'+e.data+'"':e.nodeType==1?"<"+e.nodeName+(e.id?' id="'+e.id+'"':"")+">["+e.childNodes.length+"]":e.nodeName}function f(e){this._next=this.root=e}function l(e,t){this.node=e;this.offset=t}function c(e){this.code=this[e];this.codeName=e;this.message="DOMException: "+this.codeName}var h=e.util;h.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method");h.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var p=document.createElement("div");h.areHostMethods(p,["insertBefore","appendChild","cloneNode"])||t.fail("Incomplete Element implementation");p=document.createTextNode("test");h.areHostMethods(p,["splitText","deleteData","insertData","appendData","cloneNode"])||t.fail("Incomplete Text Node implementation");var d=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return true;return false};f.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t;if(this._current)if(t=e.firstChild)this._next=t;else{for(t=null;e!==this.root&&!(t=e.nextSibling);)e=e.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}};l.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+a(this.node)+":"+this.offset+")]"}};c.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};c.prototype.toString=function(){return this.message};e.dom={arrayContains:d,getNodeIndex:n,getNodeLength:function(e){var t;return s(e)?e.length:(t=e.childNodes)?t.length:0},getCommonAncestor:r,isAncestorOf:function(e,t,n){for(t=n?t:t.parentNode;t;)if(t===e)return true;else t=t.parentNode;return false},getClosestAncestorIn:i,isCharacterDataNode:s,insertAfter:o,splitDataNode:function(e,t){var n=e.cloneNode(false);n.deleteData(0,t);e.deleteData(t,e.length-t);o(n,e);return n},getDocument:u,getWindow:function(e){e=u(e);if(typeof e.defaultView!="undefined")return e.defaultView;else if(typeof e.parentWindow!="undefined")return e.parentWindow;else throw Error("Cannot get a window object for node")},getIframeWindow:function(e){if(typeof e.contentWindow!="undefined")return e.contentWindow;else if(typeof e.contentDocument!="undefined")return e.contentDocument.defaultView;else throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(e){if(typeof e.contentDocument!="undefined")return e.contentDocument;else if(typeof e.contentWindow!="undefined")return e.contentWindow.document;else throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(e){return h.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]},getRootContainer:function(e){for(var t;t=e.parentNode;)e=t;return e},comparePoints:function(e,t,s,o){var u;if(e==s)return t===o?0:t<o?-1:1;else if(u=i(s,e,true))return t<=n(u)?-1:1;else if(u=i(e,s,true))return n(u)<o?-1:1;else{t=r(e,s);e=e===t?t:i(e,t,true);s=s===t?t:i(s,t,true);if(e===s)throw Error("comparePoints got to case 4 and childA and childB are the same!");else{for(t=t.firstChild;t;){if(t===e)return-1;else if(t===s)return 1;t=t.nextSibling}throw Error("Should not be here!")}}},inspectNode:a,createIterator:function(e){return new f(e)},DomPosition:l};e.DOMException=c});t.createModule("DomRange",function(e){function t(e,t){return e.nodeType!=3&&(D.isAncestorOf(e,t.startContainer,true)||D.isAncestorOf(e,t.endContainer,true))}function n(e){return D.getDocument(e.startContainer)}function r(e,t,n){if(t=e._listeners[t])for(var r=0,i=t.length;r<i;++r)t[r].call(e,{target:e,args:n})}function i(e){return new P(e.parentNode,D.getNodeIndex(e))}function s(e){return new P(e.parentNode,D.getNodeIndex(e)+1)}function o(e,t,n){var r=e.nodeType==11?e.firstChild:e;if(D.isCharacterDataNode(t))n==t.length?D.insertAfter(e,t):t.parentNode.insertBefore(e,n==0?t:D.splitDataNode(t,n));else n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]);return r}function u(e){for(var t,r,i=n(e.range).createDocumentFragment();r=e.next();){t=e.isPartiallySelectedSubtree();r=r.cloneNode(!t);if(t){t=e.getSubtreeIterator();r.appendChild(u(t));t.detach(true)}if(r.nodeType==10)throw new H("HIERARCHY_REQUEST_ERR");i.appendChild(r)}return i}function a(e,t,n){var r,i;for(n=n||{stop:false};r=e.next();)if(e.isPartiallySelectedSubtree())if(t(r)===false){n.stop=true;return}else{r=e.getSubtreeIterator();a(r,t,n);r.detach(true);if(n.stop)return}else for(r=D.createIterator(r);i=r.next();)if(t(i)===false){n.stop=true;return}}function f(e){for(var t;e.next();)if(e.isPartiallySelectedSubtree()){t=e.getSubtreeIterator();f(t);t.detach(true)}else e.remove()}function l(e){for(var t,r=n(e.range).createDocumentFragment(),i;t=e.next();){if(e.isPartiallySelectedSubtree()){t=t.cloneNode(false);i=e.getSubtreeIterator();t.appendChild(l(i));i.detach(true)}else e.remove();if(t.nodeType==10)throw new H("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function c(e,t,n){var r=!!(t&&t.length),i,s=!!n;if(r)i=RegExp("^("+t.join("|")+")$");var o=[];a(new p(e,false),function(e){if((!r||i.test(e.nodeType))&&(!s||n(e)))o.push(e)});return o}function h(e){return"["+(typeof e.getName=="undefined"?"Range":e.getName())+"("+D.inspectNode(e.startContainer)+":"+e.startOffset+", "+D.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){this.range=e;this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer;this.so=e.startOffset;this.ec=e.endContainer;this.eo=e.endOffset;var n=e.commonAncestorContainer;if(this.sc===this.ec&&D.isCharacterDataNode(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=this.sc===n&&!D.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:D.getClosestAncestorIn(this.sc,n,true);this._last=this.ec===n&&!D.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:D.getClosestAncestorIn(this.ec,n,true)}}}function d(e){this.code=this[e];this.codeName=e;this.message="RangeException: "+this.codeName}function v(e,t,n){this.nodes=c(e,t,n);this._next=this.nodes[0];this._position=0}function m(e){return function(t,n){for(var r,i=n?t:t.parentNode;i;){r=i.nodeType;if(D.arrayContains(e,r))return i;i=i.parentNode}return null}}function g(e,t){if(z(e,t))throw new d("INVALID_NODE_TYPE_ERR")}function y(e){if(!e.startContainer)throw new H("INVALID_STATE_ERR")}function b(e,t){if(!D.arrayContains(t,e.nodeType))throw new d("INVALID_NODE_TYPE_ERR")}function w(e,t){if(t<0||t>(D.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new H("INDEX_SIZE_ERR")}function E(e,t){if(R(e,true)!==R(t,true))throw new H("WRONG_DOCUMENT_ERR")}function S(e){if(U(e,true))throw new H("NO_MODIFICATION_ALLOWED_ERR")}function x(e,t){if(!e)throw new H(t)}function T(e){y(e);if(!D.arrayContains(j,e.startContainer.nodeType)&&!R(e.startContainer,true)||!D.arrayContains(j,e.endContainer.nodeType)&&!R(e.endContainer,true)||!(e.startOffset<=(D.isCharacterDataNode(e.startContainer)?e.startContainer.length:e.startContainer.childNodes.length))||!(e.endOffset<=(D.isCharacterDataNode(e.endContainer)?e.endContainer.length:e.endContainer.childNodes.length)))RDR.actions.catchRangyErrors("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function N(){}function C(e){e.START_TO_START=X;e.START_TO_END=V;e.END_TO_END=$;e.END_TO_START=J;e.NODE_BEFORE=K;e.NODE_AFTER=Q;e.NODE_BEFORE_AND_AFTER=G;e.NODE_INSIDE=Y}function k(e){C(e);C(e.prototype)}function L(e,t){return function(){T(this);var n=this.startContainer,r=this.startOffset,i=this.commonAncestorContainer,o=new p(this,true);if(n!==i){n=D.getClosestAncestorIn(n,i,true);r=s(n);n=r.node;r=r.offset}a(o,S);o.reset();i=e(o);o.detach();t(this,n,r,n,r);return i}}function A(n,r,o){function u(e,t){return function(n){y(this);b(n,B);b(q(n),j);n=(e?i:s)(n);(t?a:c)(this,n.node,n.offset)}}function a(e,t,n){var i=e.endContainer,s=e.endOffset;if(t!==e.startContainer||n!==this.startOffset){if(q(t)!=q(i)||D.comparePoints(t,n,i,s)==1){i=t;s=n}r(e,t,n,i,s)}}function c(e,t,n){var i=e.startContainer,s=e.startOffset;if(t!==e.endContainer||n!==this.endOffset){if(q(t)!=q(i)||D.comparePoints(t,n,i,s)==-1){i=t;s=n}r(e,i,s,t,n)}}function h(e,t,n){if(t!==e.startContainer||n!==this.startOffset||t!==e.endContainer||n!==this.endOffset)r(e,t,n,t,n)}n.prototype=new N;e.util.extend(n.prototype,{setStart:function(e,t){y(this);g(e,true);w(e,t);a(this,e,t)},setEnd:function(e,t){y(this);g(e,true);w(e,t);c(this,e,t)},setStartBefore:u(true,true),setStartAfter:u(false,true),setEndBefore:u(true,false),setEndAfter:u(false,false),collapse:function(e){T(this);e?r(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):r(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){y(this);g(e,true);r(this,e,0,e,D.getNodeLength(e))},selectNode:function(e){y(this);g(e,false);b(e,B);var t=i(e);e=s(e);r(this,t.node,t.offset,e.node,e.offset)},extractContents:L(l,r),deleteContents:L(f,r),canSurroundContents:function(){T(this);S(this.startContainer);S(this.endContainer);var e=new p(this,true),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);e.detach();return!n},detach:function(){o(this)},splitBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=e===n;D.isCharacterDataNode(n)&&i>0&&i<n.length&&D.splitDataNode(n,i);if(D.isCharacterDataNode(e)&&t>0&&t<e.length){e=D.splitDataNode(e,t);if(s){i-=t;n=e}else n==e.parentNode&&i>=D.getNodeIndex(e)&&i++;t=0}r(this,e,t,n,i)},normalizeBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=function(e){var t=e.nextSibling;if(t&&t.nodeType==e.nodeType){n=e;i=e.length;e.appendData(t.data);t.parentNode.removeChild(t)}},o=function(r){var s=r.previousSibling;if(s&&s.nodeType==r.nodeType){e=r;var o=r.length;t=s.length;r.insertData(0,s.data);s.parentNode.removeChild(s);if(e==n){i+=t;n=e}else if(n==r.parentNode){s=D.getNodeIndex(r);if(i==s){n=r;i=o}else i>s&&i--}}},u=true;if(D.isCharacterDataNode(n))n.length==i&&s(n);else{if(i>0)(u=n.childNodes[i-1])&&D.isCharacterDataNode(u)&&s(u);u=!this.collapsed}if(u)if(D.isCharacterDataNode(e))t==0&&o(e);else{if(t<e.childNodes.length)(s=e.childNodes[t])&&D.isCharacterDataNode(s)&&o(s)}else{e=n;t=i}r(this,e,t,n,i)},collapseToPoint:function(e,t){T(this);g(e,true);w(e,t);h(this,e,t)}});k(n)}function O(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset;e.commonAncestorContainer=e.collapsed?e.startContainer:D.getCommonAncestor(e.startContainer,e.endContainer)}function M(e,t,n,i,s){var o=e.startContainer!==t||e.startOffset!==n,u=e.endContainer!==i||e.endOffset!==s;e.startContainer=t;e.startOffset=n;e.endContainer=i;e.endOffset=s;O(e);r(e,"boundarychange",{startMoved:o,endMoved:u})}function _(e){this.startContainer=e;this.startOffset=0;this.endContainer=e;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};O(this)}e.requireModules(["DomUtil"]);var D=e.dom,P=D.DomPosition,H=e.DOMException;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;if(e){this._next=e!==this._last?e.nextSibling:null;if(D.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes){if(e===this.ec)(e=e.cloneNode(true)).deleteData(this.eo,e.length-this.eo);if(this._current===this.sc)(e=e.cloneNode(true)).deleteData(0,this.so)}}return e},remove:function(){var e=this._current,t,n;if(D.isCharacterDataNode(e)&&(e===this.sc||e===this.ec)){t=e===this.sc?this.so:0;n=e===this.ec?this.eo:e.length;t!=n&&e.deleteData(t,n-t)}else e.parentNode&&e.parentNode.removeChild(e)},isPartiallySelectedSubtree:function(){return t(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode){e=this.range.cloneRange();e.collapse()}else{e=new _(n(this.range));var t=this._current,r=t,i=0,s=t,o=D.getNodeLength(t);if(D.isAncestorOf(t,this.sc,true)){r=this.sc;i=this.so}if(D.isAncestorOf(t,this.ec,true)){s=this.ec;o=this.eo}M(e,r,i,s,o)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};d.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};d.prototype.toString=function(){return this.message};v.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var B=[1,3,4,5,7,8,10],j=[2,9,11],F=[1,3,4,5,7,8,10,11],I=[1,3,4,5,7,8],q=D.getRootContainer,R=m([9,11]),U=m([5,6,10,12]),z=m([6,10,12]),W=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],X=0,V=1,$=2,J=3,K=0,Q=1,G=2,Y=3;N.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){T(this);E(this.startContainer,t.startContainer);var n=e==J||e==X?"start":"end",r=e==V||e==X?"start":"end";return D.comparePoints(this[n+"Container"],this[n+"Offset"],t[r+"Container"],t[r+"Offset"])},insertNode:function(e){T(this);b(e,F);S(this.startContainer);if(D.isAncestorOf(e,this.startContainer,true))throw new H("HIERARCHY_REQUEST_ERR");this.setStartBefore(o(e,this.startContainer,this.startOffset))},cloneContents:function(){T(this);var e,t;if(this.collapsed)return n(this).createDocumentFragment();else{if(this.startContainer===this.endContainer&&D.isCharacterDataNode(this.startContainer)){e=this.startContainer.cloneNode(true);e.data=e.data.slice(this.startOffset,this.endOffset);t=n(this).createDocumentFragment();t.appendChild(e);return t}else{t=new p(this,true);e=u(t);t.detach()}return e}},canSurroundContents:function(){T(this);S(this.startContainer);S(this.endContainer);var e=new p(this,true),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);e.detach();return!n},surroundContents:function(e){b(e,I);if(!this.canSurroundContents())throw new d("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);o(e,this.startContainer,this.startOffset);e.appendChild(t);this.selectNode(e)},cloneRange:function(){T(this);for(var e=new _(n(this)),t=W.length,r;t--;){r=W[t];e[r]=this[r]}return e},toString:function(){T(this);var e=this.startContainer;if(e===this.endContainer&&D.isCharacterDataNode(e))return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):"";else{var t=[];e=new p(this,true);a(e,function(e){if(e.nodeType==3||e.nodeType==4)t.push(e.data)});e.detach();return t.join("")}},compareNode:function(e){T(this);var t=e.parentNode,n=D.getNodeIndex(e);if(!t)throw new H("NOT_FOUND_ERR");e=this.comparePoint(t,n);t=this.comparePoint(t,n+1);return e<0?t>0?G:K:t>0?Q:Y},comparePoint:function(e,t){T(this);x(e,"HIERARCHY_REQUEST_ERR");E(e,this.startContainer);if(D.comparePoints(e,t,this.startContainer,this.startOffset)<0)return-1;else if(D.comparePoints(e,t,this.endContainer,this.endOffset)>0)return 1;return 0},createContextualFragment:function(e){y(this);var t=n(this),r=t.createElement("div");r.innerHTML=e;for(e=t.createDocumentFragment();t=r.firstChild;)e.appendChild(t);return e},toHtml:function(){T(this);var e=n(this).createElement("div");e.appendChild(this.cloneContents());return e.innerHTML},intersectsNode:function(e,t){T(this);x(e,"NOT_FOUND_ERR");if(D.getDocument(e)!==n(this))return false;var r=e.parentNode,i=D.getNodeIndex(e);x(r,"NOT_FOUND_ERR");var s=D.comparePoints(r,i,this.endContainer,this.endOffset);r=D.comparePoints(r,i+1,this.startContainer,this.startOffset);return t?s<=0&&r>=0:s<0&&r>0},isPointInRange:function(e,t){T(this);x(e,"HIERARCHY_REQUEST_ERR");E(e,this.startContainer);return D.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&D.comparePoints(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e,t){T(this);if(n(e)!=n(this))throw new H("WRONG_DOCUMENT_ERR");var r=D.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),i=D.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?r<=0&&i>=0:r<0&&i>0},intersection:function(e){if(this.intersectsRange(e)){var t=D.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=D.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();t==-1&&r.setStart(e.startContainer,e.startOffset);n==1&&r.setEnd(e.endContainer,e.endOffset);return r}return null},union:function(e){if(this.intersectsRange(e,true)){var t=this.cloneRange();D.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset);D.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1&&t.setEnd(e.endContainer,e.endOffset);return t}else throw new d("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,false):this.compareNode(e)==Y},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,D.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);e=n.pop();t.setEnd(e,e.length);e=this.containsRange(t);t.detach();return e}else return this.containsNodeContents(e)},createNodeIterator:function(e,t){T(this);return new v(this,e,t)},getNodes:function(e,t){T(this);return c(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){y(this);this.setEndBefore(e);this.collapse(false)},collapseAfter:function(e){y(this);this.setStartAfter(e);this.collapse(true)},getName:function(){return"DomRange"},equals:function(e){return _.rangesEqual(this,e)},inspect:function(){return h(this)}};A(_,M,function(e){y(e);e.startContainer=e.startOffset=e.endContainer=e.endOffset=null;e.collapsed=e.commonAncestorContainer=null;r(e,"detach",null);e._listeners=null});e.rangePrototype=N.prototype;_.rangeProperties=W;_.RangeIterator=p;_.copyComparisonConstants=k;_.createPrototypeRange=A;_.inspect=h;_.getRangeDocument=n;_.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset};e.DomRange=_;e.RangeException=d});t.createModule("WrappedRange",function(t){function n(t,n,r,i){var u=t.duplicate();u.collapse(r);var a=u.parentElement();s.isAncestorOf(n,a,true)||(a=n);if(!a.canHaveHTML)return new o(a.parentNode,s.getNodeIndex(a));n=s.getDocument(a).createElement(e);var f,l=r?"StartToStart":"StartToEnd";do{a.insertBefore(n,n.previousSibling);u.moveToElementText(n)}while((f=u.compareEndPoints(l,t))>0&&n.previousSibling);l=n.nextSibling;if(f==-1&&l&&s.isCharacterDataNode(l)){u.setEndPoint(r?"EndToStart":"EndToEnd",t);if(/[\r\n]/.test(l.data)){a=u.duplicate();r=a.text.replace(/\r\n/g,"\r").length;for(r=a.moveStart("character",r);a.compareEndPoints("StartToEnd",a)==-1;){r++;a.moveStart("character",1)}}else r=u.text.length;a=new o(l,r)}else{l=(i||!r)&&n.previousSibling;a=(r=(i||r)&&n.nextSibling)&&s.isCharacterDataNode(r)?new o(r,0):l&&s.isCharacterDataNode(l)?new o(l,l.length):new o(a,s.getNodeIndex(n))}n.parentNode.removeChild(n);return a}function r(t,n){var r,i,o=t.offset,u=s.getDocument(t.node),a=u.body.createTextRange(),f=s.isCharacterDataNode(t.node);if(f){r=t.node;i=r.parentNode}else{r=t.node.childNodes;r=o<r.length?r[o]:null;i=t.node}u=u.createElement(e);u.innerHTML="&#feff;";r?i.insertBefore(u,r):i.appendChild(u);a.moveToElementText(u);a.collapse(!n);i.removeChild(u);if(f)a[n?"moveStart":"moveEnd"]("character",o);return a}t.requireModules(["DomUtil","DomRange"]);var i,s=t.dom,o=s.DomPosition,u=t.DomRange;if(t.features.implementsDomRange&&(!t.features.implementsTextRange||!t.config.preferTextRange)){(function(){function e(e){for(var t=n.length,r;t--;){r=n[t];e[r]=e.nativeRange[r]}}var t,n=u.rangeProperties,r,o;i=function(t){if(!t)throw Error("Range must be specified");this.nativeRange=t;e(this)};u.createPrototypeRange(i,function(e,t,n,r,i){var s=e.endContainer!==r||e.endOffset!=i;if(e.startContainer!==t||e.startOffset!=n||s){e.setEnd(r,i);e.setStart(t,n)}},function(e){e.nativeRange.detach();e.detached=true;for(var t=n.length,r;t--;){r=n[t];e[r]=null}});t=i.prototype;t.selectNode=function(t){this.nativeRange.selectNode(t);e(this)};t.deleteContents=function(){this.nativeRange.deleteContents();e(this)};t.extractContents=function(){var t=this.nativeRange.extractContents();e(this);return t};t.cloneContents=function(){return this.nativeRange.cloneContents()};t.surroundContents=function(t){this.nativeRange.surroundContents(t);e(this)};t.collapse=function(t){this.nativeRange.collapse(t);e(this)};t.cloneRange=function(){return new i(this.nativeRange.cloneRange())};t.refresh=function(){e(this)};t.toString=function(){return this.nativeRange.toString()};var a=document.createTextNode("test");s.getBody(document).appendChild(a);var f=document.createRange();f.setStart(a,0);f.setEnd(a,0);try{f.setStart(a,1);r=true;t.setStart=function(t,n){this.nativeRange.setStart(t,n);e(this)};t.setEnd=function(t,n){this.nativeRange.setEnd(t,n);e(this)};o=function(t){return function(n){this.nativeRange[t](n);e(this)}}}catch(l){r=false;t.setStart=function(t,n){try{this.nativeRange.setStart(t,n)}catch(r){this.nativeRange.setEnd(t,n);this.nativeRange.setStart(t,n)}e(this)};t.setEnd=function(t,n){try{this.nativeRange.setEnd(t,n)}catch(r){this.nativeRange.setStart(t,n);this.nativeRange.setEnd(t,n)}e(this)};o=function(t,n){return function(r){try{this.nativeRange[t](r)}catch(i){this.nativeRange[n](r);this.nativeRange[t](r)}e(this)}}}t.setStartBefore=o("setStartBefore","setEndBefore");t.setStartAfter=o("setStartAfter","setEndAfter");t.setEndBefore=o("setEndBefore","setStartBefore");t.setEndAfter=o("setEndAfter","setStartAfter");f.selectNodeContents(a);t.selectNodeContents=f.startContainer==a&&f.endContainer==a&&f.startOffset==0&&f.endOffset==a.length?function(t){this.nativeRange.selectNodeContents(t);e(this)}:function(e){this.setStart(e,0);this.setEnd(e,u.getEndOffset(e))};f.selectNodeContents(a);f.setEnd(a,3);r=document.createRange();r.selectNodeContents(a);r.setEnd(a,4);r.setStart(a,2);t.compareBoundaryPoints=f.compareBoundaryPoints(f.START_TO_END,r)==-1&f.compareBoundaryPoints(f.END_TO_START,r)==1?function(e,t){t=t.nativeRange||t;if(e==t.START_TO_END)e=t.END_TO_START;else if(e==t.END_TO_START)e=t.START_TO_END;return this.nativeRange.compareBoundaryPoints(e,t)}:function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};s.getBody(document).removeChild(a);f.detach();r.detach()})();t.createNativeRange=function(e){e=e||document;return e.createRange()}}else if(t.features.implementsTextRange){i=function(e){this.textRange=e;this.refresh()};i.prototype=new u(document);i.prototype.refresh=function(){var e,t,r=this.textRange;e=r.parentElement();var i=r.duplicate();i.collapse(true);t=i.parentElement();i=r.duplicate();i.collapse(false);r=i.parentElement();t=t==r?t:s.getCommonAncestor(t,r);t=t==e?t:s.getCommonAncestor(e,t);if(this.textRange.compareEndPoints("StartToEnd",this.textRange)==0)t=e=n(this.textRange,t,true,true);else{e=n(this.textRange,t,true,false);t=n(this.textRange,t,false,false)}this.setStart(e.node,e.offset);this.setEnd(t.node,t.offset)};i.rangeToTextRange=function(e){if(e.collapsed)return r(new o(e.startContainer,e.startOffset),true);else{var t=r(new o(e.startContainer,e.startOffset),true),n=r(new o(e.endContainer,e.endOffset),false);e=s.getDocument(e.startContainer).body.createTextRange();e.setEndPoint("StartToStart",t);e.setEndPoint("EndToEnd",n);return e}};u.copyComparisonConstants(i);var a=function(){return this}();if(typeof a.Range=="undefined")a.Range=i;t.createNativeRange=function(e){e=e||document;return e.body.createTextRange()}}i.prototype.getName=function(){return"WrappedRange"};t.WrappedRange=i;t.createRange=function(e){e=e||document;return new i(t.createNativeRange(e))};t.createRangyRange=function(e){e=e||document;return new u(e)};t.createIframeRange=function(e){return t.createRange(s.getIframeDocument(e))};t.createIframeRangyRange=function(e){return t.createRangyRange(s.getIframeDocument(e))};t.addCreateMissingNativeApiListener(function(e){e=e.document;if(typeof e.createRange=="undefined")e.createRange=function(){return t.createRange(this)};e=e=null})});t.createModule("WrappedSelection",function(e,t){function n(e){return(e||window).getSelection()}function r(e){return(e||window).document.selection}function i(e,t,n){var r=n?"end":"start";n=n?"start":"end";e.anchorNode=t[r+"Container"];e.anchorOffset=t[r+"Offset"];e.focusNode=t[n+"Container"];e.focusOffset=t[n+"Offset"]}function s(e){e.anchorNode=e.focusNode=null;e.anchorOffset=e.focusOffset=0;e.rangeCount=0;e.isCollapsed=true;e._ranges.length=0}function o(t){var n;if(t instanceof g){n=t._selectionNativeRange;if(!n){n=e.createNativeRange(v.getDocument(t.startContainer));n.setEnd(t.endContainer,t.endOffset);n.setStart(t.startContainer,t.startOffset);t._selectionNativeRange=n;t.attachListener("detach",function(){this._selectionNativeRange=null})}}else if(t instanceof y)n=t.nativeRange;else if(e.features.implementsDomRange&&t instanceof v.getWindow(t.startContainer).Range)n=t;return n}function u(e){var t=e.getNodes(),n;e:if(!t.length||t[0].nodeType!=1)n=false;else{n=1;for(var r=t.length;n<r;++n)if(!v.isAncestorOf(t[0],t[n])){n=false;break e}n=true}if(!n)throw Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function a(e,t){var n=new y(t);e._ranges=[n];i(e,n,false);e.rangeCount=1;e.isCollapsed=n.collapsed}function f(t){t._ranges.length=0;if(t.docSelection.type=="None")s(t);else{var n=t.docSelection.createRange();if(n&&typeof n.text!="undefined")a(t,n);else{t.rangeCount=n.length;for(var r,o=v.getDocument(n.item(0)),u=0;u<t.rangeCount;++u){r=e.createRange(o);r.selectNode(n.item(u));t._ranges.push(r)}t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed;i(t,t._ranges[t.rangeCount-1],false)}}}function l(e,t){var n=e.docSelection.createRange(),r=u(t),i=v.getDocument(n.item(0));i=v.getBody(i).createControlRange();for(var s=0,o=n.length;s<o;++s)i.add(n.item(s));try{i.add(r)}catch(a){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select();f(e)}function c(e,t,n){this.nativeSelection=e;this.docSelection=t;this._ranges=[];this.win=n;this.refresh()}function h(e,t){var n=v.getDocument(t[0].startContainer);n=v.getBody(n).createControlRange();for(var r=0,i;r<rangeCount;++r){i=u(t[r]);try{n.add(i)}catch(s){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}n.select();f(e)}function p(e,t){if(e.anchorNode&&v.getDocument(e.anchorNode)!==v.getDocument(t))throw new b("WRONG_DOCUMENT_ERR")}function d(e){var t=[],n=new w(e.anchorNode,e.anchorOffset),r=new w(e.focusNode,e.focusOffset),i=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined")for(var s=0,o=e.rangeCount;s<o;++s)t[s]=g.inspect(e.getRangeAt(s));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]);e.config.checkSelectionRanges=true;var v=e.dom,m=e.util,g=e.DomRange,y=e.WrappedRange,b=e.DOMException,w=v.DomPosition,E,S,x=e.util.isHostMethod(window,"getSelection"),T=e.util.isHostObject(document,"selection"),N=T&&(!x||e.config.preferTextRange);if(N){E=r;e.isSelectionValid=function(e){e=(e||window).document;var t=e.selection;return t.type!="None"||v.getDocument(t.createRange().parentElement())==e}}else if(x){E=n;e.isSelectionValid=function(){return true}}else t.fail("Neither document.selection or window.getSelection() detected.");e.getNativeSelection=E;x=E();var C=e.createNativeRange(document),k=v.getBody(document),L=m.areHostObjects(x,m.areHostProperties(x,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=L;var A=m.isHostMethod(x,"extend");e.features.selectionHasExtend=A;var O=typeof x.rangeCount=="number";e.features.selectionHasRangeCount=O;var M=false,_=true;m.areHostMethods(x,["addRange","getRangeAt","removeAllRanges"])&&typeof x.rangeCount=="number"&&e.features.implementsDomRange&&function(){var e=document.createElement("iframe");k.appendChild(e);var t=v.getIframeDocument(e);t.open();t.write("<html><head></head><body>12</body></html>");t.close();var n=v.getIframeWindow(e).getSelection(),r=t.documentElement.lastChild.firstChild;t=t.createRange();t.setStart(r,1);t.collapse(true);n.addRange(t);_=n.rangeCount==1;n.removeAllRanges();var i=t.cloneRange();t.setStart(r,0);i.setEnd(r,2);n.addRange(t);n.addRange(i);M=n.rangeCount==2;t.detach();i.detach();k.removeChild(e)}();e.features.selectionSupportsMultipleRanges=M;e.features.collapsedNonEditableSelectionsSupported=_;var D=false,P;if(k&&m.isHostMethod(k,"createControlRange")){P=k.createControlRange();if(m.areHostProperties(P,["item","add"]))D=true}e.features.implementsControlRange=D;S=L?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:false};var H;if(m.isHostMethod(x,"getRangeAt"))H=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}};else if(L)H=function(t){var n=v.getDocument(t.anchorNode);n=e.createRange(n);n.setStart(t.anchorNode,t.anchorOffset);n.setEnd(t.focusNode,t.focusOffset);if(n.collapsed!==this.isCollapsed){n.setStart(t.focusNode,t.focusOffset);n.setEnd(t.anchorNode,t.anchorOffset)}return n};e.getSelection=function(e){e=e||window;var t=e._rangySelection,n=E(e),i=T?r(e):null;if(t){t.nativeSelection=n;t.docSelection=i;t.refresh(e)}else{t=new c(n,i,e);e._rangySelection=t}return t};e.getIframeSelection=function(t){return e.getSelection(v.getIframeWindow(t))};P=c.prototype;if(!N&&L&&m.areHostMethods(x,["removeAllRanges","addRange"])){P.removeAllRanges=function(){this.nativeSelection.removeAllRanges();s(this)};var B=function(t,n){var r=g.getRangeDocument(n);r=e.createRange(r);r.collapseToPoint(n.endContainer,n.endOffset);t.nativeSelection.addRange(o(r));t.nativeSelection.extend(n.startContainer,n.startOffset);t.refresh()};P.addRange=O?function(t,n){if(D&&T&&this.docSelection.type=="Control")l(this,t);else if(n&&A)B(this,t);else{var r;if(M)r=this.rangeCount;else{this.removeAllRanges();r=0}this.nativeSelection.addRange(o(t));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==r+1){if(e.config.checkSelectionRanges)if((r=H(this.nativeSelection,this.rangeCount-1))&&!g.rangesEqual(r,t))t=new y(r);this._ranges[this.rangeCount-1]=t;i(this,t,I(this.nativeSelection));this.isCollapsed=S(this)}else this.refresh()}}:function(e,t){if(t&&A)B(this,e);else{this.nativeSelection.addRange(o(e));this.refresh()}};P.setRanges=function(e){if(D&&e.length>1)h(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else if(m.isHostMethod(x,"empty")&&m.isHostMethod(C,"select")&&D&&N){P.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var e;if(this.anchorNode)e=v.getDocument(this.anchorNode);else if(this.docSelection.type=="Control"){var t=this.docSelection.createRange();if(t.length)e=v.getDocument(t.item(0)).body.createTextRange()}if(e){e.body.createTextRange().select();this.docSelection.empty()}}}catch(n){}s(this)};P.addRange=function(e){if(this.docSelection.type=="Control")l(this,e);else{y.rangeToTextRange(e).select();this._ranges[0]=e;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;i(this,e,false)}};P.setRanges=function(e){this.removeAllRanges();var t=e.length;if(t>1)h(this,e);else t&&this.addRange(e[0])}}else{t.fail("No means of selecting a Range or TextRange was found");return false}P.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new b("INDEX_SIZE_ERR");else return this._ranges[e]};var j;if(N)j=function(t){var n;if(e.isSelectionValid(t.win))n=t.docSelection.createRange();else{n=v.getBody(t.win.document).createTextRange();n.collapse(true)}if(t.docSelection.type=="Control")f(t);else n&&typeof n.text!="undefined"?a(t,n):s(t)};else if(m.isHostMethod(x,"getRangeAt")&&typeof x.rangeCount=="number")j=function(t){if(D&&T&&t.docSelection.type=="Control")f(t);else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));i(t,t._ranges[t.rangeCount-1],I(t.nativeSelection));t.isCollapsed=S(t)}else s(t)}};else if(L&&typeof x.isCollapsed=="boolean"&&typeof C.collapsed=="boolean"&&e.features.implementsDomRange)j=function(e){var t;t=e.nativeSelection;if(t.anchorNode){t=H(t,0);e._ranges=[t];e.rangeCount=1;t=e.nativeSelection;e.anchorNode=t.anchorNode;e.anchorOffset=t.anchorOffset;e.focusNode=t.focusNode;e.focusOffset=t.focusOffset;e.isCollapsed=S(e)}else s(e)};else{t.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}P.refresh=function(e){var t=e?this._ranges.slice(0):null;j(this);if(e){e=t.length;if(e!=this._ranges.length)return false;for(;e--;)if(!g.rangesEqual(t[e],this._ranges[e]))return false;return true}};var F=function(e,t){var n=e.getAllRanges(),r=false;e.removeAllRanges();for(var i=0,o=n.length;i<o;++i)if(r||t!==n[i])e.addRange(n[i]);else r=true;e.rangeCount||s(e)};P.removeRange=D?function(e){if(this.docSelection.type=="Control"){var t=this.docSelection.createRange();e=u(e);var n=v.getDocument(t.item(0));n=v.getBody(n).createControlRange();for(var r,i=false,s=0,o=t.length;s<o;++s){r=t.item(s);if(r!==e||i)n.add(t.item(s));else i=true}n.select();f(this)}else F(this,e)}:function(e){F(this,e)};var I;if(!N&&L&&e.features.implementsDomRange){I=function(e){var t=false;if(e.anchorNode)t=v.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1;return t};P.isBackwards=function(){return I(this)}}else I=P.isBackwards=function(){return false};P.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")};P.collapse=function(t,n){p(this,t);var r=e.createRange(v.getDocument(t));r.collapseToPoint(t,n);this.removeAllRanges();this.addRange(r);this.isCollapsed=true};P.collapseToStart=function(){if(this.rangeCount){var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)}else throw new b("INVALID_STATE_ERR")};P.collapseToEnd=function(){if(this.rangeCount){var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)}else throw new b("INVALID_STATE_ERR")};P.selectAllChildren=function(t){p(this,t);var n=e.createRange(v.getDocument(t));n.selectNodeContents(t);this.removeAllRanges();this.addRange(n)};P.deleteFromDocument=function(){if(D&&T&&this.docSelection.type=="Control"){for(var e=this.docSelection.createRange(),t;e.length;){t=e.item(0);e.remove(t);t.parentNode.removeChild(t)}this.refresh()}else if(this.rangeCount){e=this.getAllRanges();this.removeAllRanges();t=0;for(var n=e.length;t<n;++t)e[t].deleteContents();this.addRange(e[n-1])}};P.getAllRanges=function(){return this._ranges.slice(0)};P.setSingleRange=function(e){this.setRanges([e])};P.containsNode=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(this._ranges[n].containsNode(e,t))return true;return false};P.toHtml=function(){var e="";if(this.rangeCount){e=g.getRangeDocument(this._ranges[0]).createElement("div");for(var t=0,n=this._ranges.length;t<n;++t)e.appendChild(this._ranges[t].cloneContents());e=e.innerHTML}return e};P.getName=function(){return"WrappedSelection"};P.inspect=function(){return d(this)};P.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};c.inspect=d;e.Selection=c;e.selectionPrototype=P;e.addCreateMissingNativeApiListener(function(t){if(typeof t.getSelection=="undefined")t.getSelection=function(){return e.getSelection(this)};t=null})});t.createModule("CssClassApplier",function(t){function n(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(e,t){return e.className&&RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e.className)}function i(e,t){if(e.className)r(e,t)||(e.className+=" "+t);else e.className=t}function s(e){return e.className.split(/\s+/).sort().join(" ")}function o(e,t){return s(e)==s(t)}function u(e){for(var t=e.parentNode;e.hasChildNodes();)t.insertBefore(e.firstChild,e);t.removeChild(e)}function a(e,t){var n=e.cloneRange();n.selectNodeContents(t);var r=n.intersection(e);r=r?r.toString():"";n.detach();return r!=""}function f(e,t){if(e.attributes.length!=t.attributes.length)return false;for(var n=0,r=e.attributes.length,i,s;n<r;++n){i=e.attributes[n];s=i.name;if(s!="class"){s=t.attributes.getNamedItem(s);if(i.specified!=s.specified)return false;if(i.specified&&i.nodeValue!==s.nodeValue)return false}}return true}function l(e){for(var t=0,n=e.attributes.length;t<n;++t)if(e.attributes[t].specified&&e.attributes[t].name!="class")return true;return false}function c(e,t){if(m.isCharacterDataNode(e))return t==0?!!e.previousSibling:t==e.length?!!e.nextSibling:true;return t>0&&t<e.childNodes.length}function h(e,t,n){var r;if(m.isCharacterDataNode(t))if(n==0){n=m.getNodeIndex(t);t=t.parentNode}else if(n==t.length){n=m.getNodeIndex(t)+1;t=t.parentNode}else r=m.splitDataNode(t,n);if(!r){r=t.cloneNode(false);r.id&&r.removeAttribute("id");for(var i;i=t.childNodes[n];)r.appendChild(i);m.insertAfter(r,t)}return t==e?r:h(e,r.parentNode,m.getNodeIndex(r))}function p(e,t){var n=e.nodeType==3,r=n?e.parentNode:e,i=t?"nextSibling":"previousSibling";if(n){if((n=e[i])&&n.nodeType==3)return n}else if((n=r[i])&&e.tagName==n.tagName&&o(e,n)&&f(e,n))return n[t?"firstChild":"lastChild"];return null}function d(e){this.firstTextNode=(this.isElementMerge=e.nodeType==1)?e.lastChild:e;if(this.isElementMerge)this.sortedCssClasses=s(e);this.textNodes=[this.firstTextNode]}function v(e,t,r){this.cssClass=e;this.normalize=t;this.applyToAnytagBody=false;e=typeof r;if(e=="string")if(r=="*")this.applyToAnytagBody=true;else this.tagNames=n(r.toLowerCase()).split(/\s*,\s*/);else if(e=="object"&&typeof r.length=="number"){this.tagNames=[];e=0;for(t=r.length;e<t;++e)if(r[e]=="*")this.applyToAnytagBody=true;else this.tagNames.push(r[e].toLowerCase())}else this.tagNames=[g]}t.requireModules(["WrappedSelection","WrappedRange"]);var m=t.dom,g=e,y=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){if(t.className)t.className=t.className.replace(RegExp("(?:^|\\s)"+n+"(?:\\s|$)"),e)}}();d.prototype={doMerge:function(){for(var e=[],t,n,r=0,i=this.textNodes.length;r<i;++r){t=this.textNodes[r];n=t.parentNode;e[r]=t.data;if(r){n.removeChild(t);n.hasChildNodes()||n.parentNode.removeChild(n)}}return this.firstTextNode.data=e=e.join("")},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;t<n;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}};v.prototype={appliesToElement:function(e){return this.applyToAnytagBody||m.arrayContains(this.tagNames,e.tagName.toLowerCase())},getAncestorWithClass:function(e){for(e=e.parentNode;e;){if(e.nodeType==1&&this.appliesToElement(e)&&r(e,this.cssClass))return e;e=e.parentNode}return false},postApply:function(e,t){for(var n=e[0],r=e[e.length-1],i=[],s,o=n,u=r,a=0,f=r.length,l,c,h=0,v=e.length;h<v;++h){l=e[h];if(c=p(l,false)){if(!s){s=new d(c);i.push(s)}s.textNodes.push(l);if(l===n){o=s.firstTextNode;a=o.length}if(l===r){u=s.firstTextNode;f=s.getLength()}}else s=null}if(n=p(r,true)){if(!s){s=new d(r);i.push(s)}s.textNodes.push(n)}if(i.length){h=0;for(v=i.length;h<v;++h)i[h].doMerge();t.setStart(o,a);t.setEnd(u,f)}},createContainer:function(e){e=e.createElement(g);e.className=this.cssClass;return e},applyToTextNode:function(e){var t=e.parentNode;if(t.childNodes.length==1&&this.appliesToElement(t))i(t,this.cssClass);else{t=this.createContainer(m.getDocument(e));e.parentNode.insertBefore(t,e);t.appendChild(e)}},isRemovable:function(e){return e.tagName.toLowerCase()==g&&n(e.className)==this.cssClass&&!l(e)},undoToTextNode:function(e,t,n){if(!t.containsNode(n)){e=t.cloneRange();e.selectNode(n);if(e.isPointInRange(t.endContainer,t.endOffset)&&c(t.endContainer,t.endOffset)){h(n,t.endContainer,t.endOffset);t.setEndAfter(n)}if(e.isPointInRange(t.startContainer,t.startOffset)&&c(t.startContainer,t.startOffset))n=h(n,t.startContainer,t.startOffset)}this.isRemovable(n)?u(n):y(n,this.cssClass)},applyToRange:function(e){e.splitBoundaries();var t=e.getNodes([3],function(t){return a(e,t)});if(t.length){for(var n,r=0,i=t.length;r<i;++r){n=t[r];this.getAncestorWithClass(n)||this.applyToTextNode(n)}e.setStart(t[0],0);n=t[t.length-1];e.setEnd(n,n.length);this.normalize&&this.postApply(t,e)}},applyToSelection:function(e){e=e||window;e=t.getSelection(e);var n,r=e.getAllRanges();e.removeAllRanges();for(var i=r.length;i--;){n=r[i];this.applyToRange(n);e.addRange(n)}},undoToRange:function(e){e.splitBoundaries();var t=e.getNodes([3]),n,r,i=t[t.length-1];if(t.length){for(var s=0,o=t.length;s<o;++s){n=t[s];(r=this.getAncestorWithClass(n))&&this.undoToTextNode(n,e,r);e.setStart(t[0],0);e.setEnd(i,i.length)}this.normalize&&this.postApply(t,e)}},undoToSelection:function(e){e=e||window;e=t.getSelection(e);var n=e.getAllRanges(),r;e.removeAllRanges();for(var i=0,s=n.length;i<s;++i){r=n[i];this.undoToRange(r);e.addRange(r)}},isAppliedToRange:function(e){for(var t=e.getNodes([3]),n=0,r=t.length;n<r;++n)if(a(e,t[n])&&!this.getAncestorWithClass(t[n]))return false;return true},isAppliedToSelection:function(e){e=e||window;e=t.getSelection(e).getAllRanges();for(var n=e.length;n--;)if(!this.isAppliedToRange(e[n]))return false;return true},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},detach:function(){}};v.util={hasClass:r,addClass:i,removeClass:y,hasSameClasses:o,replaceWithOwnChildren:u,elementsHaveSameNonClassAttributes:f,elementHasNonClassAttributes:l,splitNodeAt:h};t.CssClassApplier=v;t.createCssClassApplier=function(e,t,n){return new v(e,t,n)}});t.createModule("SaveRestore",function(t,n){function r(t,n){var r="selectionBoundary_"+ +(new Date)+"_"+(""+Math.random()).slice(2),i,s=u.getDocument(t.startContainer),o=t.cloneRange();o.collapse(n);i=s.createElement(e);i.id=r;i.style.lineHeight="0";i.style.display="none";i.appendChild(s.createTextNode(a));o.insertNode(i);o.detach();return i}function i(e,t,r,i){if(e=(e||document).getElementById(r)){t[i?"setStartBefore":"setEndBefore"](e);e.parentNode.removeChild(e)}else n.warn("Marker element has been removed. Cannot restore selection.")}function s(e,t){return t.compareBoundaryPoints(e.START_TO_START,e)}function o(e,t){var n=(e||document).getElementById(t);n&&n.parentNode.removeChild(n)}t.requireModules(["DomUtil","DomRange","WrappedRange"]);var u=t.dom,a="";t.saveSelection=function(e){e=e||window;var i=e.document;if(t.isSelectionValid(e)){var o=t.getSelection(e),u=o.getAllRanges(),a=[],f,l;u.sort(s);for(var c=0,p=u.length;c<p;++c){f=u[c];if(f.collapsed){l=r(f,false);a.push({markerId:l.id,collapsed:true})}else{l=r(f,false);f=r(f,true);a[c]={startMarkerId:f.id,endMarkerId:l.id,collapsed:false,backwards:u.length==1&&o.isBackwards()}}}for(c=p-1;c>=0;--c){f=u[c];if(f.collapsed)f.collapseBefore((i||document).getElementById(a[c].markerId));else{f.setEndBefore((i||document).getElementById(a[c].endMarkerId));f.setStartAfter((i||document).getElementById(a[c].startMarkerId))}}o.setRanges(u);return{win:e,doc:i,rangeInfos:a,restored:false}}else n.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.")};t.restoreSelection=function(e,r){if(!e.restored){for(var s=e.rangeInfos,o=t.getSelection(e.win),u=[],a=s.length,f=a-1,l,c;f>=0;--f){l=s[f];c=t.createRange(e.doc);if(l.collapsed)if(l=(e.doc||document).getElementById(l.markerId)){l.style.display="inline";var p=l.previousSibling;if(p&&p.nodeType==3){l.parentNode.removeChild(l);c.collapseToPoint(p,p.length)}else{c.collapseBefore(l);l.parentNode.removeChild(l)}}else n.warn("Marker element has been removed. Cannot restore selection.");else{i(e.doc,c,l.startMarkerId,true);i(e.doc,c,l.endMarkerId,false)}a==1&&c.normalizeBoundaries();u[f]=c}if(a==1&&r&&t.features.selectionHasExtend&&s[0].backwards){o.removeAllRanges();o.addRange(u[0],true)}else o.setRanges(u);e.restored=true}};t.removeMarkerElement=o;t.removeMarkers=function(e){for(var t=e.rangeInfos,n=0,r=t.length,i;n<r;++n){i=t[n];if(i.collapsed)o(e.doc,i.markerId);else{o(e.doc,i.startMarkerId);o(e.doc,i.endMarkerId)}}}});t.createModule("Serializer",function(e,n){function r(e,t){t=t||[];var n=e.nodeType,i=e.childNodes,s=i.length,o=[n,e.nodeName,s].join(":"),u="",a="";switch(n){case 3:u=e.nodeValue.replace(/</g,"<").replace(/>/g,">");break;case 8:u="<!--"+e.nodeValue.replace(/</g,"<").replace(/>/g,">")+"-->";break;default:u="<"+o+">";a="</>";break}u&&t.push(u);for(n=0;n<s;++n)r(i[n],t);a&&t.push(a);return t}function i(e){e=r(e).join("");return h(e).toString(16)}function s(e,t,n){var r=[],i=e;for(n=n||p.getDocument(e).documentElement;i&&i!=n;){r.push(p.getNodeIndex(i,true));i=i.parentNode}return r.join("/")+":"+t}function o(e,t,r){if(t)r||p.getDocument(t);else{r=r||document;t=r.documentElement}e=e.split(":");t=t;r=e[0]?e[0].split("/"):[];for(var i=r.length,s;i--;){s=parseInt(r[i],10);if(s<t.childNodes.length)t=t.childNodes[parseInt(r[i],10)];else throw n.createError("deserializePosition failed: node "+p.inspectNode(t)+" has no child with index "+s+", "+i)}return new p.DomPosition(t,parseInt(e[1],10))}function u(t,n,r){r=r||e.DomRange.getRangeDocument(t).documentElement;if(!p.isAncestorOf(r,t.commonAncestorContainer,true))throw Error("serializeRange: range is not wholly contained within specified root node");t=s(t.startContainer,t.startOffset,r)+","+s(t.endContainer,t.endOffset,r);n||(t+="{"+i(r)+"}");return t}function a(t,n,r){if(n)r=r||p.getDocument(n);else{r=r||document;n=r.documentElement}t=/^([^,]+),([^,\{]+)({([^}]+)})?$/.exec(t);var s=t[4],u=i(n);if(s&&s!==i(n))throw Error("deserializeRange: checksums of serialized range root node ("+s+") and target root node ("+u+") do not match");s=o(t[1],n,r);n=o(t[2],n,r);r=e.createRange(r);r.setStart(s.node,s.offset);r.setEnd(n.node,n.offset);return r}function f(e,t,n){if(t)n||p.getDocument(t);else{n=n||document;t=n.documentElement}e=/^([^,]+),([^,]+)({([^}]+)})?$/.exec(e)[3];return!e||e===i(t)}function l(e,n,r){e=e||t.getSelection();e=e.getAllRanges();for(var i=[],s=0,o=e.length;s<o;++s)i[s]=u(e[s],n,r);return i.join("|")}function c(t,n,r){if(n)r=r||p.getWindow(n);else{r=r||window;n=r.document.documentElement}t=t.split("|");for(var i=e.getSelection(r),s=[],o=0,u=t.length;o<u;++o)s[o]=a(t[o],n,r.document);i.setRanges(s);return i}e.requireModules(["WrappedSelection","WrappedRange"]);if(typeof encodeURIComponent=="undefined"||typeof decodeURIComponent=="undefined")n.fail("Global object is missing encodeURIComponent and/or decodeURIComponent method");var h=function(){var e=null;return function(t){for(var n=[],r=0,i=t.length,s;r<i;++r){s=t.charCodeAt(r);if(s<128)n.push(s);else s<2048?n.push(s>>6|192,s&63|128):n.push(s>>12|224,s>>6&63|128,s&63|128)}t=-1;if(!e){r=[];i=0;for(var o;i<256;++i){o=i;for(s=8;s--;)if((o&1)==1)o=o>>>1^3988292384;else o>>>=1;r[i]=o>>>0}e=r}r=e;i=0;for(s=n.length;i<s;++i){o=(t^n[i])&255;t=t>>>8^r[o]}return(t^-1)>>>0}}(),p=e.dom;e.serializePosition=s;e.deserializePosition=o;e.serializeRange=u;e.deserializeRange=a;e.canDeserializeRange=f;e.serializeSelection=l;e.deserializeSelection=c;e.canDeserializeSelection=function(e,t,n){var r;if(t)r=n?n.document:p.getDocument(t);else{n=n||window;t=n.document.documentElement}e=e.split("|");n=0;for(var i=e.length;n<i;++n)if(!f(e[n],t,r))return false;return true};e.restoreSelectionFromCookie=function(e){e=e||window;var t;e:{t=e.document.cookie.split(/[;,]/);for(var n=0,r=t.length,i;n<r;++n){i=t[n].split("=");if(i[0].replace(/^\s+/,"")=="rangySerializedSelection")if(i=i[1]){t=decodeURIComponent(i.replace(/\s+$/,""));break e}}t=null}t&&c(t,e.doc)};e.saveSelectionCookie=function(e,n){e=e||window;n=typeof n=="object"?n:{};var r=n.expires?";expires="+n.expires.toUTCString():"",i=n.path?";path="+n.path:"",s=n.domain?";domain="+n.domain:"",o=n.secure?";secure":"",u=l(t.getSelection(e));e.document.cookie=encodeURIComponent("rangySerializedSelection")+"="+encodeURIComponent(u)+r+i+s+o};e.getElementChecksum=i});return t}var rangy=plugin_rangy();window.rangy=rangy;rangy.init();plugin_jquery_log($R);plugin_jquery_hasAttr($R);plugin_jquery_json($R);plugin_jquery_cookie($R);plugin_jquery_postMessage($R);plugin_jquery_mustache($R);plugin_jquery_enhancedOffset($R);plugin_jquery_mousewheel($R);plugin_jquery_scrollStartAndStop($R);plugin_jquery_isotope($R);plugin_jquery_jScrollPane($R);plugin_jquery_twitterTip($R);plugin_jquery_rdrWidgetSummary($R);plugin_jquery_selectionographer($R,rangy);$R.expr[":"].parents=function(e,t,n){return $R(e).parents(n[3]).length<1}}var $=$R;var css=[];if(!$R.browser.msie||$R.browser.msie&&parseInt($R.browser.version,10)>8){css.push(RDR_staticUrl+"css/fonts/helvetica.css");css.push(RDR_staticUrl+"css/fonts/fontawesome.css")}if($R.browser.msie){css.push(RDR_staticUrl+"widget/css/ie.css");css.push(RDR_staticUrl+"widget/css/ie"+parseInt($R.browser.version,10)+".css")}css.push(RDR_widgetCssStaticUrl+"widget/css/widget.css?rv20");css.push(RDR_staticUrl+"widget/css/jquery.jscrollpane.css");loadCSS(css);initCommonUtils($R);initPlugins($R);readrBoard($R);RDR.actions.init();if(RDR_offline){RDR.debug()}}var RDR={};if(window.READRBOARDCOM&&window.READRBOARDCOM.hasLoaded){return}window.READRBOARDCOM=window.readrboard=RDR;RDR.hasLoaded=true;RDR.C={rindowHeaderPadding:29,rindowWidthForKindIsText:200,rindowAnimationSpeed:333,indicatorOpacity:.4,helperIndicators:{hoverDelay:250,fadeInTime:300,opacity:.6}};RDR.engageScript=document.getElementById("readrboardscript")||findEngageScript();RDR.engageScriptSrc=RDR.engageScript.src;var $RDR,$R,RDR_scriptPaths={},RDR_offline=!!(RDR.engageScriptSrc.indexOf("local.readrboard.com")!=-1||RDR.engageScriptSrc.indexOf("local.readrboard2.com")!=-1||document.domain=="local.readrboard.com"),RDR_baseUrl=RDR_offline?"http://local.readrboard.com:8080":"http://www.readrboard.com",RDR_staticUrl=RDR_offline?"http://local.readrboard.com:8080/static/":"http://s3.amazonaws.com/readrboard/",RDR_widgetCssStaticUrl=RDR_offline?"http://local.readrboard.com:8080/static/":"http://s3.amazonaws.com/readrboard/";var isTouchBrowser="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;RDR.safeThrow=function(e){var t=true;if(RDR_offline&&t){throw e}};RDR.rdr_loadScript=rdr_loadScript;RDR_scriptPaths.jquery=RDR_offline?RDR_staticUrl+"global/js/jquery-1.7.1.min.js":"http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js";rdr_loadScript({src:RDR_scriptPaths.jquery},function(){load_jquery_ui_partial(jQuery);if(isTouchBrowser){load_jquery_mobile(jQuery)}$R=jQuery.noConflict(true);var e=$R;if(e.browser.msie&&parseInt(e.browser.version,10)<8){return false}if(e.browser.msie&&parseInt(e.browser.version,10)==8){e("body").addClass("rdr_ie")}$RFunctions($R)})})()