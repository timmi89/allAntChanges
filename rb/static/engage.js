(function(){function test_readrboard_extend(){if(!RDR_offline){return}window.readrboard_extend={blessed_tags:["Love It","Hate It","Heeeeeey"]};window.readrboard_extend_per_container={question1:{blessed_tags:["tag1","tag2","tag3"]},question2:{blessed_tags:["tag3","tag4","tag5","tag6"]}}}function findEngageScript(){var e=document.getElementsByTagName("script");for(var t=0;t<e.length;t++){var n=e[t];var r=n.src;var i=r.indexOf("readrboard")!=-1&&r.indexOf("engage")!=-1;if(i){return n}}}function readrBoard(e){var t=e;t.extend(RDR,{summaries:{},current:{},assetLoaders:{content_nodes:{}},content_nodes:{},containers:{},pages:{},group:{defaults:{img_selector:"img",img_container_selectors:"#primary-photo",active_sections:"body",anno_whitelist:"body p",active_sections_with_anno_whitelist:"",media_selector:"embed, video, object, iframe",comment_length:300,initial_pin_limit:300,no_readr:"",img_blacklist:"",custom_css:"",call_to_action:"What do you think?",inline_selector:"img, embed, video, object, iframe",paragraph_helper:true,media_url_ignore_query:true,summary_widget_method:"after",br_replace_scope_selector:null}},user:{img_url:"",readr_token:"",user_id:""},known_users:{},errors:{actionbar:{rating:"",commenting:""}},styles:{},events:{track:function(e,n){var r="",i=(new Date).getTime();RDR.user=RDR.user||{};if(RDR.user&&RDR.user.user_id)r+="||uid::"+RDR.user.user_id;if(n&&RDR.util.getPageProperty("id",n))r+="||pid::"+RDR.util.getPageProperty("id",n);if(RDR.group&&RDR.group.id)r+="||gid::"+RDR.group.id;if(RDR.engageScriptParams.bookmarklet)r+="||bookmarklet";var s=e+r,o=t('<img src="'+RDR_baseUrl+"/static/widget/images/event.png?"+i+"&"+s+'" />');t("#rdr_event_pixels").append(o)},trackEventToCloud:function(e){RDR.user=RDR.user||{};RDR.event_queue=RDR.event_queue||[];if(typeof e.event_type!=="undefined"&&e.event_value!=="undefined"){var n=(typeof e.page_id!="undefined"?e.page_id:RDR.util.getPageProperty("id")).toString();var r=t.toJSON({event_type:e.event_type,event_value:e.event_value,group_id:RDR.group.id||null,user_id:RDR.user.user_id||null,page_id:n,page_title:RDR.util.getPageProperty("title")||null,canonical_url:RDR.util.getPageProperty("canonical_url")||null,page_url:RDR.util.getPageProperty("page_url")||null,long_term_session:RDR.user.guid||null,short_term_session:RDR.user.session||null,referrer:document.referrer,content_attributes:e.content_attributes||null,content_location:e.content_location||null,topics:RDR.group.topics||null,author:RDR.group.author||null,site_section:RDR.group.section||null,isTouchBrowser:isTouchBrowser,screen_width:screen.width,screen_height:screen.height,pixel_density:window.devicePixelRatio||Math.round(window.screen.availWidth/document.documentElement.clientWidth),user_agent:navigator.userAgent,container_hash:e.container_hash||null,container_kind:e.container_kind||null,reaction_body:e.reaction_body||null});if(typeof RDR.group.xdmLoaded!="undefined"&&RDR.group.xdmLoaded===true){t.postMessage("register-event::"+r,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}else{RDR.event_queue.push(e)}}}},groupSettings:{getCustomSettings:function(){var e=window.readrboard_extend||{};var n=RDR.util.getQueryParams(),r={};t.each(n,function(e,t){if(e.indexOf("rdr_")===0){e=e.substr(4);r[e]=t}});e=t.extend({},e,r);return RDR.groupSettings._translate(e)},translators:{blessed_tags:function(e){return t.map(e,function(e,t){return{body:e}})}},_translate:function(e){var n={};var r=RDR.groupSettings.translators;t.each(e,function(e,t){n[e]=!!r[e]?r[e](t):t});return n},getBlessedTags:function(e){function o(e){var n=t('[rdr-hash="'+e+'"]');var r=n.attr("rdr-item");return r}var n=window.readrboard_extend_per_container;if(e&&n){var r=o(e);var i=n[r];if(i&&i.blessed_tags){var s=RDR.groupSettings._translate(i);return s.blessed_tags}}return RDR.group.blessed_tags}},rindow:{defaults:{coords:{left:100,top:100},animTime:100,defaultHeight:260,minHeight:10,maxHeight:300,minWidth:100,maxWidth:600,forceHeight:false,rewritable:true},makeHeader:function(e,n){function f(){var e=t('<div class="rdr_linkWrap">'+"<ul>"+'<li class="rdr_link">'+'<a href="javascript:void(0);" class="rdr_undo_link">Remove reaction</a>'+"</li>"+'<li class="rdr_link">'+'<a target="_blank" href="'+RDR_baseUrl+"/interaction/"+n+'" class="rdr_seeit_link">View at ReadrBoard</a>'+"</li>"+"</ul>"+"</div>");return e}var r=e||"";var i=t.mustache('<div class="rdr rdr_header">'+'<div class="rdr_header_arrow">'+'<img src="{{RDR_staticUrl}}widget/images/header_up_arrow.png" />'+"</div>"+'<div class="rdr_loader"></div>'+'<div class="rdr_about"><a href="http://www.readrboard.com/" target="_blank">&nbsp;</a></div>'+'<div class="rdr_indicator_stats">'+'<img class="no-rdr rdr_pin" src="{{RDR_staticUrl}}widget/images/blank.png">'+'<span class="rdr_count"></span>'+"</div>"+"<h1>{{headerText}}</h1>"+"</div>",{RDR_staticUrl:RDR_staticUrl,headerText:r});var s=t(i);if(!n){return s}var o=t('<div class="rdr_menuDropDown rdr_menu_actions">'+'<span class="rdr_icon-chevron-down rdr_menuTrigger"></span>'+"</div>");var u=f();o.append(u);var a=t('<div class="rdr_rindowMenu"></div>').append(o);if(isTouchBrowser){a.on("tap",".rdr_menuDropDown",function(){t(this).toggleClass("rdr_hover")})}s.append(a);return s},makeDefaultPanelMessage:function(e,n){var r=e.data("hash");var i=RDR.summaries[r];var s=n||(e.hasClass("rdr_indicator_details")?"media":"text");var o;if(s=="text"){if(e.data("mode")=="writeMode"){o="What do you think?"}else{if(s=="text"){o="Reactions"}else{o=i.counts.tags>0?i.counts.tags+" Reactions":"Reactions"}}}else{var u=t.browser.msie&&parseInt(t.browser.version,10)<9?20:0;o=i.counts.tags>0?i.counts.tags+" Reactions":e.width()>=175+u?"What do you think?":"React:"}return o},updateFooter:function(e,t){var n=e.find("div.rdr_footer");n.show(0);if(typeof t!="undefined")n.html(t)},hideFooter:function(e){e.find("div.rdr_footer").hide(0)},panelCreate:function(e,n){if(!e)return;var r=e.find("div.rdr_body_wrap"),i=r.find("div.rdr_body").eq(0);var s=r.find("div."+n);s.remove();var o=t('<div class="rdr_body '+n+'"/>'),u=r.find("div.rdr_body").length+1;return o},panelUpdate:function(e,t,n,r){if(!e)return;var i=e.find("div.rdr_body_wrap"),s=i.find("div."+t);if(r){s.append(n)}else{s.replaceWith(n)}return n},panelShow:function(e,t,n){var r=e.find(".rdr_body_wrap");var i=e.find(".rdr_visiblePanel");if(!i.length){i=e.find(".rdr_body").eq(0)}var s=i.width();t.show().addClass("rdr-visible").css({position:"relative",top:0,left:s});e.data("panelState",2);t.addClass("rdr_visiblePanel").removeClass("rdr_hiddenPanel");i.addClass("rdr_hiddenPanel").removeClass("rdr_visiblePanel");RDR.rindow.updateSizes(e);r.animate({left:-s},RDR.C.rindowAnimationSpeed,function(){if(n)n();if(e.data("jsp")){var t=e.data("jsp");t.reinitialise()}else{e.jScrollPane({showArrows:true})}})},panelHide:function(e,t){var n=e.find(".rdr_body_wrap");var r=e.hasClass("rdr_writemode"),i=RDR.actions.indicators.utils.makeTagsListForInline(e,r);var s="rdr_tags_list";var o=e.find(".rdr_visiblePanel");o.removeClass("rdr_visiblePanel").addClass("rdr_hiddenPanel");i.addClass("rdr_visiblePanel").removeClass("rdr_hiddenPanel");var u=i.width();o.css("left",u);n.css("left",-u);RDR.rindow.updateSizes(e);n.animate({left:0},RDR.C.rindowAnimationSpeed,function(){if(t)t();e.data("panelState",1);if(e.data("jsp")){var n=e.data("jsp");n.reinitialise()}else{e.jScrollPane({showArrows:true})}})},panelEnsureFloatWidths:function(e){return;var t=e.find(".rdr_body_wrap");var n=e.find(".rdr_visiblePanel");var r=e.find(".rdr_hiddenPanel");var i=r.width();t.css({left:-i});n.css({left:i})},updateTagPanel:function(e){var t=e.data("hash");RDR.rindow.panelHide(e);RDR.rindow.tagBox.setWidth(e,e.data("initialWidth"));RDR.rindow.tagBox.setHeight(e,e.data("initialHeight"))},mediaRindowShow:function(e){var n=e.data("hash"),r=t("#rdr_indicator_details_"+n);RDR.util.cssSuperImportant(r,{display:"block"});if(e.data("hover")&&!r.data("hover")&&!r.is(":animated")&&!r.closest("div.rdr_media_details").length){r.data("hover",true);RDR.rindow.updateSizes(r)}r.addClass("rdr_engaged")},mediaRindowHide:function(e){var n=e.data("hash"),r=t("#rdr_indicator_details_"+n);if(!e.data("hover")&&!r.is(":animated")&&!r.closest("div.rdr_media_details").length){r.data("hover",false).animate({height:"0px"},RDR.C.rindowAnimationSpeed,function(){RDR.util.cssSuperImportant(r,{display:"none"})})}r.removeClass("rdr_engaged");t("#rdr_indicator_"+n).hide()},updateSizes:function(e,t){var n=e.hasClass("rdr_indicator_details")?"media":"text";var r=t||{};var i=e.find(".rdr_visiblePanel");var s=e.data("initialWidth"),o=e.data("initialHeight");var u,a;var f=0;var l={h:200,w:200,duration:RDR.C.rindowAnimationSpeed};l.w=i.width();l.h=i.height()+32;u=r.setWidth||l.w;a=r.setHeight||l.h;if(r.noAnimate){e.css({width:u,height:a})}e.animate({width:u,height:a},{duration:l.duration,queue:false});RDR.rindow.jspUpdate(e)},updatePageTagMessage:function(e,n){if(n=="tagDeleted"){var r=t("div.rdr_window:eq(0)");RDR.rindow.hideFooter(r);r.find(".rdr_header h1").text("Reaction Undone");r.find(".rdr_body").css("height","auto").html('<div class="rdr_reactionMessage rdr_reactUndoSuccess">'+'<div class="rdr_label_icon"></div>'+"<em>"+"<span>Your Reaction: </span>"+"<strong> "+e.tag.body+" </strong>"+"<span>has been undone.</span>"+"</em>"+"</div>")}},updateTagMessage:function(e){if(e.scenario&&e.rindow){if(e.args){t.each(e.args,function(n,r){if(typeof r=="object"){e[n]=t.extend(true,{},r)}else{e[n]=r}})}var n=e.hash,r=e.rindow,i=e.kind,s=e.tag,o=RDR.summaries[n],u=e.sendData?e.sendData.content_node_data:{};RDR.rindow.tagBox.setWidth(r,320);if(e.scenario!="tagDeleted"){if(e.scenario=="reactionSuccess"||e.scenario=="reactionExists"){var a=t('<div class="rdr_view_success"></div>'),f=t('<div class="rdr_subheader rdr_clearfix"></div>').appendTo(a),l=s.body?s.body:s.tag_body,c=t("<h1>"+l+"</h1>").appendTo(f),h=t('<div class="rdr_nextActions"></div>').appendTo(a);if(e.kind!="page"){var p=RDR.actions.comments.makeCommentBox({content_node:u,summary:o,hash:n,tag:s,$rindow:r,selState:u.selState||null}).appendTo(h)}var d=t('<div class="rdr_back">Close X</div>');a.prepend(d);d.click(function(){var e=RDR.rindow.safeClose(r);if(!e){return}RDR.rindow.updateTagPanel(r)});var v=true;RDR.rindow.panelUpdate(r,"rdr_view_more",a,v);RDR.user=RDR.user||{};var m=function(e){var t=e.data.args;var n={hash:t.hash,int_id:t.response.data.interaction.id,tag:t.tag,rindow:r};RDR.actions.interactions.ajax(n,"react","remove")};if(isTouchBrowser){r.find("a.rdr_undo_link").on("tap.rdr",{args:e},m)}else{r.find("a.rdr_undo_link").on("click.rdr",{args:e},m)}a.find(".rdr_comment_input").append('<div class="rdr_commentBox rdr_inlineCommentBox">'+'<div class="rdr_label_icon"></div>'+'<textarea class="rdr_add_comment_field rdr_inlineComment">Add a comment or #hashtag</textarea>'+'<div class="rdr_clear"></div>'+"</div>");var g=a.find(".rdr_add_comment_field");g.focus(function(){t(this).addClass("rdr_adding_comment");if(t(this).val()=="Add a comment or #hashtag"){t(this).val("")}}).blur(function(){if(t(this).val()===""){t(this).val("Add a comment or #hashtag");t(this).removeClass("rdr_adding_comment")}}).on("keyup",{args:e},function(e){var t=g.val();if(e.keyCode=="27"){}else if(e.keyCode=="13"){y(e)}else if(t.length>RDR.group.comment_length){t=t.substr(0,RDR.group.comment_length);g.val(t)}});a.find("button.rdr_add_comment").on("click",{args:e},function(e){y(e)});function y(e){var t=e.data.args.args?e.data.args.args:e.data.args,n=t.sendData.content_node_data,r=t.hash,i=t.page_id,s=t.rindow,o=t.tag,u=g.val();if(u.length>RDR.group.comment_length){u=u.substr(0,RDR.group.comment_length);g.val(u)}if(u!="Add a comment or #hashtag"){var a=RDR.summaries[r];n.kind=a.kind;var f={hash:r,page_id:i,content_node_data:n,comment:u,content:n.body,tag:o,rindow:s};RDR.actions.interactions.ajax(f,"comment","create")}else{g.focus()}}function b(){var i=t('<div class="rdr_shareLinks">Share your reaction: <ul></ul></div>'),o=["facebook","twitter"];t.each(o,function(o,a){var f=t('<li><a href="http://'+a+'.com" ><i class="rdr_icon-'+a+'"></i></a></li>');i.find("ul").append(f);f.click(function(){var t=e.tag.tag_body||e.tag.body;if(e.hash.jquery){u.hash="page";n=e.hash="page"}RDR.events.trackEventToCloud({event_type:"share",event_value:a,container_hash:n,container_kind:e.kind,page_id:e.page_id,reaction_body:t});var i=RDR.summaries[n];var o=e.kind||i.kind;RDR.shareWindow=window.open(RDR_staticUrl+"share.html","readr_share","menubar=1,resizable=1,width=626,height=436");RDR.actions.share_getLink({referring_int_id:e.response.data.interaction.id,hash:e.hash,kind:o,sns:a,rindow:r,tag:s,content_node:u});return false})});return i}var w=t(".rdr_nextActions");w.append(b())}RDR.actions.containers.media.onEngage(n)}else{var E=RDR.rindow.makeDefaultPanelMessage(r);var S=RDR.rindow.makeHeader(E);r.find(".rdr_header").replaceWith(S);r.removeClass("rdr_viewing_more").find("div.rdr_indicator_details_body").show();RDR.rindow.panelHide(r)}RDR.rindow.updateSizes(r)}},jspUpdate:function(e){if(!e.closest(".jspContainer").length&&!e.hasClass("jspScrollable")){e.find("div.rdr_body").each(function(){var e=t(this);if(!e.hasClass("jspScrollable")){t(this).jScrollPane({showArrows:true})}else{var n=t(this).data("jsp");n.reinitialise()}})}},tagBox:{setWidth:function(e,t){var n=RDR.group.max_rindow_width?RDR.group.max_rindow_width:t;e.removeClass("w160 w320 w480 w640").addClass("w"+n)},setHeight:function(e,t){e.find(".rdr_body, .jspContainer").height(t)},make:function(e){function j(e,t){if(!i.find(".rdr_view_more").length||!i.find(".rdr_view_more").hasClass("rdr_visiblePanel")){var n=RDR.rindow.panelCreate(i,"rdr_view_more");var r=i.find("div.rdr_body_wrap");r.append(n);n.append(e).addClass("rdr_page_reactions_summary");RDR.rindow.tagBox.setWidth(i,320);RDR.rindow.panelShow(i,n,function(){RDR.rindow.hideFooter(i)})}else{i.find(".rdr_body").html(e);RDR.rindow.jspUpdate(i)}var s=t.tag_count<=0?"no reactions":t.tag_count==1?"1 reaction":t.tag_count+" reactions";var o=RDR.rindow.makeHeader(s);i.find(".rdr_header").replaceWith(o)}function F(){var e=t('<div class="rdr_back">Close X</div>');e.click(function(){var e=!!i.attr("rdr-view-reactions-for");if(!e){RDR.rindow.close(i);return}});return e}function I(e,r,i){t().selog("hilite",true,"off");t(".rdr_twtooltip").remove();var s=F(),o=t('<table cellpadding="0" cellspacing="0" border="0" class="reaction_summary_table"></table>').append('<tbody><tr class="rdr_page_reactions"></tr></tbody>');if(r&&r.page&&r.page>0){var u=r.page==1?"1 reaction":r.page+" reactions";o.find(".rdr_page_reactions").append('<td colspan="2"><strong>'+u+"</strong> to this <strong>page</strong></td>")}if(r.img>0||r.text>0||r.media>0){o.find(".rdr_page_reactions").addClass("has_other_reactions");t.each(RDR.interaction_data[n.id],function(e,r){var s=r.hash;var u=RDR.summaries[s];var a=t('[rdr-hash="'+s+'"]');var f=u.pageId;if(!f||!i||f!=i){return}if(!o.find("tr.rdr_int_summary_"+e).length){var l=t('<tr valign="middle" class="rdr_content_reaction rdr_int_summary_'+e+'"/>'),c=RDR.interaction_data[n.id][e];if(typeof c.interaction!="undefined"&&typeof c.content_node!="undefined"){var h=c.interaction.count>1?"reactions":"reaction";l.append('<td class="rdr_count"><h4>'+c.interaction.count+"</h4><h5>"+h+"</h5></td>").data("count",c.interaction.count).data("tag",n).data("int_id",e);if(c.kind=="text"){l.append('<td class="rdr_content">'+c.content_node.body+"</td>")}else if(c.kind=="img"){l.append('<td class="rdr_content"><img src="'+c.content_node.body+'" height="50"/></td>')}else if(c.kind=="media"){l.append('<td class="rdr_content"><img src="'+RDR_baseUrl+'/static/widget/images/video_icon.png" height="33" style="margin-bottom:-10px;"/> <div style="display:inline-block;margin-left:10px;">Video</div></td>')}l.click(function(e){e.preventDefault();var t={container_hash:c.hash,location:c.content_node.location};RDR.session.revealSharedContent(t);RDR.events.trackEventToCloud({event_type:"summary bar",event_value:"view content",page_id:f})});if(!o.find("tr.rdr_content_reaction").length){o.find("tbody").append(l)}else{var p=0;t.each(o.find("tr.rdr_content_reaction"),function(e,n){if(parseInt(c.interaction.count)>parseInt(t(n).data("count"))){p=e;return false}});o.find("tr.rdr_content_reaction:eq("+p+")").before(l)}}}})}return t("<div/>").append(s,o)}var n=e.tag,r=e.boxSize?e.boxSize:"medium",i=e.$rindow?e.$rindow:null,s=e.$tagContainer?e.$tagContainer:e.$rindow?e.$rindow.find("div.rdr_body.rdr_tags_list"):null,o=i.attr("rdr-view-style")||"grid",u=n.tag_count?n.tag_count:"",a=0,f="",l=e.colorInt?e.colorInt:1,c=e.isWriteMode?e.isWriteMode:false,h=i.data("kind"),p=i.data("hash")?i.data("hash"):i.data("container"),d=RDR.summaries[p],v=typeof d!="undefined"?d.counts.tags:0,m=n.content_node_id?n.content_node_id:false,g=m?d.content_nodes[m]:"",y="";var b=o=="horizontal_bars"?true:false;if(b===true){a=parseInt(u/v*100);f="width:"+Math.round(u/d.counts.highest_tag_count*75)+"%"}if(m){g.id=m}var r=r=="big"?"rdr_box_big":r=="medium"?"rdr_box_medium":"rdr_box_small",w="",E=c?"rdr_writeMode":"",S=n.body?n.body:n.tag_body,x="",T="";if(h=="page"){y=c?"+1 "+S:""}else if(u==""){y=""}else if(u==-101){y="+1 "+S}else{var y="+1 "+S}var N="";if(typeof S!="undefiend"&&S.length<16||b===true){N="rdr_charCount"+S.length;x='<div class="rdr_tag_body rdr_tag_lineone">'+S+"</div>"}else{T="rdr_tag_split";if(S.indexOf(" ")==-1){N="rdr_charCount15";x='<div class="rdr_tag_body rdr_tag_lineone">'+S.substr(0,15)+"-<br/>"+S.substr(15)+"</div>"}else{var C="",k="",L=true;tagBodyRawSplit=S.split(" ");while(L){C+=tagBodyRawSplit.shift()+" ";if(C.length+tagBodyRawSplit[0].length>=16)L=false}k=tagBodyRawSplit.join(" ");N="rdr_charCount"+C.length;x='<div class="rdr_tag_body rdr_tag_lineone">'+C+"<br>"+k+"</div>"}}var A=n.id;var O=n.parent_id;var M=m?"rdr_content_node_"+m:"";var u=u||0;var _=b===true?a+"%":u;var D=!c&&h=="page"?"":'<span class="rdr_plusOne">+1</span>';var P=c?"":'<span class="rdr_count">'+_+"</span>"+'<i class="rdr_icon-search rdr_tag_read_icon"></i>';var H='<div class="rdr_color'+l+" "+r+" rdr_box "+w+" "+E+'" style="'+f+'">'+"<div "+'class="rdr_tag '+T+" "+M+" "+N+'" '+'data-tag_id="'+A+'" '+'data-tag_count="'+u+'" '+'data-parent_id="'+O+'" '+'data-content_node_id="'+m+'" '+">"+x+P+D+"</div>"+"</div>";var B=t(H);s.append(B);if(h=="page"){if(c==false){var q=function(){RDR.rindow.hideFooter(i);i.removeClass("rdr_rewritable");var e=RDR.util.getPageProperty("id",p),r=RDR.pages[e],s=n.tag_count,o={img:0,text:0,media:0,page:s=="+"?0:s};RDR.events.trackEventToCloud({event_type:"summary bar",event_value:"view reactions",page_id:e});t.each(r.containers,function(e,t){if(RDR.summaries&&RDR.summaries[t.hash]&&RDR.summaries[t.hash].top_interactions){if(RDR.summaries[t.hash].top_interactions.tags&&RDR.summaries[t.hash].top_interactions.tags[n.id]){o[RDR.summaries[t.hash].kind]+=RDR.summaries[t.hash].top_interactions.tags[n.id].count;o.page-=RDR.summaries[t.hash].top_interactions.tags[n.id].count}}});var u=t(this),a=I(u,o,r.id);j(a,n);u.addClass("rdr_live_hover")};B.click(function(){q()})}else{B.click(function(){t(this).addClass("rdr_tagged");i.removeClass("rdr_rewritable");var e=i.data("container");args={tag:n,hash:e,uiMode:"writeMode",kind:i.data("kind"),rindow:i,content_node:g};RDR.actions.interactions.ajax(args,"react","create")})}}else{if(isTouchBrowser){B.bind("tap",function(){t(this).addClass("rdr_tagged");i.removeClass("rdr_rewritable");var e=i.data("container");args={tag:n,hash:e,uiMode:"writeMode",kind:i.data("kind"),rindow:i,content_node:g};RDR.actions.interactions.ajax(args,"react","create")})}else{B.click(function(){t(this).addClass("rdr_tagged");i.removeClass("rdr_rewritable");var e=i.data("container");args={tag:n,hash:e,uiMode:"writeMode",kind:i.data("kind"),rindow:i,content_node:g};RDR.actions.interactions.ajax(args,"react","create")})}}if(!isTouchBrowser){B.hover(function(){var e=t(this);if(!e.hasClass("rdr_tagged")){var n=e.find("span.rdr_tag_count");n.width(n.width());n.text("+")}},function(){var e=t(this);e.find("span.rdr_tag_count").text(e.find(".rdr_tag").data("tag_count"))})}var R={},U=0;if(!t.isEmptyObject(g)&&!t.isEmptyObject(g.top_interactions)&&!t.isEmptyObject(g.top_interactions.coms)){t.each(g.top_interactions.coms,function(e,r){if(r.tag_id==parseInt(n.tag_id)){U++;if(t.isEmptyObject(R)){R=g.top_interactions.coms}}})}var z=t.isEmptyObject(R)&&typeof d!="undefined"&&(d.kind=="img"||d.kind=="media"||d.kind=="med")&&!t.isEmptyObject(d.top_interactions)&&!t.isEmptyObject(d.top_interactions.coms);if(!n.id){n.id=n.tag_id}if(z){R=d.top_interactions.coms[n.id];if(!t.isEmptyObject(R)){U=R.length}}if(!t.isEmptyObject(R)&&!c){var W=t('<span class="rdr_comment_hover rdr_tooltip_this" title="view comments"></span>');W.append('<i class="rdr_icon-comment"></i> '+U);if(isTouchBrowser){W.bind("tap",function(){t(this).tooltip("hide");RDR.actions.viewCommentContent({tag:n,hash:p,rindow:i,content_node:g,selState:g.selState});return false})}else{W.click(function(){t(this).tooltip("hide");RDR.actions.viewCommentContent({tag:n,hash:p,rindow:i,content_node:g,selState:g.selState});return false})}B.append(W);W.tooltip()}return B}},writeCustomTag:function(e,n,r){var e=n.find(".rdr_footer");e.append('<div class="rdr_box"></div> ');if(e.find("div.rdr_custom_tag").not("div.rdr_custom_tag.rdr_tagged").length==0){var r=r?r:"react",i=r=="react"?"+ Add your own":"+ Add tag...";var s=t('<div class="rdr_click_overlay"></div>').appendTo(e);var o=t('<div class="rdr_tag rdr_custom_tag"></div>');var u=t('<input value="'+i+'" />').appendTo(o);var a=t('<button class="rdr_custom_tag_submit" name="rdr_custom_tag_submit">ok</button>').appendTo(o);a.click(function(){f(o,u)});s.click(function(){u.focus()});u.focus(function(){var e=t(this);e.removeClass("rdr_default");if(e.val()==i){e.val("")}s.hide();a.show()}).blur(function(){var e=t(this);if(e.val()===""){e.val(i);a.hide();s.show()}if(e.val()==i){e.addClass("rdr_default");a.hide();s.show()}e.closest("div.rdr_tag").removeClass("rdr_hover")}).keyup(function(e){var t=u;if(e.keyCode=="13"){f(o,u)}else if(e.keyCode=="27"){t.blur();return false}else if(t.val().length>25){var n=t.val();t.val(n.substr(0,25))}});e.find(".rdr_box").append(o," ");function f(e,t){var i={},s=n.data("container");var o=t.val();if(o===""){return}i.body=o;e.parent().addClass("rdr_tagged");args={tag:i,hash:s,uiMode:"writeMode",kind:n.data("kind"),rindow:n};RDR.actions.interactions.ajax(args,r,"create");t.blur()}t(document).on("keydown.rdr",function(n){keyCodes=[16,81,87,69,82,84,89,85,73,79,80,65,83,68,70,71,72,74,75,76,90,88,67,86,66,78,77,49,50,51,52,53,54,55,56,57,48,189,187,219,221,220,186,222,188,190,191,192];if(t.inArray(n.keyCode,keyCodes)!=-1){e.find("input").focus()}})}},_rindowTypes:{tagMode:{make:function(e){if(e.is_page==true){var n=e.page,r=t(".rdr-summary-"+n.id),i={top:r.offset().top,left:r.offset().left};if(t("div.rdr_page_key_"+r.data("page_key")).length){return}var s=RDR.rindow.draw({coords:i,container:r,content:"page",kind:"page",mode:e.mode})}else{var o=e.hash;var u=RDR.util.getPageProperty("id",o);var a=RDR.summaries[o],f=a.$container,l=a.kind,c=e.rewritable==false?false:true,i={};var h=e.actionType?e.actionType:"react";if(e.mode=="writeMode"){RDR.events.trackEventToCloud({event_type:"rindow_show",event_value:"writemode",container_hash:o,container_kind:l,page_id:u});var p;if(l=="text"){p=f.selog("helpers","smartHilite");if(!p)return false;e.content=p.text;i.left=i.left+40;i.top=i.top+35;if(p){var d=p.hiliter,v=d.get$end();if(v){var m=t("<span />");m.insertAfter(v);var g=m.offset().right;var y=m.offset().bottom;m.remove();i.left=g-14;i.top=y+23}}}else{var b=!f.parents(RDR.group.img_container_selectors).length?f.offset().bottom-5:f.parents(RDR.group.img_container_selectors).first().offset().bottom+5;var i={top:b,left:f.offset().left}}}else{var w='[rdr-hash="'+o+'"]';var E=t("#rdr_indicator_"+o),S=t("#rdr_indicator_body_"+o),f=t('[rdr-hash="'+o+'"]');if(l=="text"){i={top:S.offset().top+22,left:S.offset().left-5}}else{var i={top:f.offset().bottom+5,left:f.offset().left};RDR.events.trackEventToCloud({event_type:"rindow_show",event_value:"readmode",container_hash:o,container_kind:l,page_id:u})}}if(typeof e.$custom_cta!="undefined"){i.top=e.$custom_cta.offset().top+parseInt(e.$custom_cta.attr("rdr-offset-y"));i.left=e.$custom_cta.offset().left+parseInt(e.$custom_cta.attr("rdr-offset-x"))}var s=RDR.rindow.draw({coords:i,container:o,content:e.content,kind:l,selState:p,rewritable:c,mode:e.mode});s.data("hash",o);a["$rindow_"+e.mode.toLowerCase()]=s}s.addClass("rdr_"+e.mode.toLowerCase());var x=RDR.rindow.makeDefaultPanelMessage(s);var T=RDR.rindow.makeHeader(x);s.find(".rdr_header").replaceWith(T);s.addClass("rdr_reactions");var N=s.find("div.rdr_body_wrap");var C=s.find("div.rdr_body");if(C.length){C.remove()}if(e.is_page==true){var k=RDR.actions.indicators.utils.makeTagsListForInline(s,e.mode=="writeMode",n)}else{var k=RDR.actions.indicators.utils.makeTagsListForInline(s,e.mode=="writeMode")}N.append(k);var L=N.width(),A=N.height();var O=RDR.util.stayInWindow({coords:i,width:L,ignoreWindowEdges:e.ignoreWindowEdges});s.css("left",O.left+"px").css("top",O.top+"px");s.animate({width:L},333,"swing");s.data("initialWidth",L).data("initialHeight",A);s.find("div.rdr_cell_wrapper div.rdr_tag").css({width:"100%"});return s},customOptions:{},setup:function(){}}},make:function(e,n){var r=n.hash,i=RDR.summaries[r],s=n.kind,o=n.is_page;if(!o&&!i){var i=RDR.util.makeEmptySummary(r);RDR.actions.containers.setup(i)}if(!e)e="readMode";var u=RDR.rindow.defaults,a=RDR.rindow._rindowTypes.customOptions,f=t.extend({},u,a,n,{mode:e});var l=RDR.rindow._rindowTypes.tagMode.make(f);return l},draw:function(e){RDR.rindow.closeAll();if(e.selector&&!e.container){e.container=e.selector.substr(5)}var n=t.extend({},this.defaults,e);var r=n.minHeight<60?60:n.minHeight,i=n.maxHeight;minWidth=n.minWidth,maxWidth=n.maxWidth,rdr_for=typeof n.container=="string"?"rdr_for_"+n.container:"rdr_for_page",$new_rindow=t('<div class="rdr rdr_window rdr_rewritable rdr_widget w160 '+rdr_for+'"></div>');if(n.id){t("#"+n.id).remove();$new_rindow.attr("id",n.id)}t("#rdr_sandbox").append($new_rindow);if(n.kind=="page"){$new_rindow.addClass("rdr_page_key_"+e.container.data("page_key")).addClass("rdr_page_summary")}$new_rindow.data(n);if($new_rindow.find("div.rdr_header").length===0){$new_rindow.html("");$new_rindow.append('<div class="rdr rdr_header">'+'<div class="rdr_header_arrow"><img src="'+RDR_staticUrl+'widget/images/header_up_arrow.png" /></div>'+'<div class="rdr_loader"></div>'+'<div class="rdr_about"><a href="http://www.readrboard.com/" target="_blank">&nbsp;</a></div>'+"</div>"+'<div class="rdr rdr_body_wrap rdr_clearfix"></div>'+'<div class="rdr rdr_footer"></div>');if(n.noHeader)$new_rindow.find("div.rdr_header").remove();$new_rindow.drags({handle:".rdr_header"})}var s=n.coords;$new_rindow.css("left",s.left+"px");$new_rindow.css("top",s.top+"px");if(n.height){$new_rindow.height(n.height)}RDR.actionbar.closeAll();$new_rindow.settings=n;$new_rindow.on("resizestop",function(e,n){var r=t(this)});return $new_rindow},safeClose:function(e){var t=!!e.attr("rdr-view-reactions-for");if(t){var n=RDR.rindow.makeHeader("Reactions");e.find(".rdr_header").replaceWith(n);RDR.rindow.updateFooter(e);var r=e.find(".rdr_body_wrap"),i=r.find(".rdr_visiblePanel"),s=r.find(".rdr_hiddenPanel");r.animate({left:0});i.removeClass("rdr_visiblePanel").addClass("rdr_hiddenPanel");s.removeClass("rdr_hiddenPanel").addClass("rdr_visiblePanel");return true}RDR.rindow.close(e);return true},close:function(e){RDR.rindow.clearHilites(e);e.each(function(e,n){t(n).remove()});t("#rdr_indicator_details_wrapper").find(".rdr_body_wrap").css({visibility:"visible"})},closeAll:function(){var e=t("div.rdr.rdr_window").not(".rdr_no_clear");RDR.rindow.close(e);t(".rdr_shared").removeClass("rdr_shared");t(document).unbind("keydown.rdr")},clearHilites:function(e){var n=[];e.each(function(e,r){var i=t(r).data("container");if(typeof i==="undefined")return;var s=RDR.summaries[i];var o=t(r).data("selState");if(typeof o!=="undefined"&&o!==""){n.push(o)}var u=[];if(s&&s.hasOwnProperty("content_nodes")){u=s.content_nodes}t.each(u,function(e,t){var r=t.selState;if(typeof r!=="undefined"){n.push(r)}})});t.each(n,function(e,n){try{t().selog("hilite",n,"off")}catch(r){}})},update:function(e,n){function a(e,n){var r,i;r=e.find(".rdr_tags");i=r.find(".rdr_tag_"+n.parent_interaction_node.id).filter(function(){return t(this).hasClass("rdr_content_node_"+n.content_id)});i.addClass("rdr_comment_indicator");l(n,i,e);f(e);c(n,i,e)}function f(e){var n=e.find("table.rdr_tags");if(n.find("tr:eq(0)").find("td").length==1){n.addClass("rdr-one-column");if(!isTouchBrowser){n.find("td.rdr_has_pillHover").on("mouseenter, mousemove",function(){var e=t(this),n=e.closest("div.rdr_window");thisWidth=n.data("initialWidth")}).on("mouseleave",function(){var e=t(this),n=e.closest("div.rdr_window");thisWidth=n.width()})}}}function l(n,i,s){var o=r.content_nodes;var u=o[n.content_id];if(u){var a=u.top_interactions.coms}else{var f=t.mustache('contentNode not found by id: {{id}}.  Figure out why nodeId was saved as "undefined".',{id:n.content_id});RDR.safeThrow(f)}var l=t.map(a,function(e){return e.tag_id===n.tag_id?e:null});var c=l.length;var h=i;var p=n.parent_interaction_node;var d=n.content_node;h.find(".rdr_comment_hover").remove();h.find(".rdr_comment_indicator").remove();var v=t('<span class="rdr_comment_hover"/>');v.append('<span class="rdr_icon"></span> '+c);v.click(function(){RDR.actions.viewCommentContent({tag:p,hash:e,rindow:s,content_node:d,selState:d.selState})});h.append(v);h.closest("td").addClass("rdr_has_pillHover")}function c(e,n,r){var i=e.parent_interaction_node;var s=e.content_node;var o=t('<span class="rdr_comment_feedback"/>');o.append('<span class="linkToComment">Thanks for your comment! <a href="javascript:void(0);">Close</a></span> ');o.click(function(e){e.preventDefault();RDR.rindow.safeClose(r)});r.find("div.rdr_commentBox").empty().append(o).show();r.find("button.rdr_add_comment").hide()}var r=RDR.summaries[e],i=r.$rindow_readmode,s=r.$rindow_writemode;if(n){if(n.int_type=="coms"){if(s&&s.length){$tags=s.find(".rdr_tags").find(".rdr_tag");$tags.addClass("rdr_content_node_"+n.content_id);a(s,n)}if(i&&i.length){a(i,n)}else{var o=t("#rdr_indicator_details_"+e);$tags=o.find(".rdr_tags").find(".rdr_tag");$tags.addClass("rdr_content_node_"+n.content_id);a(o,n)}}}else{var u=r.kind&&(r.kind=="img"||r.kind=="media"||r.kind=="med");if(!u){return}RDR.actions.indicators.utils.makeDetailsContent(e)}}},actionbar:{draw:function(e){function p(e){var r=t("#rdr_container_tracker_"+n),i=r.find(".rdr_mediaHilite_top");var s={top:i.offset().top,left:i.offset().right};return s}var n=e.hash,r=e.coords,i=e.kind,s=e.content,o=e.src_with_path||undefined,u=RDR.util.getPageProperty("id",n);var a="rdr_actionbar_"+n;var f=t("div.rdr_actionbar");if(t("#"+a).length>0)return t("#"+a);var l={IE:{top:"add this here",left:"add this here"},img:p,text:{top:r.top+8,left:r.left+3}};r=i=="text"?l.text:l.img(r);if(i=="text"){r=RDR.util.stayInWindow({coords:r,width:45,height:30,paddingY:40,paddingX:40,ignoreWindowEdges:e.ignoreWindowEdges})}var c=t('<div class="rdr rdr_actionbar rdr_widget rdr_widget_bar" id="'+a+'" ></div>');c.css({top:r.top,left:r.left});if(!n){RDR.safeThrow("There should always be a hash from hashNodes after hover on an unhashed image.");return}c.data("hash",n);c.append("<ul/>");var h=[{item:"reaction",tipText:"What do you think?",onclick:function(){RDR.rindow.make("writeMode",{hash:n,kind:i,content:s,src_with_path:o})}}];t.each(h,function(e,n){var r=t('<li class="rdr_icon_'+n.item+'" />'),i=t('<a href="javascript:void(0);" class="rdr_tooltip_this" title="'+n.tipText+'">'+'<span class="rdr rdr_react_icon">'+n.item+"</span>"+'<span class="rdr rdr_react_label">What do you think?</span>'+'<div class="rdr_clear"></div>'+"</a>");i.click(function(){n.onclick();return false});r.addClass("rdr_actionbar_first").append(i).appendTo(c.children("ul"))});t("#rdr_sandbox").append(c);if(i=="img"||i=="media"||i=="med"){c.addClass("rdr_actionbar_for_media");c.append('<div style="clear:both;" />').removeClass("rdr_widget rdr_widget_bar")}return c},close:function(e,n){function r(e,n){var r=e.data("timeoutCloseEvt");var i=e.data("timeoutCollapseEvt");clearTimeout(r);clearTimeout(i);var s=t('[rdr-hash="'+n+'"]'),o=t("#rdr_indicator_"+n);s.removeClass("rdr_engage_media");e.remove()}e.each(function(){var e=t(this),i=e.data("hash"),s=t("#rdr_container_tracker_"+i);if(typeof n!=="undefined"){e.fadeOut(200)}else{r(e,i);var o=t("#rdr_indicator_"+i)}})},closeSuggest:function(e){var n=t();if(!e){n=t("div.rdr_actionbar")}else if(typeof e=="string"){var r=e;n=t("#rdr_actionbar_"+r);n.data("hash",r)}else{t.each(e,function(e,t){n=n.add("#rdr_actionbar_"+t);n.data("hash",t)})}var i=this;n.each(function(){var e=t(this),r=n.data("hash"),s=t("#rdr_indicator_details_"+r),o=t('[rdr-hash="'+r+'"]'),u=t(this).data("timeoutCloseEvt");clearTimeout(u);u=setTimeout(function(){if(e.data("hover")||o.data("hover")||s.data("hover"))return;i.close(e,"fade")},300);t(this).data("timeoutCloseEvt",u)})},closeAll:function(){var e=t("div.rdr_actionbar");this.close(e)}},util:{checkForSelectedTextAndLaunchRindow:function(){var e=t("document").selog("save");if(!e)return;var n=e.range.commonAncestorContainer;var r=n.nodeType===3?t(n).parent():t(n);var i=RDR.actions.startSelect(r,null,function(e,t,n){RDR.rindow.make("writeMode",{hash:e,kind:t,content:n})})},initTouchBrowserSettings:function(){if(isTouchBrowser){t("body").addClass("rdr_touch_browser");t(window).on("scrollend",function(){RDR.util.mobileHelperToggle()})}$RDR.dequeue("initAjax")},mobileHelperToggle:function(){t(RDR.group.active_sections).find("embed[rdr-node], video[rdr-node], object[rdr-node], iframe[rdr-node], img[rdr-node]").each(function(){var e=t(this),n=e.data("hash");RDR.actions.indicators.init(n);e.addClass("rdr_live_hover")})},initPublicEvents:function(){window.readrboard.public_events=t("#rdr_sandbox");$RDR.dequeue("initAjax")},triggerPublicEvent:function(e,t){window.readrboard.public_events.trigger("event",t);window.readrboard.public_events.trigger(e,t)},makeEmptySummary:function(e,t){var n={};n={};n.hash=e;n.kind=t;n.top_interactions={};n.top_interactions.coms={};n.top_interactions.tags={};n.top_interactions.shr={};n.counts={};n.counts.tags=0;n.counts.interactions=0;n.counts.coms=0;return n},getPageProperty:function(e,n){if(!e){e="id"}if(e=="id"){var r;if(n=="page"){r=t(".rdr_window").data("container").attr("rdr-page-id");return parseInt(r,10)}if(typeof n=="object"){if(t(n).closest("[rdr-page-container]").length){return parseInt(t(n).closest("[rdr-page-container]").attr("rdr-page-container"))}}else if(!n){return t("[rdr-page-container]").eq(0).attr("rdr-page-container")}if(typeof n=="string"){var i=n;var s=t('[rdr-hash="'+i+'"]')}var r=s.data("page_id")?s.data("page_id"):s.closest("[rdr-page-container]").length?s.closest("[rdr-page-container]").attr("rdr-page-container"):t("body").attr("rdr-page-container");if(s.hasAttr("rdr-page-container")&&!s.data("page_id")){s.data("page_id",r)}return parseInt(r)}if(e=="title"){var o=t('meta[property="og:title"]').attr("content")?t('meta[property="og:title"]').attr("content"):t("title").text()?t("title").text():"";return t.trim(o)}var u=window.location.href.split("#")[0];if(e=="page_url"){return t.trim(u.toLowerCase())}if(e=="canonical_url"){var a=t('link[rel="canonical"]').length>0?t('link[rel="canonical"]').attr("href"):u;a=a.toLowerCase();if(a==RDR.util.getPageProperty("page_url")){a="same"}return t.trim(a)}},buildInteractionData:function(){t.each(RDR.summaries,function(e,n){t.each(n.top_interactions.tags,function(r,i){if(typeof RDR.summaries[e].content_nodes!="undefined"){t.each(RDR.summaries[e].content_nodes,function(t,i){if(typeof i.top_interactions.tags!="undefined"&&typeof i.top_interactions.tags[r]!="undefined"){var s=i.top_interactions.tags[r];if(typeof RDR.interaction_data[r]=="undefined"){RDR.interaction_data[r]={}}if(typeof RDR.interaction_data[r][s.parent_id]=="undefined"){RDR.interaction_data[r][s.parent_id]={}}RDR.interaction_data[r][s.parent_id].hash=e;RDR.interaction_data[r][s.parent_id].container_id=n.id;RDR.interaction_data[r][s.parent_id].tag={body:s.body,id:r};RDR.interaction_data[r][s.parent_id].kind=n.kind;RDR.interaction_data[r][s.parent_id].interaction={id:s.parent_id,count:s.count,body:s.body};RDR.interaction_data[r][s.parent_id].content_node={body:i.body,location:i.location,selState:i.selState}}})}})})},stayInWindow:function(e){var n=t(window),r=n.width(),i=n.height(),s=n.scrollTop(),o=e.width,u=e.height,a=e.coords,f=e.paddingY||10,l=e.paddingX||10,c=e.ignoreWindowEdges?e.ignoreWindowEdges:"";if(c.indexOf("r")==-1&&a.left+o+16>=r-l){a.left=r-o-l}if(c.indexOf("b")==-1&&a.top+u>i+s-f){a.top=i+s-u-f}if(c.indexOf("l")==-1&&a.left<l){a.left=l}if(c.indexOf("t")==-1&&a.top<s+f){a.top=s+f}return a},md5:{hexcase:0,b64pad:"",chrsz:8,hex_md5:function(e){return RDR.util.md5.binl2hex(RDR.util.md5.core_md5(RDR.util.md5.str2binl(e),e.length*RDR.util.md5.chrsz))},core_md5:function(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var n=1732584193;var r=-271733879;var i=-1732584194;var s=271733878;for(var o=0;o<e.length;o+=16){var u=n;var a=r;var f=i;var l=s;n=RDR.util.md5.md5_ff(n,r,i,s,e[o+0],7,-680876936);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+1],12,-389564586);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+2],17,606105819);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+3],22,-1044525330);n=RDR.util.md5.md5_ff(n,r,i,s,e[o+4],7,-176418897);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+5],12,1200080426);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+6],17,-1473231341);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+7],22,-45705983);n=RDR.util.md5.md5_ff(n,r,i,s,e[o+8],7,1770035416);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+9],12,-1958414417);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+10],17,-42063);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+11],22,-1990404162);n=RDR.util.md5.md5_ff(n,r,i,s,e[o+12],7,1804603682);s=RDR.util.md5.md5_ff(s,n,r,i,e[o+13],12,-40341101);i=RDR.util.md5.md5_ff(i,s,n,r,e[o+14],17,-1502002290);r=RDR.util.md5.md5_ff(r,i,s,n,e[o+15],22,1236535329);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+1],5,-165796510);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+6],9,-1069501632);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+11],14,643717713);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+0],20,-373897302);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+5],5,-701558691);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+10],9,38016083);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+15],14,-660478335);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+4],20,-405537848);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+9],5,568446438);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+14],9,-1019803690);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+3],14,-187363961);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+8],20,1163531501);n=RDR.util.md5.md5_gg(n,r,i,s,e[o+13],5,-1444681467);s=RDR.util.md5.md5_gg(s,n,r,i,e[o+2],9,-51403784);i=RDR.util.md5.md5_gg(i,s,n,r,e[o+7],14,1735328473);r=RDR.util.md5.md5_gg(r,i,s,n,e[o+12],20,-1926607734);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+5],4,-378558);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+8],11,-2022574463);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+11],16,1839030562);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+14],23,-35309556);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+1],4,-1530992060);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+4],11,1272893353);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+7],16,-155497632);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+10],23,-1094730640);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+13],4,681279174);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+0],11,-358537222);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+3],16,-722521979);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+6],23,76029189);n=RDR.util.md5.md5_hh(n,r,i,s,e[o+9],4,-640364487);s=RDR.util.md5.md5_hh(s,n,r,i,e[o+12],11,-421815835);i=RDR.util.md5.md5_hh(i,s,n,r,e[o+15],16,530742520);r=RDR.util.md5.md5_hh(r,i,s,n,e[o+2],23,-995338651);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+0],6,-198630844);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+7],10,1126891415);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+14],15,-1416354905);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+5],21,-57434055);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+12],6,1700485571);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+3],10,-1894986606);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+10],15,-1051523);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+1],21,-2054922799);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+8],6,1873313359);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+15],10,-30611744);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+6],15,-1560198380);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+13],21,1309151649);n=RDR.util.md5.md5_ii(n,r,i,s,e[o+4],6,-145523070);s=RDR.util.md5.md5_ii(s,n,r,i,e[o+11],10,-1120210379);i=RDR.util.md5.md5_ii(i,s,n,r,e[o+2],15,718787259);r=RDR.util.md5.md5_ii(r,i,s,n,e[o+9],21,-343485551);n=RDR.util.md5.safe_add(n,u);r=RDR.util.md5.safe_add(r,a);i=RDR.util.md5.safe_add(i,f);s=RDR.util.md5.safe_add(s,l)}return Array(n,r,i,s)},md5_cmn:function(e,t,n,r,i,s){return RDR.util.md5.safe_add(RDR.util.md5.bit_rol(RDR.util.md5.safe_add(RDR.util.md5.safe_add(t,e),RDR.util.md5.safe_add(r,s)),i),n)},md5_ff:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(t&n|~t&r,e,t,i,s,o)},md5_gg:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(t&r|n&~r,e,t,i,s,o)},md5_hh:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(t^n^r,e,t,i,s,o)},md5_ii:function(e,t,n,r,i,s,o){return RDR.util.md5.md5_cmn(n^(t|~r),e,t,i,s,o)},safe_add:function(e,t){var n=(e&65535)+(t&65535);var r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535},bit_rol:function(e,t){return e<<t|e>>>32-t},str2binl:function(e){var t=Array();var n=(1<<RDR.util.md5.chrsz)-1;for(var r=0;r<e.length*RDR.util.md5.chrsz;r+=RDR.util.md5.chrsz){t[r>>5]|=(e.charCodeAt(r/RDR.util.md5.chrsz)&n)<<r%32}return t},binl2hex:function(e){var t=RDR.util.md5.hexcase?"0123456789ABCDEF":"0123456789abcdef";var n="";for(var r=0;r<e.length*4;r++){n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15)}return n}},getCleanText:function(e){var n=e.find(".rdr_indicator");if(n.length){return}var r=t.trim(e.html().replace(/< *br *\/?>/gi," "));var i=t.trim(t("<div>"+r+"</div>").text().toLowerCase());if(i&&typeof i=="string"&&i!==""){var s=i.replace(/[\n\r\t]+/gi," ").replace().replace(/\s{2,}/g," ");return t.trim(s)}},trimToLastWord:function(e){var t=/\w+$/.exec(e);if(!t){return e}else{return e.slice(0,e.length-t[0].length)}},cssSuperImportant:function(e,n,r){var i="";t.each(n,function(e,r){r.replace("!important","");t.trim(r);r+=" !important";n[e]=r});var s=e.attr("style")||"";var o=r?n:t.extend(RDR.util.parseCssAttrToDict(s),n);t.each(o,function(e,t){i+=e+":"+t+";"});e.attr("style",i);return e},parseCssAttrToDict:function(e){var n={};var r=e.split(";");t.each(r,function(e,r){var i=r.split(":");var s=t.trim(i[0]);var o=t.trim(i[1]);if(s.length&&o.length){n[s]=o}});return n},fixBrTags:function(){var e=t(RDR.group.br_replace_scope_selector).find("> br").parent();if(!e.length){return}var n="|rdr|br|/rdr|";e.each(function(){var e=t(this);var r=e.clone();var i=t("<p></p>");r.find("> br").each(function(){t(this).replaceWith(n)});var s=r.html().split(n);for(var o=0;o<s.length;o++){var u=s[o];i.append('<div class="rdr_br_replaced">'+u+"</div>")}e.addClass("rdr_br_replaced_section").html(i.html())})},fixBodyBorderOffsetIssue:function(){var e=t("body"),n=parseInt(e.css("border-top-width"),10),r=parseInt(e.css("border-left-width"),10),i=t("#rdr_sandbox");if(!n&&!r)return;RDR.util.cssSuperImportant(i,{top:n+"px",left:r+"px"})},throttledUpdateContainerTrackers:function(){return RDR.util._.throttle(RDR.actions.indicators.utils.updateContainerTrackers,100)},userLoginState:function(){if(!t("#rdr-user").length){t(".rdr-page-summary").find("div.rdr-summary").prepend('<div id="rdr-user" />')}if(RDR&&RDR.user&&RDR.user.full_name&&t(".rdr-page-summary.defaultSummaryBar").length){var e=RDR.user.user_type=="facebook"?RDR.user.full_name.split(" ")[0]:RDR.user.full_name;t("#rdr-user").html('Hi, <a href="'+RDR_baseUrl+"/user/"+RDR.user.user_id+'" target="_blank">'+e+"</a>")}else{t("#rdr-user").html('<a href="javascript:void(0);">Log in to ReadrBoard</a>');t("#rdr-user").find("a").click(function(){RDR.session.showLoginPanel()})}},objLength:function(e){var t=0,n;for(n in e){if(e.hasOwnProperty(n)){t++}}return t},_:{debounce:function(e,t){var n;return function(){var r=this,i=arguments;var s=function(){n=null;e.apply(r,i)};clearTimeout(n);n=setTimeout(s,t)}},throttle:function(e,t){var n={};n.debounce=RDR.util._.debounce;var r,i,s,o,u;var a=n.debounce(function(){u=o=false},t);return function(){r=this;i=arguments;var n=function(){s=null;if(u)e.apply(r,i);a()};if(!s)s=setTimeout(n,t);if(o){u=true}else{e.apply(r,i)}a();o=true}},once:function(e){var t=false,n;return function(){if(t)return n;t=true;n=e.apply(this,arguments);e=null;return n}}},getQueryParams:function(e){var t=e||window.location.search;var n={};var r,i=/\+/g,s=/([^&=]+)=?([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(i," "))},u=t.substring(1);while(r=s.exec(u))n[o(r[1])]=o(r[2]);return n},getQueryStrFromUrl:function(e){var t=e.indexOf("?"),n,r,i;if(t==-1){n=e;r=""}else{n=e.slice(0,t);r=e.slice(t)}return r},createGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})},fireScrollEvent:function(e){if(e.indexOf("more")!=-1){var t="scroll_more"}else{var t="scroll"}RDR.events.trackEventToCloud({event_type:t,event_value:e})},fireEventQueue:function(){t.each(RDR.event_queue,function(e,t){RDR.events.trackEventToCloud(t)})}},debug:function(){window.RDR=window.READRBOARDCOM;window.$RDR=$RDR;window.$R=e},toggle:function(){e("body").toggleClass("no-rdr")},session:{alertBar:{make:function(e,n){var r,i,s;if(e=="fromShareLink"&&n.content!="undefined"){var o=unescape(t.evalJSON('"'+n.content+'"'));r=t("<h1>Shared with <span>ReadrBoard</span></h1>");if(t('img[rdr-hash="'+n.container_hash+'"]').length==1){i=t('<div><strong class="reactionText">Reaction: <em>'+n.reaction+"</em></strong>"+' <a class="rdr_showSelection" href="javascript:void(0);"><img src="'+n.content+'" style="max-width:100px !important;max-height:70px !important;margin:5px 0 !important;display:block !important;" />'+' <strong class="seeItLinkText rdr_blue">Show it on the page</strong></a></div>')}else{i=t('<div><strong class="reactionText">Reaction: <em>'+n.reaction+"</em></strong>"+'<strong>"</strong><em>'+o.substr(0,140)+'...</em><strong>"</strong>'+'<br /><strong class="seeItLinkText"><a class="rdr_showSelection" href="javascript:void(0);">Show it on the page</a></strong></div>')}i.find("a.rdr_showSelection").click(function(){setTimeout(function(){RDR.session.revealSharedContent(n)},200)})}if(e=="showMorePins"){r=t("<h1>See <span>more reactions</span> on this page.</h1>");i=t('<div>Readers like you are reacting to, sharing, and discussing content on this page.  <a class="rdr_show_more_pins" href="javascript:void(0);">Click here</a> to see what they\'re saying.<br><br><strong>Tip:</strong> Look for the <img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" /> icons.</div>');i.find("a.rdr_show_more_pins").click(function(){RDR.actions.summaries.showLessPopularIndicators();t(this).closest("div.rdr_alert_box").find("div.rdr_alert_box_x").click()})}if(typeof r!="undefined"){s=t('<img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" />');var u=t('<div class="rdr_alert_box rdr rdr_'+e+'" />');u.append(t('<div class="rdr_alert_box_1" />').append(s).append(r),t('<div class="rdr_alert_box_2" />').append(i),'<div class="rdr rdr_alert_box_x">x</div>');t("#rdr_sandbox").append(u);t("div.rdr_alert_box.rdr_"+e).find(".rdr_alert_box_x").click(function(){RDR.session.alertBar.close(e)});t("div.rdr_alert_box.rdr_"+e).animate({top:-5},1e3)}},close:function(e){t("div.rdr_alert_box.rdr_"+e).remove();t("div.rdr_indicator_for_media").hide();t.postMessage("close "+e,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}},revealSharedContent:function(e){var n=e.container_hash,r=t('[rdr-hash="'+n+'"]');var i=r.data("kind");if(i=="img"||i=="media"||i=="med"){r.addClass("rdr_shared");RDR.actions.indicators.utils.updateContainerTracker(n)}if(e.location&&e.location!="None"){var s=e.location;var o=t().selog("stack");var u=r.selog("save",{serialRange:s});t().selog("hilite",u,"on");t("div.rdr_page_summary").remove()}var a=r.offset().top,f=130,l=a-f||0;t("html,body").animate({scrollTop:l},1e3)},getSharedLinkInfo:function(e){if(t.cookie("content_type")!="pag"){var n=e.container_hash;var r=!!RDR.containers[n];if(!r){return}RDR.session.alertBar.make("fromShareLink",e);return true}},getUser:function(e,n){if(n&&e){RDR.session.receiveMessage(e,n)}else if(n){RDR.session.receiveMessage(false,n)}t.postMessage("getUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])},handleGetUserFail:function(e,n){var r=e.response;switch(r.message){case"Error getting user!":RDR.session.killUser();break;case"Temporary user interaction limit reached":RDR.session.showLoginPanel(e,n);break;case"Container specified does not exist":break;case"Token was invalid":case"Facebook token expired":case"FB graph error - token invalid":case"Social Auth does not exist for user":case"Data to create token is missing":if(typeof RDR.user.user_type!="undefined"&&RDR.user.user_type=="readrboard"){RDR.session.showLoginPanel(e,n)}else{RDR.session.receiveMessage(e,n);t.postMessage("reauthUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}break}},createXDMframe:function(){RDR.session.receiveMessage({},function(){RDR.util.userLoginState()});var e=RDR_baseUrl+"/static/xdm.html",n=window.location.href,r=window.location.protocol+"//"+window.location.host,i=RDR.engageScriptParams.bookmarklet?"bookmarklet=true":"",s=t('<iframe id="rdr-xdm-hidden" name="rdr-xdm-hidden" src="'+e+"?parentUrl="+n+"&parentHost="+r+"&group_id="+RDR.group.id+"&group_name="+encodeURIComponent(RDR.group.name)+"&"+i+'" width="1" height="1" style="position:absolute;top:-1000px;left:-1000px;" />');t("#rdr_sandbox").append(s);$RDR.dequeue("initAjax")},receiveMessage:function(e,n){t.receiveMessage(function(r){var i=t.evalJSON(r.data);if(i.status){if(i.status=="returning_user"||i.status=="got_temp_user"){for(var s in i.data){RDR.user=RDR.user||{};if(s=="user_boards"){RDR.user.user_boards=t.evalJSON(i.data[s])}else{RDR.user[s]=!isNaN(i.data[s])?parseInt(i.data[s],10):i.data[s]}}if(n&&e){if(!e.kind&&e.rindow){e.kind=t(e.rindow).data("kind")}e.user=RDR.user;n(e);n=null}else if(n){n();n=null}RDR.util.userLoginState()}else if(i.status=="xdm loaded"){RDR.group.xdmLoaded=true;RDR.util.fireEventQueue()}else if(i.status=="board_created"){t("div.rdr-board-create-div").remove()}else if(i.status=="board_create_cancel"){clearInterval(RDR.checkingBoardWindow);t("div.rdr-board-create-div").remove()}else if(i.status=="getUserLoginState"){RDR.session.getUser();t("#rdr_loginPanel").remove()}else if(i.status=="fb_user_needs_to_login"){if(n&&e){RDR.session.showLoginPanel(e,n)}else{RDR.session.showLoginPanel(e)}}else if(i.status=="close login panel"){RDR.util.userLoginState();t("#rdr_loginPanel").remove();t("div.rdr-summary div.rdr_info").html("<em>You're logged in!  Try your last reaction again.")}else if(i.status=="already had user"){t("#rdr_loginPanel div.rdr_body").html('<div style="padding: 5px 0; margin:0 8px; border-top:1px solid #ccc;"><strong>Welcome!</strong> You\'re logged in.</div>')}else if(i.status.indexOf("sharedLink")!=-1){var o=i.status.split("|");if(o[5]){RDR.session.referring_int_id=parseInt(o[5],10)}RDR.session.getSharedLinkInfo({container_hash:o[1],location:o[2],reaction:o[3],content:o[4],page_hash:o[6]})}}},RDR_baseUrl)},login:function(){},checkForMaxInteractions:function(){RDR.user=RDR.user||{};var e=!RDR.user.user_type;if(e&&RDR.user.num_interactions&&RDR.user.num_interactions>=RDR.group.temp_interact){return true}return false},showLoginPanel:function(e,n){t(".rdr_rewritable").removeClass("rdr_rewritable");if(t("#rdr_loginPanel").length<1){var r;if(e&&e.rindow){var i=e.rindow;r=i.offset();r.left=r.left?r.left-34:100;r.top=r.top?r.top-25:100}else{r=[];r.left=t(window).width()/2-200;r.top=150+t(window).scrollTop()}var s=RDR.rindow.draw({coords:r,id:"rdr_loginPanel",pnls:1,height:175,ignoreWindowEdges:"bt"});RDR.rindow.tagBox.setWidth(s,480);if(e)s.data("args",e);if(n)s.data("callback",n);var o=RDR_baseUrl+"/static/fb_login.html",u=window.location.href,a=window.location.protocol+"//"+window.location.host,f=e&&e.response&&e.response.message.indexOf("Temporary user interaction")!=-1?"Log In to Continue Reacting":"Log In to ReadrBoard",l=t('<iframe id="rdr-xdm-login" src="'+o+"?parentUrl="+u+"&parentHost="+a+"&group_id="+RDR.group.id+"&group_name="+RDR.group.name+'" width="480" height="140" frameborder="0" style="overflow:hidden; width:480px !important;" />');if(e&&e.response&&e.response.message.indexOf("organic")!=-1){f="Signing in is required for custom reactions"}var c=RDR.rindow.makeHeader(f);s.find(".rdr_header").replaceWith(c);RDR.rindow.hideFooter(s);s.find("div.rdr_body_wrap").append('<div class="rdr_body" />').append(l)}},killUser:function(){RDR.user={};t.postMessage("killUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])},rindowUserMessage:{show:function(e){var n=e.rindow;var r=e.interactionInfo;if(n){var i=e.msgType||null,s=null,o;var u=45,a=10,f=n.height(),l=300;var c=n.find(".rdr_body_wrap");var h=n.find("div.rdr_rindow_message"),p=n.find(".rdr_rindow_message_innerwrap"),d=t("div.rdr_otherTagsWrap"),v=n.find(".rdr_rindow_message_tempUserMsg");h.show();switch(i){case"tempUser":var m=RDR.group.temp_interact-parseInt(e.num_interactions,10),g=t('<a href="javascript:void(0);">Connect with Facebook</a>.');g.click(function(){RDR.session.showLoginPanel(e)});var y="You can react or comment <strong>"+m+" more times</strong> before you must ";v.empty().append("<span>"+y+"</span>");v.append(g);break;case"existingInteraction":s="You have already given that reaction for this.";break;case"interactionSuccess":if(r.remove){s="The "+r.type+" <em>"+r.body+"</em><br />has been removed.";v.empty()}else{s=r.type=="tag"?"You have tagged this <em>"+r.body+"</em>.":r.type=="comment"?"You have left your comment.":"";s+=" See your "+r.type+"s on this page, and at <strong><a href='"+RDR_baseUrl+"' target='_blank'>readrboard.com</a></strong>"}var b=e;if(n.find("div.rdr_rindow_message_tempUserMsg").text().length>0){$inlineTempMsg=t("<div />");$inlineTempMsg.html('<h4 style="font-size:17px;">You can react '+n.find("div.rdr_rindow_message_tempUserMsg strong").text()+'.</h4><br/><p><a style="font-weight:bold;color:#008be4;" href="javascript:void(0);">Connect with Facebook</a> to react as much as you want & show other readers here what you think.</p><br/><p>Plus, you can share and comment in-line!</p><br/><a href="javascript:void(0);"><img src="'+RDR_staticUrl+'widget/images/fb-login_to_readrboard.png" alt="Connect with Facebook" /></a>');$inlineTempMsg.find("a").click(function(){RDR.session.showLoginPanel(b)})}break}if(s){h.find("span.rdr_userMsg").html(s)}p.hide();n.queue("userMessage",function(){if(h.height()>0){p.fadeIn(500);t(this).dequeue("userMessage")}else{n.animate({height:f+u},l);d.animate({bottom:0},l);c.animate({bottom:u},l);h.animate({height:u},l,function(){p.fadeIn(500);t(this).dequeue("userMessage")})}});n.dequeue("userMessage")}},hide:function(e){if(e){var n=t("div.rdr_rindow_message");$otherTagsWrap=t("div.rdr_otherTagsWrap");var r=e.find(".rdr_body_wrap");var i=n.height(),s=e.height(),o=300,u=10;e.queue("userMessage",function(){e.animate({height:s-i},o);$otherTagsWrap.animate({bottom:0-u},o);r.animate({bottom:u},o);n.animate({height:0},o,function(){n.hide();t(this).dequeue("userMessage")})});e.dequeue("userMessage")}}}},actions:{aboutReadrBoard:function(){},init:function(){var e=this;$RDR=t(RDR);window.readrboard_extend_per_container=window.readrboard_extend_per_container||{};$RDR.queue("initAjax",function(t){e.initGroupData(RDR.group.short_name)});$RDR.queue("initAjax",function(t){e.initEnvironment()});$RDR.queue("initAjax",function(t){e.handleDeprecated()});$RDR.queue("initAjax",function(t){e.initHTMLAttributes()});$RDR.queue("initAjax",function(t){e.initPageData()});$RDR.queue("initAjax",function(e){RDR.actions.runPostPageInit();RDR.session.createXDMframe()});$RDR.queue("initAjax",function(e){RDR.util.checkForSelectedTextAndLaunchRindow();RDR.util.initPublicEvents()});$RDR.queue("initAjax",function(e){RDR.util.initTouchBrowserSettings()});$RDR.dequeue("initAjax")},initGroupData:function(e){t.ajax({url:RDR_baseUrl+"/api/settings/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON({host_name:window.location.hostname})},success:function(e,n,r){var i=e.data;var s=RDR.groupSettings.getCustomSettings();RDR.group=t.extend({},RDR.group.defaults,i,s);if(RDR.group.hideOnMobile===true&&isTouchBrowser){return false}RDR.group.anno_whitelist+=",div.rdr_br_replaced";t(RDR.group.no_readr).each(function(){var e=t(this);e.addClass("no-rdr");e.find("img").addClass("no-rdr")});if(RDR.group.active_sections==""){RDR.group.active_sections="body"}var o=RDR.group.active_sections.split(","),u="",a=RDR.group.anno_whitelist.split(",");t.each(o,function(e,n){n=t.trim(n);t.each(a,function(e,r){r=t.trim(r);u+=n+" "+r;if(e!=a.length-1){u+=","}});if(e!=o.length-1){u+=","}});RDR.group.active_sections_with_anno_whitelist=u;if(RDR.group.custom_css!==""){t("head").append(t('<style type="text/css">'+RDR.group.custom_css+"</style>"))}$RDR.dequeue("initAjax")},error:function(e){}})},initPageData:function(){var e=RDR.util.getQueryStrFromUrl(RDR.engageScriptSrc);RDR.engageScriptParams=RDR.util.getQueryParams(e);RDR.group.useDefaultSummaryBar=RDR.engageScriptParams.bookmarklet&&!t(".rdr-page-summary").length&&!t(RDR.group.summary_widget_selector).length;if(RDR.group.useDefaultSummaryBar){t('<div id="rdr-page-summary" class="rdr no-rdr rdr-page-summary defaultSummaryBar"/>').appendTo("body")}var n=[],r=[],i,s,o,u,a;var f={};if(RDR.group.post_selector!==""&&RDR.group.post_href_selector!==""&&RDR.group.summary_widget_selector!==""){t(RDR.group.post_selector).each(function(){var e=n.length;var s=t(this);var u=s.find(RDR.group.post_href_selector);var a=s.find(RDR.group.summary_widget_selector);if(u.attr("href")){o=u.attr("href");if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}if(o.indexOf(window.location.origin)==-1){if(o.substr(0,1)=="/"){o=window.location.origin+o}else{o=window.location.origin+window.location.pathname+o}}r.push(o);i={group_id:parseInt(RDR.group.id,10),url:o,canonical_url:"same",title:u.text()};n.push(i);f[e]=i;if(!s.hasAttr("rdr-page-container")){s.attr("rdr-page-container","true").attr("rdr-page-key",e)}a.attr("rdr-page-widget-key",e)}})}var l=RDR.util.getPageProperty("page_url");if(t.inArray(l,r)==-1||r.length==0){u=RDR.util.getPageProperty("canonical_url");a=RDR.util.getPageProperty("title");i={group_id:parseInt(RDR.group.id,10),url:l,canonical_url:l==u?"same":u,title:a};RDR.group.thisPage=i;n.push(i);s=n.length-1;f[s]=i;if(!t("body").hasAttr("rdr-page-container")){t("body").attr("rdr-page-key",s);if(t(".rdr-page-summary").length==1){t(".rdr-page-summary").attr("rdr-page-widget-key",s)}else{var c=t("body").find(RDR.group.summary_widget_selector).eq(0);if(c.attr("rdr-page-widget-key")!="0"){c.attr("rdr-page-widget-key",s)}}}}var h={pages:n};t.ajax({url:RDR_baseUrl+"/api/page/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(h)},success:function(e){var n="";if(RDR.group.useDefaultSummaryBar){n="default summary bar"}else{if(e.data.length===1){n="single summary bar"}else if(e.data.length>1){n="multiple pages"}else{n="unexpected"}}t.each(e.data,function(e,t){t.key=e;t.url=f[e].url;RDR.actions.pages.save(t.id,t);RDR.actions.pages.initPageContainer(t.id)});RDR.events.trackEventToCloud({event_type:"widget_load",event_value:n,page_id:RDR.util.getPageProperty("id")});$RDR.dequeue("initAjax")},error:function(e){}})},runPostPageInit:function(){function o(e){var n=t(e),r=n.data("hash");n.removeClass("rdr_live_hover");t("#rdr_indicator_"+r).hide()}var e=RDR.group.img_blacklist&&RDR.group.img_blacklist!=""?":not("+RDR.group.img_blacklist+")":"";if(isTouchBrowser){t(RDR.group.active_sections).find("embed[rdr-node], video[rdr-node], object[rdr-node], iframe[rdr-node], img[rdr-node]").each(function(){RDR.actions.indicators.init(t(this).attr("rdr-hash"))});if(!t.cookie("hideDoubleTapMessage")&&!RDR.group.hideDoubleTapMessage){var n=RDR.group.doubleTapMessage?RDR.group.doubleTapMessage:"<strong>Double-tap</strong> any paragraph to respond!<a>Close this</a>",r=RDR.group.doubleTapMessagePosition?"rdr_"+RDR.group.doubleTapMessagePosition:"rdr_bottom",i=t('<div class="rdr rdr_mobile_message">'+n+"</div>"),s=t("#rdr_sandbox");i.addClass(r).on("tap",function(){t.cookie("hideDoubleTapMessage",true);t(this).remove()}).appendTo(s)}}else{t(RDR.group.active_sections).on("mouseenter","embed, video, object, iframe, img"+e,function(){var e=t(this);var n=e.data("hash");RDR.actions.indicators.utils.updateContainerTrackers();if(e.closest(".no-rdr").length){return}var r=160;if(e.width()>=r){var i=e.hasAttr("rdr-hashed"),s=e.closest(".rdr, .no-rdr").length;e.addClass("rdr_live_hover");if(!i&&!s){var o=RDR.actions.hashNodes(t(this));var n;t.each(o,function(e,t){n=t[0]});if(!n){RDR.safeThrow("There should always be a hash from hashNodes after hover on an unhashed image.");return}RDR.actions.sendHashes(o,function(){if(e.hasClass("rdr_live_hover")){if(!t("#rdr_indicator_details_"+n).hasClass("rdr_engaged")){t("#rdr_indicator_"+n).show()}}})}else{var n=e.data("hash");e.addClass("rdr_live_hover");if(!t("#rdr_indicator_details_"+n).hasClass("rdr_engaged")){t("#rdr_indicator_"+n).show()}RDR.actions.content_nodes.init(n,function(){})}}}).on("mouseleave","embed, video, object, iframe, img"+e,function(e){var n=t(this);if(!n.parents(RDR.group.img_container_selectors).length){o(n)}})}},initEnvironment:function(){var e=t('<div id="rdr_sandbox" class="rdr rdr_sandbox"/>').appendTo("body");if(isTouchBrowser){t("#rdr_sandbox").addClass("isTouchBrowser")}if(t.cookie("rdr_session")===null){var n=RDR.user.session=RDR.util.createGuid();var r=new Date;var i=30;r.setTime(r.getTime()+i*60*1e3);t.cookie("rdr_session",n,{expires:r})}else{RDR.user.session=t.cookie("rdr_session")}if(t.cookie("rdr_user")===null){var s=RDR.user.guid=RDR.util.createGuid();var o=new Date;var u=180;o.setTime(o.getTime()+u*60*1e3*60*24);t.cookie("rdr_user",s,{expires:o})}else{RDR.user.guid=t.cookie("rdr_user")}var a=["topics","author","section"];t.each(a,function(e,n){if(RDR.group[n+"_selector"]!="undefined"&&RDR.group[n+"_attribute"]!="undefined"&&t(RDR.group[n+"_selector"]).length){RDR.group[n]="";t(RDR.group[n+"_selector"]).each(function(){RDR.group[n]+=t(this).attr(RDR.group[n+"_attribute"])+","});RDR.group[n]=RDR.group[n].substr(0,RDR.group[n].length-1)}});RDR.util.fixBodyBorderOffsetIssue();if(!!RDR.group.br_replace_scope_selector){RDR.util.fixBrTags()}var f={paddingLeft:t("body").css("padding-left").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("padding-left"))/100):parseInt(t("body").css("padding-left")),marginLeft:t("body").css("margin-left").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("margin-left"))/100):parseInt(t("body").css("margin-left")),left:t("body").css("left").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("left"))/100):parseInt(t("body").css("left")),paddingLeft:t("body").css("padding-top").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("padding-top"))/100):parseInt(t("body").css("padding-top")),marginTop:t("body").css("margin-top").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("margin-top"))/100):parseInt(t("body").css("margin-top")),top:t("body").css("top").indexOf("%")!=-1?t(window).width()*(parseInt(t("body").css("top"))/100):parseInt(t("body").css("top"))},l=-(f.marginLeft+f.left+f.paddingLeft),c=-(f.marginTop+f.top+f.paddingTop);l=isNaN(l)?0:l;c=isNaN(c)?0:c;var h=parseInt(e.css("top"),10);var p=parseInt(e.css("left"),10);RDR.util.cssSuperImportant(e,{left:p+l+"px",top:h+c+"px"},true);e.append("<style>.rdr_twtooltip { margin-left:"+l+"px !important; margin-top:"+c+"px !important; } </style>");t('<div id="rdr_container_tracker_wrap" /><div id="rdr_indicator_details_wrapper" /><div id="rdr_event_pixels" />').appendTo(e);t(document).on("mouseup.rdr",function(e){setTimeout(function(){RDR.actions.startSelectFromMouseUp(e)},1)});t(document).on("mousedown.rdr",function(e){var n=t(e.target);if(n.closest(".rdr_inline").length||!n.parents().hasClass("rdr")&&!t("div.rdr-board-create-div").length){RDR.actions.UIClearState();if(!isTouchBrowser){t("div.rdr_indicator_details_for_media").each(function(){RDR.actions.containers.media.onDisengage(t(this).data("container"))})}}});t(document).on("keyup.rdr",function(e){if(e.keyCode=="27"){RDR.actions.UIClearState()}});t(window).resize(RDR.util.throttledUpdateContainerTrackers());$RDR.dequeue("initAjax")},handleDeprecated:function(){t("[rdr-custom-display]").each(function(){var e=t(this);e.attr("rdr-item",e.attr("rdr-custom-display"));e.removeAttr("rdr-custom-display")});t("[rdr-grid-for]").each(function(){var e=t(this);e.attr("rdr-view-reactions-for",e.attr("rdr-grid-for"));e.removeAttr("rdr-grid-for")});$RDR.dequeue("initAjax")},initHTMLAttributes:function(){t("[rdr-reactions][rdr-item]").each(function(){var e=t(this),n=e.attr("rdr-item"),r=e.attr("rdr-reactions");if(r&&typeof window.readrboard_extend_per_container[n]=="undefined"){var i={};i.blessed_tags=[];t.each(r.split(";"),function(e,n){i.blessed_tags.push(t.trim(n))});window.readrboard_extend_per_container[n]=i}});$RDR.dequeue("initAjax")},reInit:function(){RDR.actions.hashCustomDisplayHashes()},UIClearState:function(){t("div.rdr_twtooltip").remove();RDR.rindow.closeAll();RDR.actionbar.closeAll();RDR.actions.containers.media.disengageAll();t("div.rdr.rdr_tag_details.rdr_sbRollover").remove();if(!isTouchBrowser){t("div.rdr_indicator_for_media").hide()}t().selog("hilite",true,"off");var e=t(".rdr_fromShareLink").length;if(e){RDR.session.alertBar.close("fromShareLink")}},catchRangyErrors:function(e){RDR.safeThrow(e)},hashNodes:function(e,n){if(typeof e==="undefined"){return}var r=t(),i=[{kind:"media",$group:null,whiteList:RDR.group.media_selector,filterParam:"embed, video, object, iframe",setupFunc:function(){var e=this.src;t(this).data({body:e})}},{kind:"img",$group:null,whiteList:RDR.group.img_selector,filterParam:"img",setupFunc:function(){var e=this.src;t(this).data({body:e})}},{kind:"text",$group:null,whiteList:RDR.group.active_sections_with_anno_whitelist,filterParam:function(e,n){var r=t(n),i=r.text(),s=r.parent().text();if(i!=s){return!!i}},setupFunc:function(){var e=t(this),n=RDR.util.getCleanText(e);e.data("body",n)}},{kind:"custom",$group:null,whiteList:"",filterParam:function(e,n){var r=t(this);return!!r.hasAttr("rdr-src")},setupFunc:function(){var e=t(this),n=e.attr("rdr-src");e.data({body:n})}}];t.each(i,function(n,i){var s=e.filter(i.filterParam);s=s.add(e.find(i.whiteList));if(!!RDR.group.br_replace_scope_selector&&i.kind=="text"){s=s.add(e.find(".rdr_br_replaced"))}s=s.not(r);if(i.kind=="text"){s=s.not(RDR.group.media_selector+", "+RDR.group.img_selector)}s=s.not("[rdr-hashed], .no-rdr, #rdr_sandbox");i.$nodes=s;s.each(function(){i.setupFunc.apply(this);t(this).data("kind",i.kind)});r=r.add(s);var o=r.filter(RDR.group.inline_selector);o.each(function(){t(this).data("inlineIndicator",true)})});if(!r.data("body")){return false}var s={};var o=[];r.each(function(){function b(e){return t(e).find(":not(iframe,noscript)").andSelf().contents().filter(function(){return this.nodeType==3})}var e=t(this),n=e.data("body"),r=e.data("kind"),i=e.get(0).nodeName.toLowerCase(),o=n,u,a,f;if(e.closest(".no-rdr").length){return}if((r=="img"||r=="media")&&n){f="rdr-"+r+"-"+o;a=RDR.util.md5.hex_md5(f);e.data("oldHash",a);var l=/[-\w]+\.(?:[-\w]+\.xn--[-\w]+|[-\w]{3,}|[-\w]+\.[-\w]{2})$/i;var c=o.split("/");c.splice(0,2);var h=c.shift();if(!h){return}var p=h.split(":")[0];var d=c.join("/");var v=l.exec(p);if(v==null){return}else{o=v[0]+"/"+d}var m=["soundcloud.com"];t.each(m,function(e,t){if(o.indexOf(t)!=-1){RDR.group.media_url_ignore_query=false}});if(RDR.group.media_url_ignore_query&&o.indexOf("?")){o=o.split("?")[0]}if(e.hasAttr("rdr-oldhash")){u=e.data("hash")}else{f="rdr-"+r+"-"+o;u=RDR.util.md5.hex_md5(f)}}else{if(!n){return}f="rdr-"+r+"-"+n;u=RDR.util.md5.hex_md5(f);if(!e.hasAttr("rdr-hash")){var g=1;while(typeof RDR.summaries[u]!="undefined"){f="rdr-"+r+"-"+n+"-"+g;u=RDR.util.md5.hex_md5(f);g++}}}if(e.parents('[rdr-hash="'+u+'"]').length){var y=e.parents('[rdr-hash="'+u+'"]');RDR.actions.stripRdrNode(y)}if(e.get(0).nodeName.toLowerCase()=="img"&&e.parents("[rdr-hash]").length&&!e.find(RDR.group.anno_whitelist).length){var y=e.parents("[rdr-hash]");RDR.actions.stripRdrNode(y)}RDR.actions.containers.save({body:n,kind:r,hash:u,HTMLkind:i,$this:e});e.attr("rdr-hash",u).attr("rdr-node","true");if(i!="body"){e.on("mouseenter",function(){RDR.actions.indicators.init(u);t(this).addClass("rdr_live_hover")}).on("mouseleave",function(){t(this).removeClass("rdr_live_hover")})}var w=RDR.actions.summaries.init(u);RDR.actions.summaries.save(w);var E=RDR.util.getPageProperty("id",u);if(!s[E])s[E]=[];s[E].push(u);e.data("hash",u)});return s},sendHashes:function(e,n){t.each(e,function(e,r){if(!e||typeof r!="object"){RDR.safeThrow("No more messy hashes allowed!!");return}t.each(t("[rdr-item]"),function(e,n){var i=t(n);if(typeof i.data("rdr-hashed")=="undefined"){var s=i.attr("rdr-hash");r=t.grep(r,function(e){return e!=s});if(typeof s!="undefined"){r.push(s)}RDR.actions.indicators.init(s);i.data("rdr-hashed",true)}});t.each(r,function(e,n){if(typeof n!="string"){RDR.safeThrow("why is your hash not a string!?");return}var r=t('[rdr-hash="'+n+'"]');if(r.length==1){r.attr("rdr-hashed","true")}});var i=parseInt(e,10);if(isNaN(i)){RDR.safeThrow("why is the pageID NAN ??: "+e+"-->"+i)}var s=[];t.each(t('[rdr-crossPageContent="true"]'),function(e,n){var i=t(n).attr("rdr-hash");s.push(i);r=t.grep(r,function(e){return e!=i});RDR.actions.indicators.init(i)});RDR.actions.sendHashesForSinglePage({short_name:RDR.group.short_name,pageID:i,hashes:r,crossPageHashes:s},n)})},sendHashesForSinglePage:function(e,n){var r=e.pageID;t.ajax({url:RDR_baseUrl+"/api/summary/containers/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(e)},success:function(e){if(typeof e!="undefined"&&typeof e.data!="undefined"){if(typeof e.data.known!="undefined"){RDR.known_hashes=e.data.known}if(typeof e.data.crossPageKnown!="undefined"){if(typeof e.data.known!="undefined"){RDR.known_hashes=t.extend(RDR.known_hashes,e.data.crossPageKnown)}RDR.crosspage_hashes=e.data.crossPageKnown}t.each(t('[rdr-crossPageContent="true"]'),function(e,n){var r=t(n).attr("rdr-hash");var i={hash:r,counts:{coms:0,tags:0,interactions:0},top_interactions:{coms:[],tags:{}}};if(typeof RDR.crosspage_hashes!="undefined"){RDR.crosspage_hashes={}}RDR.crosspage_hashes[r]=i});var i={};i[r]=e.data.known;t.each(e.data.unknown,function(e,n){if(typeof n!="string"){RDR.safeThrow("why would this not be a string?");return}var s;var o=t('[rdr-hash="'+n+'"]');var u=o.data("kind");if(!u){RDR.safeThrow("node should always have data: kind")}s=RDR.util.makeEmptySummary(n,u);i[r][n]=s});if(!t.isEmptyObject(i)){RDR.actions.containers.setup(i);if(typeof n!=="undefined"){n()}}var s=[];t.each(e.data.crossPageKnown,function(e,t){if(s.indexOf(t.hash)==-1){s.push(t.hash)}});t.each(t("[rdr-item]"),function(e,n){if(s.indexOf(t(n).data("hash"))==-1){s.push(t(n).data("hash"))}});RDR.actions.containers.initCustomDisplayHashes(s)}}})},hashCustomDisplayHashes:function(){var e={},n=RDR.util.getPageProperty();e[n]=[];if(t("[rdr-item]").length){t.each(t("[rdr-item]"),function(r,i){var s=t(i);RDR.actions.hashNodes(s);var o=s.attr("rdr-hash");e[n].push(o);RDR.actions.indicators.init(o)})}RDR.actions.sendHashes(e)},comments:{makeCommentBox:function(e,n){var r=e.content_node,i=e.tag,s=e.summary,o=e.hash,u=e.$rindow,a=e.selState;n=n||{};var f=n.helpText||"Add comments or #hashtags";var l=n.cta||"Leave a comment";var c=t('<div class="rdr_commentBox rdr_clearfix"></div>');var h=t('<div class="rdr_comment">'),p=t('<textarea class="rdr_default_msg">'+f+"</textarea>"),d=t('<div class="rdr_charCount">'+RDR.group.comment_length+" characters left</div>"),v=t('<button class="rdr_commentSubmit">Comment</button>');h.append(p,d,v);p.focus(function(){RDR.events.track("start_comment_lg::"+r.id+"|"+i.id);t(this).removeClass("rdr_default_msg");if(t(this).val()==f){t(this).val("")}}).blur(function(){var e=t(this).val();if(e===""||e===f){t(this).addClass("rdr_default_msg");t(this).val(f)}}).keyup(function(e){var n=p.val();if(e.keyCode=="27"){t(this).blur();return false}else if(n.length>RDR.group.comment_length){n=n.substr(0,RDR.group.comment_length);p.val(n)}p.siblings("div.rdr_charCount").text(RDR.group.comment_length-n.length+" characters left")});v.click(function(n){t.extend(e,{$commentTextarea:p,helpText:f});RDR.actions.comments.submitComment(e)});c.append(h);return c},submitComment:function(e){var n=e.$commentTextarea,r=e.helpText,i=e.content_node,s=e.summary,o=e.hash,u=e.tag,a=e.$rindow,f=e.selState;var l=n.val();if(l.length>RDR.group.comment_length){l=l.substr(0,RDR.group.comment_length);n.val(l);n.siblings("div.rdr_charCount").text(RDR.group.comment_length-l.length+" characters left")}if(l!=r){if(t.isEmptyObject(i)&&s.kind=="img"){i={body:t("img.rdr-"+s.hash).get(0).src,kind:s.kind,hash:s.hash}}else{var c=t('[rdr-hash="'+s.hash+'"]'),h=c.attr("rdr-content-type");if(h){if(h=="media"){i.kind="media"}else if(h=="image"){i.kind="img"}else{i.kind="text"}}else{i.kind="text"}}var p={hash:o,content_node_data:i,comment:l,content:i.body,tag:u,rindow:a,selState:f};RDR.actions.interactions.ajax(p,"comment","create")}else{n.focus()}return false}},containers:{updateCrossPageHash:function(e){var n=t('[rdr-hash="'+e+'"]').length>0;if(!n){return}RDR.actions.indicators.init(e);var r=t('[rdr-hash="'+e+'"]'),i=r.attr("rdr-item"),s=t('[rdr-view-reactions-for="'+i+'"]');if(s.length){RDR.actions.content_nodes.init(e,function(){RDR.actions.indicators.utils.makeTagsListForInline(s,false);s.jScrollPane({showArrows:true})})}},initCustomDisplayHashes:function(e){t.each(e,function(e,n){var r=t('[rdr-hash="'+n+'"]');if(typeof n!="undefined"&&typeof r.attr("rdr_summary_loaded")=="undefined"){RDR.actions.indicators.init(n);RDR.summaries[n].crossPage=true;var i=t('[rdr-hash="'+n+'"]'),s=i.attr("rdr-item"),o=t('[rdr-view-reactions-for="'+s+'"]'),u=o.attr("rdr-view-style")||"grid",a=o.width(),f=o.height();o.data("hash",n).data("container",n).addClass("no-rdr");if(u=="grid"){if(f<200){f=200;o.height(f)}RDR.util.cssSuperImportant(o,{height:f+"px"});if(o.length){var l=parseInt(a/160);a=l*160;if(a>960){a=960}if(!o.closest(".rdr_reactionView_wrapper").length){o.wrap('<div class="rdr_reactionView_wrapper" style="width:'+a+"px;height:"+f+'px;"></div>')}o.addClass("w"+a).html('<div class="rdr rdr_window rdr_inline w'+a+' rdr_no_clear" style="position:relative !important;"><div class="rdr rdr_header"><div class="rdr_header_arrow"><img src="'+RDR_staticUrl+'widget/images/header_up_arrow.png"></div><div class="rdr_loader"></div><div class="rdr_about"><a href="http://www.readrboard.com/" target="_blank">&nbsp;</a></div><div class="rdr_indicator_stats"><img class="no-rdr rdr_pin" src="'+RDR_staticUrl+'widget/images/blank.png"><span class="rdr_count"></span></div><h1>Reactions</h1></div><div class="rdr rdr_body_wrap rdr_grid rdr_clearfix"></div></div>');RDR.actions.content_nodes.init(n,function(){RDR.actions.indicators.utils.makeTagsListForInline(o,false);o.jScrollPane({showArrows:true})})}else{RDR.actions.content_nodes.init(n)}}else if(u=="horizontal_bars"){o.html('<div class="rdr rdr_inline rdr_body_wrap rdr_horizontal_bars rdr_clearfix"></div>');RDR.actions.content_nodes.init(n,function(){RDR.actions.indicators.utils.makeTagsListForInline(o,false)})}}})},media:{onEngage:function(e){return;var n=t('img[rdr-hash="'+e+'"], iframe[rdr-hash="'+e+'"],embed[rdr-hash="'+e+'"],video[rdr-hash="'+e+'"],object[rdr-hash="'+e+'"]').eq(0),r=t("#rdr_indicator_"+e),i=t("#rdr_indicator_details_"+e);var s=n.hasAttr("rdr-hashed"),o=n.closest(".rdr, .no-rdr").length;var u=RDR.containers[e];if(u){var a=u.$this;a.data("hover",true).data("hash",e);RDR.actions.indicators.utils.updateContainerTracker(e);RDR.rindow.mediaRindowShow(a)}},onDisengage:function(e){return;var n=t('img[rdr-hash="'+e+'"], iframe[rdr-hash="'+e+'"],embed[rdr-hash="'+e+'"],video[rdr-hash="'+e+'"],object[rdr-hash="'+e+'"]').eq(0),r=t("#rdr_indicator_"+e),i=t("#rdr_indicator_details_"+e);var s=n.data("timeoutCloseEvt_"+e);clearTimeout(s);s=setTimeout(function(){var t=RDR.containers[e];if(t){n.data("hover",false).data("hash",e);RDR.rindow.mediaRindowHide(n)}},100);n.data("timeoutCloseEvt_"+e,s)},disengageAll:function(){var e=[];t(".rdr_live_hover").each(function(){var n=t(this).data("hash");e.push(n);RDR.actions.containers.media.onDisengage(n)})}},save:function(e){if(RDR.containers.hasOwnProperty(e.hash))return RDR.containers[e.hash];var t=typeof e.id==="undefined"||e.id===null?null:e.id;var n={id:t,body:e.body||null,kind:e.kind,hash:e.hash,HTMLkind:e.HTMLkind||null,$this:e.$this||null};RDR.containers[e.hash]=n;return n},setup:function(e){var n={img:function(e,t){var n=RDR.containers[e];var r=n.$this;var i=r[0].src;var s={body:i,kind:t.kind,container:e,hash:e};RDR.content_nodes[e]=s;RDR.rindow.update(e);if(isTouchBrowser){RDR.actions.content_nodes.init(e,function(){});RDR.actions.indicators.init(e)}},media:function(e,t){this.img(e,t)},text:function(e,t){},custom:function(e,t){}};var r=[];t.each(e,function(e,i){if(!i||t.isArray(i)){RDR.safeThrow("For godsake no. This should not be an array of hashes and it should not be the bastard cruft of some frankenpage object.");return}t.each(i,function(i,s){s.hash=i;var o=RDR.containers[i];if(o){var u=o.$this;var a={},f=s.top_interactions.coms;t.each(f,function(e,t){if(s.kind=="text"){a[t.tag_id]=t}else{if(!a[t.tag_id])a[t.tag_id]=[];a[t.tag_id].push(t)}});s.top_interactions.coms=a;RDR.actions.summaries.save(s);var l=false;t.each(RDR.pages[e].containers,function(e,t){if(t.hash==i){l=true}});if(l==false){RDR.pages[e].containers.push({hash:i,id:s.id})}else{}var c=s.kind;if(c!="page"){n[c](i,s)}if(s.counts.tags>0){r.push(i)}}})});RDR.actions.summaries.sortPopularTextContainers();RDR.actions.summaries.displayPopularIndicators();t.each(RDR.known_hashes,function(e,n){var r=t('img[rdr-node="returnedHash"]');if(r.length){if(r.data("oldHash")==e){r.attr("rdr-hash",e).attr("rdr-oldhash","true").data("hash",e)}}RDR.actions.indicators.init(e)});RDR.actions.indicators.show(r)},send:function(e,n){function l(){r={};i=0;s=0}var r={},i=0,s=0,o,u,a=300,f=1400;t.each(e,function(e,n){var a=RDR.containers[n];var c={HTMLkind:a.HTMLkind,body:"",hash:a.hash,id:a.id,kind:a.kind};u=encodeURIComponent(t.toJSON(c));o=u.length;if(o>f){c=false}else{s+=o;if(s>f){RDR.actions.containers._ajaxSend(r);l()}r[n]=c;i+=o}});if(!t.isEmptyObject(r)){RDR.actions.containers._ajaxSend(r,n)}},_ajaxSend:function(e,n){var r=e;t.ajax({url:RDR_baseUrl+"/api/containers/create/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(r)},success:function(e){var r=e.data;var i={};t.each(r,function(e,t){if(!t){return}var n=RDR.containers[e];n.id=t;i[e]=RDR.actions.summaries.init(e)});RDR.actions.containers.setup(i);if(typeof n!=="undefined"){n()}}})}},content_nodes:{make:function(e){var t=e.hash;var n;if(e.location){n=e.container+"-"+e.location}else{n=e.container}if(RDR.content_nodes.hasOwnProperty(n))return RDR.content_nodes[n];var r={container:e.container,body:e.body,location:e.location,hash:t};RDR.content_nodes[n]=r;return r},quickFixReset:function(e){var t=RDR.summaries[e],n=typeof t!="undefined"?t.id:"";if(n){delete RDR.assetLoaders.content_nodes[n];RDR.actions.content_nodes.init(e)}},init:function(e,n){var r=RDR.summaries[e],i=typeof r!="undefined"?r.id:"";if(!i){return}var s=RDR.util.getPageProperty("id",e);r.pageId=s;var o={page_id:s,container_id:i,hash:e,cross_page:r.$container.hasAttr("rdr-crossPageContent")?true:false};var u=RDR.assetLoaders.content_nodes[i];if(!u){u=t.ajax({url:RDR_baseUrl+"/api/summary/container/content/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(o)}});RDR.assetLoaders.content_nodes[i]=u}u.then(function(i){if(i.status!=="success"){return false}var s=i.data;t.each(s,function(n,r){var i=t('[rdr-hash="'+e+'"]');try{r.selState=i.selog("save",{serialRange:r.location})}catch(s){r.selState=undefined}});RDR.content_nodes[e]=s;r.content_nodes=s;if(r.kind=="text"){}else{r.top_interactions.coms={};t.each(s,function(e,n){var i=n.top_interactions.coms;t.each(i,function(e,t){r.top_interactions.coms[t.tag_id]=r.top_interactions.coms[t.tag_id]||[];r.top_interactions.coms[t.tag_id].push(t)})})}t('[rdr-hash="'+e+'"]').attr("rdr_summary_loaded","true");if(n){n()}if(RDR.contentNodeQueue&&RDR.contentNodeQueue[e]&&RDR.contentNodeQueue[e].length){t.each(RDR.contentNodeQueue[e],function(){var t=RDR.contentNodeQueue[e].pop();t(e)})}})},utils:{getMediaDims:function(e){var t=e.height();var n=e.width();return!t||!n?{}:{height:t,width:n}},makeDictSortedByTag:function(e){var n={};t.each(e,function(e,r){t.each(r.top_interactions.tags,function(e,t){if(!n.hasOwnProperty(e)){n[e]=[]}n[e].push(r)})});return n},initHiliteStates:function(e,n){t.each(n,function(t,n){if(n.selState){e.data("selStates").push(n.selState)}});if(!isTouchBrowser){e.hover(function(){var e=t(this).data("selStates");var n=e.length?e[e.length-1]:null;if(n){t().selog("hilite",n,"on")}},function(){var e=t(this).data("selStates");var n=e.length?e[e.length-1]:null;if(n){t().selog("hilite",n,"off")}})}}}},interactions:{ajax:function(e,n,r){var i=e.hash,s=RDR.summaries[i],o=s?s.kind:"";if(!r)r="create";if(!RDR.actions.interactions.hasOwnProperty(n)){return false}var u={};RDR.actions.interactions[n].preAjax(e,r);RDR.session.getUser(e,function(e){var s=RDR.actions.interactions.defaultSendData(e),o=RDR.actions.interactions[n].customSendData(e),a=t.extend({},s,o,u);e.sendData=a;e.hash=i;e.sendData.hash=i;RDR.actions.interactions.send(e,n,r)})},send:function(e,n,r){var i=t.extend(true,{},e.sendData);if(i.rindow)delete i.rindow;if(i.settings)delete i.settings;if(i.selState)delete i.selState;if(i.content_node)delete i.content_node;if(i.content_node_data&&i.content_node_data.selState)delete i.content_node_data.selState;if(i.content_node_data&&i.content_node_data.counts)delete i.content_node_data.counts;if(i.content_node_data&&i.content_node_data.top_interactions)delete i.content_node_data.top_interactions;if(i.content_node_data&&i.content_node_data.$container)delete i.content_node_data.$container;if(i.content_node_data&&i.content_node_data.$indicator)delete i.content_node_data.$indicator;if(i.content_node_data&&i.content_node_data.$indicator_details)delete i.content_node_data.$indicator_details;if(i.content_node_data&&i.content_node_data.$rindow_readmode)delete i.content_node_data.$rindow_readmode;if(i.node)delete i.node;if(i.uiMode)delete i.uiMode;if(i.sendData)delete i.sendData;if(RDR.summaries[i.hash])i.container_kind=RDR.summaries[i.hash].kind;if(i.content_node_data&&i.content_node_data.container)delete i.content_node_data.container;var s=n=="react"?"tag":n;if(typeof i.tag!="undefined"){i.tag.body=i.tag.body?i.tag.body:i.tag.tag_body}if(i.kind=="page"){i.hash="page";i.container_kind="text";i.page_id=i.page_id||RDR.util.getPageProperty("id","page");delete i.content_node_data.hash}var o=RDR_baseUrl+"/api/"+s+"/"+r+"/";var u=RDR.session.checkForMaxInteractions(e);if(!u){t.ajax({url:o,type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(i)},success:function(t){e.response=t;if(t.data&&t.data.container){e.container_id=t.data.container.id;var i=e.hash=t.data.container.hash}if(t.data&&t.data.num_interactions){RDR.user.num_interactions=t.data.num_interactions}if(t.status=="success"){if(e.response.data.interaction){}else if(e.response.data.deleted_interaction){}if(e.response.data.deleted_interaction){e.deleted_interaction=e.response.data.deleted_interaction}e.scenario=e.response.data.existing?"reactionExists":e.response.data.deleted_interaction?"tagDeleted":"reactionSuccess";if(typeof e.tag.id=="undefined"){e.tag.id=t.data.interaction.interaction_node.id}RDR.actions.interactions[n].onSuccess[r](e)}else{if(n=="react"){if(t.message=="sign in required for organic reactions"){RDR.session.showLoginPanel(e)}else{RDR.actions.interactions[n].onFail(e)}}else{if(t.message.indexOf("Temporary user interaction limit reached")!=-1){RDR.session.showLoginPanel(e)}if(t.message=="existing interaction"){e.msgType="existingInteraction";RDR.session.rindowUserMessage.show(e)}else{RDR.session.handleGetUserFail(e,function(){RDR.actions.interactions.ajax(e,n,"create")})}}}RDR.util.userLoginState()}})}else{RDR.session.showLoginPanel(e,function(){RDR.actions.interactions.ajax(e,n,"create")})}},defaultSendData:function(e){e.user_id=RDR.user.user_id;e.readr_token=RDR.user.readr_token;e.group_id=RDR.group.id;e.page_id=e.page_id?e.page_id:RDR.util.getPageProperty("id",e.hash);return e},comment:{preAjax:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","visible")},customSendData:function(e){},onSuccess:{create:function(e){var n=e.rindow,r=e.hash,i=e.response,s=e.tag;if(n){n.find("div.rdr_loader").css("visibility","hidden");RDR.actions.content_nodes.quickFixReset(r);var o=n.hasClass("rdr_inline")||n.find(".rdr_inline").length;var u=t('<span class="success_msg" >Thanks for your comment! </span>');var a=t('<a class="rdr_doneButton" href="#">Close</a>').click(function(e){e.preventDefault();RDR.rindow.safeClose(n)});var f=t(".rdr_subheader").length;if(f){t(".rdr_nextActions").remove();n.find(".rdr_subheader").empty().append(u).append(a)}else{n.find(".rdr_commentBox").empty().append(u).append(a)}}var l=i.data.interaction,c=i.data.content_node?i.data.content_node:i.content_node_data?i.content_node_data:e.content_node_data,h=c&&c.id?c.id:"",p=i.data.num_interactions;var d=c.kind=="text"||c.kind=="txt";var v=i.data.existing;if(!d&&v){var m=RDR.content_nodes[r];t.each(m,function(e,t){if(e&&e!="undefined"){c=t;h=c.id}})}var g=parseInt(e.tag.id,10);var y={delta:1,num_interactions:p,id:l.id,body:l.interaction_node.body,content_node:c,content_id:h,tag_id:g,user:e.user,social_user:e.social_user,parent_id:null,parent_interaction_node:e.tag};var b={coms:{}};b.coms[g]=y;RDR.actions.content_nodes.init(r,function(){RDR.actions.summaries.update(r,b)});RDR.util.triggerPublicEvent("comment");RDR.events.trackEventToCloud({event_type:"comment",event_value:l.interaction_node.body,container_hash:r,container_kind:c.kind,page_id:e.page_id,reaction_body:e.tag.tag_body})},remove:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}},onFail:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}},share:{preAjax:function(){var e=args.rindow;if(e)e.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")},onFail:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}},boardadd:{preAjax:function(){var e=args.rindow;if(e)e.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:{create:function(e){var n=e.rindow?e.rindow:t("div.rdr_tag_details.rdr_reacted.rdr_live_hover");n.find("div.rdr_loader").css("visibility","hidden");var r=e.board_name.replace(/\s/g,"_"),i={board_id:e.board_id,int_id:e.int_id},s=t('<div class="rdr_success">Success!  See <a target="_blank" href="'+RDR_baseUrl+"/board/"+e.board_id+"/"+r+'" class="rdr_seeit_link">your board.</a> <a href="javascript:void(0);" class="rdr_seeit_link rdr_undo">Undo?</a></div>');n.find(".rdr_select_user_board").append(s).find("select").hide();s.find("a.rdr_undo").click(function(){e.rindow=n;RDR.actions.interactions.ajax(e,"boarddelete","create")})}}},boarddelete:{preAjax:function(){var e=args.rindow;if(e)e.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:{create:function(e){var t=e.rindow;if(t)t.find("div.rdr_loader").css("visibility","hidden")}}},react:{preAjax:function(e,t){var n=e.rindow;if(n)n.find("div.rdr_loader").css("visibility","visible")},customSendData:function(e){var n=e.hash,r=RDR.summaries[n],i=t('[rdr-hash="'+n+'"]'),s,o,u;var a=n=="page"||e.kind&&e.kind=="page";if(a){s="page";o=e.tag;c={container:n,body:"",kind:s,hash:n};u={tag:o,node:null,content_node_data:c,hash:n,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:e.page_id?e.page_id:RDR.util.getPageProperty("id",n)}}else{s=r.kind;var i=t('[rdr-hash="'+n+'"]');var f=e.rindow,l=e.tag;o=typeof e.tag.data=="function"?e.tag.data("tag"):e.tag;var c={};var h=e.content_node||null;if(s=="custom"){c={container:f.data("container"),body:i.attr("rdr-src"),kind:"media",location:i.get(0).nodeName.toLowerCase(),hash:n,item_type:i.hasAttr("rdr-item-type")?i.attr("rdr-item-type"):""}}else if(s=="img"||s=="media"||s=="med"){var p=i[0].src;if(RDR.group.media_url_ignore_query&&p.indexOf("?")){p=p.split("?")[0]}c={container:f.data("container"),body:p,kind:s,hash:n,item_type:i.hasAttr("rdr-item-type")?i.attr("rdr-item-type"):""};var d=RDR.actions.content_nodes.utils.getMediaDims(i);t.extend(c,d)}else{if(h){c={container:f.data("container"),body:h.body,location:h.location,kind:s,id:h.id,item_type:i.hasAttr("rdr-item-type")?i.attr("rdr-item-type"):""}}else{if(i.hasAttr("rdr-item")&&typeof RDR.summaries[n].content_nodes!="undefined"&&RDR.summaries[n].content_nodes.length){t.each(RDR.summaries[n].content_nodes,function(e,t){if(e!="undefined"){h=t}});c={container:f.data("container"),body:h.body,location:h.location,kind:s,id:h.id,item_type:i.attr("rdr-item-type")}}else{var v=f.find("div.rdr_tag_"+o.id).data("content_node_id"),m=v?r.content_nodes[v].selState:f.data("selState");if(!m){RDR.safeThrow("selState not found:  I cannot figure out why this happens every once in a while");return}c={container:f.data("container"),body:m.text,location:m.serialRange,kind:s,item_type:i.hasAttr("rdr-item-type")?i.attr("rdr-item-type"):""}}}if(c.location.indexOf("/")!=-1){var g=c.location.split(","),y="";y=g[0].split("/")[1]+","+g[1].split("/")[1];c.location=y}}u={tag:o,node:h,content_node_data:c,hash:c.container,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:RDR.util.getPageProperty("id",n),int_id:e.int_id}}return u},onSuccess:{create:function(e){function w(e){}function E(e){}function S(e){var t={hash:e.hash,kind:"page",page_id:e.page_id,int_id:e.response.data.interaction.id,tag:e.tag,rindow:e.rindow};RDR.actions.interactions.ajax(t,"react","remove")}function x(e){var t={kind:"page",page_id:e.page_id,id:e.response.data.interaction.interaction_node.id,parent_id:null,parent_interaction_node:null,content_id:null,body:e.response.data.interaction.interaction_node.body,delta:1,user:e.user,social_user:e.social_user};var n={tags:{}};n.tags[t.id]=t;RDR.actions.summaries.update(e.hash,n,true,e.page_id)}function T(e){var n=["facebook","twitter","tumblr"];var r=e.hash;var i=t('<div class="shareWrapper" ></div>');i.append('<strong class="rdr_share_it">Share It:</strong>');t.each(n,function(n,s){i.append('<a href="http://'+s+'.com" class="rdr_share_link"><img class="no-rdr" src="'+RDR_staticUrl+"widget/images/social-icons-loose/social-icon-"+s+'.png" /></a>');i.find("a.rdr_share_link:last").click(function(){RDR.events.trackEventToCloud({event_type:"share",event_value:s,container_kind:e.kind,page_id:e.page_id});RDR.shareWindow=window.open(RDR_staticUrl+"share.html","readr_share","menubar=1,resizable=1,width=626,height=436");var n=t('meta[property="og:title"]').attr("content")?t('meta[property="og:title"]').attr("content"):t("title").text()?t("title").text():"";RDR.actions.share_getLink({hash:r,kind:e.kind,sns:s,rindow:{},tag:e.tag,content_node:{content:n,kind:"page"}});return false})});return i}var n=e.rindow,r=n.data("mode")||"writeMode",i=e.response,s=i.interaction,o=i.data.interaction.interaction_node,u=i.data.container,a=e.sendData,f=a.content_node_data,l=typeof e.tag.data=="function"?e.tag.data("tag"):e.tag,c=i.data.interaction.id;RDR.events.trackEventToCloud({event_type:"reaction",event_value:l.body,reaction_body:l.body,container_hash:e.hash,container_kind:e.kind,page_id:e.page_id});t("#rdr_loginPanel").remove();if(n)n.find("div.rdr_loader").css("visibility","hidden");t('[rdr-hash="'+p+'"]').removeAttr("rdr_summary_loaded");t(".rdr_twtooltip").remove();if(e.kind&&e.kind=="page"){var h=e.response.data.existing;if(!h){x(e)}else{}RDR.actions.viewReactionSuccess(e)}else{var p=e.hash,d=RDR.summaries[p],v=d.kind;e.settings=e.sendData.content_node_data;var m=a.content_node_data;m.hash=m.container;m.kind=a.kind;if(typeof d.content_nodes=="undefined"){d.content_nodes={}}var g=RDR.containers[p];if(g&&u&&u.id){g.id=u.id}if(typeof d.content_nodes[f.id]=="undefined"){d.content_nodes[f.id]={body:f.body,counts:{coms:0,tags:1,interactions:1},id:f.id,kind:f.kind,location:a.content_node_data.location,selState:false,top_interactions:{coms:{},tags:{}}}}else{if(e.scenario!="reactionExists"){d.content_nodes[f.id].counts.tags++;d.content_nodes[f.id].counts.interactions++}}if(typeof d.content_nodes[f.id].top_interactions.tags[l.id]=="undefined"){d.content_nodes[f.id].top_interactions.tags[l.id]={count:1,body:l.body,parent_id:null}}else{if(e.scenario!="reactionExists"){d.content_nodes[f.id].top_interactions.tags[l.id].count++}}m=e.content_node||RDR.actions.content_nodes.make(m);d.id=d.id||e.container_id;var y={id:o.id,parent_id:null,parent_interaction_node:l,content_id:null,body:o.body,delta:1,user:e.user,social_user:e.social_user};var b={tags:{}};b.tags[y.id]=y;if(e.scenario!="reactionExists"){RDR.actions.summaries.update(p,b)}RDR.actions.viewReactionSuccess(e)}RDR.util.triggerPublicEvent("tag",{body:e.tag.body,hash:e.hash,kind:e.kind})},remove:function(e){var t=e.sendData;var n=e.response.data.deleted_interaction.interaction_node;var r=e.rindow,i=e.tag,s=e.int_id;if(r)r.find("div.rdr_loader").css("visibility","hidden");var o=t.hash;var u={id:n.id,parent_id:null,content_id:null,body:n.body,delta:-1,user:e.user,social_user:e.social_user};var a={tags:{}};a.tags[u.id]=u;var f=e.kind=="page"||o=="page";if(f){RDR.actions.summaries.update(o,a,f,e.page_id)}else{RDR.actions.summaries.update(o,a)}var l={msgType:"interactionSuccess",interactionInfo:{type:"tag",body:n.body,remove:true},rindow:r};r.queue("userMessage",function(){RDR.session.rindowUserMessage.show(l)});if(f){RDR.rindow.updatePageTagMessage(e,"tagDeleted")}else{RDR.rindow.updateTagMessage({rindow:r,tag:e.tag,scenario:"tagDeleted",args:e})}}},onFail:function(e){var t=e.rindow,n=e.response;if(t)t.find("div.rdr_loader").css("visibility","hidden");if(n.message.indexOf("Temporary user interaction limit reached")!=-1){RDR.session.receiveMessage(e,function(){RDR.actions.interactions.ajax(e,"react","create")});RDR.session.showLoginPanel(e)}else if(n.message=="existing interaction"){e.msgType="existingInteraction";RDR.session.rindowUserMessage.show(e)}else{RDR.session.handleGetUserFail(e,function(){RDR.actions.interactions.ajax(e,"react","create")})}}}},indicators:{show:function(e,n){n=true;var r=this.fetch(e);if(r.length==1)r.removeClass("rdr_dont_show");var i=!t.browser.msie?RDR.C.indicatorOpacity:"1";if(!t.browser.msie||t.browser.msie&&parseInt(t.browser.version,10)>8){r.not(".rdr_dont_show").css({opacity:"0",visibility:"visible"});if(n){r.not(".rdr_dont_show").css({opacity:i});return}else{r.filter("div.rdr_indicator_for_text").not(".rdr_dont_show").stop().fadeTo(800,i)}}},hide:function(e){var t=this.fetch(e);t.css({opacity:"0",visibility:"hidden"})},fetch:function(e){var n=t();if(typeof e==="string"){var r=e;n=t("#rdr_indicator_"+r)}else{var i=e;t.each(i,function(e,r){n=n.add(t("#rdr_indicator_"+r))})}return n},init:function(e){function m(){var e=r.$indicator_body=t('<div class="rdr rdr_indicator_body " />').attr("id",u).appendTo(l).append('<img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" />','<span class="rdr_count" />','<span class="rdr_count_label" />');l.css("visibility","visible")}function g(){l.on("mouseover.showRindow",function(){y();var e=l.hasClass("rdr_helper")&&RDR.group.paragraph_helper;if(e){}})}function y(){if(l.$rindow){if(l.$rindow.data("container")==e){return}l.$rindow.remove()}var t=RDR.rindow.make("readMode",{hash:e});var n=RDR.util.getPageProperty("id",e);if(!t){return}l.$rindow=t;if(l.data("isZeroCountIndicator")){b();RDR.events.trackEventToCloud({event_type:"rindow_show",event_value:"indicator_helper",container_hash:e,container_kind:"text",page_id:n})}else{RDR.events.trackEventToCloud({event_type:"rindow_show",event_value:"readmode",container_hash:e,container_kind:"text",page_id:n})}}function b(){var n=l.$rindow;var r=RDR.rindow.makeHeader("What do you think?");n.addClass("rdr_helper_rindow");n.find(".rdr_header").replaceWith(r);r.append('<div class="rdr_header_arrow"><img src="'+RDR_staticUrl+'widget/images/header_up_arrow.png" /></div>');$rindowBody=t('<div class="rdr_body rdr_visiblePanel" />');$rindowBody.html("");n.find("div.rdr_body_wrap").append($rindowBody);RDR.rindow.updateFooter(n,'<span class="rdr_cta_msg">Click to respond</span>');n.find(".rdr_footer").addClass("rdr_cta").find(".rdr_cta_msg").click(function(){n.remove();var r=t('[rdr-hash="'+e+'"]');var i=r[0];t("document").selog("selectEl",i);n=RDR.rindow.make("writeMode",{hash:e})})}function w(t){l.on("mouseover.contentNodeInit",function(){if(!l.hasAttr("rdr-item")){RDR.actions.content_nodes.init(e,t)}})}function E(){l.unbind("mouseover.contentNodeInit");l.triggerHandler("mouseover.showRindow")}function S(e){e.each(function(){var e=t(this);e.on("mouseover.showRindow",function(){x(e)})})}function x(n){if(l.$rindow){if(l.$rindow.data("container")==e){return}l.$rindow.remove()}var r=n.attr("rdr-mode")=="write"?"writeMode":"readMode";if(r=="writeMode"){if(s.length){el=s[0]}else{var i='[rdr-hash="'+e+'"]';el=t(i)[0]}t("document").selog("selectEl",el)}var o=RDR.rindow.make(r,{hash:e,$custom_cta:n});var u=RDR.util.getPageProperty("id",e);if(!o){return}l.$rindow=o;RDR.events.trackEventToCloud({event_type:"rindow_show",event_value:n.attr("rdr-mode")+"mode",container_hash:e,container_kind:"text",page_id:u})}var n=this;var r=RDR.summaries[e];if(typeof r!="undefined"&&r.$container.hasAttr("rdr-node")){var i=r.kind,s=r.$container,o="rdr_indicator_"+e,u="rdr_indicator_body_"+e,a="rdr_indicator_details_"+e;if(s.hasAttr("rdr-page-container"))return;s.attr("rdr-hasIndicator","true");if(s.hasAttr("rdr-item")){var f=s.attr("rdr-item"),l=r.$indicator=s,c=t('[rdr-counter-for="'+f+'"]'),h=t('[rdr-view-reactions-for="'+f+'"]'),p=t('[rdr-cta-for="'+f+'"]');w();if(c.length){c.addClass("rdr_count")}if(p.length){S(p);E()}if(h.length){}RDR.actions.indicators.update(e)}else{t("#rdr_indicator_"+e).remove();t("#rdr_container_tracker_"+e).remove();t("#rdr_indicator_details_"+e).remove();if(t("#rdr_indicator_"+e).length){return}var l=r.$indicator=t('<div class="rdr_indicator" />').attr("id",o).data("hash",e);m();if(!i){return}RDR.actions.indicators.utils.kindSpecificSetup[i](e);if(i=="text"){function d(e){return t(e).find(":not(iframe,noscript)").andSelf().contents().filter(function(){return this.nodeType==3})}if(s.find("img").length&&!d(s).length){RDR.actions.stripRdrNode(s);return}s.unbind(".rdr_helper");if(!isTouchBrowser){s.bind("mouseenter.rdr_helper",function(){var e=l.hasClass("rdr_helper")&&RDR.group.paragraph_helper;if(e){RDR.actions.indicators.helpers.over(l)}});s.bind("mouseleave.rdr_helper",function(e){var t=l.hasClass("rdr_helper")&&RDR.group.paragraph_helper;if(t){RDR.actions.indicators.helpers.out(l)}})}else{if(i=="text"){s.on("doubletap",function(n){var r=t('[rdr-hash="'+e+'"]');var i=r[0];t("document").selog("selectEl",i);var s=RDR.rindow.make("writeMode",{hash:e})})}}var v=!(r.counts.tags>0);l.data("isZeroCountIndicator",v);if(v){l.addClass("rdr_helper");g()}else{w(function(){g();E()})}}RDR.actions.indicators.update(e)}}},update:function(e,n){var r=this;var i=RDR.summaries[e],s=i.kind,o=i.$container,u=i.kind==="text";if(o.hasAttr("rdr-item")){var a=o.attr("rdr-item"),f=i.$indicator=o,l=t('[rdr-counter-for="'+a+'"]'),c=t('[rdr-view-reactions-for="'+a+'"]'),h=t('[rdr-cta-for="'+a+'"]');if(l.length){if(i.counts.tags>0){l.html(RDR.commonUtil.prettyNumber(i.counts.tags))}else{l.html("0")}}if(h.length){}if(c.length){}}else{if(n){if(u){o.closest("[rdr-node]").find(".rdr_indicator").remove()}else{}RDR.actions.indicators.init(e);return}var f=i.$indicator,p=i.$indicator_body,d=i.$indicator_details;var v=p.find(".rdr_count"),m=p.find(".rdr_count_label"),g=d?d.find("div.rdr_header h1"):false,y=i.counts.tags>0;var b=i.counts.tags>1?"Reactions":"Reaction";if(y){if(u){v.html(RDR.commonUtil.prettyNumber(i.counts.tags));m.text(b)}else{v.html(RDR.commonUtil.prettyNumber(i.counts.tags)+" "+b)}if(g)g.html(RDR.commonUtil.prettyNumber(i.counts.tags)+" Reactions");RDR.actions.indicators.show(e)}else{f.addClass("rdr_no_reactions");v.html('<span class="rdr_react_label">What do you think?</span>');if(u){if(RDR.group.paragraph_helper){RDR.actions.indicators.show(e);f.addClass("rdr_helper")}else{RDR.actions.indicators.hide(e)}}}}},helpers:{over:function(e){var t=e.data("containerHover");if(t){return}RDR.util.cssSuperImportant(e,{display:"inline"});e.css("opacity",RDR.C.helperIndicators.opacity)},out:function(e){e.data("containerHover",false);var t=e.data("hoverTimeout");clearTimeout(t);if(isTouchBrowser){}else{RDR.util.cssSuperImportant(e,{display:"none"})}}},utils:{checkTrailingWhiteSpace:function(e){var n=e.children().get().reverse();var r=null;var i=true;t.each(n,function(e){if(!i){return}var n=t(this).text()=="";if(n){r=this}else{i=false}});return r},kindSpecificSetup:{img:function(e){function c(){if(t("div.rdr_media_details").not("rdr_loaded").length){var r=n.$indicator_details=t("<div />").attr("id",a).addClass("rdr rdr_indicator_details rdr_widget rdr_widget_bar");t("div.rdr_media_details").html(r);u.addClass("rdr_inline_video");t("div.rdr_media_details").addClass("rdr_sandbox")}else{var r=n.$indicator_details=t("<div />").attr("id",a).addClass("rdr rdr_indicator_details rdr_widget rdr_widget_bar").appendTo("#rdr_indicator_details_wrapper")}r.data("container",e);r.data("hash",e);r.data("summary",n);r.addClass("rdr_indicator_details_for_media").click(function(){r.addClass("rdr_live_hover");RDR.actions.containers.media.onEngage(e)});i.addClass("rdr_indicator_for_media rdr_indicator_for_media_inline").find(".rdr_indicator_body").append('<div class="rdr_chevron_cta"><i class="rdr_icon-chevron-down"></i></div>');if(isTouchBrowser){i.bind("tap",function(){t(this).toggleClass("rdr_hover")})}}var n=RDR.summaries[e],r=n.$container,i=n.$indicator,s=n.$indicator_body,o=t("#rdr_container_tracker_wrap"),u=t('<div class="rdr_container_tracker" />'),a="rdr_indicator_details_"+e,f=RDR.util.getPageProperty("id",e);if(r.width()<160){RDR.safeThrow("Too small to init.");return}if(r.css("display")=="none"||r.css("visibility")=="hidden"){RDR.safeThrow("not visible.");return}var l=t("#rdr_container_tracker_"+e);if(l.length){RDR.safeThrow("Images are not expected to get re-inited.");return}u.attr("id","rdr_container_tracker_"+e).appendTo(o);c();i.appendTo(u);if(isTouchBrowser){i.bind("tap",function(){if(n.counts.interactions==0){var r=RDR.rindow.make("writeMode",{hash:e})}else{var r=RDR.rindow.make("readMode",{hash:e})}t(this).addClass("rdr_live_hover")})}else{i.on("mouseenter",function(){if(n.counts.interactions==0){var r=RDR.rindow.make("writeMode",{hash:e})}else{var r=RDR.rindow.make("readMode",{hash:e})}t(this).addClass("rdr_live_hover")}).on("mouseleave",function(){t(this).removeClass("rdr_live_hover")})}RDR.actions.indicators.utils.updateContainerTracker(e)},media:function(e){this.img(e)},text:function(e){var n=RDR.summaries[e],r=n.$container,i=n.$indicator,s=n.$indicator_body,o=t("rdr_actionbar_"+e);i.addClass("rdr_indicator_for_text").addClass("rdr_dont_show");var u=RDR.actions.indicators.utils.checkTrailingWhiteSpace(r);if(u){t(u).before(i)}else{i.appendTo(r)}}},makeDetailsContent:function(e){var n=this;var r=RDR.summaries[e],i=r.$container,s=r.$indicator,o=r.$indicator_body,u=r.$indicator_details,a=t("rdr_actionbar_"+e);if(typeof s!="undefined"){u.find("div.rdr_body_wrap").remove();var f=RDR.rindow.makeDefaultPanelMessage(u);var l=RDR.rindow.makeHeader(f);var c=t('<div class="rdr rdr_body_wrap rdr_clearfix" />');var h=r.kind;var p=h=="img"||h=="image"||h=="imgage"||h=="med"||h=="media";if(p&&!u.find("div.rdr_view_success").length){u.data("initialWidth",i.width())}var d=u;var v=RDR.actions.indicators.utils.makeTagsListForInline(d);c.append(v);u.empty().append(l,c)}},makeTagsListForInline:function(e,n,r){function y(e){function n(e,t){return t.tag_count-e.tag_count}t.each(e,function(e,t){if(!t.tag_count)t.tag_count=-101});e.sort(n);var r={big:[],medium:[],small:[]},i=e[0].tag_count,s=e[Math.floor(e.length/2)].tag_count,o=e[e.length-1].tag_count,u=function(e){var n=0;t.each(e,function(e,t){n+=t.tag_count});return Math.floor(n/e.length)}(e),a=s>u?s:u;t.each(e,function(e,t){var n=typeof t.tag_body!="undefined"?t.tag_body:t.body;if(i>15&&t.tag_count>=Math.floor(i*.8)){r.big.push(t);return}else if(t.tag_count>a){r.medium.push(t);return}else{r.small.push(t);return}});return r}function b(t){if(!t.length){return}var i=y(t),s=i.big.length+i.medium.length+i.small.length,o=1;if(a=="grid"){if(s>6&&!n){if(isTouchBrowser){RDR.rindow.tagBox.setWidth(e,320)}else{RDR.rindow.tagBox.setWidth(e,480)}}else if(typeof r!="undefined"&&n){RDR.rindow.tagBox.setWidth(e,320)}else if(t.length>1){if(i.big.length){RDR.rindow.tagBox.setWidth(e,320)}if(i.medium.length){RDR.rindow.tagBox.setWidth(e,320)}if(i.small.length>=3){RDR.rindow.tagBox.setWidth(e,320)}}}while(i.big.length||i.medium.length||i.small.length){if(i.big.length){var u=i.big.shift();RDR.rindow.tagBox.make({tag:u,boxSize:"big",$rindow:e,isWriteMode:n,colorInt:o});o++;if(o==6)o=1}else if(i.medium.length){var u=i.medium.shift();RDR.rindow.tagBox.make({tag:u,boxSize:"medium",$rindow:e,isWriteMode:n,colorInt:o});o++;if(o==6)o=1}else if(i.small.length){var u=i.small.shift();RDR.rindow.tagBox.make({tag:u,boxSize:"small",$rindow:e,isWriteMode:n,colorInt:o});o++;if(o==6)o=1}}}function w(e){e.isotope({masonry:{columnWidth:160}},function(){function i(){var i=e.find("div.rdr_box:eq("+n+")");i.addClass("rdr_animated");n++;if(n>t){clearInterval(r)}}var t=e.find("div.rdr_box").length,n=0;var r=setInterval(function(){i()},20)})}function E(e){var n=e.find(".rdr_box");var r=n.eq(-1);if(isTouchBrowser){if(n.index(r)%2==0){r.addClass("rdr_wide")}return}if(!r.length){return}var i=r.position();var s=false;r.addClass("rdr_clear_transform").css({height:"auto",width:"auto",top:i.top,left:i.left,bottom:0,right:0});t(n.get().reverse()).each(function(){if(s){return}var e=t(this);var n=e.position();var r=n.top==i.top;var o=n.top==i.top;var u=n.left==i.left;if(!o&&!u){s=true;return}if(o){e.addClass("rdr_clear_transform").css({height:"auto",top:n.top,left:n.left,bottom:0})}})}var i=e.data("hash")||e.attr("rdr-hash");var s=!i||i=="page";var o=!s?RDR.summaries[i]:{};var u=RDR.groupSettings.getBlessedTags(i);var a=e.attr("rdr-view-style")||"grid";if(!Date.now){Date.now=function(){return(new Date).valueOf()}}var f=t('<div class="rdr_body rdr_tags_list rdr_'+a+'" />').data("now",Date.now()),l=t('<div class="rdr_body rdr_tags_list" />').data("now",Date.now());var c=e.find(".rdr_tags_list");e.find(".rdr_body_wrap").append(f);c.remove();if(typeof r!="undefined"){if(!n&&r.toptags.length){b(r.toptags);RDR.rindow.updateFooter(e,'<span class="rdr_cta_msg">What do you think?</span>');e.find(".rdr_footer").addClass("rdr_cta").find("span.rdr_cta_msg").click(function(){e.remove();e=RDR.rindow.make("writeMode",{hash:"page",page:r,is_page:true})})}else{var h=RDR.rindow.makeHeader("What do you think?"),n=true;e.find(".rdr_header").replaceWith(h);b(u);var p=RDR.rindow.writeCustomTag(f,e);e.removeClass("rdr_rewritable")}}else if(n){b(u)}else if(s){}else{if(!t.isEmptyObject(o.top_interactions.tags)){RDR.actions.summaries.sortInteractions(i);b(o.interaction_order);if(o.kind=="text"){if(!o.crossPage){RDR.rindow.updateFooter(e,'<span class="rdr_cta_msg">What do you think?</span>');e.find(".rdr_footer").addClass("rdr_cta").find(".rdr_cta_msg").click(function(){e.remove();var n=t('[rdr-hash="'+i+'"]');var r=n[0];t("document").selog("selectEl",r);e=RDR.rindow.make("writeMode",{hash:i})})}}else{RDR.rindow.updateFooter(e,'<span class="rdr_cta_msg">What do you think?</span>');e.find(".rdr_footer").addClass("rdr_cta").find(".rdr_cta_msg").click(function(){e.remove();e=RDR.rindow.make("writeMode",{hash:i})})}}else{RDR.rindow.updateFooter(e,'<span class="rdr_no_reactions_msg rdr_clearfix">No reactions yet!</span>')}}if(typeof r=="undefined"&&n){var p=RDR.rindow.writeCustomTag(f,e);e.removeClass("rdr_rewritable")}if(!n&&!isTouchBrowser){e.on("mouseleave",function(e){var n=t(this),r;r=setTimeout(function(){if(n.hasClass("rdr_rewritable")){n.remove()}},300);t(this).data("timeoutCloseEvt",r)}).on("mouseenter",function(){var e=t(this).data("timeoutCloseEvt");clearTimeout(e)});if(typeof o!="undefined"&&o.kind=="text"&&!t.isEmptyObject(o.content_nodes)){e.find("div.rdr_box").each(function(){t(this).hover(function(){var n=o.content_nodes[t(this).find("div.rdr_tag").data("content_node_id")].selState;var r=!e.data("panelState")||e.data("panelState")===1;if(r){t().selog("hilite",n,"on");e.data("selState",n)}},function(){var n=o.content_nodes[t(this).find("div.rdr_tag").data("content_node_id")].selState;var r=!e.data("panelState")||e.data("panelState")===1;if(r){t().selog("hilite",n,"off")}})})}}if(s){}if(a=="grid"||n){w(f);E(f)}else{var d=f.find("div.rdr_box").length,v=0;var m=setInterval(function(){g()},20);function g(){var e=f.find("div.rdr_box:eq("+v+")");e.addClass("rdr_animated");v++;if(v>d){clearInterval(m)}}}return f},updateContainerTrackers:function(){t.each(RDR.containers,function(e,t){if(t.kind&&(t.kind=="img"||t.kind=="media"||t.kind=="med")){RDR.actions.indicators.utils.updateContainerTracker(t.hash)}})},updateContainerTracker:function(e){var n=RDR.summaries[e],r=n.$container,i=t("#rdr_container_tracker_"+e);var s=RDR.containers[e];if(s.kind&&(s.kind=="text"||s.kind=="txt"))return;var o={top:parseInt(r.css("padding-top"),10),right:parseInt(r.css("padding-right"),10),bottom:parseInt(r.css("padding-bottom"),10),left:parseInt(r.css("padding-left"),10)};var u=parseInt(r.css("border-top-width"),10)+parseInt(r.css("border-bottom-width"),10)+parseInt(r.css("border-left-width"),10)+parseInt(r.css("border-right-width"),10);var a={};a.top=!u?o.top:0;a.left=!u?o.left:0;RDR.util.cssSuperImportant(i,{top:r.offset().top+a.top+"px",left:r.offset().left+a.left+"px"},true);this.updateMediaTracker(e)},updateInlineIndicator:function(e){var t=RDR.summaries[e],n=t.$container,r=t.$indicator_details;r.css({top:n.offset().bottom,left:n.offset().left,width:n.outerWidth()})},updateMediaTracker:function(e){var n=RDR.summaries[e],r=n.$container,i=n.$indicator,s=n.$indicator_body,o=n.$indicator_details,u=t("#rdr_container_tracker_"+e);if(s){if(r.parents(RDR.group.img_container_selectors).length){r=r.parents(RDR.group.img_container_selectors).first()}var a,f;var l=parseInt(r.css("border-top-width"),10)+parseInt(r.css("border-bottom-width"),10)+parseInt(r.css("border-left-width"),10)+parseInt(r.css("border-right-width"),10);if(l){a=r.outerWidth();f=r.outerHeight()}else{a=r.width();f=r.height()}var c={top:parseInt(r.css("padding-top"),10),right:parseInt(r.css("padding-right"),10),bottom:parseInt(r.css("padding-bottom"),10),left:parseInt(r.css("padding-left"),10)};var h=0,p=s.width(),d=t.browser.msie&&parseInt(t.browser.version,10)<9?10:0;var v=n.kind=="media"?r.height()+d+36:r.height()+d+12;i.data("top",v);if(n.kind=="media"){i.addClass("rdr_indicator_not_img")}RDR.util.cssSuperImportant(i,{left:12+"px",top:v+"px"},true);var m=n.kind=="text"?false:true;if(m){RDR.actions.indicators.utils.updateInlineIndicator(e)}else{}}},borderHilites:{designVersion:2,makeAttempt:0,make:function(e){var n=t("#rdr_indicator_"+e),r=t('[rdr-hash="'+e+'"]'),i=t("#rdr_container_tracker_"+e),s=i.find(".rdr_media_border_wrap");if(!i.hasClass("rdr_inline_video")){if(!s.length){s=t('<div class="rdr_media_border_wrap" />').appendTo(i);s.addClass("designVersion_"+RDR.actions.indicators.utils.borderHilites.designVersion)}s.hide();var o={top:{$side:null,css:{}},right:{$side:null,css:{}},bottom:{$side:null,css:{}},left:{$side:null,css:{}}};s.data("borders",o)}},update:function(e){var n=RDR.actions.indicators.utils.borderHilites;var r=t("#rdr_indicator_"+e),i=t('[rdr-hash="'+e+'"]'),s=t("#rdr_container_tracker_"+e),o=s.find(".rdr_media_border_wrap");if(!o.length){if(this.makeAttempt>1)return;this.makeAttempt++;RDR.actions.indicators.utils.borderHilites.make(e);return}this.makeAttempt=0;o.hide();var u={top:{$side:null,css:{}},right:{$side:null,css:{}},bottom:{$side:null,css:{}},left:{$side:null,css:{}}};var a=n.designVersion===1?2:n.designVersion===2?3:2;var f,l;var c=false;t.each(u,function(e,n){var r="rdr_mediaHilite_"+e;n.$side=o.find("."+r);if(!n.$side.length){n.$side=t("<div />").addClass(r).appendTo(o)}if(parseInt(i.css("border-"+e+"-width"),10)){c=true}});if(c){f=i.outerWidth();l=i.outerHeight()}else{f=i.width();l=i.height()}var h=2*a;u.top.css={width:f+h+"px",height:0+"px",top:-a+"px",left:-a+"px"};u.right.css={width:0+"px",height:l+"px",top:0+"px",left:f+"px"};u.bottom.css={width:f+h+"px",height:0+"px",top:l+"px",left:-a+"px"};u.left.css={width:0+"px",height:l+"px",top:0+"px",left:-a+"px"};t.each(u,function(e,t){RDR.util.cssSuperImportant(t.$side,t.css,true)})},engage:function(e,n){var r=t("#rdr_container_tracker_"+e),i=r.find(".rdr_media_border_wrap");i.addClass("engaged");if(n){i.addClass("engagedForShareLink")}},disengage:function(e){var n=t("#rdr_container_tracker_"+e),r=n.find(".rdr_media_border_wrap");r.removeClass("engaged");r.removeClass("engagedForShareLink");t("#rdr_indicator_"+e).hide()},engageAll:function(){$mediaBorderWrap=t(".rdr_media_border_wrap");$mediaBorderWrap.addClass("engaged")},disengageAll:function(){$mediaBorderWrap=t(".rdr_media_border_wrap");$mediaBorderWrap.removeClass("engaged");$mediaBorderWrap.removeClass("engagedForShareLink");t("div.rdr_indicator_for_media").hide()}}}},summaries:{init:function(e){if(typeof RDR.summaries[e]=="object"){return RDR.summaries[e]}var t=RDR.containers[e];var n={hash:e,kind:t.kind,id:t.id,counts:{coms:0,tags:0,interactions:0},top_interactions:{coms:{},tags:{}}};return n},save:function(e){var n=e.hash;if(RDR.summaries.hasOwnProperty(n)){}RDR.summaries[n]=e;e.$container=t('[rdr-hash="'+n+'"]')},update:function(e,n,r,i){function o(e){var t=e.hash;var n=e.summary;var r=e.interaction_node_type;var i=e.id;var s=e.diffNode;var o=n.top_interactions[r];var u=o.hasOwnProperty(i)&&typeof o[i]!=="undefined";if(u){var a=o[i];a.count+=s.delta;if(r=="tags"){RDR.actions.summaries.updatePageSummaryTags(t,s);if(a.count<=0){delete o[i]}}}else{if(r=="tags"){o[i]={count:s.delta,body:s.body,id:i,parent_id:s.parent_id,parent_interaction_node:s.parent_interaction_node};RDR.actions.summaries.updatePageSummaryTags(t,s)}else{var f=s.user;o[s.tag_id]={body:s.body,content_node:s.content_node,content_id:s.content_id,id:s.id,social_user:s.social_user,tag_id:s.tag_id,user:s.user,parent_id:s.parent_id,parent_interaction_node:s.parent_interaction_node}}}}function u(e){return;var n=e.hash;var r=e.summary;var i=e.interaction_node_type;var s=e.id;var o=e.diffNode;var u=r.content_nodes;if(!u){return}t.each(u,function(e,n){if(i=="tags"){if(e===o.content_id){n.counts[i]+=o.delta;n.counts[interactions]+=o.delta;var r=o.id;var s=n.top_interactions.tags[r];if(s){s.count+=o.delta;if(s.count<=0){delete n.top_interactions.tags[r]}}}}else if(i=="coms"){if(n.id===o.content_id){n.counts[i]+=o.delta;n.counts[interactions]+=o.delta;var u=n.top_interactions.coms;if(o.delta===-1){t.each(u,function(e,t){})}else{}}}})}if(r){t.each(n,function(n,r){t.each(r,function(t,n){n.page_id=i;RDR.actions.summaries.updatePageSummaryTags(e,n)})});return}var s;if(!RDR.summaries.hasOwnProperty(e)){s=RDR.actions.summaries.init(e)}else{s=RDR.summaries[e]}t.each(n,function(n,r){t.each(r,function(t,r){o({hash:e,summary:s,interaction_node_type:n,id:t,diffNode:r});s.counts[n]+=r.delta;s.counts.interactions+=r.delta;r.int_type=n;RDR.rindow.update(e,r)})});RDR.actions.summaries.sortInteractions(e);if(e=="pageSummary"){makeSummaryWidget(RDR.page)}else{}},updatePageSummaryTags:function(e,n){var r=n.id;var i=n.page_id||RDR.util.getPageProperty("id",e);var s=RDR.pages[i];var o=s.toptags;var u;t.each(o,function(){if(this.id==r){s.count+=n.delta;this.tag_count+=n.delta;u=true}});if(!u){o.push({body:n.body,id:n.id,tag_count:1})}var a=s.summary;t.each(a,function(e,t){if(t.kind=="tag"){t.count=t.count+n.delta}});var f=t('[rdr-page-container="'+i+'"]');var l=f.find("[rdr-page-widget-key]");l.rdrWidgetSummary("update")},sortByTags:function(e){function t(e,t){return t.tag_count-e.tag_count}return e.sort(t)},sortInteractions:function(e){function n(e,t){return t.tag_count-e.tag_count}function o(e){if(e>r.counts.highest_tag_count){r.counts.highest_tag_count=e}}var r=RDR.summaries[e];r.interaction_order=[];r.counts.highest_tag_count=0;var i=r.kind=="text"||r.kind=="txt";if(i){if(!t.isEmptyObject(r.content_nodes)){t.each(r.content_nodes,function(e,n){t.each(n.top_interactions.tags,function(t,n){r.interaction_order.push({tag_count:n.count,tag_id:t,tag_body:n.body,content_node_id:e,parent_id:n.parent_id});o(n.count)})})}else{t.each(r.top_interactions.tags,function(e,t){r.interaction_order.push({tag_count:t.count,tag_id:e,tag_body:t.body,content_node_id:s,parent_id:t.parent_id});o(t.count)})}}else if(!t.isEmptyObject(r.top_interactions)&&!t.isEmptyObject(r.content_nodes)){var s=t.map(r.content_nodes,function(e,t){return t})[0];t.each(r.top_interactions.tags,function(e,t){r.interaction_order.push({tag_count:t.count,tag_id:e,tag_body:t.body,content_node_id:s,parent_id:t.parent_id});o(t.count)})}r.interaction_order.sort(n)},sortPopularTextContainers:function(){function e(e,t){return t.interactions-e.interactions}RDR.text_container_popularity=[];t.each(RDR.summaries,function(e,t){if(t.kind=="text"&&t.counts.interactions>0){RDR.text_container_popularity.push({hash:e,interactions:t.counts.interactions})}});RDR.text_container_popularity.sort(e)},displayPopularIndicators:function(){for(var e=0;e<RDR.group.initial_pin_limit;e++){if(RDR.text_container_popularity[e])t("#rdr_indicator_"+RDR.text_container_popularity[e].hash).removeClass("rdr_dont_show")}},showLessPopularIndicators:function(){var e=[];for(var n=RDR.group.initial_pin_limit;n<RDR.text_container_popularity.length;n++){if(RDR.text_container_popularity[n]){if(RDR.text_container_popularity[n].interactions>0){t("#rdr_indicator_"+RDR.text_container_popularity[n].hash).removeClass("rdr_dont_show");e.push(RDR.text_container_popularity[n].hash)}}}RDR.actions.indicators.show(e)}},insertContainerIcon:function(e){},viewReactionSuccess:function(e){var n=e.tag,r=e.rindow,i=e.response.data.interaction,s=e.content_node==""?e.response.data.content_node:e.content_node;r.removeClass("rdr_rewritable").addClass("rdr_viewing_more").find(".rdr_footer").hide();var o=e.scenario=="reactionSuccess"?"Thanks for your reaction!":"You've already reacted to this";var u=e.kind=="page";if(u){var a=null,f="page"}else{var a=e.hash,l=RDR.summaries[a],f=l.kind}var c=RDR.rindow.makeHeader(o,e.response.data.interaction.id);r.find(".rdr_header").replaceWith(c);var h=RDR.rindow.panelCreate(r,"rdr_view_more");var p=r.find("div.rdr_body_wrap");p.append(h);RDR.rindow.updateTagMessage(e);RDR.rindow.panelShow(r,h,function(){if(f=="text"&&e.selState){var n=e.selState;t().selog("hilite",n,"on")}var i=RDR.actions.indicators.utils.makeTagsListForInline(r);if(e.scenario!="reactionExists"){RDR.actions.containers.updateCrossPageHash(a)}i.addClass("rdr_hiddenPanel");var s="rdr_tags_list";RDR.rindow.hideFooter(r);RDR.rindow.panelUpdate(r,s,i);var o=t('[rdr-hash="'+a+'"]').length>0;if(!o){}})},viewCommentContent:function(e){function y(){var e=t('<div class="rdr_commentBox rdr_innerWrap"></div>').html('<div class="rdr_commentComplete"><div><h4>Leave a comment:</h4></div></div>');var u="Add a comment or #hashtag",a=t('<div class="rdr_comment rdr_clearfix">'),f=t('<textarea class="commentTextArea rdr_default_msg">'+u+"</textarea>"),l=t('<div class="rdr_charCount">'+RDR.group.comment_length+" characters left</div>"),c=t('<button class="rdr_commentSubmit">Comment</button>');a.append(f,l,c);f.focus(function(){if(t(this).val()==u){t(this).val("")}}).blur(function(){var e=t(this).val();if(e===""||e===u){t(this).addClass("rdr_default_msg");t(this).val(u)}}).keyup(function(e){var n=f.val();if(e.keyCode=="27"){t(this).blur();return false}else if(n.length>RDR.group.comment_length){n=n.substr(0,RDR.group.comment_length);f.val(n)}f.siblings("div.rdr_charCount").text(RDR.group.comment_length-n.length+" characters left")});c.click(function(e){var a=f.val();if(a.length>RDR.group.comment_length){a=a.substr(0,RDR.group.comment_length);f.val(a);f.siblings("div.rdr_charCount").text(RDR.group.comment_length-a.length+" characters left")}if(a!=u){if(t.isEmptyObject(i)&&o.kind=="img"){i={body:t('img[rdr-hash="'+o.hash+'"]').get(0).src,kind:o.kind,hash:o.hash}}else{var l=t('[rdr-hash="'+o.hash+'"]'),c=l.attr("rdr-content-type");if(c){if(c=="media"){i.kind="media"}else if(c=="image"){i.kind="image"}else{i.kind="text"}}else{i.kind="text"}}var h=h||null;var p={hash:s,content_node_data:i,comment:a,content:i.body,tag:n,rindow:r,selState:h};RDR.actions.interactions.ajax(p,"comment","create")}else{f.focus()}return false});e.append(a);return e}function b(){var e=t('<div class="rdr_back">Close X</div>');e.click(function(){var e=!!r.attr("rdr-view-reactions-for");if(!e){RDR.rindow.close(r);return}var t=RDR.rindow.makeHeader("Reactions");r.find(".rdr_header").replaceWith(t);RDR.rindow.updateTagPanel(r)});return e}function w(){var e,r=n.id?n.id:n.tag_id;if(a=="text"){e=o.content_nodes[i.id].top_interactions.coms}else{e=o.top_interactions.coms[r]}var s=0;if(!t.isArray(e)){e=[].push(e)}t.each(e,function(e,t){if(t.tag_id==r){s++}});var u=!t.isEmptyObject(e);if(!u)return;var f=t('<div class="rdr_otherCommentsBox"></div>');var l=t('<div class="rdr_comment_header rdr_innerWrap"><h4>(<span>'+s+"</span>) Comments:</h4></div>");f.append(l);t.each(e,function(e,n){if(n.tag_id!=r){return}f.show();var i=t('<div class="rdr_commentSet rdr_innerWrap" />'),s=t('<div class="rdr_commentBy" />'),o=t('<div class="rdr_comment" />'),u=t('<div class="rdr_commentReplies" />'),a=t('<div class="rdr_commentReply" />'),l=t('<a href="javascript:void(0);">Reply</a>');var c=n&&n.social_user&&n.social_user.img_url?n.social_user.img_url:RDR_staticUrl+"widget/images/anonymousplode.png";var h=!n||!n.user||n.user.first_name===""?"Anonymous":n.user.first_name+" "+n.user.last_name;s.html('<a href="'+RDR_baseUrl+"/user/"+n.user.id+'" target="_blank"><img src="'+c+'" class="no-rdr" /> '+h+"</a>").click(function(){});o.html('<div class="rdr_comment_body">'+n.body+"</div>");i.append(s,o);f.append(i)});f.find("div.rdr_commentSet:last-child").addClass("rdr_lastchild");return f}var n=e.tag,r=e.rindow,i=e.content_node;RDR.events.trackEventToCloud({event_type:"view comments",event_value:"",container_hash:e.hash,container_kind:e.content_node.kind,page_id:RDR.util.getPageProperty("id"),reaction_body:e.tag.tag_body});r.removeClass("rdr_rewritable").addClass("rdr_viewing_more");RDR.rindow.tagBox.setWidth(r,320);RDR.rindow.hideFooter(r);var s=e.hash,o=RDR.summaries[s],u=n.tag_body?n.tag_body:n.body,a=o.kind;var f=RDR.rindow.makeHeader(n.tag_body);r.find(".rdr_header").replaceWith(f);var l=RDR.rindow.panelCreate(r,"rdr_view_more");var c=r.find("div.rdr_body_wrap");c.append(l);var h=t('<div class="rdr_commentsWrap"></div>');var p=b();var d=b();var v=w();var m=y();h.append(p,v,m,d);l.append(h);var g=a=="img"||a=="imgage"||a=="med"||a=="media";RDR.rindow.panelShow(r,l,function(){if(a=="text"){var n=e.selState||o.content_nodes[i.id].selState;t().selog("hilite",n,"on");r.data("selState",n)}})},share_getLink:function(e){var n=e.hash,r=RDR.summaries[n],i=e.kind?e.kind:r.kind;RDR.session.getUser(e,function(r){var s=r.rindow,o=r.tag;var u=r.content_node_info?r.content_node_info:r.content_node;if(!u.hash)u.hash=u.container?u.container:r.hash;if(!u.content)u.content=u.body;var a={hash:n,body:u.content,location:u.location,kind:i};var f=RDR.actions.content_nodes.make(a);t.postMessage("page_hash|"+window.location.hash,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"]);if(typeof o.body=="undefined"){o.body=o.tag_body}var l={tag:o,hash:u.hash,content_node_data:a,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:RDR.util.getPageProperty("id",n),referring_int_id:e.referring_int_id,container_kind:e.kind=="page"?"page":RDR.summaries[n].kind};t.ajax({url:RDR_baseUrl+"/api/share/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:t.toJSON(l)},success:function(t){e.response=t;if(t.status=="fail"){if(t.message.indexOf("Temporary user interaction limit reached")!=-1){RDR.session.showLoginPanel(e)}else{RDR.session.handleGetUserFail(e,function(){RDR.actions.share_getLink(e)})}}else{RDR.actions.shareContent({sns:r.sns,content_node_info:u,short_url:t.data.short_url,reaction:o.body,container_kind:n=="page"?"page":RDR.summaries[n].kind})}},error:function(e){}})})},shareContent:function(e){function p(){return RDR.group.name?RDR.group.name:document.domain.replace("www.","")}function d(e,t,n){var r=n?t?"&#124;":"|":t?"&raquo;":"";return t?e+"&nbsp;"+r+"&nbsp;":e+" "+r}function v(e,t,n){var r="...";var i=t-r.length;var s=e.length<=t?e:e.substr(0,i)+r;s=n?'"'+s+'"':s;return s}var t=p();var n=e.content_node_info.content,r="",i="",s=300;switch(e.sns){case"facebook":var o="";var u="";var a="";var f="A ReadrBoard Reaction on "+t;switch(e.container_kind){case"txt":case"text":s=300;i=v(n,s,true);a=d(e.reaction)+" "+i;break;case"img":case"image":i="[a picture on "+t+"] Check it out: ";if(RDR_offline){n=n.replace("local.readrboard.com:8080","www.readrboard.com");n=n.replace("localhost:8080","www.readrboard.com")}o="&p[images][0]="+encodeURI(n);a=d(e.reaction)+" "+i;break;case"media":case"med":case"video":i="[a video on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break;case"page":i="[an article on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break}r="http://www.facebook.com/sharer.php?s=100"+"&p[title]="+encodeURI(a)+"&p[url]="+e.short_url+"&p[summary]="+encodeURI(a)+o+u;break;case"twitter":var a="";var f="A ReadrBoard Reaction on "+t;var l=RDR.group.twitter?"&via="+RDR.group.twitter:"";switch(e.container_kind){case"txt":case"text":s=110-e.reaction.length;i=v(n,s,true);a=d(e.reaction)+" "+i;break;case"img":case"image":i="[a picture on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break;case"media":case"med":case"video":i="[a video on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break;case"page":i="[an article on "+t+"] Check it out: ";a=d(e.reaction)+" "+i;break}r="http://twitter.com/intent/tweet?"+"url="+e.short_url+l+"&text="+encodeURI(a);break;case"tumblr":var a="";switch(e.container_kind){case"txt":case"text":var f=d(e.reaction,true)+'&nbsp;[a <a href="'+e.short_url+'">quote</a> on '+t+" via ReadrBoard]";s=300;i=v(n,s);r="http://www.tumblr.com/share/quote?"+"quote="+encodeURIComponent(i)+"&source="+encodeURIComponent(f);break;case"img":case"image":if(RDR_offline){n=n.replace("local.readrboard.com:8080","www.readrboard.com");n=n.replace("localhost:8080","www.readrboard.com")}a=d(e.reaction,true);var f='&nbsp;[a <a href="'+e.short_url+'">picture</a> on '+t+" via ReadrBoard]";r="http://www.tumblr.com/share/photo?"+"source="+encodeURIComponent(n)+"&caption="+encodeURIComponent(a+f)+"&click_thru="+encodeURIComponent(e.short_url);break;case"media":case"med":case"video":var c='<iframe src=" '+e.content_node_info.body+' "></iframe>';a=d(e.reaction,true);var f='&nbsp;[a <a href="'+e.short_url+'">video</a> on '+t+" via ReadrBoard]";var h=a+f;r="http://www.tumblr.com/share/video?&embed="+encodeURIComponent(c)+"&caption="+encodeURIComponent(h);break;case"page":var f=d(e.reaction,true)+'&nbsp;[an <a href="'+e.short_url+'">article</a> on '+t+" via ReadrBoard]";s=300;i=v(n,s);r="http://www.tumblr.com/share/link?"+"url="+encodeURIComponent(e.short_url)+"&description="+encodeURIComponent(f);break}break;case"linkedin":break}if(r!==""){if(RDR.shareWindow){RDR.shareWindow.location=r}}else{if(RDR.shareWindow){RDR.shareWindow.close()}}},newUpdateData:function(e){var t=RDR.summaries[e],n=t.$rindow_readmode,r=t.$rindow_writemode},startSelect:function(e,n,r){function c(e){var n=null;var r=false;e.parents().each(function(){if(r){return}var e=t(this);if(d(e)){n=t(this);r=true}});return n}function h(r){var i=r.data("hash"),s=RDR.summaries[i]||"undefined";if(p(i))return false;if(s!="undefined"){var u=s.$indicator;RDR.actions.indicators.helpers.out(u)}RDR.rindow.close(t("div.rdr.rdr_window.rdr.rdr_rewritable"));var a=n?{top:parseInt(n.pageY,10),left:parseInt(n.pageX,10)}:{top:e.offset().top,left:e.offset().left};return RDR.actionbar.draw({coords:a,kind:"text",content:o.text,hash:r.data("hash")})}function p(e){var t=RDR.summaries[e]||"undefined";if(!t)return false;var n=t.$rindow_writemode;if(n&&n.filter(":visible").length){return n}else{return false}}function d(e){var t=(e.css("display")=="block"||e.css("display")=="list-item")&&!e.closest(".rdr_indicator").length&&!e.is("html, body");return t}if(e.hasAttr("rdr-item")&&t('[rdr-cta-for="'+e.attr("rdr-item")+'"]').length){return}RDR.actionbar.closeAll();var i=800;if(e.closest(".rdr, .no-rdr, #rdr_sandbox").length&&!e.closest(".rdr_indicator").length)return;var s=null;if(d(e)){s=e}else{s=c(e)}if(s===null)return;$rdrParent=s.closest("[rdr-hashed]");var o=s.selog("save");if(!o||!o.serialRange||!o.text||/^\s*$/g.test(o.text))return;if(o.text.length>i)return;var u="text";var a=o.text;if($rdrParent.length&&$rdrParent.hasAttr("rdr-hashed")&&!$rdrParent.hasAttr("rdr-page-container")){if(r){var f=$rdrParent.data("hash");r(f,u,a);return}return h($rdrParent)}else{var l=RDR.actions.hashNodes(s);if(l){RDR.actions.sendHashes(l,function(){if(r){var e=s.data("hash");r(e,u,a);return}return h(s)})}}},startSelectFromMouseUp:function(e){var n=t(e.target);RDR.actions.startSelect(n,e)},stripRdrNode:function(e){e.removeAttr("rdr-node rdr-hasIndicator rdr-hashed rdr_summary_loaded rdr-hash").find(".rdr_indicator").remove()},pages:{save:function(e,t){RDR.pages[t.id]=t},initPageContainer:function(e){var n=RDR.pages[e],r=n.key;var i=t(RDR.group.post_selector+'[rdr-page-key="'+r+'"]').length==1?t(RDR.group.post_selector+'[rdr-page-key="'+r+'"]'):t('body[rdr-page-key="'+r+'"]');if(i.length!==1)return;i.removeAttr("rdr-page-key");i.attr("rdr-page-container",e);var s=RDR.util.md5.hex_md5(String(n.id));var o=i.get(0).nodeName.toLowerCase();RDR.actions.containers.save({id:String(n.id),kind:"page",hash:s,HTMLkind:null});i.data("page_id",String(n.id));RDR.actions.hashNodes(i);var u={};if(n.containers.length>0){u[n.id]=[];t.each(n.containers,function(e,t){if(typeof t.hash!="undefined"){u[n.id].push(t.hash)}})}if(n&&t("[rdr-item]").length){u[n.id]=u[n.id]||[];t.each(t("[rdr-item]"),function(e,r){RDR.actions.hashNodes(t(r));var i=t(r).attr("rdr-hash");if(typeof i!="undefined"){u[n.id].push(i)}})}RDR.actions.sendHashes(u);var a=n;a.key=r;if(i.find(RDR.group.summary_widget_selector).length==1&&i.find(RDR.group.summary_widget_selector+'[rdr-page-widget-key="'+r+'"]')){a.$anchor=i.find(RDR.group.summary_widget_selector)}else if(t(".rdr-page-summary").length==1){a.$anchor=t(".rdr-page-summary").eq(0)}else{var f=typeof RDR.engageScriptParams.bookmarklet=="undefined"?"top:-1000px !important":"";a.$anchor=t('<div id="rdr-page-summary" class="rdr no-rdr rdr-page-summary defaultSummaryBar" style="'+f+'"/>');a.$anchor.appendTo("body")}t("#rdr_sandbox").append('<div id="rdr_summary_tag_details" />');if(t("div.rdr-summary").length===0||t("div.rdr-summary").length<t(RDR.group.post_selector).length){a.$anchor.rdrWidgetSummary(a)}}},users:{save:function(e,t){}}}})}function rdr_loadScript(e,t){var n=document.getElementsByTagName("head")[0];if(n){var r=document.createElement("script");r.setAttribute("src",e.src);r.setAttribute("type","text/javascript");if(r.readyState){r.onreadystatechange=function(){if(r.readyState=="loaded"||r.readyState=="complete"){r.onreadystatechange=null;t()}}}else{r.onload=function(){t()}}n.appendChild(r)}}function jquery_onload(e){$R=e.noConflict(true);var t=$R;!function(e,t){"use strict";var n,r;if(e.uaMatch=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:n[0]||""}},n=e.uaMatch(t.navigator.userAgent),r={},n.browser&&(r[n.browser]=!0,r.version=n.version,r.versionNumber=parseInt(n.version)),n.platform&&(r[n.platform]=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv){var i="msie";n.browser=i,r[i]=!0}if(r.opr){var s="opera";n.browser=s,r[s]=!0}if(r.safari&&r.android){var o="android";n.browser=o,r[o]=!0}r.name=n.browser,r.platform=n.platform,e.browser=r}(t,window);if(t.browser.msie&&parseInt(t.browser.version,10)<9){return false}if(t.browser.msie&&parseInt(t.browser.version,10)==8){t("body").addClass("rdr_ie")}$RFunctions($R)}function load_mobileEvents(e){(function(e){function t(){var e=a();if(e!==f){f=e;o.trigger("orientationchange")}}function n(t,n,r,i){var s=r.type;r.type=n;e.event.dispatch.call(t,r,i);r.type=s}e.attrFn=e.attrFn||{};var r=navigator.userAgent.toLowerCase(),i=r.indexOf("chrome")>-1&&(r.indexOf("windows")>-1||r.indexOf("macintosh")>-1||r.indexOf("linux")>-1)&&r.indexOf("chrome")<0,s={swipe_h_threshold:50,swipe_v_threshold:50,taphold_threshold:750,doubletap_int:500,touch_capable:"ontouchstart"in document.documentElement&&!i,orientation_support:"orientation"in window&&"onorientationchange"in window,startevent:"ontouchstart"in document.documentElement&&!i?"touchstart":"mousedown",endevent:"ontouchstart"in document.documentElement&&!i?"touchend":"mouseup",moveevent:"ontouchstart"in document.documentElement&&!i?"touchmove":"mousemove",tapevent:"ontouchstart"in document.documentElement&&!i?"tap":"click",scrollevent:"ontouchstart"in document.documentElement&&!i?"touchmove":"scroll",hold_timer:null,tap_timer:null};e.isTouchCapable=function(){return s.touch_capable};e.getStartEvent=function(){return s.startevent};e.getEndEvent=function(){return s.endevent};e.getMoveEvent=function(){return s.moveevent};e.getTapEvent=function(){return s.tapevent};e.getScrollEvent=function(){return s.scrollevent};e.each(["tapstart","tapend","tap","singletap","doubletap","taphold","swipe","swipeup","swiperight","swipedown","swipeleft","swipeend","scrollstart","scrollend","orientationchange"],function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)};e.attrFn[n]=true});e.event.special.tapstart={setup:function(){var t=this,r=e(t);r.bind(s.startevent,function(e){r.data("callee",arguments.callee);if(e.which&&e.which!==1){return false}var i=e.originalEvent,o={position:{x:s.touch_capable?i.touches[0].screenX:e.screenX,y:s.touch_capable?i.touches[0].screenY:e.screenY},offset:{x:s.touch_capable?i.touches[0].pageX-i.touches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?i.touches[0].pageY-i.touches[0].target.offsetTop:e.offsetY},time:(new Date).getTime(),target:e.target};n(t,"tapstart",e,o);return true})},remove:function(){e(this).unbind(s.startevent,e(this).data.callee)}};e.event.special.tapend={setup:function(){var t=this,r=e(t);r.bind(s.endevent,function(e){r.data("callee",arguments.callee);var i=e.originalEvent;var o={position:{x:s.touch_capable?i.changedTouches[0].screenX:e.screenX,y:s.touch_capable?i.changedTouches[0].screenY:e.screenY},offset:{x:s.touch_capable?i.changedTouches[0].pageX-i.changedTouches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?i.changedTouches[0].pageY-i.changedTouches[0].target.offsetTop:e.offsetY},time:(new Date).getTime(),target:e.target};n(t,"tapend",e,o);return true})},remove:function(){e(this).unbind(s.endevent,e(this).data.callee)}};e.event.special.taphold={setup:function(){var t=this,r=e(t),i,o,u={x:0,y:0};r.bind(s.startevent,function(e){if(e.which&&e.which!==1){return false}else{r.data("tapheld",false);i=e.target;var o=e.originalEvent;var a=(new Date).getTime(),f={x:s.touch_capable?o.touches[0].screenX:e.screenX,y:s.touch_capable?o.touches[0].screenY:e.screenY},l={x:s.touch_capable?o.touches[0].pageX-o.touches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?o.touches[0].pageY-o.touches[0].target.offsetTop:e.offsetY};u.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;u.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;s.hold_timer=window.setTimeout(function(){var c=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,h=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;if(e.target==i&&u.x==c&&u.y==h){r.data("tapheld",true);var p=(new Date).getTime(),d={x:s.touch_capable?o.touches[0].screenX:e.screenX,y:s.touch_capable?o.touches[0].screenY:e.screenY},v={x:s.touch_capable?o.touches[0].pageX-o.touches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?o.touches[0].pageY-o.touches[0].target.offsetTop:e.offsetY};duration=p-a;var m={startTime:a,endTime:p,startPosition:f,startOffset:l,endPosition:d,endOffset:v,duration:duration,target:e.target};r.data("callee1",arguments.callee);n(t,"taphold",e,m)}},s.taphold_threshold);return true}}).bind(s.endevent,function(){r.data("callee2",arguments.callee);r.data("tapheld",false);window.clearTimeout(s.hold_timer)})},remove:function(){e(this).unbind(s.startevent,e(this).data.callee1).unbind(s.endevent,e(this).data.callee2)}};e.event.special.doubletap={setup:function(){var t=this,r=e(t),i,o,u,a;r.bind(s.startevent,function(e){if(e.which&&e.which!==1){return false}else{r.data("doubletapped",false);i=e.target;r.data("callee1",arguments.callee);a=e.originalEvent;u={position:{x:s.touch_capable?a.touches[0].screenX:e.screenX,y:s.touch_capable?a.touches[0].screenY:e.screenY},offset:{x:s.touch_capable?a.touches[0].pageX-a.touches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?a.touches[0].pageY-a.touches[0].target.offsetTop:e.offsetY},time:(new Date).getTime(),target:e.target};return true}}).bind(s.endevent,function(e){var f=(new Date).getTime();var l=r.data("lastTouch")||f+1;var c=f-l;window.clearTimeout(o);r.data("callee2",arguments.callee);if(c<s.doubletap_int&&c>0&&e.target==i&&c>100){r.data("doubletapped",true);window.clearTimeout(s.tap_timer);var h={position:{x:s.touch_capable?a.touches[0].screenX:e.screenX,y:s.touch_capable?a.touches[0].screenY:e.screenY},offset:{x:s.touch_capable?a.touches[0].pageX-a.touches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?a.touches[0].pageY-a.touches[0].target.offsetTop:e.offsetY},time:(new Date).getTime(),target:e.target};var p={firstTap:u,secondTap:h,interval:h.time-u.time};n(t,"doubletap",e,p)}else{r.data("lastTouch",f);o=window.setTimeout(function(e){window.clearTimeout(o)},s.doubletap_int,[e])}r.data("lastTouch",f)})},remove:function(){e(this).unbind(s.startevent,e(this).data.callee1).unbind(s.endevent,e(this).data.callee2)}};e.event.special.singletap={setup:function(){var t=this,r=e(t),i=null,o=null,u={x:0,y:0};r.bind(s.startevent,function(e){if(e.which&&e.which!==1){return false}else{o=(new Date).getTime();i=e.target;r.data("callee1",arguments.callee);u.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;u.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;return true}}).bind(s.endevent,function(e){r.data("callee2",arguments.callee);if(e.target==i){end_pos_x=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageX:e.pageX;end_pos_y=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageY:e.pageY;s.tap_timer=window.setTimeout(function(){if(!r.data("doubletapped")&&!r.data("tapheld")&&u.x==end_pos_x&&u.y==end_pos_y){var i=e.originalEvent;var a={position:{x:s.touch_capable?i.changedTouches[0].screenX:e.screenX,y:s.touch_capable?i.changedTouches[0].screenY:e.screenY},offset:{x:s.touch_capable?i.changedTouches[0].pageX-i.changedTouches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?i.changedTouches[0].pageY-i.changedTouches[0].target.offsetTop:e.offsetY},time:(new Date).getTime(),target:e.target};if(a.time-o<s.taphold_threshold){n(t,"singletap",e,a)}}},s.doubletap_int)}})},remove:function(){e(this).unbind(s.startevent,e(this).data.callee1).unbind(s.endevent,e(this).data.callee2)}};e.event.special.tap={setup:function(){var t=this,r=e(t),i=false,o=null,u,a={x:0,y:0};r.bind(s.startevent,function(e){r.data("callee1",arguments.callee);if(e.which&&e.which!==1){return false}else{i=true;a.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;a.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;u=(new Date).getTime();o=e.target;return true}}).bind(s.endevent,function(e){r.data("callee2",arguments.callee);var f=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageX:e.pageX,l=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageY:e.pageY;if(o==e.target&&i&&(new Date).getTime()-u<s.taphold_threshold&&a.x==f&&a.y==l){var c=e.originalEvent;var h={position:{x:s.touch_capable?c.changedTouches[0].screenX:e.screenX,y:s.touch_capable?c.changedTouches[0].screenY:e.screenY},offset:{x:s.touch_capable?c.changedTouches[0].pageX-c.changedTouches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?c.changedTouches[0].pageY-c.changedTouches[0].target.offsetTop:e.offsetY},time:(new Date).getTime(),target:e.target};n(t,"tap",e,h)}})},remove:function(){e(this).unbind(s.startevent,e(this).data.callee1).unbind(s.endevent,e(this).data.callee2)}};e.event.special.swipe={setup:function(){function t(t){o=e(t.target);o.data("callee1",arguments.callee);f.x=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageX:t.pageX;f.y=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageY:t.pageY;l.x=f.x;l.y=f.y;u=true;var n=t.originalEvent;c={position:{x:s.touch_capable?n.touches[0].screenX:t.screenX,y:s.touch_capable?n.touches[0].screenY:t.screenY},offset:{x:s.touch_capable?n.touches[0].pageX-n.touches[0].target.offsetLeft:t.offsetX,y:s.touch_capable?n.touches[0].pageY-n.touches[0].target.offsetTop:t.offsetY},time:(new Date).getTime(),target:t.target};var r=new Date;while(new Date-r<100){}}function n(t){o=e(t.target);o.data("callee2",arguments.callee);l.x=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageX:t.pageX;l.y=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageY:t.pageY;window.clearTimeout(s.hold_timer);var n;var r=o.data("xthreshold"),i=o.data("ythreshold"),h=typeof r!=="undefined"&&r!==false&&parseInt(r)?parseInt(r):s.swipe_h_threshold,p=typeof i!=="undefined"&&i!==false&&parseInt(i)?parseInt(i):s.swipe_v_threshold;if(f.y>l.y&&f.y-l.y>p){n="swipeup"}if(f.x<l.x&&l.x-f.x>h){n="swiperight"}if(f.y<l.y&&l.y-f.y>p){n="swipedown"}if(f.x>l.x&&f.x-l.x>h){n="swipeleft"}if(n!=undefined&&u){f.x=0;f.y=0;l.x=0;l.y=0;u=false;var d=t.originalEvent;endEvnt={position:{x:s.touch_capable?d.touches[0].screenX:t.screenX,y:s.touch_capable?d.touches[0].screenY:t.screenY},offset:{x:s.touch_capable?d.touches[0].pageX-d.touches[0].target.offsetLeft:t.offsetX,y:s.touch_capable?d.touches[0].pageY-d.touches[0].target.offsetTop:t.offsetY},time:(new Date).getTime(),target:t.target};var v=Math.abs(c.position.x-endEvnt.position.x),m=Math.abs(c.position.y-endEvnt.position.y);var g={startEvnt:c,endEvnt:endEvnt,direction:n.replace("swipe",""),xAmount:v,yAmount:m,duration:endEvnt.time-c.time};a=true;o.trigger("swipe",g).trigger(n,g)}}function r(t){o=e(t.target);var n="";o.data("callee3",arguments.callee);if(a){var r=o.data("xthreshold"),i=o.data("ythreshold"),f=typeof r!=="undefined"&&r!==false&&parseInt(r)?parseInt(r):s.swipe_h_threshold,l=typeof i!=="undefined"&&i!==false&&parseInt(i)?parseInt(i):s.swipe_v_threshold;var h=t.originalEvent;endEvnt={position:{x:s.touch_capable?h.changedTouches[0].screenX:t.screenX,y:s.touch_capable?h.changedTouches[0].screenY:t.screenY},offset:{x:s.touch_capable?h.changedTouches[0].pageX-h.changedTouches[0].target.offsetLeft:t.offsetX,y:s.touch_capable?h.changedTouches[0].pageY-h.changedTouches[0].target.offsetTop:t.offsetY},time:(new Date).getTime(),target:t.target};if(c.position.y>endEvnt.position.y&&c.position.y-endEvnt.position.y>l){n="swipeup"}if(c.position.x<endEvnt.position.x&&endEvnt.position.x-c.position.x>f){n="swiperight"}if(c.position.y<endEvnt.position.y&&endEvnt.position.y-c.position.y>l){n="swipedown"}if(c.position.x>endEvnt.position.x&&c.position.x-endEvnt.position.x>f){n="swipeleft"}var p=Math.abs(c.position.x-endEvnt.position.x),d=Math.abs(c.position.y-endEvnt.position.y);var v={startEvnt:c,endEvnt:endEvnt,direction:n.replace("swipe",""),xAmount:p,yAmount:d,duration:endEvnt.time-c.time};o.trigger("swipeend",v)}u=false;a=false}var i=this,o=e(i),u=false,a=false,f={x:0,y:0},l={x:0,y:0},c;o.bind(s.startevent,t);o.bind(s.moveevent,n);o.bind(s.endevent,r)},remove:function(){e(this).unbind(s.startevent,e(this).data.callee1).unbind(s.moveevent,e(this).data.callee2).unbind(s.endevent,e(this).data.callee3)}};e.event.special.scrollstart={setup:function(){function t(e,t){o=t;n(r,o?"scrollstart":"scrollend",e)}var r=this,i=e(r),o,u;i.bind(s.scrollevent,function(e){i.data("callee",arguments.callee);if(!o){t(e,true)}clearTimeout(u);u=setTimeout(function(){t(e,false)},50)})},remove:function(){e(this).unbind(s.scrollevent,e(this).data.callee)}};var o=e(window),u,a,f,l,c,h={0:true,180:true};if(s.orientation_support){var p=window.innerWidth||e(window).width(),d=window.innerHeight||e(window).height(),v=50;l=p>d&&p-d>v;c=h[window.orientation];if(l&&c||!l&&!c){h={"-90":true,90:true}}}e.event.special.orientationchange=u={setup:function(){if(s.orientation_support){return false}f=a();o.bind("throttledresize",t);return true},teardown:function(){if(s.orientation_support){return false}o.unbind("throttledresize",t);return true},add:function(e){var t=e.handler;e.handler=function(e){e.orientation=a();return t.apply(this,arguments)}}};e.event.special.orientationchange.orientation=a=function(){var e=true,t=document.documentElement;if(s.orientation_support){e=h[window.orientation]}else{e=t&&t.clientWidth/t.clientHeight<1.1}return e?"portrait":"landscape"};e.event.special.throttledresize={setup:function(){e(this).bind("resize",g)},teardown:function(){e(this).unbind("resize",g)}};var m=250,g=function(){w=(new Date).getTime();E=w-y;if(E>=m){y=w;e(this).trigger("throttledresize")}else{if(b){window.clearTimeout(b)}b=window.setTimeout(t,m-E)}},y=0,b,w,E;e.each({scrollend:"scrollstart",swipeup:"swipe",swiperight:"swipe",swipedown:"swipe",swipeleft:"swipe",swipeend:"swipe"},function(t,n,r){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)}}})})(e)}function $RFunctions($R){function loadCSS(e){$R.each(e,function(e,t){$R("<link>").attr({href:t,rel:"stylesheet"}).appendTo("body")})}function initCommonUtils(e){e.extend(RDR,{commonUtil:{prettyNumber:function(e){var t=parseInt(e,10);if(isNaN(t)||t<0)return false;var n=["","K","M","B","T"];for(var r=0;r<n.length;r++){var i=Math.pow(10,3*r);var s=Math.pow(10,3*(r+1));if(t<s){return""+Math.floor(t/i)+n[r]}}}}})}function initPlugins($R){function plugin_jquery_log(e){var t=e;e.clog=function(){if(window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,arguments)}};e.fn.clog=function(){var t=arguments||this;e.clog(t);return this};if(typeof clog==="undefined"){clog=function(){e.clog(arguments)}}if(typeof t!=="undefined"){t.clog=e.clog;t.fn.clog=e.fn.clog}}function plugin_jquery_hasAttr(e){e.fn.hasAttr=function(e){return this.attr(e)!==undefined}}function plugin_jquery_json($){$.toJSON=function(e){var t=typeof e;if(e===null)return"null";if(t=="undefined")return undefined;if(t=="number"||t=="boolean")return e+"";if(t=="string")return $.quoteString(e);if(t=="object"){if(e.constructor===Date){var n=e.getUTCMonth()+1;if(n<10)n="0"+n;var r=e.getUTCDate();if(r<10)r="0"+r;var i=e.getUTCFullYear();var s=e.getUTCHours();if(s<10)s="0"+s;var o=e.getUTCMinutes();if(o<10)o="0"+o;var u=e.getUTCSeconds();if(u<10)u="0"+u;var a=e.getUTCMilliseconds();if(a<100)a="0"+a;if(a<10)a="0"+a;return'"'+i+"-"+n+"-"+r+"T"+s+":"+o+":"+u+"."+a+'Z"'}if(e.constructor===Array){var f=[];for(var l=0;l<e.length;l++)f.push($.toJSON(e[l])||"null");return"["+f.join(",")+"]"}var c=[];for(var h in e){var p;var t=typeof h;if(t=="number")p='"'+h+'"';else if(t=="string")p=$.quoteString(h);else continue;if(typeof e[h]=="function")continue;var d=$.toJSON(e[h]);if(typeof d!="undefined")c.push(p+":"+d)}return"{"+c.join(", ")+"}"}};$.evalJSON=function(src){return eval("("+src+")")};$.secureEvalJSON=function(src){var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@");filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");else throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(e){if(e.match(_escapeable)){return'"'+e.replace(_escapeable,function(e){var t=_meta[e];if(typeof t==="string")return t;t=e.charCodeAt();return"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)})+'"'}return'"'+e+'"'};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var _meta={"\b":"\\b","  ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}}function plugin_jquery_cookie(e){e.cookie=function(t,n,r){if(arguments.length>1&&String(n)!=="[object Object]"){r=e.extend({},r);if(n===null||n===undefined){r.expires=-1}if(typeof r.expires==="number"){var i=r.expires,s=r.expires=new Date;s.setDate(s.getDate()+i)}n=String(n);return document.cookie=[encodeURIComponent(t),"=",r.raw?n:encodeURIComponent(n),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}r=n||{};var o,u=r.raw?function(e){return e}:decodeURIComponent;return(o=(new RegExp("(?:^|; )"+encodeURIComponent(t)+"=([^;]*)")).exec(document.cookie))?u(o[1]):null}}function plugin_jquery_postMessage(e){var t,n,r=1,i,s=this,o=!1,u="postMessage",a="addEventListener",f,l=s[u]&&!e.browser.opera;e[u]=function(t,n,i){if(!n){return}t=typeof t==="string"?t:e.param(t);i=i||parent;if(l){i[u](t,n.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(n){i.location=n.replace(/#.*$/,"")+"#"+ +(new Date)+r++ +"&"+t}}};e.receiveMessage=f=function(r,u,h){if(l){if(r){i&&f();i=function(t){if(typeof u==="string"&&t.origin!==u||e.isFunction(u)&&u(t.origin)===o){return o}r(t)}}if(s[a]){s[r?a:"removeEventListener"]("message",i,o)}else{s[r?"attachEvent":"detachEvent"]("onmessage",i)}}else{t&&clearInterval(t);t=null;if(r){h=typeof u==="number"?u:typeof h==="number"?h:100;t=setInterval(function(){var e=document.location.hash,t=/^#?\d+&/;if(e!==n&&t.test(e)){n=e;r({data:e.replace(t,"")})}},h)}}}}function plugin_jquery_drags(e){$.fn.drags=function(e){e=$.extend({handle:""},e);var t=$(this);var n=t;n.on("mousedown",function(n){if(e.handle!==""&&!$(n.target).closest(".rdr_header").length){return}t.removeClass("rdr_rewritable");var r=t.outerHeight(),i=t.outerWidth(),s=t.offset(),o=s.top+r-n.pageY,u=s.left+i-n.pageX;$(document).on("mousemove.rdr_drag",function(e){t.offset({top:e.pageY+o-r,left:e.pageX+u-i})}).on("mouseup",function(){$(this).off("mousemove.rdr_drag")});n.preventDefault()});return this}}function plugin_jquery_enhancedOffset(e){var t=e.fn.offset;e.fn.offset=function(){var n=t.call(this),r=n?n.top+this.outerHeight():0,i=n?n.left+this.outerWidth():0,s=arguments;return s.length?this.animate({top:s[0].top||s[0],left:s[0].left||s[1]},(s[0].top?s[1]:s[2])||1):e.extend(n,{bottom:r,right:i})}}function plugin_jquery_rdrWidgetSummary(e){function r(t){var n=t;var r="rdr-summary-key-"+n.key;e("."+r).remove();var s=e(n.parentContainer),o=e('<div class="rdr rdr-summary rdr-summary-'+n.id+' rdr-border-box" rdr-page-id="'+n.id+'"></div>').addClass(r);if(RDR.engageScriptParams.bookmarklet=="true"){o.addClass("rdr_bookmarklet")}o.data({page_id:n.id,page_key:n.key});var u=RDR.group.summary_widget_method!=""?RDR.group.summary_widget_method:"after";s[u](o);var a=s.hasClass("defaultSummaryBar")?"top":"top";o.find("img.rdr_tooltip_this").tooltip({placement:a});o.append('<div class="rdr_chevron_cta"><i class="rdr_icon-chevron-down"></i></div>'+'<a href="'+RDR_baseUrl+'" target="_blank" class="rdr_logo">'+'<span class="no-rdr rdr-logo" title="This is <strong style=\'color:#4d92da;\'>ReadrBoard</strong>. Click to visit our site and learn more!" src="'+RDR_staticUrl+'widget/images/blank.png" ></span>'+"</a>");o.find(".rdr-logo").click(function(){});o.find(".rdr-logo").tooltip({});var f=function(){i();var t=e(this).data("page_id");var r=RDR.rindow.make("readMode",{is_page:true,page:n,tags:n.toptags});RDR.events.trackEventToCloud({event_type:"summary bar",event_value:"show",page_id:t})};if(isTouchBrowser){o.bind("tap",function(){f.call(this);e(this).toggleClass("rdr_hover")})}else{o.hover(f,function(){})}var l;if(t.summary){e.each(t.summary,function(){if(this.kind=="tag"){l=this.count}})}var c=0;if(l){c=l}else{e.each(n.toptags,function(e,t){c+=t.tag_count})}var h=c>1?c+" Reactions":c>0?c+" Reaction":"Reactions";o.append('<a class="rdr_reactions_label">'+h+"</a>")}function i(t){if(typeof RDR.interaction_data=="undefined"){RDR.interaction_data={}}e.each(RDR.summaries,function(t,n){e.each(n.top_interactions.tags,function(e,n){if(typeof n!="undefined"){if(typeof RDR.summaries[t].content_nodes!="undefined"){RDR.util.buildInteractionData()}else{RDR.actions.content_nodes.init(t,function(){RDR.util.buildInteractionData()})}}})})}e.fn.rdrWidgetSummary=function(t){if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist.")}};var t={};var n={init:function(n){var i=this[0]===document?e(".rdr-summary"):this,s;return i.each(function(){s=n?e.extend({},t,n):t;s.parentContainer=this;e(this).data("settings",s);r(s)})},update:function(){var t=this[0]===document?e(".rdr-summary"):this;return t.each(function(t){var n=e(this).data("settings");n.summary=RDR.pages[n.id].summary;r(n)})}}}function plugin_jquery_selectionographer(e,t){function f(){return t.getSelection()}function l(n){var r=this,i=o,s,u,a=n||{},l={styleName:"rdr_hilite",container:document,serialRange:null,range:null},c={idx:i.length,timestamp:e.now(),interactionID:null,hiliter:null,revisionParent:null,text:""},p=e.extend({},l,a,c);if(!p.range&&!p.serialRange){var d=f();if(d.isCollapsed)return false;s=d.getRangeAt(0);try{u=t.serializeRange(s,true,p.container)}catch(v){u=false}}else if(p.range){s=p.range;try{u=t.serializeRange(s,true,p.container)}catch(m){u=false}}else if(p.serialRange){u=p.serialRange;s=t.deserializeRange(u,p.container)}else{}p.serialRange=u;p.range=s.cloneRange();p.text=p.range.toString();if(p.text.length===0)return false;p.hiliter=h(p);return p}function c(e){if(e===false)return false;if(typeof e==="object")return e;var t=o,n=typeof e=="string"||typeof e=="number"?e:t.length-1,r=t[n];if(r)return r;return false}function h(n){if(n.hiliter){return n.hiliter}var r=n.range,i=n.styleName,s;var o=i+"_"+n.idx;s=t.createCssClassApplier(o,true);s["class"]=o;s["get$start"]=function(){return e(r.startContainer).closest("."+s["class"])};s["get$end"]=function(){return e(r.endContainer).closest("."+s["class"])};s["isActive"]=function(){var e=false;try{e=s["isAppliedToRange"](r)}catch(t){e=null}return e};return s}function p(t,n){var i=t.range,s=t.styleName,o=t.hiliter,u=o["isActive"]();if(u==null){return}if(!u&&(n==="on"||n==="toggle")){o.applyToRange(i);e("."+o["class"]).addClass(s);o["get$start"]().addClass(s+"_start");o["get$end"]().addClass(s+"_end");r.clear()}else if(u&&(n==="off"||n==="toggle")){o["get$start"]().removeClass(s+"_start");o["get$end"]().removeClass(s+"_end");e("."+o["class"]).removeClass(s);if(o.isAppliedToRange(i)){o.undoToRange(i)}else{}}return t}function d(t,n){var r={start:true,offset:undefined,relOffset:undefined},i=e.extend({},r,n),s=i.start?t.startOffset:t.endOffset;if(typeof i.offset==="undefined"){if(typeof i.relOffset==="undefined"){return s}i.offset=s+i.relOffset}try{if(i.start){t.setStart(t.startContainer,i.offset)}else{t.setEnd(t.endContainer,i.offset)}return t}catch(o){return false}}function v(t,n){var r=this,i=u,s={};if(typeof n==="undefined"||n===null){e.each(i,function(e,t){s[e]=[]})}else if(typeof n==="string"){s[n]=[]}else{e.each(n,function(e,t){if(typeof t==="string"){s[t]=[]}else{var n=t[0];var r=t.length>1?t.slice(1):[];s[n]=r}})}e.each(s,function(e,n){var r=i[e]||function(){};t=r(t,n)});return t}e.fn.selectionographer=function(t){if(r[t]){return r[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist.")}};e.fn.selog=e.fn.selectionographer;var n={};var r={init:function(t){var r=this;t=t||{};return r.each(function(){i=e.extend(n,t)})},save:function(e){var t=this,n=o,r=e||{},i;r.container=r.container||t[0]||document;i=l(r);if(!i)return false;n[i.idx]=i;return i},selectEl:function(e){var n=t.createRange();n.selectNodeContents(e);var r=t.getSelection();r.setSingleRange(n)},activate:function(e){var t=c(e);if(!t)return false;r.clear();f().setSingleRange(t.range);return t},clear:function(){f().removeAllRanges()},modify:function(e,t){if(e instanceof Array){t=e;e=undefined}var n=c(e),i,s,o;if(!n)return false;s=n.range.cloneRange();s=v(s,t);i={range:s,container:n.container};o=r.save(i);return o},hilite:function(e,t){var n=t;if(typeof e==="string"&&isNaN(e)){n=e;e=undefined}n=n||"on";var r=c(e);if(!r){return false}if(typeof r.serialRange!=="undefined"&&r.serialRange===false){return false}p(r,n);return r},helpers:function(e){var t=s[e];return t?t.apply(this,Array.prototype.slice.call(arguments,1)):false},find:function(t){var n=[],r=this,i;if(!t)return false;RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};t=RegExp.escape(t);i=new RegExp(t,"gim");return r.each(function(){var t=e(this).text(),n=0,r=0,s=[];while((n=i.exec(t))&&r<5){s.push(n.index);r++}return s})},stack:function(){return o},data:function(e){return a[e]}};var i={},s={smartHilite:function(){return r.hilite(r.modify(r.save.apply(this)))},activateRange:function(e){var t={};if(!e)return false;if(typeof e==="string"){t.serialRange=e}else{t.range=e}return r.activate(r.save(t))}},o=[],u={filterOutRDRIndicator:function(t,n){var r=t.commonAncestorContainer;var i=e(r).find(".rdr_indicator");if(i.length){var s=t.containsNode(i[0],true);if(s){t.setEndBefore(i[0])}}return t},stripWhiteSpace:function(e){var t=e.toString(),n={},r={};n.textnode=e.startContainer;n.offset=e.startOffset;n.regx=/^\s+/;n.result=n.regx.exec(t);r.textnode=e.endContainer;r.offset=e.endOffset;r.regx=/\s+$/;r.result=r.regx.exec(t);if(n.result){n.resultStrLen=n.result[0].length;d(e,{relOffset:n.resultStrLen})}if(r.result){r.resultStrLen=r.result[0].length;d(e,{relOffset:-r.resultStrLen,start:false})}return e},firstWordSnap:function(e){var n=e.startContainer,r=e.startOffset,i;if(r===0)return e;var s={range:t.createRange()};s.range.setStart(n,0);s.range.setEnd(n,r);s.str0=s.range.toString();s.regx1=/\s*\S+$/;s.result1=s.regx1.exec(s.str0);if(s.result1===null)return e;s.str1=s.result1[0];s.str2=s.str1.replace(/\s*/,"");s.extraWordChars=s.str2.length;d(e,{relOffset:-s.extraWordChars});return e},lastWordSnap:function(e){var n=e.endContainer,r=e.endOffset,i;if(r===0)return e;var s={range:t.createRange()};s.range.setStart(n,r);s.range.setEnd(n,n.length);s.str0=s.range.toString();s.regx1=/^\S+(?=(\s|$))/;s.result1=s.regx1.exec(s.str0);if(s.result1===null)return e;s.str1=s.result1[0];s.extraWordChars=s.str1.length;d(e,{relOffset:s.extraWordChars,start:false});return e}},a={stack:o};e(document).selog()}function plugin_jquery_mustache(e){var t=e;var n=undefined;(function(e){(function(e,t){"object"==typeof exports&&exports?module.exports=t:"function"==typeof n&&n.amd?n(t):e.Mustache=t})(this,function(){function e(e,t){return y.call(e,t)}function t(t){return!e(d,t)}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e){return(e+"").replace(/[&<>"'\/]/g,function(e){return E[e]})}function i(e){this.string=e,this.tail=e,this.pos=0}function s(e,t){this.view=e,this.parent=t,this._cache={}}function o(){this.clearCache()}function u(e,t,n,r){for(var i,s,o,a="",f=0,l=e.length;l>f;++f)switch(i=e[f],s=i[1],i[0]){case"#":if(o=n.lookup(s),"object"==typeof o)if(w(o))for(var h=0,p=o.length;p>h;++h)a+=u(i[4],t,n.push(o[h]),r);else o&&(a+=u(i[4],t,n.push(o),r));else if("function"==typeof o){var d=null==r?null:r.slice(i[3],i[5]);o=o.call(n.view,d,function(e){return t.render(e,n)}),null!=o&&(a+=o)}else o&&(a+=u(i[4],t,n,r));break;case"^":o=n.lookup(s),(!o||w(o)&&0===o.length)&&(a+=u(i[4],t,n,r));break;case">":o=t.getPartial(s),"function"==typeof o&&(a+=o(n));break;case"&":o=n.lookup(s),null!=o&&(a+=o);break;case"name":o=n.lookup(s),null!=o&&(a+=c.escape(o));break;case"text":a+=s}return a}function a(e){for(var t,n=[],r=n,i=[],s=0,o=e.length;o>s;++s)switch(t=e[s],t[0]){case"#":case"^":i.push(t),r.push(t),r=t[4]=[];break;case"/":var u=i.pop();u[5]=t[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(t)}return n}function f(e){for(var t,n,r=[],i=0,s=e.length;s>i;++i)t=e[i],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(n=t,r.push(t)));return r}function l(e){return[RegExp(n(e[0])+"\\s*"),RegExp("\\s*"+n(e[1]))]}var c={};c.name="mustache.js",c.version="0.7.2",c.tags=["{{","}}"],c.Scanner=i,c.Context=s,c.Writer=o;var h=/\s*/,p=/\s+/,d=/\S/,v=/\s*=/,m=/\s*\}/,g=/#|\^|\/|>|\{|&|=|!/,y=RegExp.prototype.test,b=Object.prototype.toString,w=Array.isArray||function(e){return"[object Array]"===b.call(e)},E={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};c.escape=r,i.prototype.eos=function(){return""===this.tail},i.prototype.scan=function(e){var t=this.tail.match(e);return t&&0===t.index?(this.tail=this.tail.substring(t[0].length),this.pos+=t[0].length,t[0]):""},i.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return t},s.make=function(e){return e instanceof s?e:new s(e)},s.prototype.push=function(e){return new s(e,this)},s.prototype.lookup=function(e){var t=this._cache[e];if(!t){if("."==e)t=this.view;else for(var n=this;n;){if(e.indexOf(".")>0){t=n.view;for(var r=e.split("."),i=0;t&&r.length>i;)t=t[r[i++]]}else t=n.view[e];if(null!=t)break;n=n.parent}this._cache[e]=t}return"function"==typeof t&&(t=t.call(this.view)),t},o.prototype.clearCache=function(){this._cache={},this._partialCache={}},o.prototype.compile=function(e,t){var n=this._cache[e];if(!n){var r=c.parse(e,t);n=this._cache[e]=this.compileTokens(r,e)}return n},o.prototype.compilePartial=function(e,t,n){var r=this.compile(t,n);return this._partialCache[e]=r,r},o.prototype.getPartial=function(e){return e in this._partialCache||!this._loadPartial||this.compilePartial(e,this._loadPartial(e)),this._partialCache[e]},o.prototype.compileTokens=function(e,t){var n=this;return function(r,i){if(i)if("function"==typeof i)n._loadPartial=i;else for(var o in i)n.compilePartial(o,i[o]);return u(e,n,s.make(r),t)}},o.prototype.render=function(e,t,n){return this.compile(e)(t,n)},c.parse=function(e,r){function s(){if(N&&!C)for(;T.length;)delete x[T.pop()];else T=[];N=!1,C=!1}if(e=e||"",r=r||c.tags,"string"==typeof r&&(r=r.split(p)),2!==r.length)throw Error("Invalid tags: "+r.join(", "));for(var o,u,d,y,b,w=l(r),E=new i(e),S=[],x=[],T=[],N=!1,C=!1;!E.eos();){if(o=E.pos,d=E.scanUntil(w[0]))for(var L=0,A=d.length;A>L;++L)y=d.charAt(L),t(y)?T.push(x.length):C=!0,x.push(["text",y,o,o+1]),o+=1,"\n"==y&&s();if(!E.scan(w[0]))break;if(N=!0,u=E.scan(g)||"name",E.scan(h),"="===u?(d=E.scanUntil(v),E.scan(v),E.scanUntil(w[1])):"{"===u?(d=E.scanUntil(RegExp("\\s*"+n("}"+r[1]))),E.scan(m),E.scanUntil(w[1]),u="&"):d=E.scanUntil(w[1]),!E.scan(w[1]))throw Error("Unclosed tag at "+E.pos);if(b=[u,d,o,E.pos],x.push(b),"#"===u||"^"===u)S.push(b);else if("/"===u){if(0===S.length)throw Error('Unopened section "'+d+'" at '+o);var O=S.pop();if(O[1]!==d)throw Error('Unclosed section "'+O[1]+'" at '+o)}else if("name"===u||"{"===u||"&"===u)C=!0;else if("="===u){if(r=d.split(p),2!==r.length)throw Error("Invalid tags at "+o+": "+r.join(", "));w=l(r)}}var O=S.pop();if(O)throw Error('Unclosed section "'+O[1]+'" at '+E.pos);return x=f(x),a(x)};var S=new o;return c.clearCache=function(){return S.clearCache()},c.compile=function(e,t){return S.compile(e,t)},c.compilePartial=function(e,t,n){return S.compilePartial(e,t,n)},c.compileTokens=function(e,t){return S.compileTokens(e,t)},c.render=function(e,t,n){return S.render(e,t,n)},c.to_html=function(e,t,n,r){var i=c.render(e,t,n);return"function"!=typeof r?i:(r(i),void 0)},c}()),e.mustache=function(e,t,n){return Mustache.render(e,t,n)},e.fn.mustache=function(t,n){return e(this).map(function(r,i){var s=e.trim(e(i).html()),o=e.mustache(s,t,n);return e(o).get()})}})(e)}function plugin_jquery_improvedCSS(e){e.fn.css2=e.fn.css;e.fn.css=function(){if(arguments.length)return e.fn.css2.apply(this,arguments);var t=["font-family","font-size","font-weight","font-style","color","text-transform","text-decoration","letter-spacing","word-spacing","lineHeight","text-align","vertical-align","direction","background-color","background-image","background-repeat","background-position","background-attachment","opacity","width","height","top","right","bottom","left","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","position","display","visibility","z-index","overflow-x","overflow-y","white-space","clip","float","clear","cursor","list-style-image","list-style-position","list-style-type","marker-offset"];var n=t.length,r={},i;for(var s=0;s<n;s++){i=t[s];r[i]=e.fn.css2.call(this,i);if(i=="lineHeight"){r[i]=e.fn.css2.call(this,"auto")}i=typeof i==="undefined"?"auto":i}return r}}function plugin_jquery_mousewheel(e){function r(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=true,o=0,u=0;t=e.event.fix(n);t.type="mousewheel";if(n.wheelDelta){i=n.wheelDelta/120}if(n.detail){i=-n.detail/3}u=i;if(n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS){u=0;o=-1*i}if(n.wheelDeltaY!==undefined){u=n.wheelDeltaY/120}if(n.wheelDeltaX!==undefined){o=-1*n.wheelDeltaX/120}r.unshift(t,i,o,u);return(e.event.dispatch||e.event.handle).apply(this,r)}var t=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks){for(var n=t.length;n;){e.event.fixHooks[t[--n]]=e.event.mouseHooks}}e.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var e=t.length;e;){this.addEventListener(t[--e],r,false)}}else{this.onmousewheel=r}},teardown:function(){if(this.removeEventListener){for(var e=t.length;e;){this.removeEventListener(t[--e],r,false)}}else{this.onmousewheel=null}}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}function plugin_jquery_isotope(e){!function(e,t){"use strict";var n,r=e.document,i=r.documentElement,s=e.Modernizr,o=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},u="Moz Webkit O Ms".split(" "),a=function(e){var t,n=i.style;if("string"==typeof n[e])return e;e=o(e);for(var r=0,s=u.length;s>r;r++)if(t=u[r]+e,"string"==typeof n[t])return t},f=a("transform"),l=a("transitionProperty"),c={csstransforms:function(){return!!f},csstransforms3d:function(){var e=!!a("perspective");if(e&&"webkitPerspective"in i.style){var n=t("<style>@media (transform-3d),(-webkit-transform-3d){#modernizr{height:3px}}</style>").appendTo("head"),r=t('<div id="modernizr" />').appendTo("html");e=3===r.height(),r.remove(),n.remove()}return e},csstransitions:function(){return!!l}};if(s)for(n in c)s.hasOwnProperty(n)||s.addTest&&s.addTest(n,c[n]);else{s=e.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var h,p=" ";for(n in c)h=c[n](),s[n]=h,p+=" "+(h?"":"no-")+n;t("html").addClass(p)}if(s.csstransforms){var d=s.csstransforms3d?{translate:function(e){return"translate3d("+e[0]+"px, "+e[1]+"px, 0) "},scale:function(e){return"scale3d("+e+", "+e+", 1) "}}:{translate:function(e){return"translate("+e[0]+"px, "+e[1]+"px) "},scale:function(e){return"scale("+e+") "}},v=function(e,n,r){var i,s,o=t.data(e,"isoTransform")||{},u={},a={};u[n]=r,t.extend(o,u);for(i in o)s=o[i],a[i]=d[i](s);var l=a.translate||"",c=a.scale||"",h=l+c;t.data(e,"isoTransform",o),e.style[f]=h};t.cssNumber.scale=!0,t.cssHooks.scale={set:function(e,t){v(e,"scale",t)},get:function(e){var n=t.data(e,"isoTransform");return n&&n.scale?n.scale:1}},t.fx.step.scale=function(e){t.cssHooks.scale.set(e.elem,e.now+e.unit)},t.cssNumber.translate=!0,t.cssHooks.translate={set:function(e,t){v(e,"translate",t)},get:function(e){var n=t.data(e,"isoTransform");return n&&n.translate?n.translate:[0,0]}}}var m,g;s.csstransitions&&(m={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[l],g=a("transitionDuration"));var y,b=t.event,w=t.event.handle?"handle":"dispatch";b.special.smartresize={setup:function(){t(this).bind("resize",b.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",b.special.smartresize.handler)},handler:function(e,t){var n=this,r=arguments;e.type="smartresize",y&&clearTimeout(y),y=setTimeout(function(){b[w].apply(n,r)},"execAsap"===t?0:100)}},t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])},t.Isotope=function(e,n,r){this.element=t(n),this._create(e),this._init(r)};var E=["width","height"],S=t(e);t.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!0,itemPositionDataEnabled:!1},t.Isotope.prototype={_create:function(e){this.options=t.extend({},t.Isotope.settings,e),this.styleQueue=[],this.elemCount=0;var n=this.element[0].style;this.originalStyle={};var r=E.slice(0);for(var i in this.options.containerStyle)r.push(i);for(var s=0,o=r.length;o>s;s++)i=r[s],this.originalStyle[i]=n[i]||"";this.element.css(this.options.containerStyle),this._updateAnimationEngine(),this._updateUsingTransforms();var u={"original-order":function(e,t){return t.elemCount++,t.elemCount},random:function(){return Math.random()}};this.options.getSortData=t.extend(this.options.getSortData,u),this.reloadItems(),this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var a=this;setTimeout(function(){a.element.addClass(a.options.containerClass)},0),this.options.resizable&&S.bind("smartresize.isotope",function(){a.resize()}),this.element.delegate("."+this.options.hiddenClass,"click",function(){return!1})},_getAtoms:function(e){var t=this.options.itemSelector,n=t?e.filter(t).add(e.find(t)):e,r={position:"absolute"};return n=n.filter(function(e,t){return 1===t.nodeType}),this.usingTransforms&&(r.left=0,r.top=0),n.css(r).addClass(this.options.itemClass),this.updateSortData(n,!0),n},_init:function(e){this.$filteredAtoms=this._filter(this.$allAtoms),this._sort(),this.reLayout(e)},option:function(e){if(t.isPlainObject(e)){this.options=t.extend(!0,this.options,e);var n;for(var r in e)n="_update"+o(r),this[n]&&this[n]()}},_updateAnimationEngine:function(){var e,t=this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"");switch(t){case"css":case"none":e=!1;break;case"jquery":e=!0;break;default:e=!s.csstransitions}this.isUsingJQueryAnimation=e,this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var e=this.usingTransforms=this.options.transformsEnabled&&s.csstransforms&&s.csstransitions&&!this.isUsingJQueryAnimation;e||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale),this.getPositionStyles=e?this._translate:this._positionAbs},_filter:function(e){var t=""===this.options.filter?"*":this.options.filter;if(!t)return e;var n=this.options.hiddenClass,r="."+n,i=e.filter(r),s=i;if("*"!==t){s=i.filter(t);var o=e.not(r).not(t).addClass(n);this.styleQueue.push({$el:o,style:this.options.hiddenStyle})}return this.styleQueue.push({$el:s,style:this.options.visibleStyle}),s.removeClass(n),e.filter(t)},updateSortData:function(e,n){var r,i,s=this,o=this.options.getSortData;e.each(function(){r=t(this),i={};for(var e in o)i[e]=n||"original-order"!==e?o[e](r,s):t.data(this,"isotope-sort-data")[e];t.data(this,"isotope-sort-data",i)})},_sort:function(){var e=this.options.sortBy,t=this._getSorter,n=this.options.sortAscending?1:-1,r=function(r,i){var s=t(r,e),o=t(i,e);return s===o&&"original-order"!==e&&(s=t(r,"original-order"),o=t(i,"original-order")),(s>o?1:o>s?-1:0)*n};this.$filteredAtoms.sort(r)},_getSorter:function(e,n){return t.data(e,"isotope-sort-data")[n]},_translate:function(e,t){return{translate:[e,t]}},_positionAbs:function(e,t){return{left:e,top:t}},_pushPosition:function(e,t,n){t=Math.round(t+this.offset.left),n=Math.round(n+this.offset.top);var r=this.getPositionStyles(t,n);this.styleQueue.push({$el:e,style:r}),this.options.itemPositionDataEnabled&&e.data("isotope-item-position",{x:t,y:n})},layout:function(e,t){var n=this.options.layoutMode;if(this["_"+n+"Layout"](e),this.options.resizesContainer){var r=this["_"+n+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:r})}this._processStyleQueue(e,t),this.isLaidOut=!0},_processStyleQueue:function(e,n){var r,i,o,u,a=this.isLaidOut?this.isUsingJQueryAnimation?"animate":"css":"css",f=this.options.animationOptions,l=this.options.onLayout;if(i=function(e,t){t.$el[a](t.style,f)},this._isInserting&&this.isUsingJQueryAnimation)i=function(e,t){r=t.$el.hasClass("no-transition")?"css":a,t.$el[r](t.style,f)};else if(n||l||f.complete){var c=!1,h=[n,l,f.complete],p=this;if(o=!0,u=function(){if(!c){for(var t,n=0,r=h.length;r>n;n++)t=h[n],"function"==typeof t&&t.call(p.element,e,p);c=!0}},this.isUsingJQueryAnimation&&"animate"===a)f.complete=u,o=!1;else if(s.csstransitions){for(var d,v=0,y=this.styleQueue[0],b=y&&y.$el;!b||!b.length;){if(d=this.styleQueue[v++],!d)return;b=d.$el}var w=parseFloat(getComputedStyle(b[0])[g]);w>0&&(i=function(e,t){t.$el[a](t.style,f).one(m,u)},o=!1)}}t.each(this.styleQueue,i),o&&u(),this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(e){this["_"+this.options.layoutMode+"Reset"](),this.layout(this.$filteredAtoms,e)},addItems:function(e,t){var n=this._getAtoms(e);this.$allAtoms=this.$allAtoms.add(n),t&&t(n)},insert:function(e,t){this.element.append(e);var n=this;this.addItems(e,function(e){var r=n._filter(e);n._addHideAppended(r),n._sort(),n.reLayout(),n._revealAppended(r,t)})},appended:function(e,t){var n=this;this.addItems(e,function(e){n._addHideAppended(e),n.layout(e),n._revealAppended(e,t)})},_addHideAppended:function(e){this.$filteredAtoms=this.$filteredAtoms.add(e),e.addClass("no-transition"),this._isInserting=!0,this.styleQueue.push({$el:e,style:this.options.hiddenStyle})},_revealAppended:function(e,t){var n=this;setTimeout(function(){e.removeClass("no-transition"),n.styleQueue.push({$el:e,style:n.options.visibleStyle}),n._isInserting=!1,n._processStyleQueue(e,t)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(e,t){this.$allAtoms=this.$allAtoms.not(e),this.$filteredAtoms=this.$filteredAtoms.not(e);var n=this,r=function(){e.remove(),t&&t.call(n.element)};e.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:e,style:this.options.hiddenStyle}),this._sort(),this.reLayout(r)):r()},shuffle:function(e){this.updateSortData(this.$allAtoms),this.options.sortBy="random",this._sort(),this.reLayout(e)},destroy:function(){var e=this.usingTransforms,t=this.options;this.$allAtoms.removeClass(t.hiddenClass+" "+t.itemClass).each(function(){var t=this.style;t.position="",t.top="",t.left="",t.opacity="",e&&(t[f]="")});var n=this.element[0].style;for(var r in this.originalStyle)n[r]=this.originalStyle[r];this.element.unbind(".isotope").undelegate("."+t.hiddenClass,"click").removeClass(t.containerClass).removeData("isotope"),S.unbind(".isotope")},_getSegments:function(e){var t,n=this.options.layoutMode,r=e?"rowHeight":"columnWidth",i=e?"height":"width",s=e?"rows":"cols",u=this.element[i](),a=this.options[n]&&this.options[n][r]||this.$filteredAtoms["outer"+o(i)](!0)||u;t=Math.floor(u/a),t=Math.max(t,1),this[n][s]=t,this[n][r]=a},_checkIfSegmentsChanged:function(e){var t=this.options.layoutMode,n=e?"rows":"cols",r=this[t][n];return this._getSegments(e),this[t][n]!==r},_masonryReset:function(){this.masonry={},this._getSegments();var e=this.masonry.cols;for(this.masonry.colYs=[];e--;)this.masonry.colYs.push(0)},_masonryLayout:function(e){var n=this,r=n.masonry;e.each(function(){var e=t(this),i=Math.ceil(e.outerWidth(!0)/r.columnWidth);if(i=Math.min(i,r.cols),1===i)n._masonryPlaceBrick(e,r.colYs);else{var s,o,u=r.cols+1-i,a=[];for(o=0;u>o;o++)s=r.colYs.slice(o,o+i),a[o]=Math.max.apply(Math,s);n._masonryPlaceBrick(e,a)}})},_masonryPlaceBrick:function(e,t){for(var n=Math.min.apply(Math,t),r=0,i=0,s=t.length;s>i;i++)if(t[i]===n){r=i;break}var o=this.masonry.columnWidth*r,u=n;this._pushPosition(e,o,u);var a=n+e.outerHeight(!0),f=this.masonry.cols+1-s;for(i=0;f>i;i++)this.masonry.colYs[r+i]=a},_masonryGetContainerSize:function(){var e=Math.max.apply(Math,this.masonry.colYs);return{height:e}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(e){var n=this,r=this.element.width(),i=this.fitRows;e.each(function(){var e=t(this),s=e.outerWidth(!0),o=e.outerHeight(!0);0!==i.x&&s+i.x>r&&(i.x=0,i.y=i.height),n._pushPosition(e,i.x,i.y),i.height=Math.max(i.y+o,i.height),i.x+=s})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return!0},_cellsByRowReset:function(){this.cellsByRow={index:0},this._getSegments(),this._getSegments(!0)},_cellsByRowLayout:function(e){var n=this,r=this.cellsByRow;e.each(function(){var e=t(this),i=r.index%r.cols,s=Math.floor(r.index/r.cols),o=(i+.5)*r.columnWidth-e.outerWidth(!0)/2,u=(s+.5)*r.rowHeight-e.outerHeight(!0)/2;n._pushPosition(e,o,u),r.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function(e){var n=this;e.each(function(){var e=t(this);n._pushPosition(e,0,n.straightDown.y),n.straightDown.y+=e.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return!0},_masonryHorizontalReset:function(){this.masonryHorizontal={},this._getSegments(!0);var e=this.masonryHorizontal.rows;for(this.masonryHorizontal.rowXs=[];e--;)this.masonryHorizontal.rowXs.push(0)},_masonryHorizontalLayout:function(e){var n=this,r=n.masonryHorizontal;e.each(function(){var e=t(this),i=Math.ceil(e.outerHeight(!0)/r.rowHeight);if(i=Math.min(i,r.rows),1===i)n._masonryHorizontalPlaceBrick(e,r.rowXs);else{var s,o,u=r.rows+1-i,a=[];for(o=0;u>o;o++)s=r.rowXs.slice(o,o+i),a[o]=Math.max.apply(Math,s);n._masonryHorizontalPlaceBrick(e,a)}})},_masonryHorizontalPlaceBrick:function(e,t){for(var n=Math.min.apply(Math,t),r=0,i=0,s=t.length;s>i;i++)if(t[i]===n){r=i;break}var o=n,u=this.masonryHorizontal.rowHeight*r;this._pushPosition(e,o,u);var a=n+e.outerWidth(!0),f=this.masonryHorizontal.rows+1-s;for(i=0;f>i;i++)this.masonryHorizontal.rowXs[r+i]=a},_masonryHorizontalGetContainerSize:function(){var e=Math.max.apply(Math,this.masonryHorizontal.rowXs);return{width:e}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function(e){var n=this,r=this.element.height(),i=this.fitColumns;e.each(function(){var e=t(this),s=e.outerWidth(!0),o=e.outerHeight(!0);0!==i.y&&o+i.y>r&&(i.x=i.width,i.y=0),n._pushPosition(e,i.x,i.y),i.width=Math.max(i.x+s,i.width),i.y+=o})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return!0},_cellsByColumnReset:function(){this.cellsByColumn={index:0},this._getSegments(),this._getSegments(!0)},_cellsByColumnLayout:function(e){var n=this,r=this.cellsByColumn;e.each(function(){var e=t(this),i=Math.floor(r.index/r.rows),s=r.index%r.rows,o=(i+.5)*r.columnWidth-e.outerWidth(!0)/2,u=(s+.5)*r.rowHeight-e.outerHeight(!0)/2;n._pushPosition(e,o,u),r.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function(e){var n=this;e.each(function(){var e=t(this);n._pushPosition(e,n.straightAcross.x,0),n.straightAcross.x+=e.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return!0}},t.fn.imagesLoaded=function(e){function n(){e.call(i,s)}function r(e){var i=e.target;i.src!==u&&-1===t.inArray(i,a)&&(a.push(i),--o<=0&&(setTimeout(n),s.unbind(".imagesLoaded",r)))}var i=this,s=i.find("img").add(i.filter("img")),o=s.length,u="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",a=[];return o||n(),s.bind("load.imagesLoaded error.imagesLoaded",r).each(function(){var e=this.src;this.src=u,this.src=e}),i};var x=function(t){e.console&&e.console.error(t)};t.fn.isotope=function(e,n){if("string"==typeof e){var r=Array.prototype.slice.call(arguments,1);this.each(function(){var n=t.data(this,"isotope");return n?t.isFunction(n[e])&&"_"!==e.charAt(0)?void n[e].apply(n,r):void x("no such method '"+e+"' for isotope instance"):void x("cannot call methods on isotope prior to initialization; attempted to call method '"+e+"'")})}else this.each(function(){var r=t.data(this,"isotope");r?(r.option(e),r._init(n)):t.data(this,"isotope",new t.Isotope(e,this,n))});return this}}(window,e)}function plugin_jquery_jScrollPane(e){var t=e,n=window,r=undefined;t.fn.jScrollPane=function(e){function n(e,n){function $(n){var s,g,y,E,S,T,N=false,C=false;i=n;if(o===r){S=e.scrollTop();T=e.scrollLeft();e.css({overflow:"hidden",padding:0});u=e.innerWidth()+I;a=e.innerHeight();e.width(u);o=t('<div class="jspPane" />').css("padding",F).append(e.children());f=t('<div class="jspContainer" />').css({width:u+"px",height:a+"px"}).append(o).appendTo(e)}else{e.css("width","");N=i.stickToBottom&&mt();C=i.stickToRight&&gt();E=e.innerWidth()+I!=u||e.outerHeight()!=a;if(E){u=e.innerWidth()+I;a=e.innerHeight();f.css({width:u+"px",height:a+"px"})}if(!E&&q==l&&o.outerHeight()==h){e.width(u);return}q=l;o.css("width","");e.width(u);f.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}o.css("overflow","auto");if(n.contentWidth){l=n.contentWidth}else{l=o[0].scrollWidth}h=o[0].scrollHeight;o.css("overflow","");p=l/u;d=h/a;v=d>1;m=p>1;if(!(m||v)){e.removeClass("jspScrollable");o.css({top:0,width:f.width()-I});bt();St();Tt();rt();Ct()}else{e.addClass("jspScrollable");s=i.maintainPosition&&(w||x);if(s){g=dt();y=vt()}J();Q();Y();if(s){ht(C?l-u:g,false);ct(N?h-a:y,false)}Et();yt();Lt();if(i.enableKeyboardNavigation){xt()}if(i.clickOnTrack){nt()}Nt();if(i.hijackInternalLinks){kt()}}if(i.autoReinitialise&&!j){j=setInterval(function(){$(i)},i.autoReinitialiseDelay)}else{if(!i.autoReinitialise&&j){clearInterval(j)}}S&&e.scrollTop(0)&&ct(S,false);T&&e.scrollLeft(0)&&ht(T,false);e.trigger("jsp-initialised",[m||v])}function J(){if(v){f.append(t('<div class="jspVerticalBar" />').append(t('<div class="jspCap jspCapTop" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragTop" />'),t('<div class="jspDragBottom" />'))),t('<div class="jspCap jspCapBottom" />')));T=f.find(">.jspVerticalBar");N=T.find(">.jspTrack");g=N.find(">.jspDrag");if(i.showArrows){A=t('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",et(0,-1)).bind("click.jsp",wt);O=t('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",et(0,1)).bind("click.jsp",wt);if(i.arrowScrollOnHover){A.bind("mouseover.jsp",et(0,-1,A));O.bind("mouseover.jsp",et(0,1,O))}Z(N,i.verticalArrowPositions,A,O)}k=a;f.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){k-=t(this).outerHeight()});g.hover(function(){g.addClass("jspHover")},function(){g.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",wt);g.addClass("jspActive");var n=e.pageY-g.position().top;t("html").bind("mousemove.jsp",function(e){st(e.pageY-n,false)}).bind("mouseup.jsp mouseleave.jsp",it);return false});K()}}function K(){N.height(k+"px");w=0;C=i.verticalGutter+N.outerWidth();o.width(u-C-I);try{if(T.position().left===0){o.css("margin-left",C+"px")}}catch(e){}}function Q(){if(m){f.append(t('<div class="jspHorizontalBar" />').append(t('<div class="jspCap jspCapLeft" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragLeft" />'),t('<div class="jspDragRight" />'))),t('<div class="jspCap jspCapRight" />')));M=f.find(">.jspHorizontalBar");_=M.find(">.jspTrack");E=_.find(">.jspDrag");if(i.showArrows){H=t('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",et(-1,0)).bind("click.jsp",wt);B=t('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",et(1,0)).bind("click.jsp",wt);if(i.arrowScrollOnHover){H.bind("mouseover.jsp",et(-1,0,H));B.bind("mouseover.jsp",et(1,0,B))}Z(_,i.horizontalArrowPositions,H,B)}E.hover(function(){E.addClass("jspHover")},function(){E.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",wt);E.addClass("jspActive");var n=e.pageX-E.position().left;t("html").bind("mousemove.jsp",function(e){ut(e.pageX-n,false)}).bind("mouseup.jsp mouseleave.jsp",it);return false});D=f.innerWidth();G()}}function G(){f.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){D-=t(this).outerWidth()});_.width(D+"px");x=0}function Y(){if(m&&v){var e=_.outerHeight(),n=N.outerWidth();k-=e;t(M).find(">.jspCap:visible,>.jspArrow").each(function(){D+=t(this).outerWidth()});D-=n;a-=n;u-=e;_.parent().append(t('<div class="jspCorner" />').css("width",e+"px"));K();G()}if(m){o.width(f.outerWidth()-I+"px")}h=o.outerHeight();d=h/a;if(m){P=Math.ceil(1/p*D);if(P>i.horizontalDragMaxWidth){P=i.horizontalDragMaxWidth}else{if(P<i.horizontalDragMinWidth){P=i.horizontalDragMinWidth}}E.width(P+"px");S=D-P;at(x)}if(v){L=Math.ceil(1/d*k);if(L>i.verticalDragMaxHeight){L=i.verticalDragMaxHeight}else{if(L<i.verticalDragMinHeight){L=i.verticalDragMinHeight}}g.height(L+"px");y=k-L;ot(w)}}function Z(e,t,n,r){var i="before",s="after",o;if(t=="os"){t=/Mac/.test(navigator.platform)?"after":"split"}if(t==i){s=t}else{if(t==s){i=t;o=n;n=r;r=o}}e[i](n)[s](r)}function et(e,t,n){return function(){tt(e,t,this,n);this.blur();return false}}function tt(e,n,r,o){r=t(r).addClass("jspActive");var u,a,f=true,l=function(){if(e!==0){s.scrollByX(e*i.arrowButtonSpeed)}if(n!==0){s.scrollByY(n*i.arrowButtonSpeed)}a=setTimeout(l,f?i.initialDelay:i.arrowRepeatFreq);f=false};l();u=o?"mouseout.jsp":"mouseup.jsp";o=o||t("html");o.bind(u,function(){r.removeClass("jspActive");a&&clearTimeout(a);a=null;o.unbind(u)})}function nt(){rt();if(v){N.bind("mousedown.jsp",function(e){if(e.originalTarget===r||e.originalTarget==e.currentTarget){var n=t(this),o=n.offset(),u=e.pageY-o.top-w,f,l=true,p=function(){var t=n.offset(),r=e.pageY-t.top-L/2,o=a*i.scrollPagePercent,c=y*o/(h-a);if(u<0){if(w-c>r){s.scrollByY(-o)}else{st(r)}}else{if(u>0){if(w+c<r){s.scrollByY(o)}else{st(r)}}else{d();return}}f=setTimeout(p,l?i.initialDelay:i.trackClickRepeatFreq);l=false},d=function(){f&&clearTimeout(f);f=null;t(document).unbind("mouseup.jsp",d)};p();t(document).bind("mouseup.jsp",d);return false}})}if(m){_.bind("mousedown.jsp",function(e){if(e.originalTarget===r||e.originalTarget==e.currentTarget){var n=t(this),o=n.offset(),a=e.pageX-o.left-x,f,h=true,p=function(){var t=n.offset(),r=e.pageX-t.left-P/2,o=u*i.scrollPagePercent,c=S*o/(l-u);if(a<0){if(x-c>r){s.scrollByX(-o)}else{ut(r)}}else{if(a>0){if(x+c<r){s.scrollByX(o)}else{ut(r)}}else{d();return}}f=setTimeout(p,h?i.initialDelay:i.trackClickRepeatFreq);h=false},d=function(){f&&clearTimeout(f);f=null;t(document).unbind("mouseup.jsp",d)};p();t(document).bind("mouseup.jsp",d);return false}})}}function rt(){if(_){_.unbind("mousedown.jsp")}if(N){N.unbind("mousedown.jsp")}}function it(){t("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(g){g.removeClass("jspActive")}if(E){E.removeClass("jspActive")}}function st(e,t){if(!v){return}if(e<0){e=0}else{if(e>y){e=y}}if(t===r){t=i.animateScroll}if(t){s.animate(g,"top",e,ot)}else{g.css("top",e);ot(e)}}function ot(t){if(t===r){t=g.position().top}f.scrollTop(0);w=t;var n=w===0,i=w==y,s=t/y,u=-s*(h-a);if(R!=n||z!=i){R=n;z=i;e.trigger("jsp-arrow-change",[R,z,U,W])}ft(n,i);o.css("top",u);e.trigger("jsp-scroll-y",[-u,n,i]).trigger("scroll")}function ut(e,t){if(!m){return}if(e<0){e=0}else{if(e>S){e=S}}if(t===r){t=i.animateScroll}if(t){s.animate(E,"left",e,at)}else{E.css("left",e);at(e)}}function at(t){if(t===r){t=E.position().left}f.scrollTop(0);x=t;var n=x===0,i=x==S,s=t/S,a=-s*(l-u);if(U!=n||W!=i){U=n;W=i;e.trigger("jsp-arrow-change",[R,z,U,W])}lt(n,i);o.css("left",a);e.trigger("jsp-scroll-x",[-a,n,i]).trigger("scroll")}function ft(e,t){if(i.showArrows){A[e?"addClass":"removeClass"]("jspDisabled");O[t?"addClass":"removeClass"]("jspDisabled")}}function lt(e,t){if(i.showArrows){H[e?"addClass":"removeClass"]("jspDisabled");B[t?"addClass":"removeClass"]("jspDisabled")}}function ct(e,t){var n=e/(h-a);st(n*y,t)}function ht(e,t){var n=e/(l-u);ut(n*S,t)}function pt(e,n,r){var s,o,l,c=0,h=0,p,d,v,m,g,y;try{s=t(e)}catch(w){return}o=s.outerHeight();l=s.outerWidth();f.scrollTop(0);f.scrollLeft(0);while(!s.is(".jspPane")){c+=s.position().top;h+=s.position().left;s=s.offsetParent();if(/^body|html$/i.test(s[0].nodeName)){return}}p=vt();v=p+a;if(c<p||n){g=c-i.verticalGutter}else{if(c+o>v){g=c-a+o+i.verticalGutter}}if(g){ct(g,r)}d=dt();m=d+u;if(h<d||n){y=h-i.horizontalGutter}else{if(h+l>m){y=h-u+l+i.horizontalGutter}}if(y){ht(y,r)}}function dt(){return-o.position().left}function vt(){return-o.position().top}function mt(){var e=h-a;return e>20&&e-vt()<10}function gt(){var e=l-u;return e>20&&e-dt()<10}function yt(){f.unbind(V).bind(V,function(e,t,n,r){var o=x,u=w;s.scrollBy(n*i.mouseWheelSpeed,-r*i.mouseWheelSpeed,false);return o==x&&u==w})}function bt(){f.unbind(V)}function wt(){return false}function Et(){o.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){pt(e.target,false)})}function St(){o.find(":input,a").unbind("focus.jsp")}function xt(){function l(){var e=x,t=w;switch(n){case 40:s.scrollByY(i.keyboardSpeed,false);break;case 38:s.scrollByY(-i.keyboardSpeed,false);break;case 34:case 32:s.scrollByY(a*i.scrollPagePercent,false);break;case 33:s.scrollByY(-a*i.scrollPagePercent,false);break;case 39:s.scrollByX(i.keyboardSpeed,false);break;case 37:s.scrollByX(-i.keyboardSpeed,false);break}r=e!=x||t!=w;return r}var n,r,u=[];m&&u.push(M[0]);v&&u.push(T[0]);o.focus(function(){e.focus()});e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target!==this&&!(u.length&&t(e.target).closest(u).length)){return}var i=x,s=w;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=e.keyCode;l();break;case 35:ct(h-a);n=null;break;case 36:ct(0);n=null;break}r=e.keyCode==n&&i!=x||s!=w;return!r}).bind("keypress.jsp",function(e){if(e.keyCode==n){l()}return!r});if(i.hideFocus){e.css("outline","none");if("hideFocus"in f[0]){e.attr("hideFocus",true)}}else{e.css("outline","");if("hideFocus"in f[0]){e.attr("hideFocus",false)}}}function Tt(){e.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function Nt(){if(location.hash&&location.hash.length>1){var e,n;try{e=t(location.hash)}catch(r){return}if(e.length&&o.find(location.hash)){if(f.scrollTop()===0){n=setInterval(function(){if(f.scrollTop()>0){pt(location.hash,true);t(document).scrollTop(f.position().top);clearInterval(n)}},50)}else{pt(location.hash,true);t(document).scrollTop(f.position().top)}}}}function Ct(){t("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function kt(){Ct();t("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var e=this.href.split("#"),t;if(e.length>1){t=e[1];if(t.length>0&&o.find("#"+t).length>0){pt("#"+t,true);return false}}})}function Lt(){var e,t,n,r,i,o=false;f.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(s){var u=s.originalEvent.touches[0];e=dt();t=vt();n=u.pageX;r=u.pageY;i=false;o=true}).bind("touchmove.jsp",function(u){if(!o){return}var a=u.originalEvent.touches[0],f=x,l=w;s.scrollTo(e+n-a.pageX,t+r-a.pageY);i=i||Math.abs(n-a.pageX)>5||Math.abs(r-a.pageY)>5;return f==x&&l==w}).bind("touchend.jsp",function(e){o=false}).bind("click.jsp-touchclick",function(e){if(i){i=false;return false}})}function At(){var t=vt(),n=dt();e.removeClass("jspScrollable").unbind(".jsp");e.replaceWith(X.append(o.children()));X.scrollTop(t);X.scrollLeft(n)}var i,s=this,o,u,a,f,l,h,p,d,v,m,g,y,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R=true,U=true,z=false,W=false,X=e.clone(false,false).empty(),V=t.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";F=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft");I=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0);t.extend(s,{reinitialise:function(e){e=t.extend({},i,e);$(e)},scrollToElement:function(e,t,n){pt(e,t,n)},scrollTo:function(e,t,n){ht(e,n);ct(t,n)},scrollToX:function(e,t){ht(e,t)},scrollToY:function(e,t){ct(e,t)},scrollToPercentX:function(e,t){ht(e*(l-u),t)},scrollToPercentY:function(e,t){ct(e*(h-a),t)},scrollBy:function(e,t,n){s.scrollByX(e,n);s.scrollByY(t,n)},scrollByX:function(e,t){e=e>=0?Math.max(e,1):Math.min(e,-1);var n=dt()+e,r=n/(l-u);ut(r*S,t)},scrollByY:function(e,t){e=e>=0?Math.max(e,1):Math.min(e,-1);var n=vt()+e,r=n/(h-a);st(r*y,t)},positionDragX:function(e,t){ut(e,t)},positionDragY:function(e,t){st(e,t)},animate:function(e,t,n,r){var s={};s[t]=n;e.animate(s,{duration:i.animateDuration,ease:i.animateEase,queue:false,step:r})},getContentPositionX:function(){return dt()},getContentPositionY:function(){return vt()},getContentWidth:function(){return l},getContentHeight:function(){return h},getPercentScrolledX:function(){return dt()/(l-u)},getPercentScrolledY:function(){return vt()/(h-a)},getIsScrollableH:function(){return m},getIsScrollableV:function(){return v},getContentPane:function(){return o},scrollToBottom:function(e){st(y,e)},hijackInternalLinks:function(){kt()},destroy:function(){At()}});$(n)}e=t.extend({},t.fn.jScrollPane.defaults,e);t.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed});return this.each(function(){var r=t(this),i=r.data("jsp");if(i){i.reinitialise(e)}else{i=new n(r,e);r.data("jsp",i)}})};t.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:r,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}function plugin_jquery_twitterTip(e){!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t;this.$element=e(n);this.options=this.getOptions(r);this.enabled=true;if(this.options.trigger!="manual"){i=this.options.trigger=="hover"?"mouseenter":"focus";s=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.bind(i,this.options.selector,e.proxy(this.enter,this));this.$element.bind(s,this.options.selector,e.proxy(this.leave,this))}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){t=e.extend({},e.fn[this.type].defaults,t,this.$element.data());if(t.delay&&typeof t.delay=="number"){t.delay={show:t.delay,hide:t.delay}}return t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show){n.show()}else{n.hoverState="in";setTimeout(function(){if(n.hoverState=="in"){n.show()}},n.options.delay.show)}},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.hide){n.hide()}else{n.hoverState="out";setTimeout(function(){if(n.hoverState=="out"){n.hide()}},n.options.delay.hide)}},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip();this.setContent();if(this.options.animation){e.addClass("rdr_tw_fade")}s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement;t=/rdr_tw_in/.test(s);e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body);n=this.getPosition(t);r=e[0].offsetWidth;i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i-5,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width};break}e.css(o).addClass("rdr_tw_"+s).addClass("rdr_tw_in")}},setContent:function(){var e=this.tip();e.find(".rdr_twtooltip-inner").html(this.getTitle());e.removeClass("rdr_tw_fade rdr_tw_in rdr_tw_top rdr_tw_bottom rdr_tw_left rdr_tw_right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t);n.remove()})}var t=this,n=this.tip();n.removeClass("rdr_tw_in");e.support.transition&&this.$tip.hasClass("rdr_tw_fade")?r():n.remove();if(e.support.transition&&this.$tip.hasClass("rdr_tw_fade")){}else{}},fixTitle:function(){var e=this.$element;if(e.attr("title")||typeof e.attr("data-original-title")!="string"){e.attr("data-original-title",e.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title);e=(e||"").toString().replace(/(^\s*|\s*$)/,"");return e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("rdr_tw_in")?"hide":"show"]()}};e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;if(!i)r.data("tooltip",i=new t(this,s));if(typeof n=="string")i[n]()})};e.fn.tooltip.Constructor=t;e.fn.tooltip.defaults={animation:true,delay:0,selector:false,placement:"top",trigger:"hover",title:"",template:'<div class="rdr rdr_twtooltip"><div class="rdr_twtooltip-arrow"></div><div class="rdr_twtooltip-inner"></div></div>'}}(e)}function plugin_rangy(){var e="ins";var t=function(){function e(e,t){var n=typeof e[t];return n=="function"||!!(n=="object"&&e[t])||n=="unknown"}function t(e,t){return!!(typeof e[t]=="object"&&e[t])}function n(e,t){return typeof e[t]!="undefined"}function r(e){return function(t,n){for(var r=n.length;r--;)if(!e(t,n[r]))return false;return true}}function i(e){return e&&h(e,c)&&d(e,l)}function s(e){window.alert("Rangy not supported in your browser. Reason: "+e);v.initialized=true;v.supported=false}function o(){if(!v.initialized){var n,r=false,o=false;if(e(document,"createRange")){n=document.createRange();if(h(n,f)&&d(n,a))r=true;n.detach()}if((n=t(document,"body")?document.body:document.getElementsByTagName("body")[0])&&e(n,"createTextRange")){n=n.createTextRange();if(i(n))o=true}!r&&!o&&s("Neither Range nor TextRange are implemented");v.initialized=true;v.features={implementsDomRange:r,implementsTextRange:o};r=g.concat(m);o=0;for(n=r.length;o<n;++o)try{r[o](v)}catch(u){t(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",u)}}}function u(e){this.name=e;this.supported=this.initialized=false}var a=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],f=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],l=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],c=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint"],h=r(e),p=r(t),d=r(n),v={version:"1.2beta2",initialized:false,supported:true,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:h,areHostObjects:p,areHostProperties:d,isTextRange:i},features:{},modules:{},config:{alertOnWarn:false,preferTextRange:false}};v.fail=s;v.warn=function(e){e="Rangy warning: "+e;if(v.config.alertOnWarn)window.alert(e);else typeof window.console!="undefined"&&typeof window.console.log!="undefined"&&window.console.log(e)};if({}.hasOwnProperty)v.util.extend=function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};else s("hasOwnProperty not supported");var m=[],g=[];v.init=o;v.addInitListener=function(e){v.initialized?e(v):m.push(e)};var y=[];v.addCreateMissingNativeApiListener=function(e){y.push(e)};v.createMissingNativeApi=function(e){e=e||window;o();for(var t=0,n=y.length;t<n;++t)y[t](e)};u.prototype.fail=function(e){this.initialized=true;this.supported=false;throw Error("Module '"+this.name+"' failed to load: "+e)};u.prototype.warn=function(e){v.warn("Module "+this.name+": "+e)};u.prototype.createError=function(e){return Error("Error in Rangy "+this.name+" module: "+e)};v.createModule=function(e,t){var n=new u(e);v.modules[e]=n;g.push(function(e){t(e,n);n.initialized=true;n.supported=true})};v.requireModules=function(e){for(var t=0,n=e.length,r,i;t<n;++t){i=e[t];r=v.modules[i];if(!r||!(r instanceof u))throw Error("Module '"+i+"' not found");if(!r.supported)throw Error("Module '"+i+"' not supported")}};var b=false;p=function(){if(!b){b=true;v.initialized||o()}};if(typeof window=="undefined")s("No window found");else if(typeof document=="undefined")s("No document found");else{e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",p,false);if(e(window,"addEventListener"))window.addEventListener("load",p,false);else e(window,"attachEvent")?window.attachEvent("onload",p):s("Window does not have required addEventListener or attachEvent method");return v}}();t.createModule("DomUtil",function(e,t){function n(e){for(var t=0;e=e.previousSibling;)t++;return t}function r(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(d(n,r))return r;return null}function i(e,t,n){for(n=n?e:e.parentNode;n;){e=n.parentNode;if(e===t)return n;n=e}return null}function s(e){e=e.nodeType;return e==3||e==4||e==8}function o(e,t){var n=t.nextSibling,r=t.parentNode;n?r.insertBefore(e,n):r.appendChild(e);return e}function u(e){if(e.nodeType==9)return e;else if(typeof e.ownerDocument!="undefined")return e.ownerDocument;else if(typeof e.document!="undefined")return e.document;else if(e.parentNode)return u(e.parentNode);else throw Error("getDocument: no document found for node")}function a(e){if(!e)return"[No node]";return s(e)?'"'+e.data+'"':e.nodeType==1?"<"+e.nodeName+(e.id?' id="'+e.id+'"':"")+">["+e.childNodes.length+"]":e.nodeName}function f(e){this._next=this.root=e}function l(e,t){this.node=e;this.offset=t}function c(e){this.code=this[e];this.codeName=e;this.message="DOMException: "+this.codeName}var h=e.util;h.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method");h.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var p=document.createElement("div");h.areHostMethods(p,["insertBefore","appendChild","cloneNode"])||t.fail("Incomplete Element implementation");p=document.createTextNode("test");h.areHostMethods(p,["splitText","deleteData","insertData","appendData","cloneNode"])||t.fail("Incomplete Text Node implementation");var d=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return true;return false};f.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t;if(this._current)if(t=e.firstChild)this._next=t;else{for(t=null;e!==this.root&&!(t=e.nextSibling);)e=e.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}};l.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+a(this.node)+":"+this.offset+")]"}};c.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};c.prototype.toString=function(){return this.message};e.dom={arrayContains:d,getNodeIndex:n,getNodeLength:function(e){var t;return s(e)?e.length:(t=e.childNodes)?t.length:0},getCommonAncestor:r,isAncestorOf:function(e,t,n){for(t=n?t:t.parentNode;t;)if(t===e)return true;else t=t.parentNode;return false},getClosestAncestorIn:i,isCharacterDataNode:s,insertAfter:o,splitDataNode:function(e,t){var n=e.cloneNode(false);n.deleteData(0,t);e.deleteData(t,e.length-t);o(n,e);return n},getDocument:u,getWindow:function(e){e=u(e);if(typeof e.defaultView!="undefined")return e.defaultView;else if(typeof e.parentWindow!="undefined")return e.parentWindow;else throw Error("Cannot get a window object for node")},getIframeWindow:function(e){if(typeof e.contentWindow!="undefined")return e.contentWindow;else if(typeof e.contentDocument!="undefined")return e.contentDocument.defaultView;else throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(e){if(typeof e.contentDocument!="undefined")return e.contentDocument;else if(typeof e.contentWindow!="undefined")return e.contentWindow.document;else throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(e){return h.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]},getRootContainer:function(e){for(var t;t=e.parentNode;)e=t;return e},comparePoints:function(e,t,s,o){var u;if(e==s)return t===o?0:t<o?-1:1;else if(u=i(s,e,true))return t<=n(u)?-1:1;else if(u=i(e,s,true))return n(u)<o?-1:1;else{t=r(e,s);e=e===t?t:i(e,t,true);s=s===t?t:i(s,t,true);if(e===s)throw Error("comparePoints got to case 4 and childA and childB are the same!");else{for(t=t.firstChild;t;){if(t===e)return-1;else if(t===s)return 1;t=t.nextSibling}throw Error("Should not be here!")}}},inspectNode:a,createIterator:function(e){return new f(e)},DomPosition:l};e.DOMException=c});t.createModule("DomRange",function(e){function t(e,t){return e.nodeType!=3&&(D.isAncestorOf(e,t.startContainer,true)||D.isAncestorOf(e,t.endContainer,true))}function n(e){return D.getDocument(e.startContainer)}function r(e,t,n){if(t=e._listeners[t])for(var r=0,i=t.length;r<i;++r)t[r].call(e,{target:e,args:n})}function i(e){return new P(e.parentNode,D.getNodeIndex(e))}function s(e){return new P(e.parentNode,D.getNodeIndex(e)+1)}function o(e,t,n){var r=e.nodeType==11?e.firstChild:e;if(D.isCharacterDataNode(t))n==t.length?D.insertAfter(e,t):t.parentNode.insertBefore(e,n==0?t:D.splitDataNode(t,n));else n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]);return r}function u(e){for(var t,r,i=n(e.range).createDocumentFragment();r=e.next();){t=e.isPartiallySelectedSubtree();r=r.cloneNode(!t);if(t){t=e.getSubtreeIterator();r.appendChild(u(t));t.detach(true)}if(r.nodeType==10)throw new H("HIERARCHY_REQUEST_ERR");i.appendChild(r)}return i}function a(e,t,n){var r,i;for(n=n||{stop:false};r=e.next();)if(e.isPartiallySelectedSubtree())if(t(r)===false){n.stop=true;return}else{r=e.getSubtreeIterator();a(r,t,n);r.detach(true);if(n.stop)return}else for(r=D.createIterator(r);i=r.next();)if(t(i)===false){n.stop=true;return}}function f(e){for(var t;e.next();)if(e.isPartiallySelectedSubtree()){t=e.getSubtreeIterator();f(t);t.detach(true)}else e.remove()}function l(e){for(var t,r=n(e.range).createDocumentFragment(),i;t=e.next();){if(e.isPartiallySelectedSubtree()){t=t.cloneNode(false);i=e.getSubtreeIterator();t.appendChild(l(i));i.detach(true)}else e.remove();if(t.nodeType==10)throw new H("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function c(e,t,n){var r=!!(t&&t.length),i,s=!!n;if(r)i=RegExp("^("+t.join("|")+")$");var o=[];a(new p(e,false),function(e){if((!r||i.test(e.nodeType))&&(!s||n(e)))o.push(e)});return o}function h(e){return"["+(typeof e.getName=="undefined"?"Range":e.getName())+"("+D.inspectNode(e.startContainer)+":"+e.startOffset+", "+D.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){this.range=e;this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer;this.so=e.startOffset;this.ec=e.endContainer;this.eo=e.endOffset;var n=e.commonAncestorContainer;if(this.sc===this.ec&&D.isCharacterDataNode(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=this.sc===n&&!D.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:D.getClosestAncestorIn(this.sc,n,true);this._last=this.ec===n&&!D.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:D.getClosestAncestorIn(this.ec,n,true)}}}function d(e){this.code=this[e];this.codeName=e;this.message="RangeException: "+this.codeName}function v(e,t,n){this.nodes=c(e,t,n);this._next=this.nodes[0];this._position=0}function m(e){return function(t,n){for(var r,i=n?t:t.parentNode;i;){r=i.nodeType;if(D.arrayContains(e,r))return i;i=i.parentNode}return null}}function g(e,t){if(z(e,t))throw new d("INVALID_NODE_TYPE_ERR")}function y(e){if(!e.startContainer)throw new H("INVALID_STATE_ERR")}function b(e,t){if(!D.arrayContains(t,e.nodeType))throw new d("INVALID_NODE_TYPE_ERR")}function w(e,t){if(t<0||t>(D.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new H("INDEX_SIZE_ERR")}function E(e,t){if(R(e,true)!==R(t,true))throw new H("WRONG_DOCUMENT_ERR")}function S(e){if(U(e,true))throw new H("NO_MODIFICATION_ALLOWED_ERR")}function x(e,t){if(!e)throw new H(t)}function T(e){y(e);if(!D.arrayContains(j,e.startContainer.nodeType)&&!R(e.startContainer,true)||!D.arrayContains(j,e.endContainer.nodeType)&&!R(e.endContainer,true)||!(e.startOffset<=(D.isCharacterDataNode(e.startContainer)?e.startContainer.length:e.startContainer.childNodes.length))||!(e.endOffset<=(D.isCharacterDataNode(e.endContainer)?e.endContainer.length:e.endContainer.childNodes.length)))RDR.actions.catchRangyErrors("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function N(){}function C(e){e.START_TO_START=X;e.START_TO_END=V;e.END_TO_END=$;e.END_TO_START=J;e.NODE_BEFORE=K;e.NODE_AFTER=Q;e.NODE_BEFORE_AND_AFTER=G;e.NODE_INSIDE=Y}function k(e){C(e);C(e.prototype)}function L(e,t){return function(){T(this);var n=this.startContainer,r=this.startOffset,i=this.commonAncestorContainer,o=new p(this,true);if(n!==i){n=D.getClosestAncestorIn(n,i,true);r=s(n);n=r.node;r=r.offset}a(o,S);o.reset();i=e(o);o.detach();t(this,n,r,n,r);return i}}function A(n,r,o){function u(e,t){return function(n){y(this);b(n,B);b(q(n),j);n=(e?i:s)(n);(t?a:c)(this,n.node,n.offset)}}function a(e,t,n){var i=e.endContainer,s=e.endOffset;if(t!==e.startContainer||n!==this.startOffset){if(q(t)!=q(i)||D.comparePoints(t,n,i,s)==1){i=t;s=n}r(e,t,n,i,s)}}function c(e,t,n){var i=e.startContainer,s=e.startOffset;if(t!==e.endContainer||n!==this.endOffset){if(q(t)!=q(i)||D.comparePoints(t,n,i,s)==-1){i=t;s=n}r(e,i,s,t,n)}}function h(e,t,n){if(t!==e.startContainer||n!==this.startOffset||t!==e.endContainer||n!==this.endOffset)r(e,t,n,t,n)}n.prototype=new N;e.util.extend(n.prototype,{setStart:function(e,t){y(this);g(e,true);w(e,t);a(this,e,t)},setEnd:function(e,t){y(this);g(e,true);w(e,t);c(this,e,t)},setStartBefore:u(true,true),setStartAfter:u(false,true),setEndBefore:u(true,false),setEndAfter:u(false,false),collapse:function(e){T(this);e?r(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):r(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){y(this);g(e,true);r(this,e,0,e,D.getNodeLength(e))},selectNode:function(e){y(this);g(e,false);b(e,B);var t=i(e);e=s(e);r(this,t.node,t.offset,e.node,e.offset)},extractContents:L(l,r),deleteContents:L(f,r),canSurroundContents:function(){T(this);S(this.startContainer);S(this.endContainer);var e=new p(this,true),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);e.detach();return!n},detach:function(){o(this)},splitBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=e===n;D.isCharacterDataNode(n)&&i>0&&i<n.length&&D.splitDataNode(n,i);if(D.isCharacterDataNode(e)&&t>0&&t<e.length){e=D.splitDataNode(e,t);if(s){i-=t;n=e}else n==e.parentNode&&i>=D.getNodeIndex(e)&&i++;t=0}r(this,e,t,n,i)},normalizeBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=function(e){var t=e.nextSibling;if(t&&t.nodeType==e.nodeType){n=e;i=e.length;e.appendData(t.data);t.parentNode.removeChild(t)}},o=function(r){var s=r.previousSibling;if(s&&s.nodeType==r.nodeType){e=r;var o=r.length;t=s.length;r.insertData(0,s.data);s.parentNode.removeChild(s);if(e==n){i+=t;n=e}else if(n==r.parentNode){s=D.getNodeIndex(r);if(i==s){n=r;i=o}else i>s&&i--}}},u=true;if(D.isCharacterDataNode(n))n.length==i&&s(n);else{if(i>0)(u=n.childNodes[i-1])&&D.isCharacterDataNode(u)&&s(u);u=!this.collapsed}if(u)if(D.isCharacterDataNode(e))t==0&&o(e);else{if(t<e.childNodes.length)(s=e.childNodes[t])&&D.isCharacterDataNode(s)&&o(s)}else{e=n;t=i}r(this,e,t,n,i)},collapseToPoint:function(e,t){T(this);g(e,true);w(e,t);h(this,e,t)}});k(n)}function O(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset;e.commonAncestorContainer=e.collapsed?e.startContainer:D.getCommonAncestor(e.startContainer,e.endContainer)}function M(e,t,n,i,s){var o=e.startContainer!==t||e.startOffset!==n,u=e.endContainer!==i||e.endOffset!==s;e.startContainer=t;e.startOffset=n;e.endContainer=i;e.endOffset=s;O(e);r(e,"boundarychange",{startMoved:o,endMoved:u})}function _(e){this.startContainer=e;this.startOffset=0;this.endContainer=e;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};O(this)}e.requireModules(["DomUtil"]);var D=e.dom,P=D.DomPosition,H=e.DOMException;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;if(e){this._next=e!==this._last?e.nextSibling:null;if(D.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes){if(e===this.ec)(e=e.cloneNode(true)).deleteData(this.eo,e.length-this.eo);if(this._current===this.sc)(e=e.cloneNode(true)).deleteData(0,this.so)}}return e},remove:function(){var e=this._current,t,n;if(D.isCharacterDataNode(e)&&(e===this.sc||e===this.ec)){t=e===this.sc?this.so:0;n=e===this.ec?this.eo:e.length;t!=n&&e.deleteData(t,n-t)}else e.parentNode&&e.parentNode.removeChild(e)},isPartiallySelectedSubtree:function(){return t(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode){e=this.range.cloneRange();e.collapse()}else{e=new _(n(this.range));var t=this._current,r=t,i=0,s=t,o=D.getNodeLength(t);if(D.isAncestorOf(t,this.sc,true)){r=this.sc;i=this.so}if(D.isAncestorOf(t,this.ec,true)){s=this.ec;o=this.eo}M(e,r,i,s,o)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};d.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};d.prototype.toString=function(){return this.message};v.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var B=[1,3,4,5,7,8,10],j=[2,9,11],F=[1,3,4,5,7,8,10,11],I=[1,3,4,5,7,8],q=D.getRootContainer,R=m([9,11]),U=m([5,6,10,12]),z=m([6,10,12]),W=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],X=0,V=1,$=2,J=3,K=0,Q=1,G=2,Y=3;N.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){T(this);E(this.startContainer,t.startContainer);var n=e==J||e==X?"start":"end",r=e==V||e==X?"start":"end";return D.comparePoints(this[n+"Container"],this[n+"Offset"],t[r+"Container"],t[r+"Offset"])},insertNode:function(e){T(this);b(e,F);S(this.startContainer);if(D.isAncestorOf(e,this.startContainer,true))throw new H("HIERARCHY_REQUEST_ERR");this.setStartBefore(o(e,this.startContainer,this.startOffset))},cloneContents:function(){T(this);var e,t;if(this.collapsed)return n(this).createDocumentFragment();else{if(this.startContainer===this.endContainer&&D.isCharacterDataNode(this.startContainer)){e=this.startContainer.cloneNode(true);e.data=e.data.slice(this.startOffset,this.endOffset);t=n(this).createDocumentFragment();t.appendChild(e);return t}else{t=new p(this,true);e=u(t);t.detach()}return e}},canSurroundContents:function(){T(this);S(this.startContainer);S(this.endContainer);var e=new p(this,true),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);e.detach();return!n},surroundContents:function(e){b(e,I);if(!this.canSurroundContents())throw new d("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);o(e,this.startContainer,this.startOffset);e.appendChild(t);this.selectNode(e)},cloneRange:function(){T(this);for(var e=new _(n(this)),t=W.length,r;t--;){r=W[t];e[r]=this[r]}return e},toString:function(){T(this);var e=this.startContainer;if(e===this.endContainer&&D.isCharacterDataNode(e))return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):"";else{var t=[];e=new p(this,true);a(e,function(e){if(e.nodeType==3||e.nodeType==4)t.push(e.data)});e.detach();return t.join("")}},compareNode:function(e){T(this);var t=e.parentNode,n=D.getNodeIndex(e);if(!t)throw new H("NOT_FOUND_ERR");e=this.comparePoint(t,n);t=this.comparePoint(t,n+1);return e<0?t>0?G:K:t>0?Q:Y},comparePoint:function(e,t){T(this);x(e,"HIERARCHY_REQUEST_ERR");E(e,this.startContainer);if(D.comparePoints(e,t,this.startContainer,this.startOffset)<0)return-1;else if(D.comparePoints(e,t,this.endContainer,this.endOffset)>0)return 1;return 0},createContextualFragment:function(e){y(this);var t=n(this),r=t.createElement("div");r.innerHTML=e;for(e=t.createDocumentFragment();t=r.firstChild;)e.appendChild(t);return e},toHtml:function(){T(this);var e=n(this).createElement("div");e.appendChild(this.cloneContents());return e.innerHTML},intersectsNode:function(e,t){T(this);x(e,"NOT_FOUND_ERR");if(D.getDocument(e)!==n(this))return false;var r=e.parentNode,i=D.getNodeIndex(e);x(r,"NOT_FOUND_ERR");var s=D.comparePoints(r,i,this.endContainer,this.endOffset);r=D.comparePoints(r,i+1,this.startContainer,this.startOffset);return t?s<=0&&r>=0:s<0&&r>0},isPointInRange:function(e,t){T(this);x(e,"HIERARCHY_REQUEST_ERR");E(e,this.startContainer);return D.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&D.comparePoints(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e,t){T(this);if(n(e)!=n(this))throw new H("WRONG_DOCUMENT_ERR");var r=D.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),i=D.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?r<=0&&i>=0:r<0&&i>0},intersection:function(e){if(this.intersectsRange(e)){var t=D.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=D.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();t==-1&&r.setStart(e.startContainer,e.startOffset);n==1&&r.setEnd(e.endContainer,e.endOffset);return r}return null},union:function(e){if(this.intersectsRange(e,true)){var t=this.cloneRange();D.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset);D.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1&&t.setEnd(e.endContainer,e.endOffset);return t}else throw new d("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,false):this.compareNode(e)==Y},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,D.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);e=n.pop();t.setEnd(e,e.length);e=this.containsRange(t);t.detach();return e}else return this.containsNodeContents(e)},createNodeIterator:function(e,t){T(this);return new v(this,e,t)},getNodes:function(e,t){T(this);return c(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){y(this);this.setEndBefore(e);this.collapse(false)},collapseAfter:function(e){y(this);this.setStartAfter(e);this.collapse(true)},getName:function(){return"DomRange"},equals:function(e){return _.rangesEqual(this,e)},inspect:function(){return h(this)}};A(_,M,function(e){y(e);e.startContainer=e.startOffset=e.endContainer=e.endOffset=null;e.collapsed=e.commonAncestorContainer=null;r(e,"detach",null);e._listeners=null});e.rangePrototype=N.prototype;_.rangeProperties=W;_.RangeIterator=p;_.copyComparisonConstants=k;_.createPrototypeRange=A;_.inspect=h;_.getRangeDocument=n;_.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset};e.DomRange=_;e.RangeException=d});t.createModule("WrappedRange",function(t){function n(t,n,r,i){var u=t.duplicate();u.collapse(r);var a=u.parentElement();s.isAncestorOf(n,a,true)||(a=n);if(!a.canHaveHTML)return new o(a.parentNode,s.getNodeIndex(a));n=s.getDocument(a).createElement(e);var f,l=r?"StartToStart":"StartToEnd";do{a.insertBefore(n,n.previousSibling);u.moveToElementText(n)}while((f=u.compareEndPoints(l,t))>0&&n.previousSibling);l=n.nextSibling;if(f==-1&&l&&s.isCharacterDataNode(l)){u.setEndPoint(r?"EndToStart":"EndToEnd",t);if(/[\r\n]/.test(l.data)){a=u.duplicate();r=a.text.replace(/\r\n/g,"\r").length;for(r=a.moveStart("character",r);a.compareEndPoints("StartToEnd",a)==-1;){r++;a.moveStart("character",1)}}else r=u.text.length;a=new o(l,r)}else{l=(i||!r)&&n.previousSibling;a=(r=(i||r)&&n.nextSibling)&&s.isCharacterDataNode(r)?new o(r,0):l&&s.isCharacterDataNode(l)?new o(l,l.length):new o(a,s.getNodeIndex(n))}n.parentNode.removeChild(n);return a}function r(t,n){var r,i,o=t.offset,u=s.getDocument(t.node),a=u.body.createTextRange(),f=s.isCharacterDataNode(t.node);if(f){r=t.node;i=r.parentNode}else{r=t.node.childNodes;r=o<r.length?r[o]:null;i=t.node}u=u.createElement(e);u.innerHTML="&#feff;";r?i.insertBefore(u,r):i.appendChild(u);a.moveToElementText(u);a.collapse(!n);i.removeChild(u);if(f)a[n?"moveStart":"moveEnd"]("character",o);return a}t.requireModules(["DomUtil","DomRange"]);var i,s=t.dom,o=s.DomPosition,u=t.DomRange;if(t.features.implementsDomRange&&(!t.features.implementsTextRange||!t.config.preferTextRange)){(function(){function e(e){for(var t=n.length,r;t--;){r=n[t];e[r]=e.nativeRange[r]}}var t,n=u.rangeProperties,r,o;i=function(t){if(!t)throw Error("Range must be specified");this.nativeRange=t;e(this)};u.createPrototypeRange(i,function(e,t,n,r,i){var s=e.endContainer!==r||e.endOffset!=i;if(e.startContainer!==t||e.startOffset!=n||s){e.setEnd(r,i);e.setStart(t,n)}},function(e){e.nativeRange.detach();e.detached=true;for(var t=n.length,r;t--;){r=n[t];e[r]=null}});t=i.prototype;t.selectNode=function(t){this.nativeRange.selectNode(t);e(this)};t.deleteContents=function(){this.nativeRange.deleteContents();e(this)};t.extractContents=function(){var t=this.nativeRange.extractContents();e(this);return t};t.cloneContents=function(){return this.nativeRange.cloneContents()};t.surroundContents=function(t){this.nativeRange.surroundContents(t);e(this)};t.collapse=function(t){this.nativeRange.collapse(t);e(this)};t.cloneRange=function(){return new i(this.nativeRange.cloneRange())};t.refresh=function(){e(this)};t.toString=function(){return this.nativeRange.toString()};var a=document.createTextNode("test");s.getBody(document).appendChild(a);var f=document.createRange();f.setStart(a,0);f.setEnd(a,0);try{f.setStart(a,1);r=true;t.setStart=function(t,n){this.nativeRange.setStart(t,n);e(this)};t.setEnd=function(t,n){this.nativeRange.setEnd(t,n);e(this)};o=function(t){return function(n){this.nativeRange[t](n);e(this)}}}catch(l){r=false;t.setStart=function(t,n){try{this.nativeRange.setStart(t,n)}catch(r){this.nativeRange.setEnd(t,n);this.nativeRange.setStart(t,n)}e(this)};t.setEnd=function(t,n){try{this.nativeRange.setEnd(t,n)}catch(r){this.nativeRange.setStart(t,n);this.nativeRange.setEnd(t,n)}e(this)};o=function(t,n){return function(r){try{this.nativeRange[t](r)}catch(i){this.nativeRange[n](r);this.nativeRange[t](r)}e(this)}}}t.setStartBefore=o("setStartBefore","setEndBefore");t.setStartAfter=o("setStartAfter","setEndAfter");t.setEndBefore=o("setEndBefore","setStartBefore");t.setEndAfter=o("setEndAfter","setStartAfter");f.selectNodeContents(a);t.selectNodeContents=f.startContainer==a&&f.endContainer==a&&f.startOffset==0&&f.endOffset==a.length?function(t){this.nativeRange.selectNodeContents(t);e(this)}:function(e){this.setStart(e,0);this.setEnd(e,u.getEndOffset(e))};f.selectNodeContents(a);f.setEnd(a,3);r=document.createRange();r.selectNodeContents(a);r.setEnd(a,4);r.setStart(a,2);t.compareBoundaryPoints=f.compareBoundaryPoints(f.START_TO_END,r)==-1&f.compareBoundaryPoints(f.END_TO_START,r)==1?function(e,t){t=t.nativeRange||t;if(e==t.START_TO_END)e=t.END_TO_START;else if(e==t.END_TO_START)e=t.START_TO_END;return this.nativeRange.compareBoundaryPoints(e,t)}:function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};s.getBody(document).removeChild(a);f.detach();r.detach()})();t.createNativeRange=function(e){e=e||document;return e.createRange()}}else if(t.features.implementsTextRange){i=function(e){this.textRange=e;this.refresh()};i.prototype=new u(document);i.prototype.refresh=function(){var e,t,r=this.textRange;e=r.parentElement();var i=r.duplicate();i.collapse(true);t=i.parentElement();i=r.duplicate();i.collapse(false);r=i.parentElement();t=t==r?t:s.getCommonAncestor(t,r);t=t==e?t:s.getCommonAncestor(e,t);if(this.textRange.compareEndPoints("StartToEnd",this.textRange)==0)t=e=n(this.textRange,t,true,true);else{e=n(this.textRange,t,true,false);t=n(this.textRange,t,false,false)}this.setStart(e.node,e.offset);this.setEnd(t.node,t.offset)};i.rangeToTextRange=function(e){if(e.collapsed)return r(new o(e.startContainer,e.startOffset),true);else{var t=r(new o(e.startContainer,e.startOffset),true),n=r(new o(e.endContainer,e.endOffset),false);e=s.getDocument(e.startContainer).body.createTextRange();e.setEndPoint("StartToStart",t);e.setEndPoint("EndToEnd",n);return e}};u.copyComparisonConstants(i);var a=function(){return this}();if(typeof a.Range=="undefined")a.Range=i;t.createNativeRange=function(e){e=e||document;return e.body.createTextRange()}}i.prototype.getName=function(){return"WrappedRange"};t.WrappedRange=i;t.createRange=function(e){e=e||document;return new i(t.createNativeRange(e))};t.createRangyRange=function(e){e=e||document;return new u(e)};t.createIframeRange=function(e){return t.createRange(s.getIframeDocument(e))};t.createIframeRangyRange=function(e){return t.createRangyRange(s.getIframeDocument(e))};t.addCreateMissingNativeApiListener(function(e){e=e.document;if(typeof e.createRange=="undefined")e.createRange=function(){return t.createRange(this)};e=e=null})});t.createModule("WrappedSelection",function(e,t){function n(e){return(e||window).getSelection()}function r(e){return(e||window).document.selection}function i(e,t,n){var r=n?"end":"start";n=n?"start":"end";e.anchorNode=t[r+"Container"];e.anchorOffset=t[r+"Offset"];e.focusNode=t[n+"Container"];e.focusOffset=t[n+"Offset"]}function s(e){e.anchorNode=e.focusNode=null;e.anchorOffset=e.focusOffset=0;e.rangeCount=0;e.isCollapsed=true;e._ranges.length=0}function o(t){var n;if(t instanceof g){n=t._selectionNativeRange;if(!n){n=e.createNativeRange(v.getDocument(t.startContainer));n.setEnd(t.endContainer,t.endOffset);n.setStart(t.startContainer,t.startOffset);t._selectionNativeRange=n;t.attachListener("detach",function(){this._selectionNativeRange=null})}}else if(t instanceof y)n=t.nativeRange;else if(e.features.implementsDomRange&&t instanceof v.getWindow(t.startContainer).Range)n=t;return n}function u(e){var t=e.getNodes(),n;e:if(!t.length||t[0].nodeType!=1)n=false;else{n=1;for(var r=t.length;n<r;++n)if(!v.isAncestorOf(t[0],t[n])){n=false;break e}n=true}if(!n)throw Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function a(e,t){var n=new y(t);e._ranges=[n];i(e,n,false);e.rangeCount=1;e.isCollapsed=n.collapsed}function f(t){t._ranges.length=0;if(t.docSelection.type=="None")s(t);else{var n=t.docSelection.createRange();if(n&&typeof n.text!="undefined")a(t,n);else{t.rangeCount=n.length;for(var r,o=v.getDocument(n.item(0)),u=0;u<t.rangeCount;++u){r=e.createRange(o);r.selectNode(n.item(u));t._ranges.push(r)}t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed;i(t,t._ranges[t.rangeCount-1],false)}}}function l(e,t){var n=e.docSelection.createRange(),r=u(t),i=v.getDocument(n.item(0));i=v.getBody(i).createControlRange();for(var s=0,o=n.length;s<o;++s)i.add(n.item(s));try{i.add(r)}catch(a){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select();f(e)}function c(e,t,n){this.nativeSelection=e;this.docSelection=t;this._ranges=[];this.win=n;this.refresh()}function h(e,t){var n=v.getDocument(t[0].startContainer);n=v.getBody(n).createControlRange();for(var r=0,i;r<rangeCount;++r){i=u(t[r]);try{n.add(i)}catch(s){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}n.select();f(e)}function p(e,t){if(e.anchorNode&&v.getDocument(e.anchorNode)!==v.getDocument(t))throw new b("WRONG_DOCUMENT_ERR")}function d(e){var t=[],n=new w(e.anchorNode,e.anchorOffset),r=new w(e.focusNode,e.focusOffset),i=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined")for(var s=0,o=e.rangeCount;s<o;++s)t[s]=g.inspect(e.getRangeAt(s));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]);e.config.checkSelectionRanges=true;var v=e.dom,m=e.util,g=e.DomRange,y=e.WrappedRange,b=e.DOMException,w=v.DomPosition,E,S,x=e.util.isHostMethod(window,"getSelection"),T=e.util.isHostObject(document,"selection"),N=T&&(!x||e.config.preferTextRange);if(N){E=r;e.isSelectionValid=function(e){e=(e||window).document;var t=e.selection;return t.type!="None"||v.getDocument(t.createRange().parentElement())==e}}else if(x){E=n;e.isSelectionValid=function(){return true}}else t.fail("Neither document.selection or window.getSelection() detected.");e.getNativeSelection=E;x=E();var C=e.createNativeRange(document),k=v.getBody(document),L=m.areHostObjects(x,m.areHostProperties(x,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=L;var A=m.isHostMethod(x,"extend");e.features.selectionHasExtend=A;var O=typeof x.rangeCount=="number";e.features.selectionHasRangeCount=O;var M=false,_=true;m.areHostMethods(x,["addRange","getRangeAt","removeAllRanges"])&&typeof x.rangeCount=="number"&&e.features.implementsDomRange&&function(){var e=document.createElement("iframe");k.appendChild(e);var t=v.getIframeDocument(e);t.open();t.write("<html><head></head><body>12</body></html>");t.close();var n=v.getIframeWindow(e).getSelection(),r=t.documentElement.lastChild.firstChild;t=t.createRange();t.setStart(r,1);t.collapse(true);n.addRange(t);_=n.rangeCount==1;n.removeAllRanges();var i=t.cloneRange();t.setStart(r,0);i.setEnd(r,2);n.addRange(t);n.addRange(i);M=n.rangeCount==2;t.detach();i.detach();k.removeChild(e)}();e.features.selectionSupportsMultipleRanges=M;e.features.collapsedNonEditableSelectionsSupported=_;var D=false,P;if(k&&m.isHostMethod(k,"createControlRange")){P=k.createControlRange();if(m.areHostProperties(P,["item","add"]))D=true}e.features.implementsControlRange=D;S=L?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:false};var H;if(m.isHostMethod(x,"getRangeAt"))H=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}};else if(L)H=function(t){var n=v.getDocument(t.anchorNode);n=e.createRange(n);n.setStart(t.anchorNode,t.anchorOffset);n.setEnd(t.focusNode,t.focusOffset);if(n.collapsed!==this.isCollapsed){n.setStart(t.focusNode,t.focusOffset);n.setEnd(t.anchorNode,t.anchorOffset)}return n};e.getSelection=function(e){e=e||window;var t=e._rangySelection,n=E(e),i=T?r(e):null;if(t){t.nativeSelection=n;t.docSelection=i;t.refresh(e)}else{t=new c(n,i,e);e._rangySelection=t}return t};e.getIframeSelection=function(t){return e.getSelection(v.getIframeWindow(t))};P=c.prototype;if(!N&&L&&m.areHostMethods(x,["removeAllRanges","addRange"])){P.removeAllRanges=function(){this.nativeSelection.removeAllRanges();s(this)};var B=function(t,n){var r=g.getRangeDocument(n);r=e.createRange(r);r.collapseToPoint(n.endContainer,n.endOffset);t.nativeSelection.addRange(o(r));t.nativeSelection.extend(n.startContainer,n.startOffset);t.refresh()};P.addRange=O?function(t,n){if(D&&T&&this.docSelection.type=="Control")l(this,t);else if(n&&A)B(this,t);else{var r;if(M)r=this.rangeCount;else{this.removeAllRanges();r=0}this.nativeSelection.addRange(o(t));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==r+1){if(e.config.checkSelectionRanges)if((r=H(this.nativeSelection,this.rangeCount-1))&&!g.rangesEqual(r,t))t=new y(r);this._ranges[this.rangeCount-1]=t;i(this,t,I(this.nativeSelection));this.isCollapsed=S(this)}else this.refresh()}}:function(e,t){if(t&&A)B(this,e);else{this.nativeSelection.addRange(o(e));this.refresh()}};P.setRanges=function(e){if(D&&e.length>1)h(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else if(m.isHostMethod(x,"empty")&&m.isHostMethod(C,"select")&&D&&N){P.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var e;if(this.anchorNode)e=v.getDocument(this.anchorNode);else if(this.docSelection.type=="Control"){var t=this.docSelection.createRange();if(t.length)e=v.getDocument(t.item(0)).body.createTextRange()}if(e){e.body.createTextRange().select();this.docSelection.empty()}}}catch(n){}s(this)};P.addRange=function(e){if(this.docSelection.type=="Control")l(this,e);else{y.rangeToTextRange(e).select();this._ranges[0]=e;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;i(this,e,false)}};P.setRanges=function(e){this.removeAllRanges();var t=e.length;if(t>1)h(this,e);else t&&this.addRange(e[0])}}else{t.fail("No means of selecting a Range or TextRange was found");return false}P.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new b("INDEX_SIZE_ERR");else return this._ranges[e]};var j;if(N)j=function(t){var n;if(e.isSelectionValid(t.win))n=t.docSelection.createRange();else{n=v.getBody(t.win.document).createTextRange();n.collapse(true)}if(t.docSelection.type=="Control")f(t);else n&&typeof n.text!="undefined"?a(t,n):s(t)};else if(m.isHostMethod(x,"getRangeAt")&&typeof x.rangeCount=="number")j=function(t){if(D&&T&&t.docSelection.type=="Control")f(t);else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));i(t,t._ranges[t.rangeCount-1],I(t.nativeSelection));t.isCollapsed=S(t)}else s(t)}};else if(L&&typeof x.isCollapsed=="boolean"&&typeof C.collapsed=="boolean"&&e.features.implementsDomRange)j=function(e){var t;t=e.nativeSelection;if(t.anchorNode){t=H(t,0);e._ranges=[t];e.rangeCount=1;t=e.nativeSelection;e.anchorNode=t.anchorNode;e.anchorOffset=t.anchorOffset;e.focusNode=t.focusNode;e.focusOffset=t.focusOffset;e.isCollapsed=S(e)}else s(e)};else{t.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}P.refresh=function(e){var t=e?this._ranges.slice(0):null;j(this);if(e){e=t.length;if(e!=this._ranges.length)return false;for(;e--;)if(!g.rangesEqual(t[e],this._ranges[e]))return false;return true}};var F=function(e,t){var n=e.getAllRanges(),r=false;e.removeAllRanges();for(var i=0,o=n.length;i<o;++i)if(r||t!==n[i])e.addRange(n[i]);else r=true;e.rangeCount||s(e)};P.removeRange=D?function(e){if(this.docSelection.type=="Control"){var t=this.docSelection.createRange();e=u(e);var n=v.getDocument(t.item(0));n=v.getBody(n).createControlRange();for(var r,i=false,s=0,o=t.length;s<o;++s){r=t.item(s);if(r!==e||i)n.add(t.item(s));else i=true}n.select();f(this)}else F(this,e)}:function(e){F(this,e)};var I;if(!N&&L&&e.features.implementsDomRange){I=function(e){var t=false;if(e.anchorNode)t=v.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1;return t};P.isBackwards=function(){return I(this)}}else I=P.isBackwards=function(){return false};P.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")};P.collapse=function(t,n){p(this,t);var r=e.createRange(v.getDocument(t));r.collapseToPoint(t,n);this.removeAllRanges();this.addRange(r);this.isCollapsed=true};P.collapseToStart=function(){if(this.rangeCount){var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)}else throw new b("INVALID_STATE_ERR")};P.collapseToEnd=function(){if(this.rangeCount){var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)}else throw new b("INVALID_STATE_ERR")};P.selectAllChildren=function(t){p(this,t);var n=e.createRange(v.getDocument(t));n.selectNodeContents(t);this.removeAllRanges();this.addRange(n)};P.deleteFromDocument=function(){if(D&&T&&this.docSelection.type=="Control"){for(var e=this.docSelection.createRange(),t;e.length;){t=e.item(0);e.remove(t);t.parentNode.removeChild(t)}this.refresh()}else if(this.rangeCount){e=this.getAllRanges();this.removeAllRanges();t=0;for(var n=e.length;t<n;++t)e[t].deleteContents();this.addRange(e[n-1])}};P.getAllRanges=function(){return this._ranges.slice(0)};P.setSingleRange=function(e){this.setRanges([e])};P.containsNode=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(this._ranges[n].containsNode(e,t))return true;return false};P.toHtml=function(){var e="";if(this.rangeCount){e=g.getRangeDocument(this._ranges[0]).createElement("div");for(var t=0,n=this._ranges.length;t<n;++t)e.appendChild(this._ranges[t].cloneContents());e=e.innerHTML}return e};P.getName=function(){return"WrappedSelection"};P.inspect=function(){return d(this)};P.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};c.inspect=d;e.Selection=c;e.selectionPrototype=P;e.addCreateMissingNativeApiListener(function(t){if(typeof t.getSelection=="undefined")t.getSelection=function(){return e.getSelection(this)};t=null})});t.createModule("CssClassApplier",function(t){function n(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(e,t){return e.className&&RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e.className)}function i(e,t){if(e.className)r(e,t)||(e.className+=" "+t);else e.className=t}function s(e){return e.className.split(/\s+/).sort().join(" ")}function o(e,t){return s(e)==s(t)}function u(e){for(var t=e.parentNode;e.hasChildNodes();)t.insertBefore(e.firstChild,e);t.removeChild(e)}function a(e,t){var n=e.cloneRange();n.selectNodeContents(t);var r=n.intersection(e);r=r?r.toString():"";n.detach();return r!=""}function f(e,t){if(e.attributes.length!=t.attributes.length)return false;for(var n=0,r=e.attributes.length,i,s;n<r;++n){i=e.attributes[n];s=i.name;if(s!="class"){s=t.attributes.getNamedItem(s);if(i.specified!=s.specified)return false;if(i.specified&&i.nodeValue!==s.nodeValue)return false}}return true}function l(e){for(var t=0,n=e.attributes.length;t<n;++t)if(e.attributes[t].specified&&e.attributes[t].name!="class")return true;return false}function c(e,t){if(m.isCharacterDataNode(e))return t==0?!!e.previousSibling:t==e.length?!!e.nextSibling:true;return t>0&&t<e.childNodes.length}function h(e,t,n){var r;if(m.isCharacterDataNode(t))if(n==0){n=m.getNodeIndex(t);t=t.parentNode}else if(n==t.length){n=m.getNodeIndex(t)+1;t=t.parentNode}else r=m.splitDataNode(t,n);if(!r){r=t.cloneNode(false);r.id&&r.removeAttribute("id");for(var i;i=t.childNodes[n];)r.appendChild(i);m.insertAfter(r,t)}return t==e?r:h(e,r.parentNode,m.getNodeIndex(r))}function p(e,t){var n=e.nodeType==3,r=n?e.parentNode:e,i=t?"nextSibling":"previousSibling";if(n){if((n=e[i])&&n.nodeType==3)return n}else if((n=r[i])&&e.tagName==n.tagName&&o(e,n)&&f(e,n))return n[t?"firstChild":"lastChild"];return null}function d(e){this.firstTextNode=(this.isElementMerge=e.nodeType==1)?e.lastChild:e;if(this.isElementMerge)this.sortedCssClasses=s(e);this.textNodes=[this.firstTextNode]}function v(e,t,r){this.cssClass=e;this.normalize=t;this.applyToAnytagBody=false;e=typeof r;if(e=="string")if(r=="*")this.applyToAnytagBody=true;else this.tagNames=n(r.toLowerCase()).split(/\s*,\s*/);else if(e=="object"&&typeof r.length=="number"){this.tagNames=[];e=0;for(t=r.length;e<t;++e)if(r[e]=="*")this.applyToAnytagBody=true;else this.tagNames.push(r[e].toLowerCase())}else this.tagNames=[g]}t.requireModules(["WrappedSelection","WrappedRange"]);var m=t.dom,g=e,y=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){if(t.className)t.className=t.className.replace(RegExp("(?:^|\\s)"+n+"(?:\\s|$)"),e)}}();d.prototype={doMerge:function(){for(var e=[],t,n,r=0,i=this.textNodes.length;r<i;++r){t=this.textNodes[r];n=t.parentNode;e[r]=t.data;if(r){n.removeChild(t);n.hasChildNodes()||n.parentNode.removeChild(n)}}return this.firstTextNode.data=e=e.join("")},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;t<n;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}};v.prototype={appliesToElement:function(e){return this.applyToAnytagBody||m.arrayContains(this.tagNames,e.tagName.toLowerCase())},getAncestorWithClass:function(e){for(e=e.parentNode;e;){if(e.nodeType==1&&this.appliesToElement(e)&&r(e,this.cssClass))return e;e=e.parentNode}return false},postApply:function(e,t){for(var n=e[0],r=e[e.length-1],i=[],s,o=n,u=r,a=0,f=r.length,l,c,h=0,v=e.length;h<v;++h){l=e[h];if(c=p(l,false)){if(!s){s=new d(c);i.push(s)}s.textNodes.push(l);if(l===n){o=s.firstTextNode;a=o.length}if(l===r){u=s.firstTextNode;f=s.getLength()}}else s=null}if(n=p(r,true)){if(!s){s=new d(r);i.push(s)}s.textNodes.push(n)}if(i.length){h=0;for(v=i.length;h<v;++h)i[h].doMerge();t.setStart(o,a);t.setEnd(u,f)}},createContainer:function(e){e=e.createElement(g);e.className=this.cssClass;return e},applyToTextNode:function(e){var t=e.parentNode;if(t.childNodes.length==1&&this.appliesToElement(t))i(t,this.cssClass);else{t=this.createContainer(m.getDocument(e));e.parentNode.insertBefore(t,e);t.appendChild(e)}},isRemovable:function(e){return e.tagName.toLowerCase()==g&&n(e.className)==this.cssClass&&!l(e)},undoToTextNode:function(e,t,n){if(!t.containsNode(n)){e=t.cloneRange();e.selectNode(n);if(e.isPointInRange(t.endContainer,t.endOffset)&&c(t.endContainer,t.endOffset)){h(n,t.endContainer,t.endOffset);t.setEndAfter(n)}if(e.isPointInRange(t.startContainer,t.startOffset)&&c(t.startContainer,t.startOffset))n=h(n,t.startContainer,t.startOffset)}this.isRemovable(n)?u(n):y(n,this.cssClass)},applyToRange:function(e){e.splitBoundaries();var t=e.getNodes([3],function(t){return a(e,t)});if(t.length){for(var n,r=0,i=t.length;r<i;++r){n=t[r];this.getAncestorWithClass(n)||this.applyToTextNode(n)}e.setStart(t[0],0);n=t[t.length-1];e.setEnd(n,n.length);this.normalize&&this.postApply(t,e)}},applyToSelection:function(e){e=e||window;e=t.getSelection(e);var n,r=e.getAllRanges();e.removeAllRanges();for(var i=r.length;i--;){n=r[i];this.applyToRange(n);e.addRange(n)}},undoToRange:function(e){e.splitBoundaries();var t=e.getNodes([3]),n,r,i=t[t.length-1];if(t.length){for(var s=0,o=t.length;s<o;++s){n=t[s];(r=this.getAncestorWithClass(n))&&this.undoToTextNode(n,e,r);e.setStart(t[0],0);e.setEnd(i,i.length)}this.normalize&&this.postApply(t,e)}},undoToSelection:function(e){e=e||window;e=t.getSelection(e);var n=e.getAllRanges(),r;e.removeAllRanges();for(var i=0,s=n.length;i<s;++i){r=n[i];this.undoToRange(r);e.addRange(r)}},isAppliedToRange:function(e){for(var t=e.getNodes([3]),n=0,r=t.length;n<r;++n)if(a(e,t[n])&&!this.getAncestorWithClass(t[n]))return false;return true},isAppliedToSelection:function(e){e=e||window;e=t.getSelection(e).getAllRanges();for(var n=e.length;n--;)if(!this.isAppliedToRange(e[n]))return false;return true},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},detach:function(){}};v.util={hasClass:r,addClass:i,removeClass:y,hasSameClasses:o,replaceWithOwnChildren:u,elementsHaveSameNonClassAttributes:f,elementHasNonClassAttributes:l,splitNodeAt:h};t.CssClassApplier=v;t.createCssClassApplier=function(e,t,n){return new v(e,t,n)}});t.createModule("SaveRestore",function(t,n){function r(t,n){var r="selectionBoundary_"+ +(new Date)+"_"+(""+Math.random()).slice(2),i,s=u.getDocument(t.startContainer),o=t.cloneRange();o.collapse(n);i=s.createElement(e);i.id=r;i.style.lineHeight="0";i.style.display="none";i.appendChild(s.createTextNode(a));o.insertNode(i);o.detach();return i}function i(e,t,r,i){if(e=(e||document).getElementById(r)){t[i?"setStartBefore":"setEndBefore"](e);e.parentNode.removeChild(e)}else n.warn("Marker element has been removed. Cannot restore selection.")}function s(e,t){return t.compareBoundaryPoints(e.START_TO_START,e)}function o(e,t){var n=(e||document).getElementById(t);n&&n.parentNode.removeChild(n)}t.requireModules(["DomUtil","DomRange","WrappedRange"]);var u=t.dom,a="";t.saveSelection=function(e){e=e||window;var i=e.document;if(t.isSelectionValid(e)){var o=t.getSelection(e),u=o.getAllRanges(),a=[],f,l;u.sort(s);for(var c=0,p=u.length;c<p;++c){f=u[c];if(f.collapsed){l=r(f,false);a.push({markerId:l.id,collapsed:true})}else{l=r(f,false);f=r(f,true);a[c]={startMarkerId:f.id,endMarkerId:l.id,collapsed:false,backwards:u.length==1&&o.isBackwards()}}}for(c=p-1;c>=0;--c){f=u[c];if(f.collapsed)f.collapseBefore((i||document).getElementById(a[c].markerId));else{f.setEndBefore((i||document).getElementById(a[c].endMarkerId));f.setStartAfter((i||document).getElementById(a[c].startMarkerId))}}o.setRanges(u);return{win:e,doc:i,rangeInfos:a,restored:false}}else n.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.")};t.restoreSelection=function(e,r){if(!e.restored){for(var s=e.rangeInfos,o=t.getSelection(e.win),u=[],a=s.length,f=a-1,l,c;f>=0;--f){l=s[f];c=t.createRange(e.doc);if(l.collapsed)if(l=(e.doc||document).getElementById(l.markerId)){l.style.display="inline";var p=l.previousSibling;if(p&&p.nodeType==3){l.parentNode.removeChild(l);c.collapseToPoint(p,p.length)}else{c.collapseBefore(l);l.parentNode.removeChild(l)}}else n.warn("Marker element has been removed. Cannot restore selection.");else{i(e.doc,c,l.startMarkerId,true);i(e.doc,c,l.endMarkerId,false)}a==1&&c.normalizeBoundaries();u[f]=c}if(a==1&&r&&t.features.selectionHasExtend&&s[0].backwards){o.removeAllRanges();o.addRange(u[0],true)}else o.setRanges(u);e.restored=true}};t.removeMarkerElement=o;t.removeMarkers=function(e){for(var t=e.rangeInfos,n=0,r=t.length,i;n<r;++n){i=t[n];if(i.collapsed)o(e.doc,i.markerId);else{o(e.doc,i.startMarkerId);o(e.doc,i.endMarkerId)}}}});t.createModule("Serializer",function(e,n){function r(e,t){t=t||[];var n=e.nodeType,i=e.childNodes,s=i.length,o=[n,e.nodeName,s].join(":"),u="",a="";switch(n){case 3:u=e.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");break;case 8:u="<!--"+e.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"-->";break;default:u="<"+o+">";a="</>";break}u&&t.push(u);for(n=0;n<s;++n)r(i[n],t);a&&t.push(a);return t}function i(e){e=r(e).join("");return h(e).toString(16)}function s(e,t,n){var r=[],i=e;for(n=n||p.getDocument(e).documentElement;i&&i!=n;){r.push(p.getNodeIndex(i,true));i=i.parentNode}return r.join("/")+":"+t}function o(e,t,r){if(t)r||p.getDocument(t);else{r=r||document;t=r.documentElement}e=e.split(":");t=t;r=e[0]?e[0].split("/"):[];for(var i=r.length,s;i--;){s=parseInt(r[i],10);if(s<t.childNodes.length)t=t.childNodes[parseInt(r[i],10)];else throw n.createError("deserializePosition failed: node "+p.inspectNode(t)+" has no child with index "+s+", "+i)}return new p.DomPosition(t,parseInt(e[1],10))}function u(t,n,r){r=r||e.DomRange.getRangeDocument(t).documentElement;if(!p.isAncestorOf(r,t.commonAncestorContainer,true))throw Error("serializeRange: range is not wholly contained within specified root node");t=s(t.startContainer,t.startOffset,r)+","+s(t.endContainer,t.endOffset,r);n||(t+="{"+i(r)+"}");return t}function a(t,n,r){if(n)r=r||p.getDocument(n);else{r=r||document;n=r.documentElement}t=/^([^,]+),([^,\{]+)({([^}]+)})?$/.exec(t);var s=t[4],u=i(n);if(s&&s!==i(n))throw Error("deserializeRange: checksums of serialized range root node ("+s+") and target root node ("+u+") do not match");s=o(t[1],n,r);n=o(t[2],n,r);r=e.createRange(r);r.setStart(s.node,s.offset);r.setEnd(n.node,n.offset);return r}function f(e,t,n){if(t)n||p.getDocument(t);else{n=n||document;t=n.documentElement}e=/^([^,]+),([^,]+)({([^}]+)})?$/.exec(e)[3];return!e||e===i(t)}function l(e,n,r){e=e||t.getSelection();e=e.getAllRanges();for(var i=[],s=0,o=e.length;s<o;++s)i[s]=u(e[s],n,r);return i.join("|")}function c(t,n,r){if(n)r=r||p.getWindow(n);else{r=r||window;n=r.document.documentElement}t=t.split("|");for(var i=e.getSelection(r),s=[],o=0,u=t.length;o<u;++o)s[o]=a(t[o],n,r.document);i.setRanges(s);return i}e.requireModules(["WrappedSelection","WrappedRange"]);if(typeof encodeURIComponent=="undefined"||typeof decodeURIComponent=="undefined")n.fail("Global object is missing encodeURIComponent and/or decodeURIComponent method");var h=function(){var e=null;return function(t){for(var n=[],r=0,i=t.length,s;r<i;++r){s=t.charCodeAt(r);if(s<128)n.push(s);else s<2048?n.push(s>>6|192,s&63|128):n.push(s>>12|224,s>>6&63|128,s&63|128)}t=-1;if(!e){r=[];i=0;for(var o;i<256;++i){o=i;for(s=8;s--;)if((o&1)==1)o=o>>>1^3988292384;else o>>>=1;r[i]=o>>>0}e=r}r=e;i=0;for(s=n.length;i<s;++i){o=(t^n[i])&255;t=t>>>8^r[o]}return(t^-1)>>>0}}(),p=e.dom;e.serializePosition=s;e.deserializePosition=o;e.serializeRange=u;e.deserializeRange=a;e.canDeserializeRange=f;e.serializeSelection=l;e.deserializeSelection=c;e.canDeserializeSelection=function(e,t,n){var r;if(t)r=n?n.document:p.getDocument(t);else{n=n||window;t=n.document.documentElement}e=e.split("|");n=0;for(var i=e.length;n<i;++n)if(!f(e[n],t,r))return false;return true};e.restoreSelectionFromCookie=function(e){e=e||window;var t;e:{t=e.document.cookie.split(/[;,]/);for(var n=0,r=t.length,i;n<r;++n){i=t[n].split("=");if(i[0].replace(/^\s+/,"")=="rangySerializedSelection")if(i=i[1]){t=decodeURIComponent(i.replace(/\s+$/,""));break e}}t=null}t&&c(t,e.doc)};e.saveSelectionCookie=function(e,n){e=e||window;n=typeof n=="object"?n:{};var r=n.expires?";expires="+n.expires.toUTCString():"",i=n.path?";path="+n.path:"",s=n.domain?";domain="+n.domain:"",o=n.secure?";secure":"",u=l(t.getSelection(e));e.document.cookie=encodeURIComponent("rangySerializedSelection")+"="+encodeURIComponent(u)+r+i+s+o};e.getElementChecksum=i});return t}var rangy=plugin_rangy();window.rangy=rangy;rangy.init();plugin_jquery_log($R);plugin_jquery_hasAttr($R);plugin_jquery_json($R);plugin_jquery_cookie($R);plugin_jquery_postMessage($R);plugin_jquery_mustache($R);plugin_jquery_enhancedOffset($R);plugin_jquery_drags($R);plugin_jquery_mousewheel($R);plugin_jquery_isotope($R);plugin_jquery_jScrollPane($R);plugin_jquery_twitterTip($R);plugin_jquery_rdrWidgetSummary($R);plugin_jquery_selectionographer($R,rangy);$R.expr[":"].parents=function(e,t,n){return $R(e).parents(n[3]).length<1}}var $=$R;var css=[];if(!$R.browser.msie||$R.browser.msie&&parseInt($R.browser.version,10)>8){css.push(RDR_staticUrl+"css/fonts/helvetica.css");css.push(RDR_staticUrl+"css/fonts/fontawesome.css")}if($R.browser.msie){css.push(RDR_staticUrl+"widget/css/ie.css");css.push(RDR_staticUrl+"widget/css/ie"+parseInt($R.browser.version,10)+".css")}css.push(RDR_widgetCssStaticUrl+"widget/css/widget.css?rv21");css.push(RDR_staticUrl+"widget/css/jquery.jscrollpane.css");loadCSS(css);initCommonUtils($R);initPlugins($R);readrBoard($R);RDR.actions.init();if(RDR_offline){RDR.debug()}}var RDR={};if(window.READRBOARDCOM&&window.READRBOARDCOM.hasLoaded){window.READRBOARDCOM.actions.reInit();return}window.READRBOARDCOM=window.readrboard=RDR;RDR.hasLoaded=true;RDR.C={rindowHeaderPadding:29,rindowWidthForKindIsText:200,rindowAnimationSpeed:333,indicatorOpacity:.4,helperIndicators:{hoverDelay:250,fadeInTime:300,opacity:.6}};RDR.engageScript=document.getElementById("readrboardscript")||findEngageScript();RDR.engageScriptSrc=RDR.engageScript.src;var $RDR,$R,RDR_scriptPaths={},RDR_offline=!!(RDR.engageScriptSrc.indexOf("local.readrboard.com")!=-1||RDR.engageScriptSrc.indexOf("local.readrboard2.com")!=-1||document.domain=="local.readrboard.com"),RDR_baseUrl=RDR_offline?"http://local.readrboard.com:8080":"http://www.readrboard.com",RDR_staticUrl=RDR_offline?"http://local.readrboard.com:8080/static/":"http://s3.amazonaws.com/readrboard/",RDR_widgetCssStaticUrl=RDR_offline?"http://local.readrboard.com:8080/static/":"http://s3.amazonaws.com/readrboard/";var isTouchBrowser="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;RDR.safeThrow=function(e){var t=true;if(RDR_offline&&t){throw e}};RDR.rdr_loadScript=rdr_loadScript;RDR_scriptPaths.jquery=RDR_offline?RDR_staticUrl+"global/js/jquery-1.10.2.min.js":"//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js";rdr_loadScript({src:RDR_scriptPaths.jquery},function(){if(isTouchBrowser){load_mobileEvents(jQuery)}jquery_onload(jQuery)})})()