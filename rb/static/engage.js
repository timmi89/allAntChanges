!function(){function test_antenna_extend(){ANT_offline&&(window.antenna_extend={default_reactions:["Love It","Hate It","Heeeeeey"]},window.antenna_extend_per_container={question1:{default_reactions:["tag1","tag2","tag3"]},question2:{default_reactions:["tag3","tag4","tag5","tag6"]}})}function findEngageScript(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++){var c=a[b],d=c.src,e=(-1!=d.indexOf("antenna")||-1!=d.indexOf("local-static.antenna.is")||-1!=d.indexOf("readrboard"))&&-1!=d.indexOf("engage");if(e)return c}}function antenna(a){var b=a;b.extend(ANT,{summaries:{},current:{},assetLoaders:{content_nodes:{}},content_nodes:{},containers:{},pages:{},group:{defaults:{premium:!1,img_selector:"img",img_container_selectors:"#primary-photo",active_sections:"body",anno_whitelist:"body p",active_sections_with_anno_whitelist:"",media_selector:"embed, video, iframe",comment_length:500,initial_pin_limit:3,no_ant:"",img_blacklist:"",custom_css:"",inline_selector:"img, embed, video, iframe",paragraph_helper:!0,media_url_ignore_query:!0,summary_widget_method:"after",language:"en",ab_test_impact:!0,ab_test_sample_percentage:10,img_indicator_show_onload:!0,img_indicator_show_side:"left",tag_box_bg_colors:"background:rgba(0,0,0,0.25);",tag_box_bg_colors_hover:"background:rgba(0,0,0,0.1);",tag_box_font_family:"HelveticaNeue,Helvetica,Arial,sans-serif",tags_bg_css:"background-image: linear-gradient(185deg,#333,#777);",tag_box_text_colors:"color:#fff;",ignore_subdomain:!1,summary_widget_expanded_mobile:!1,separate_cta_expanded:"none",br_replace_scope_selector:null}},user:{img_url:"",ant_token:"",user_id:""},known_users:{},errors:{actionbar:{rating:"",commenting:""}},styles:{},events:{focusedSeconds:0,fireScrollEvent:function(a){if(-1!=a.indexOf("more"))var b="scroll_more";else var b="sc";ANT.events.trackEventToCloud({event_type:b,event_value:a})},fireEventQueue:function(){b.each(ANT.events.queue,function(a,b){ANT.events.trackEventToCloud(b)})},trackEventToCloud:function(a){if(ANT.user=ANT.user||{},ANT.events.queue=ANT.events.queue||[],(ANT.events.recordEvents||"sl"==a.event_type)&&"undefined"!=typeof a.event_type&&"undefined"!==a.event_value){var c="sl"==a.event_type?"na":parseInt(("undefined"!=typeof a.page_id?a.page_id:ANT.util.getPageProperty("id")).toString()),d=document.referrer.split("/"),e=d.splice(2).join("/"),f=/[-\w]+\.(?:[-\w]+\.xn--[-\w]+|[-\w]{2,}|[-\w]+\.[-\w]{2})$/i,g=e.split("/").splice(0,1).join("/").split(":")[0],h=(g?f.exec(g)[0]:"",{et:a.event_type,ev:a.event_value,gid:ANT.group.id||null,uid:ANT.user.user_id||null,pid:c,lts:ANT.user.lts||null,sts:ANT.user.sts||null,ref:e||null,cid:a.content_id||null,ah:"sl"==a.event_type?"na":parseInt(ANT.group.active_section_milestones[100])||null,ch:a.container_hash||null,ck:a.container_kind||null,r:a.reaction_body||null,pt:ANT.util.getPageProperty("title")||null,cu:ANT.util.getPageProperty("canonical_url")||null,pu:ANT.util.getPageProperty("page_url")||null,ru:e||null,ca:a.content_attributes||null,cl:a.content_location||null,ptop:ANT.group.topics||null,a:ANT.group.author||null,sec:ANT.group.section||null,it:isTouchBrowser||!1,sw:screen.width,sh:screen.height,pd:window.devicePixelRatio||Math.round(window.screen.availWidth/document.documentElement.clientWidth),ua:navigator.userAgent}),i=b.toJSON(h),j="local.antenna.is"!=document.domain?"http://events.readrboard.com/insert":"http://nodebq.docker:3000/insert";b.ajax({url:j,type:"get",contentType:"application/json",dataType:"jsonp",data:{json:i},success:function(a){}})}},emit:function(a,b,c){ANT.events.lastEvent=a,ANT.events.lastValue=b,ANT.events.lastSupplementary=c,document.createEvent?(evt=document.createEvent("Event"),evt.initEvent(a,!0,!0),document.dispatchEvent(evt)):document.createEventObject&&document.documentElement[a]++}},groupSettings:{getCustomSettings:function(){var a=window.antenna_extend||{};"undefined"!=typeof a.blessed_tags&&(a.default_reactions=a.blessed_tags.slice(),delete a.blessed_tags),"undefined"!=typeof a.no_readr&&(a.no_ant=a.no_readr,delete a.no_readr);var c=ANT.util.getQueryParams(),d={};return b.each(c,function(a,b){0===a.indexOf("ant_")&&(a=a.substr(4),d[a]=b)}),a=b.extend({},a,d),ANT.groupSettings._translate(a)},translators:{default_reactions:function(a){return b.map(a,function(a,b){return{body:a,is_default:!0}})}},_translate:function(a){var c={},d=ANT.groupSettings.translators;return b.each(a,function(a,b){c[a]=d[a]?d[a](b):b}),c},getBlessedTags:function(a){function c(a){var c=b('[ant-hash="'+a+'"]'),d=c.attr("ant-item");return d}var d=window.antenna_extend_per_container;if(a&&d){var e=c(a),f=d[e];if(f&&f.blessed_tags&&(f.default_reactions=f.blessed_tags.slice(),delete f.blessed_tags),f&&f.default_reactions){var g=ANT.groupSettings._translate(f);return g.default_reactions}}return ANT.group.default_reactions}},aWindow:{defaults:{coords:{left:100,top:100},animTime:100,defaultHeight:260,minHeight:10,maxHeight:300,minWidth:125,maxWidth:600,forceHeight:!1,rewritable:!0},makeHeader:function(a,c){function d(){var a=b('<div class="ant_linkWrap"><ul><li class="ant_link"><a target="_blank" href="'+ANT_baseUrl+"/interaction/"+c+'" class="ant_seeit_link">'+ANT.t("view_on_site")+"</a></li></ul></div>");return a}var e=a||"",f=b.mustache('<div class="ant ant_header"><div class="ant_close">X</div><div class="ant_loader"></div><div class="ant_indicator_stats"><span class="ant-antenna-logo"></span><span class="ant_count"></span></div><h1>{{headerText}}</h1></div>',{ANT_staticUrl:ANT_staticUrl,headerText:e}),g=b(f);if(g.find(".ant_close").on("touchend.ant",function(a){a&&a.preventDefault(),ANT.actions.UIClearState(),ANT.util.isTouchDragging(a)}),!c)return g;var h=b('<div class="ant_menuDropDown ant_menu_actions"><span class="ant-chevron-down ant_menuTrigger"></span></div>'),i=d();h.append(i);var j=b('<div class="ant_aWindowMenu"></div>').append(h);return isTouchBrowser&&j.on("touchend.ant",".ant_menuDropDown",function(a){ANT.util.isTouchDragging(a)||b(this).toggleClass("ant_hover")}),g.append(j),g},makeDefaultPanelMessage:function(a,c){var d,e=a.data("hash"),f=ANT.summaries[e],g=c||(a.hasClass("ant_indicator_details")?"media":"text");if("text"==g)d="writeMode"==a.data("mode")?ANT.t("main_cta"):"text"==g?ANT.t("reactions"):f.counts.tags>0?f.counts.tags+ANT.t("reactions"):ANT.t("reactions");else{var h=b.browser.msie&&parseInt(b.browser.version,10)<9?20:0;d=f.counts.tags>0?f.counts.tags+" "+ANT.t("reactions"):a.width()>=175+h?ANT.t("main_cta"):ANT.t("react")+":"}return d},updateFooter:function(a,b){var c=a.find("div.ant_footer");c.show(0),"undefined"!=typeof b&&c.html(b+'<a class="antenna-logo-link" target="_blank" href="'+window.location.protocol+'//www.antenna.is/">Antenna</a>')},hideFooter:function(a){a.find("div.ant_footer").hide(0)},panelCreate:function(a,c){if(a){var d=a.find("div.ant_body_wrap"),e=(d.find("div.ant_body").eq(0),d.find("div."+c));e.remove();var f=b('<div class="ant_body '+c+'"/>');d.find("div.ant_body").length+1;return f}},panelUpdate:function(a,b,c,d){if(a){var e=a.find("div.ant_body_wrap"),f=e.find("div."+b);return d||!f.length?f.append(c):f.replaceWith(c),c}},panelShow:function(a,b,c){var d=a.find(".ant_body_wrap"),e=a.find(".ant_visiblePanel");e.length||(e=a.find(".ant_body").eq(0));var f=e.width();b.show().addClass("ant-visible").css({position:"relative",top:0,left:f}),ANT.util.stayInWindow(a,!0),a.data("panelState",2),b.addClass("ant_visiblePanel").removeClass("ant_hiddenPanel"),e.addClass("ant_hiddenPanel").removeClass("ant_visiblePanel"),ANT.aWindow.updateSizes(a),d.animate({left:-f},ANT.C.aWindowAnimationSpeed,function(){if(c&&c(),a.data("jsp")){var b=a.data("jsp");b.reinitialise()}else a.jScrollPane({showArrows:!0,contentWidth:"0px"})})},panelHide:function(a,b){var c=a.find(".ant_body_wrap"),d=a.hasClass("ant_writemode"),e=ANT.actions.indicators.utils.makeTagsListForInline(a,d),f=a.find(".ant_visiblePanel");f.removeClass("ant_visiblePanel").addClass("ant_hiddenPanel"),e.addClass("ant_visiblePanel").removeClass("ant_hiddenPanel");var g=e.width();f.css("left",g),c.css("left",-g),ANT.aWindow.updateSizes(a),c.animate({left:0},ANT.C.aWindowAnimationSpeed,function(){if(b&&b(),a.data("panelState",1),a.data("jsp")){var c=a.data("jsp");c.reinitialise()}else a.jScrollPane({showArrows:!0,contentWidth:"0px"})})},updateTagPanel:function(a){a.data("hash");ANT.aWindow.panelHide(a),ANT.aWindow.tagBox.setWidth(a,a.data("initialWidth")),ANT.aWindow.tagBox.setHeight(a,a.data("initialHeight"))},mediaAWindowShow:function(a){var c=a.data("hash"),d=b("#ant_indicator_details_"+c);ANT.util.cssSuperImportant(d,{display:"block"}),!a.data("hover")||d.data("hover")||d.is(":animated")||d.closest("div.ant_media_details").length||(d.data("hover",!0),ANT.aWindow.updateSizes(d)),d.addClass("ant_engaged")},mediaAWindowHide:function(a){var c=a.data("hash"),d=b("#ant_indicator_details_"+c);a.data("hover")||d.is(":animated")||d.closest("div.ant_media_details").length||d.data("hover",!1).animate({height:"0px"},ANT.C.aWindowAnimationSpeed,function(){ANT.util.cssSuperImportant(d,{display:"none"})}),d.removeClass("ant_engaged"),b("#ant_indicator_"+c).hide()},updateSizes:function(a,b){var c,d,e=(a.hasClass("ant_indicator_details")?"media":"text",b||{}),f=a.find(".ant_visiblePanel"),g=(a.data("initialWidth"),a.data("initialHeight"),{h:200,w:200,duration:ANT.C.aWindowAnimationSpeed});g.w=f.width(),g.h=f.height()+32,c=e.setWidth||g.w,d=e.setHeight||g.h,e.noAnimate&&a.css({width:c,height:d}),a.animate({width:c,height:d},{duration:g.duration,queue:!1}),ANT.aWindow.jspUpdate(a)},updatePageTagMessage:function(a,b){},updateTagMessage:function(a){function c(){var c=b('<div class="ant_shareLinks"><div class="ant_share_cta">'+ANT.t("share_reaction")+":</div> <ul></ul></div>"),f=["facebook","twitter"];return b.each(f,function(f,h){var j=b('<li><a href="http://'+h+'.com" ><i class="ant-social-'+h+'"></i></a></li>');c.find("ul").append(j),j.click(function(){var b=a.tag.tag_body||a.tag.body;a.hash.jquery&&(i.hash="page",d=a.hash="page"),ANT.events.trackEventToCloud({event_type:"sh",event_value:h,container_hash:d,container_kind:a.kind,page_id:a.page_id,reaction_body:b});var c=ANT.summaries[d],f=a.kind||c.kind;return ANT.shareWindow=window.open(ANT_staticUrl+"share.html","ant_share","menubar=1,resizable=1,width=626,height=436"),ANT.actions.share_getLink({referring_int_id:a.response.data.interaction.id,hash:a.hash,kind:f,sns:h,aWindow:e,tag:g,content_node:i}),!1})}),c}if(a.scenario&&a.aWindow){a.args&&b.each(a.args,function(c,d){"object"==typeof d?a[c]=b.extend(!0,{},d):a[c]=d});var d=a.hash,e=a.aWindow,f=a.kind,g=a.tag,h=ANT.summaries[d],i=a.sendData?a.sendData.content_node_data:{};if(ANT.aWindow.tagBox.setWidth(e,222),"tagDeleted"!=a.scenario){if("reactionSuccess"==a.scenario||"reactionExists"==a.scenario){var j=b('<div class="ant_view_success"></div>'),k=b('<div class="ant_subheader ant_clearfix"></div>').appendTo(j),l=g.body?g.body:g.tag_body,m=(b("<h1>"+l+"</h1>").appendTo(k),b('<div class="ant_nextActions"></div>').appendTo(j));if("page"!=a.kind){ANT.actions.comments.makeCommentBox({content_node:i,summary:h,hash:d,tag:g,kind:f,$aWindow:e,selState:i.selState||null}).appendTo(m)}var n=b('<div class="ant_back">'+ANT.t("close")+" X</div>");j.prepend(n),n.click(function(){var a=ANT.aWindow.safeClose(e);a&&ANT.aWindow.updateTagPanel(e)});var o=!0;ANT.aWindow.panelUpdate(e,"ant_view_more",j,o),ANT.user=ANT.user||{};var p=function(a){var b=a.data.args,c={hash:b.hash,int_id:b.response.data.interaction.id,tag:b.tag,aWindow:e};ANT.actions.interactions.ajax(c,"react","remove")};isTouchBrowser?e.find("a.ant_undo_link").on("touchend.ant",{args:a},p):e.find("a.ant_undo_link").on("click.ant",{args:a},p);var q=b(".ant_nextActions");q.append(c())}ANT.actions.containers.media.onEngage(d)}else{var r=ANT.aWindow.makeDefaultPanelMessage(e),s=ANT.aWindow.makeHeader(r);e.find(".ant_header").replaceWith(s),e.removeClass("ant_viewing_more").find("div.ant_indicator_details_body").show(),ANT.aWindow.panelHide(e)}ANT.aWindow.updateSizes(e)}},jspUpdate:function(a){a.closest(".jspContainer").length||a.hasClass("jspScrollable")||a.find("div.ant_body").each(function(){var a=b(this);if(a.hasClass("jspScrollable")){var c=b(this).data("jsp");c.reinitialise()}else b(this).jScrollPane({showArrows:!0,contentWidth:"0px"})})},tagBox:{setWidth:function(a,b){var c=ANT.group.max_aWindow_width?ANT.group.max_aWindow_width:b;a.removeClass("w111 w222").addClass("w"+c)},setHeight:function(a,b){a.find(".ant_body, .jspContainer").height(b)},make:function(a){function c(a,b){if(h.find(".ant_view_more").length&&h.find(".ant_view_more").hasClass("ant_visiblePanel"))h.find(".ant_body").html(a),ANT.aWindow.jspUpdate(h);else{var c=ANT.aWindow.panelCreate(h,"ant_view_more"),d=h.find("div.ant_body_wrap");d.append(c),c.append(a).addClass("ant_page_reactions_summary"),ANT.aWindow.tagBox.setWidth(h,222),ANT.aWindow.panelShow(h,c,function(){ANT.aWindow.hideFooter(h)})}var e=b.tag_count<=0?"no reactions":1==b.tag_count?"1 "+ANT.t("single_reaction"):b.tag_count+" "+ANT.t("plural_reaction"),f=ANT.aWindow.makeHeader(e);h.find(".ant_header").replaceWith(f)}function d(){var a=b('<div class="ant_back">'+ANT.t("close")+" X</div>");return a.on("click.ant, touchend.ant",function(){ANT.aWindow.close(h)}),a}function e(a,c,e){b().selog("hilite",!0,"off"),b(".ant_twtooltip").remove();var g=d(),h=b('<table cellpadding="0" cellspacing="0" border="0" class="reaction_summary_table"></table>').append('<tbody><tr class="ant_page_reactions"></tr></tbody>');if(c&&c.page&&c.page>0){var i=1==c.page?"1 "+ANT.t("single_reaction"):c.page+" "+ANT.t("plural_reaction");h.find(".ant_page_reactions").append('<td colspan="2"><strong>'+i+"</strong> "+ANT.t("to_page")+"</td>")}return(c.img>0||c.text>0||c.media>0)&&(h.find(".ant_page_reactions").addClass("has_other_reactions"),b.each(ANT.interaction_data[f.id],function(a,c){var d=c.hash,g=ANT.summaries[d],i=(b('[ant-hash="'+d+'"]'),g.pageId);if(i&&e&&i==e&&!h.find("tr.ant_int_summary_"+a).length){var j=b('<tr valign="middle" class="ant_content_reaction ant_int_summary_'+a+'"/>'),k=ANT.interaction_data[f.id][a];if("undefined"!=typeof k.interaction&&"undefined"!=typeof k.content_node){var l=k.interaction.count>1?ANT.t("plural_reaction"):ANT.t("single_reaction");if(j.append('<td class="ant_count"><h4>'+k.interaction.count+"</h4><h5>"+l+"</h5></td>").data("count",k.interaction.count).data("tag",f).data("int_id",a),"text"==k.kind?j.append('<td class="ant_content">'+k.content_node.body+"</td>"):"img"==k.kind?j.append('<td class="ant_content"><img src="'+k.content_node.body+'" height="50"/></td>'):"media"==k.kind&&j.append('<td class="ant_content"><img src="'+ANT_baseUrl+'/static/widget/images/video_icon.png" height="33" style="margin-bottom:-10px;"/> <div style="display:inline-block;margin-left:10px;">Video</div></td>'),j.on("click.ant, touchend.ant",function(a){a.preventDefault();var b={container_hash:k.hash,location:k.content_node.location};ANT.session.revealSharedContent(b),ANT.events.trackEventToCloud({event_type:"sb",event_value:"vc",page_id:i})}),h.find("tr.ant_content_reaction").length){var m=0;b.each(h.find("tr.ant_content_reaction"),function(a,c){return parseInt(k.interaction.count)>parseInt(b(c).data("count"))?(m=a,!1):void 0}),h.find("tr.ant_content_reaction:eq("+m+")").before(j)}else h.find("tbody").append(j)}}})),b("<div/>").append(g,h)}var f=a.tag,g=a.boxSize?a.boxSize:"medium",h=a.$aWindow?a.$aWindow:null,i=a.$tagContainer?a.$tagContainer:a.$aWindow?a.$aWindow.find("div.ant_body.ant_tags_list"):null,j=(h.attr("ant-view-style")||"grid",f.tag_count?f.tag_count:""),k=(a.bgColorInt?a.bgColorInt:0,a.rowNum?a.rowNum:0),l=a.isWriteMode?a.isWriteMode:!1,m=h.data("kind"),n=h.data("hash")?h.data("hash"):h.data("container"),o=ANT.summaries[n],p=("undefined"!=typeof o?o.counts.tags:0,f.content_node_id?f.content_node_id:!1),q=p?o.content_nodes[p]:"";p&&(q.id=p);var g="big"==g?"ant_box_big":"ant_box_medium",r="",s=l?"ant_writeMode":"",t=f.body?f.body:f.tag_body,u=t.split(" "),v="",w="",x="",y="",z="";if("undefined"!=typeof t){1==u.length?v=u[0]:b.each(u,function(a,b){var c=0===a?"":" ";v.length<11&&v.length+b.length<11?v+=c+b:w+=c+b}),ANT.group.tag_box_font_family=ANT.group.tag_box_font_family.replace(/['"]+/g,"'"),v=b.trim(v)+" ";var A=v.length>17?"max":v.length;if(v='<div class="ant_charCount_'+A+'" style="font-family:'+ANT.group.tag_box_font_family+';">'+v+"</div>",""!=w){w=b.trim(w);var B=w.length>17?"max":w.length;w='<div class="ant_charCount_'+B+'" style="font-family:'+ANT.group.tag_box_font_family+';">'+w+"</div>"}x=v+w;var C="";y='<div class="ant_tag_body">'+x+"</div>";var D=f.id,E=f.parent_id,F=p?"ant_content_node_"+p:"",j=j||0,G=j,H=l?'<span class="ant_plusOne">+1</span>':'<span class="ant_count" style="font-family:'+ANT.group.tag_box_font_family+';">'+G+'</span><span class="ant_plusOne" style="">+1</span>'+("page"==m?'<span class="ant_search ant_tooltip_this" title="View content<br/>with this reaction"><i class="ant-search"></i></span>':""),I='<div class="'+g+" ant_box "+r+" "+s+" row_num_"+k+'"><div class="ant_tag '+z+" "+F+" "+C+'" data-tag_id="'+D+'" data-tag_count="'+j+'" data-parent_id="'+E+'" data-content_node_id="'+p+'" ><div class="ant_tag_wrap"><div class="ant_tag_wrap2">'+y+'<div class="ant_tag_actions">'+H+"</div></div></div></div></div>",J=b(I);i.append(J);var K={},L=0;b.isEmptyObject(q)||b.isEmptyObject(q.top_interactions)||b.isEmptyObject(q.top_interactions.coms)||b.each(q.top_interactions.coms,function(a,c){c.tag_id==parseInt(f.tag_id)&&(L++,b.isEmptyObject(K)&&(K=q.top_interactions.coms))});var M=b.isEmptyObject(K)&&"undefined"!=typeof o&&("img"==o.kind||"media"==o.kind||"med"==o.kind)&&!b.isEmptyObject(o.top_interactions)&&!b.isEmptyObject(o.top_interactions.coms);if(f.id||(f.id=f.tag_id),M&&(K=o.top_interactions.coms[f.id],b.isEmptyObject(K)||(L=K.length)),!l&&"page"!=m){var N=L>0?!0:!1,O="View comments";0===L&&(L="",O="Add comment here");var P=b('<span class="ant_comment_hover ant_tooltip_this '+(N?"":"ant_hide")+'" title="'+O+'"></span>');P.append('<i class="ant-comment"></i> '+L),isTouchBrowser?P.on("touchend.ant",function(){return b(this).tooltip("hide"),ANT.actions.viewCommentContent({tag:f,hash:n,aWindow:h,content_node:q,selState:q.selState}),!1}):P.click(function(){return b(this).tooltip("hide"),ANT.actions.viewCommentContent({tag:f,hash:n,aWindow:h,content_node:q,selState:q.selState}),!1}),J.find(".ant_tag_actions").append(P)}J.find(".ant_tooltip_this").tooltip();var Q=isTouchBrowser?"touchend.ant":"click.ant";if("page"==m){J.find(".ant_search").hover(function(){b(this).closest(".ant_box").toggleClass("hidePlusOne")});var R=function(){ANT.aWindow.hideFooter(h),h.removeClass("ant_rewritable");var a=ANT.util.getPageProperty("id",n),d=ANT.pages[a],g=f.tag_count,i={img:0,text:0,media:0,page:"+"==g?0:g};ANT.events.trackEventToCloud({event_type:"sb",event_value:"vr",page_id:a}),b.each(d.containers,function(a,b){ANT.summaries&&ANT.summaries[b.hash]&&ANT.summaries[b.hash].top_interactions&&ANT.summaries[b.hash].top_interactions.tags&&ANT.summaries[b.hash].top_interactions.tags[f.id]&&(i[ANT.summaries[b.hash].kind]+=ANT.summaries[b.hash].top_interactions.tags[f.id].count,i.page-=ANT.summaries[b.hash].top_interactions.tags[f.id].count)});var j=b(this),k=e(j,i,d.id);c(k,f),j.addClass("ant_live_hover")};J.find(".ant_search").on(Q,function(a){return a&&a.preventDefault(),R(),!1}),J.on(Q,function(a){if(!ANT.util.isTouchDragging(a)&&0==ANT.util.bubblingEvents.touchend){b(this).addClass("ant_tagged"),h.removeClass("ant_rewritable");var c=h.data("container");args={tag:f,hash:c,uiMode:"writeMode",kind:h.data("kind"),aWindow:h,content_node:q},ANT.actions.interactions.ajax(args,"react","create")}})}else J.on(Q,function(a){if(!ANT.util.isTouchDragging(a)&&0==ANT.util.bubblingEvents.touchend){b(this).addClass("ant_tagged"),h.removeClass("ant_rewritable");var c=h.data("container");args={tag:f,hash:c,uiMode:"writeMode",kind:h.data("kind"),aWindow:h,content_node:q},ANT.actions.interactions.ajax(args,"react","create")}});return isTouchBrowser||J.hover(function(){var a=b(this);if(!a.hasClass("ant_tagged")){var c=a.find("span.ant_tag_count");c.width(c.width()),c.text("+")}},function(){var a=b(this);a.find("span.ant_tag_count").text(a.find(".ant_tag").data("tag_count"))}),J}}},writeCustomTag:function(a,c,d){function e(a,b){var e={},f=c.data("container"),g=b.val();""!==g&&(e.body=g,a.parent().addClass("ant_tagged"),args={tag:e,hash:f,uiMode:"writeMode",kind:c.data("kind"),aWindow:c},ANT.actions.interactions.ajax(args,d,"create"),b.blur())}var a=c.find(".ant_footer");if(a.append('<div class="ant_box"></div><a class="antenna-logo-link" target="_blank" href="'+window.location.protocol+'//www.antenna.is/">Antenna</a>'),0==a.find("div.ant_custom_tag").not("div.ant_custom_tag.ant_tagged").length){var d=d?d:"react",f="+ "+ANT.t("add_custom"),g=b('<div class="ant_click_overlay"></div>').appendTo(a),h=b('<div class="ant_tag ant_custom_tag"></div>'),i=b('<input value="'+f+'" />').appendTo(h),j=b('<button class="ant_custom_tag_submit" name="ant_custom_tag_submit">ok</button>').appendTo(h);j.click(function(){e(h,i)}),g.click(function(){i.focus()}),i.focus(function(){var a=b(this);a.removeClass("ant_default"),a.val()==f&&a.val(""),g.hide(),j.css("display","inline-block"),c.removeClass("ant_rewritable")}).blur(function(){var a=b(this);""===a.val()&&(a.val(f),j.hide(),g.show()),a.val()==f&&(a.addClass("ant_default"),j.hide(),g.show()),a.closest("div.ant_tag").removeClass("ant_hover")}).keyup(function(a){var b=i;if("13"==a.keyCode)e(h,i);else{if("27"==a.keyCode)return b.blur(),!1;if(b.val().length>25){var c=b.val();b.val(c.substr(0,25))}}}),a.find(".ant_box").append(h," "),b(document).on("keydown.ant",function(c){keyCodes=[16,81,87,69,82,84,89,85,73,79,80,65,83,68,70,71,72,74,75,76,90,88,67,86,66,78,77,49,50,51,52,53,54,55,56,57,48,189,187,219,221,220,186,222,188,190,191,192],-1!=b.inArray(c.keyCode,keyCodes)&&a.find("input").focus()})}},_aWindowTypes:{tagMode:{make:function(a){if(1==a.is_page){var c=a.page,d=b(".ant-summary-"+c.id),e=d.find(".ant_logo"),f={top:e.offset().top-11,left:e.offset().left-9};if(b("div.ant_page_key_"+d.data("page_key")).length)return;var g=ANT.aWindow.draw({coords:f,container:d,content:"page",kind:"page",mode:a.mode})}else{var h=a.hash,i=ANT.util.getPageProperty("id",h),j=ANT.summaries[h],k=j.$container,l=j.kind,m=0==a.rewritable?!1:!0,f=a.coords?a.coords:{},n=(a.actionType?a.actionType:"react",k.width());k.height();if("writeMode"==a.mode){ANT.events.trackEventToCloud({event_type:"rs",event_value:"wr",container_hash:h,container_kind:l,page_id:i});var o;if("text"==l){if(o=k.selog("helpers","smartHilite"),!o)return!1;if(a.content=o.text,f.force?f.top=f.top-15:(f.left=f.left+40,f.top=f.top+35),o){var p=o.hiliter,q=p.get$end();if(q){var r=b("<span />");if(r.insertAfter(q),!f.force){var s=r.offset().right,t=r.offset().bottom;f.left=s-14,f.top=t+2}r.remove()}}if(isTouchBrowser)var k=b('[ant-hash="'+h+'"]'),n=k.width(),u=k.offset().left,v=-111,f={top:k.offset().bottom+10,left:n/2+u+v}}else if("undefined"!=typeof a.coords&&a.coords.force)var f=a.coords;else{var w=j.$indicator.offset(),f={};f.top=w.top,f.left=w.left}}else{var x=(b("#ant_indicator_"+h),b("#ant_indicator_body_"+h)),k=b('[ant-hash="'+h+'"]');if("text"==l)f={top:x.offset().top,left:x.offset().left};else{var w=j.$indicator.offset(),f={};f.top=w.top,f.left=w.left,ANT.events.trackEventToCloud({event_type:"rs",event_value:"undefined"!=typeof j.counts.highest_tag_count?"rd":"rd-zero",container_hash:h,container_kind:l,page_id:i}),ANT.events.emit("antenna.reactionview","",{hash:h,kind:l})}}if("undefined"!=typeof a.$custom_cta){var y=a.$custom_cta.offset();if(isTouchBrowser)var f={top:y.bottom+5,left:y.left};else{var z=a.$custom_cta.attr("ant-offset-x")?parseInt(a.$custom_cta.attr("ant-offset-x")):0,A=a.$custom_cta.attr("ant-offset-y")?parseInt(a.$custom_cta.attr("ant-offset-y")):0;f.top=y.top+A,f.left=y.left+z}}var g=ANT.aWindow.draw({coords:f,container:h,content:a.content,kind:l,selState:o,rewritable:m,mode:a.mode});g.data("hash",h),j["$aWindow_"+a.mode.toLowerCase()]=g}g.addClass("ant_"+a.mode.toLowerCase());var B=ANT.aWindow.makeDefaultPanelMessage(g),C=ANT.aWindow.makeHeader(B);g.find(".ant_header").replaceWith(C),g.addClass("ant_reactions");var D=g.find("div.ant_body_wrap"),E=g.find("div.ant_body");if(E.length&&E.remove(),1==a.is_page)var F=ANT.actions.indicators.utils.makeTagsListForInline(g,"writeMode"==a.mode,c);else var F=ANT.actions.indicators.utils.makeTagsListForInline(g,"writeMode"==a.mode);D.append(F);var G=D.width(),H=D.height();return g.css("left",f.left+"px").css("top",f.top+"px"),g.animate({width:G},333,"swing"),g.data("initialWidth",G).data("initialHeight",H),g.find("div.ant_cell_wrapper div.ant_tag").css({width:"100%"}),g},customOptions:{},setup:function(){}}},make:function(a,c){var d=c.hash,e=ANT.summaries[d],f=(c.kind,c.is_page);if(!f&&!e){var e=ANT.util.makeEmptySummary(d);ANT.actions.containers.setup(e)}a||(a="readMode");var g=ANT.aWindow.defaults,h=ANT.aWindow._aWindowTypes.customOptions,i=b.extend({},g,h,c,{mode:a}),j=ANT.aWindow._aWindowTypes.tagMode.make(i);return"undefined"!=typeof j?(setTimeout(function(){j.addClass("ant_show")},1),ANT.util.stayInWindow(j),j):void 0},draw:function(a){a.purpose&&"login"==a.purpose||ANT.aWindow.closeAll(),a.selector&&!a.container&&(a.container=a.selector.substr(5));var c=b.extend({},this.defaults,a);c.minHeight<60?60:c.minHeight,c.maxHeight;minWidth=c.minWidth,maxWidth=c.maxWidth,ant_for="string"==typeof c.container?"ant_for_"+c.container:"ant_for_page",$new_aWindow=b('<div class="ant ant_window ant_rewritable ant_widget w111 '+ant_for+'"></div>'),c.id&&(b("#"+c.id).remove(),$new_aWindow.attr("id",c.id)),b("#ant_sandbox").append($new_aWindow),"page"==c.kind&&$new_aWindow.addClass("ant_page_key_"+a.container.data("page_key")).addClass("ant_page_summary"),$new_aWindow.data(c),0===$new_aWindow.find("div.ant_header").length&&($new_aWindow.html(""),$new_aWindow.append('<div class="ant ant_header"><div class="ant_loader"></div></div><div class="ant ant_body_wrap ant_clearfix"></div><div class="ant ant_footer"></div>'),c.noHeader&&$new_aWindow.find("div.ant_header").remove(),$new_aWindow.drags({handle:".ant_header"}));var d=c.coords;return $new_aWindow.css("left",d.left+"px"),$new_aWindow.css("top",d.top+"px"),c.height&&$new_aWindow.height(c.height),ANT.actionbar.closeAll(),$new_aWindow.settings=c,ANT.actions.indicators.showOnlyInitial===!0&&-1!=c.mode.indexOf("read")&&(ANT.actions.indicators.showOnlyInitial=!1,ANT.actions.summaries.showLessPopularIndicators()),$new_aWindow},safeClose:function(a){return ANT.aWindow.close(a),!0},close:function(a){ANT.aWindow.clearHilites(a),a.each(function(a,c){b(c).remove()}),b("#ant_indicator_details_wrapper").find(".ant_body_wrap").css({visibility:"visible"})},closeAll:function(){var a=b("div.ant.ant_window").not(".ant_no_clear");ANT.aWindow.close(a),b(".ant_shared").removeClass("ant_shared"),b(document).off("keydown.ant")},clearHilites:function(a){var c=[];a.each(function(a,d){var e=b(d).data("container");if("undefined"!=typeof e){var f=ANT.summaries[e],g=b(d).data("selState");"undefined"!=typeof g&&""!==g&&c.push(g);var h=[];f&&f.hasOwnProperty("content_nodes")&&(h=f.content_nodes),b.each(h,function(a,b){var d=b.selState;"undefined"!=typeof d&&c.push(d)})}}),b.each(c,function(a,c){try{b().selog("hilite",c,"off")}catch(d){}})},update:function(a,c){function d(a,c){var d,h;d=a.find(".ant_tags"),h=d.find(".ant_tag_"+c.parent_interaction_node.id).filter(function(){return b(this).hasClass("ant_content_node_"+c.content_id)}),h.addClass("ant_comment_indicator"),f(c,h,a),e(a),g(c,h,a)}function e(a){var c=a.find("table.ant_tags");1==c.find("tr:eq(0)").find("td").length&&(c.addClass("ant-one-column"),isTouchBrowser||c.find("td.ant_has_pillHover").on("mouseenter.ant, mousemove.ant",function(){var a=b(this),c=a.closest("div.ant_window");thisWidth=c.data("initialWidth")}).on("mouseleave.ant",function(){var a=b(this),c=a.closest("div.ant_window");thisWidth=c.width()}))}function f(c,d,e){var f=h.content_nodes,g=f[c.content_id];if(g)var i=g.top_interactions.coms;else{var j=b.mustache('contentNode not found by id: {{id}}.  Figure out why nodeId was saved as "undefined".',{id:c.content_id});ANT.safeThrow(j)}var k=b.map(i,function(a){return a.tag_id===c.tag_id?a:null}),l=k.length,m=d,n=c.parent_interaction_node,o=c.content_node;m.find(".ant_comment_hover").remove(),m.find(".ant_comment_indicator").remove();var p=b('<span class="ant_comment_hover"/>');p.append('<span class="ant_icon"></span> '+l),p.click(function(){ANT.actions.viewCommentContent({tag:n,hash:a,aWindow:e,content_node:o,selState:o.selState})}),m.append(p),m.closest("td").addClass("ant_has_pillHover")}function g(a,c,d){var e=(a.parent_interaction_node,a.content_node,b('<span class="ant_comment_feedback"/>'));e.append('<span class="linkToComment">'+ANT.t("thanks_for_comment")+' <a href="javascript:void(0);">'+ANT.t("close")+"</a></span> "),e.click(function(a){a.preventDefault(),ANT.aWindow.safeClose(d)}),d.find("div.ant_commentBox").empty().append(e).show(),d.find("button.ant_add_comment").hide()}var h=ANT.summaries[a],i=h.$aWindow_readmode,j=h.$aWindow_writemode;if(c){if("coms"==c.int_type)if(j&&j.length&&($tags=j.find(".ant_tags").find(".ant_tag"),$tags.addClass("ant_content_node_"+c.content_id),d(j,c)),i&&i.length)d(i,c);else{var k=b("#ant_indicator_details_"+a);$tags=k.find(".ant_tags").find(".ant_tag"),$tags.addClass("ant_content_node_"+c.content_id),d(k,c)}}else{var l=h.kind&&("img"==h.kind||"media"==h.kind||"med"==h.kind);if(!l)return;ANT.actions.indicators.utils.makeDetailsContent(a)}}},actionbar:{draw:function(a){function c(a){var c=b("#ant_container_tracker_"+d),e=c.find(".ant_mediaHilite_top"),f={top:e.offset().top,left:e.offset().right};return f}var d=a.hash,e=a.coords,f=a.kind,g=a.content,h=a.src_with_path||void 0,i=(ANT.util.getPageProperty("id",d),"ant_actionbar_"+d);b("div.ant_actionbar");if(b("#"+i).length>0)return b("#"+i);var j={IE:{top:"add this here",left:"add this here"},img:c,text:{top:e.top-40,left:e.left+3}};if(e="text"==f?j.text:j.img(e),e.top<0||e.left<0)return!1;var k=b('<div class="ant ant_actionbar ant_widget ant_widget_bar" id="'+i+'" ></div>');if(k.css({top:e.top,left:e.left}),!d)return void ANT.safeThrow("There should always be a hash from hashNodes after hover on an unhashed image.");k.data("hash",d);var l=a.clickAction?a.clickAction:function(){ANT.aWindow.make("writeMode",{hash:d,kind:f,content:g,src_with_path:h})},m=b('<a href="javascript:void(0);" class="ant_tooltip_this"><span class="ant-antenna-logo"></span><span class="ant ant_react_label">'+ANT.t("main_cta")+'</span><div class="ant_clear"></div></a><div class="ant_down_arrow"></div>');return k.append(m),k.on("mouseenter.ant",function(){ANT.util.setFunctionTimer(function(){k.addClass("ant_hover")},500),clearTimeout(k.data("ant_actionbarShowTimer"))}).on("mouseleave.ant",function(){ANT.util.clearFunctionTimer(),k.removeClass("ant_hover"),k.data("ant_actionbarShowTimer",setTimeout(function(){ANT.actionbar.close(k),b('[ant-hash="'+d+'"]').removeClass("ant_live_hover")},1e3))}).on("click.ant",l),b("#ant_sandbox").append(k),setTimeout(function(){k.addClass("ant_show")},10),("img"==f||"media"==f||"med"==f)&&(k.addClass("ant_actionbar_for_media"),k.append('<div style="clear:both;" />').removeClass("ant_widget ant_widget_bar")),k},close:function(a,c){function d(a,c){var d=a.data("timeoutCloseEvt"),e=a.data("timeoutCollapseEvt");clearTimeout(d),clearTimeout(e);var f=b('[ant-hash="'+c+'"]');b("#ant_indicator_"+c);f.removeClass("ant_engage_media"),a.remove()}a.each(function(){var a=b(this),c=a.data("hash");b("#ant_container_tracker_"+c);a.removeClass("ant_show"),setTimeout(function(){d(a,c)},200)})},closeSuggest:function(a){var c=b();if(a)if("string"==typeof a){var d=a;c=b("#ant_actionbar_"+d),c.data("hash",d)}else b.each(a,function(a,b){c=c.add("#ant_actionbar_"+b),
c.data("hash",b)});else c=b("div.ant_actionbar");var e=this;c.each(function(){var a=b(this),d=c.data("hash"),f=b("#ant_indicator_details_"+d),g=b('[ant-hash="'+d+'"]'),h=b(this).data("timeoutCloseEvt");clearTimeout(h),h=setTimeout(function(){a.data("hover")||g.data("hover")||f.data("hover")||e.close(a,"fade")},300),b(this).data("timeoutCloseEvt",h)})},closeAll:function(){var a=b("div.ant_actionbar");this.close(a)}},t:function(a){return"undefined"!=typeof ANT.lang[ANT.group.language][a]?ANT.lang[ANT.group.language][a]:"###"},lang:{en:{main_cta:"What do you think?",your_reaction:"Your Reaction?",react:"React",add_custom:"Add Your Own",reactions:"Reactions",okay:"Okay",single_reaction:"reaction",plural_reaction:"reactions",to_page:"to this <strong>page</strong>",close:"Close",thanks:"Thanks For Your Reaction!",already_done_that:"You've already reacted to this",remove_reaction:"Remove reaction",view_on_site:"View at Antenna",add_comment:"Add comments or #hashtags",characters_left:"NNN characters left",comment:"Comment",comments:"Comments",thanks_for_comment:"Thanks for your comment!",share_reaction:"Share your reaction",doubleTapMessage:"<strong>Single-tap</strong> any paragraph to respond!",bad_language_warning:"This site has blocked that from being a valid reaction.\n\nPlease try something that will be more appropriate for this community."},es:{main_cta:"¿Qué piensas?",your_reaction:"¿Reacción tuyo?",react:"Reaccionar",add_custom:"Añade lo tuyo",reactions:"Reacciones",okay:"Bien",single_reaction:"reacción",plural_reaction:"reacciones",to_page:"a esta <strong>página</strong>",close:"cerrar",thanks:"Gracias por tu reacción",already_done_that:"Ya reaccionaste a esto",remove_reaction:"Remover reacción",view_on_site:"Ver en Antenna",add_comment:"Añade comentarios o #hashtags",characters_left:"Quedan NNN caracteres ",comment:" Comenta",comments:" Comentas",thanks_for_comment:"Gracias por tu comentario",share_reaction:"Comparte tu reacción",doubleTapMessage:"<strong>Toca</strong> un párrafo para opinar",bad_language_warning:"Este sitio ha bloqueado una palabra inadecuada de ser una reacción válida.\n\nPor favor intente algo más apropiado para esta comunidad"}},broadcast:{init:function(){var a=b(ANT.group.recirc_selector).first();if(ANT.util.activeAB()&&ANT.group.show_recirc&&a.length){var c=ANT_offline?"http://www.antenna.is/analytics/recirc/v1/2352/":ANT_baseUrl+"/analytics/recirc/v1/"+ANT.group.id+"/";b.ajax({url:c,type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON({})},success:function(c){var d=b('<div class="antenna-broadcast no-ant"></div>'),e=b('<div class="ant-tiles"></div>'),f=b('<div class="ant-explanation"><span class="ant-antenna-logo"></span>Antenna<p>These tiles have reactions from other readers, telling you why certain content caught their attention.</p><p>Add your voice!  React to text, images, and video on the site and your opinion might show up here, too. Just look for the <span class="ant-antenna-logo ant-inline"></span> logo.</p><p>For more information about Antenna, <a href="http://www.antenna.is/">visit our website</a>.</p><p><a href="javascript:void(0);" class="ant-close">Close this</a></p></div>');a.width()<400&&d.addClass("ant-thin");var g=""!=ANT.group.recirc_title?ANT.group.recirc_title:"Popular Reactions";d.append('<div class="ant-broadcast-header"><div class="ant-headline">'+g+'</div><div class="ant-logo"><span class="ant-antenna-logo"></span></div></div>');for(var h=0,i=[];i.length<c.data.length;){for(var j=Math.ceil(Math.random()*c.data.length),k=!1,l=0;l<i.length;l++)if(i[l]==j){k=!0;break}k||(i[i.length]=j)}b.each(i,function(a,b){var d=c.data[b-1];if(5>h){var f=!1;if("pag"==d.content.kind)d.page.image&&(f=!0,g='<img src="'+d.page.image+'" />');else{var g="img"==d.content.kind?'<img src="'+d.content.body+'" />':"med"==d.content.kind?'<iframe class="contentBody" width="250" height="250" frameborder="0" src="'+d.content.body+'"></iframe>':d.content.body.split(" ").length<2?"":d.content.body,i="txt"==d.content.kind&&d.content.body.length<16?d.page.image:"";f=!0}if(f===!0){var j='<div class="ant-featured ant-featured-'+d.content.kind+'" style="background-image:url('+i+')"><div class="ant-featured-container"><a href="//www.antenna.is/r/'+d.reaction.id+'/"><div class="ant-featured-content">'+g+'</div><div class="ant-featured-overlay"></div><div class="ant-featured-gradient"></div><div class="ant-featured-reaction">'+d.reaction.body+'</div><div class="ant-featured-headline">'+d.page.title+"</div></a></div></div>";e.append(j),h++}}}),d.append(e,f),d.find(".ant-logo, .ant-close").click(function(){d.find(".ant-explanation").toggleClass("ant-visible")});var m=""!=ANT.group.recirc_jquery_method?ANT.group.recirc_jquery_method:"append";a[m](d),ANT.actions.indicators.utils.updateContainerTrackers()}})}},forceDisplay:function(a){ANT.group.show_recirc=!0,a&&(ANT.group.recirc_selector=a),ANT.broadcast.init()}},status:{group:!1,page:!1},util:{cookies:{create:function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"},read:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null},erase:function(a){createCookie(a,"",-1)}},hexToRgb:function(a){if(a=b.trim(a)){var c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d});var d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return d?parseInt(d[1],16)+","+parseInt(d[2],16)+","+parseInt(d[3],16):null}return"0,0,0"},getColorLuma:function(a){var b=a.split(",")[0],c=a.split(",")[1],d=a.split(",")[2];return.2126*b+.7152*c+.0722*d},bubblingEvents:{touchend:!1,dragging:!1,startX:0,startY:0},isTouchDragging:function(a){return isTouchBrowser&&Math.abs(a.originalEvent.changedTouches[0].clientY-ANT.util.bubblingEvents.startY)>10?!0:!1},windowBlur:function(){},windowFocus:function(){},timerStart:0,timerEnd:0,clearFunctionTimer:function(a){a||(a="ant_functionTimer"),clearTimeout(b.data(this,a))},setFunctionTimer:function(a,c,d){d||(d="ant_functionTimer"),ANT.util.clearFunctionTimer(d),c||(c=300),"undefined"!=typeof a&&b.data(this,d,setTimeout(function(){a()},c))},clearWindowInterval:function(){},checkForSelectedTextAndLaunchAWindow:function(){var a=b("document").selog("save");if(a){var c=a.range.commonAncestorContainer,d=3===c.nodeType?b(c).parent():b(c);ANT.actions.startSelect(d,null,function(a,b,c){ANT.aWindow.make("writeMode",{hash:a,kind:b,content:c})})}},initTouchBrowserSettings:function(){isTouchBrowser&&ANT.util.activeAB()&&b(window).on("scrollend.ant",function(){ANT.util.mobileHelperToggle()}),$ANT.dequeue("initAjax")},mobileHelperToggle:function(){b(ANT.group.active_sections).find("embed[ant-node], video[ant-node], iframe[ant-node], img[ant-node]").each(function(){var a=b(this),c=a.data("hash");ANT.actions.indicators.init(c),a.addClass("ant_live_hover")})},initPublicEvents:function(){window.antenna.public_events=b("#ant_sandbox"),$ANT.dequeue("initAjax")},makeEmptySummary:function(a,b){var c={};return c={},c.hash=a,c.kind=b,c.top_interactions={},c.top_interactions.coms={},c.top_interactions.tags={},c.top_interactions.shr={},c.counts={},c.counts.tags=0,c.counts.interactions=0,c.counts.coms=0,c},getPageProperty:function(a,c){if(a||(a="id"),"id"==a){var d;if("page"==c)return d=b(".ant_window").data("container").attr("ant-page-id"),parseInt(d,10);if("object"==typeof c){if(b(c).closest("[ant-page-container]").length)return parseInt(b(c).closest("[ant-page-container]").attr("ant-page-container"))}else if(!c)return b("[ant-page-container]").eq(0).attr("ant-page-container");if("string"==typeof c)var e=c,f=b('[ant-hash="'+e+'"]');var d=f.data("page_id")?f.data("page_id"):f.closest("[ant-page-container]").length?f.closest("[ant-page-container]").attr("ant-page-container"):b("body").attr("ant-page-container");return f.hasAttr("ant-page-container")&&!f.data("page_id")&&f.data("page_id",d),parseInt(d)}if("title"==a){var g=b('meta[property="og:title"]').attr("content")?b('meta[property="og:title"]').attr("content"):b("title").text()?b("title").text():"";return b.trim(g)}var h=b.trim(window.location.href.split("#")[0]).toLowerCase();if("page_url"==a)return ANT.actions.removeSubdomainFromPageUrl(h);if("canonical_url"==a){var i=b('link[rel="canonical"]').length>0?b('link[rel="canonical"]').attr("href"):h;b('[property="antenna:url"]').length>0&&(i=b('[property="antenna:url"]').attr("content")),i=b.trim(i.toLowerCase()),i==ANT.util.getPageProperty("page_url")&&(i="same"),"same"!=i&&-1==ANT.util.getPageProperty("page_url").indexOf(i)&&(i=ANT.util.getPageProperty("page_url"));var j=b.trim(window.location.protocol+"//"+window.location.hostname+"/").toLowerCase();return i==j&&h!=j&&(i=h),ANT.actions.removeSubdomainFromPageUrl(b.trim(i))}},buildInteractionData:function(){b.each(ANT.summaries,function(a,c){b.each(c.top_interactions.tags,function(d,e){"undefined"!=typeof ANT.summaries[a].content_nodes&&b.each(ANT.summaries[a].content_nodes,function(b,e){if("undefined"!=typeof e.top_interactions.tags&&"undefined"!=typeof e.top_interactions.tags[d]){var f=e.top_interactions.tags[d];"undefined"==typeof ANT.interaction_data[d]&&(ANT.interaction_data[d]={}),"undefined"==typeof ANT.interaction_data[d][f.parent_id]&&(ANT.interaction_data[d][f.parent_id]={}),ANT.interaction_data[d][f.parent_id].hash=a,ANT.interaction_data[d][f.parent_id].container_id=c.id,ANT.interaction_data[d][f.parent_id].tag={body:f.body,id:d},ANT.interaction_data[d][f.parent_id].kind=c.kind,ANT.interaction_data[d][f.parent_id].interaction={id:f.parent_id,count:f.count,body:f.body},ANT.interaction_data[d][f.parent_id].content_node={body:e.body,location:e.location,selState:e.selState}}})})})},stayInWindow:function(a,c){var c=!1;if(!isMobile){var d=b(window),e=d.width(),f=d.height(),g=d.scrollTop(),h=a.offset(),i=h.top,j=h.left,k=h.right,l=(a.width(),a.height()),m=l+i-(f+g);m>0&&(c?a.animate({top:i-m},333):a.css("top",i-m));var n=k-e;n>0&&(c?a.animate({left:j-n},333):a.css("left",j-n)),0>j&&a.css("left","0px")}},md5:{hexcase:0,b64pad:"",chrsz:8,hex_md5:function(a){return ANT.util.md5.binl2hex(ANT.util.md5.core_md5(ANT.util.md5.str2binl(a),a.length*ANT.util.md5.chrsz))},core_md5:function(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16){var h=c,i=d,j=e,k=f;c=ANT.util.md5.md5_ff(c,d,e,f,a[g+0],7,-680876936),f=ANT.util.md5.md5_ff(f,c,d,e,a[g+1],12,-389564586),e=ANT.util.md5.md5_ff(e,f,c,d,a[g+2],17,606105819),d=ANT.util.md5.md5_ff(d,e,f,c,a[g+3],22,-1044525330),c=ANT.util.md5.md5_ff(c,d,e,f,a[g+4],7,-176418897),f=ANT.util.md5.md5_ff(f,c,d,e,a[g+5],12,1200080426),e=ANT.util.md5.md5_ff(e,f,c,d,a[g+6],17,-1473231341),d=ANT.util.md5.md5_ff(d,e,f,c,a[g+7],22,-45705983),c=ANT.util.md5.md5_ff(c,d,e,f,a[g+8],7,1770035416),f=ANT.util.md5.md5_ff(f,c,d,e,a[g+9],12,-1958414417),e=ANT.util.md5.md5_ff(e,f,c,d,a[g+10],17,-42063),d=ANT.util.md5.md5_ff(d,e,f,c,a[g+11],22,-1990404162),c=ANT.util.md5.md5_ff(c,d,e,f,a[g+12],7,1804603682),f=ANT.util.md5.md5_ff(f,c,d,e,a[g+13],12,-40341101),e=ANT.util.md5.md5_ff(e,f,c,d,a[g+14],17,-1502002290),d=ANT.util.md5.md5_ff(d,e,f,c,a[g+15],22,1236535329),c=ANT.util.md5.md5_gg(c,d,e,f,a[g+1],5,-165796510),f=ANT.util.md5.md5_gg(f,c,d,e,a[g+6],9,-1069501632),e=ANT.util.md5.md5_gg(e,f,c,d,a[g+11],14,643717713),d=ANT.util.md5.md5_gg(d,e,f,c,a[g+0],20,-373897302),c=ANT.util.md5.md5_gg(c,d,e,f,a[g+5],5,-701558691),f=ANT.util.md5.md5_gg(f,c,d,e,a[g+10],9,38016083),e=ANT.util.md5.md5_gg(e,f,c,d,a[g+15],14,-660478335),d=ANT.util.md5.md5_gg(d,e,f,c,a[g+4],20,-405537848),c=ANT.util.md5.md5_gg(c,d,e,f,a[g+9],5,568446438),f=ANT.util.md5.md5_gg(f,c,d,e,a[g+14],9,-1019803690),e=ANT.util.md5.md5_gg(e,f,c,d,a[g+3],14,-187363961),d=ANT.util.md5.md5_gg(d,e,f,c,a[g+8],20,1163531501),c=ANT.util.md5.md5_gg(c,d,e,f,a[g+13],5,-1444681467),f=ANT.util.md5.md5_gg(f,c,d,e,a[g+2],9,-51403784),e=ANT.util.md5.md5_gg(e,f,c,d,a[g+7],14,1735328473),d=ANT.util.md5.md5_gg(d,e,f,c,a[g+12],20,-1926607734),c=ANT.util.md5.md5_hh(c,d,e,f,a[g+5],4,-378558),f=ANT.util.md5.md5_hh(f,c,d,e,a[g+8],11,-2022574463),e=ANT.util.md5.md5_hh(e,f,c,d,a[g+11],16,1839030562),d=ANT.util.md5.md5_hh(d,e,f,c,a[g+14],23,-35309556),c=ANT.util.md5.md5_hh(c,d,e,f,a[g+1],4,-1530992060),f=ANT.util.md5.md5_hh(f,c,d,e,a[g+4],11,1272893353),e=ANT.util.md5.md5_hh(e,f,c,d,a[g+7],16,-155497632),d=ANT.util.md5.md5_hh(d,e,f,c,a[g+10],23,-1094730640),c=ANT.util.md5.md5_hh(c,d,e,f,a[g+13],4,681279174),f=ANT.util.md5.md5_hh(f,c,d,e,a[g+0],11,-358537222),e=ANT.util.md5.md5_hh(e,f,c,d,a[g+3],16,-722521979),d=ANT.util.md5.md5_hh(d,e,f,c,a[g+6],23,76029189),c=ANT.util.md5.md5_hh(c,d,e,f,a[g+9],4,-640364487),f=ANT.util.md5.md5_hh(f,c,d,e,a[g+12],11,-421815835),e=ANT.util.md5.md5_hh(e,f,c,d,a[g+15],16,530742520),d=ANT.util.md5.md5_hh(d,e,f,c,a[g+2],23,-995338651),c=ANT.util.md5.md5_ii(c,d,e,f,a[g+0],6,-198630844),f=ANT.util.md5.md5_ii(f,c,d,e,a[g+7],10,1126891415),e=ANT.util.md5.md5_ii(e,f,c,d,a[g+14],15,-1416354905),d=ANT.util.md5.md5_ii(d,e,f,c,a[g+5],21,-57434055),c=ANT.util.md5.md5_ii(c,d,e,f,a[g+12],6,1700485571),f=ANT.util.md5.md5_ii(f,c,d,e,a[g+3],10,-1894986606),e=ANT.util.md5.md5_ii(e,f,c,d,a[g+10],15,-1051523),d=ANT.util.md5.md5_ii(d,e,f,c,a[g+1],21,-2054922799),c=ANT.util.md5.md5_ii(c,d,e,f,a[g+8],6,1873313359),f=ANT.util.md5.md5_ii(f,c,d,e,a[g+15],10,-30611744),e=ANT.util.md5.md5_ii(e,f,c,d,a[g+6],15,-1560198380),d=ANT.util.md5.md5_ii(d,e,f,c,a[g+13],21,1309151649),c=ANT.util.md5.md5_ii(c,d,e,f,a[g+4],6,-145523070),f=ANT.util.md5.md5_ii(f,c,d,e,a[g+11],10,-1120210379),e=ANT.util.md5.md5_ii(e,f,c,d,a[g+2],15,718787259),d=ANT.util.md5.md5_ii(d,e,f,c,a[g+9],21,-343485551),c=ANT.util.md5.safe_add(c,h),d=ANT.util.md5.safe_add(d,i),e=ANT.util.md5.safe_add(e,j),f=ANT.util.md5.safe_add(f,k)}return Array(c,d,e,f)},md5_cmn:function(a,b,c,d,e,f){return ANT.util.md5.safe_add(ANT.util.md5.bit_rol(ANT.util.md5.safe_add(ANT.util.md5.safe_add(b,a),ANT.util.md5.safe_add(d,f)),e),c)},md5_ff:function(a,b,c,d,e,f,g){return ANT.util.md5.md5_cmn(b&c|~b&d,a,b,e,f,g)},md5_gg:function(a,b,c,d,e,f,g){return ANT.util.md5.md5_cmn(b&d|c&~d,a,b,e,f,g)},md5_hh:function(a,b,c,d,e,f,g){return ANT.util.md5.md5_cmn(b^c^d,a,b,e,f,g)},md5_ii:function(a,b,c,d,e,f,g){return ANT.util.md5.md5_cmn(c^(b|~d),a,b,e,f,g)},safe_add:function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c},bit_rol:function(a,b){return a<<b|a>>>32-b},str2binl:function(a){for(var b=Array(),c=(1<<ANT.util.md5.chrsz)-1,d=0;d<a.length*ANT.util.md5.chrsz;d+=ANT.util.md5.chrsz)b[d>>5]|=(a.charCodeAt(d/ANT.util.md5.chrsz)&c)<<d%32;return b},binl2hex:function(a){for(var b=ANT.util.md5.hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>d%4*8+4&15)+b.charAt(a[d>>2]>>d%4*8&15);return c}},getCleanText:function(a){var c=a.clone();c.find(".ant, .ant-custom-cta-container").remove();var d=c.find(".ant_indicator");if(!d.length){var e=b.trim(c.html().replace(/< *br *\/?>/gi," ")),f=b.trim(b("<div>"+e+"</div>").text().toLowerCase());if(f&&"string"==typeof f&&""!==f){var g=f.replace(/[\n\r\t]+/gi," ").replace().replace(/\s{2,}/g," ");return b.trim(g)}}},trimToLastWord:function(a){var b=/\w+$/.exec(a);return b?a.slice(0,a.length-b[0].length):a},cssSuperImportant:function(a,c,d){var e="";b.each(c,function(a,d){d.replace("!important",""),b.trim(d),d+=" !important",c[a]=d});var f=a.attr("style")||"",g=d?c:b.extend(ANT.util.parseCssAttrToDict(f),c);return b.each(g,function(a,b){e+=a+":"+b+";"}),a.attr("style",e),a},parseCssAttrToDict:function(a){var c={},d=a.split(";");return b.each(d,function(a,d){var e=d.split(":"),f=b.trim(e[0]),g=b.trim(e[1]);f.length&&g.length&&(c[f]=g)}),c},fixBrTags:function(){var a=b(ANT.group.br_replace_scope_selector).find("> br").parent();if(a.length){var c="|ant|br|/ant|";a.each(function(){var a=b(this),d=a.clone(),e=b("<p></p>");d.find("> br").each(function(){b(this).replaceWith(c)});for(var f=d.html().split(c),g=0;g<f.length;g++){var h=f[g];e.append('<div class="ant_br_replaced">'+h+"</div>")}a.addClass("ant_br_replaced_section").html(e.html())})}},fixBodyBorderOffsetIssue:function(){var a=b("body"),c=parseInt(a.css("border-top-width"),10),d=parseInt(a.css("border-left-width"),10),e=b("#ant_sandbox");(c||d)&&ANT.util.cssSuperImportant(e,{top:c+"px",left:d+"px"})},throttledUpdateContainerTrackers:function(){return ANT.util._.throttle(ANT.actions.indicators.utils.updateContainerTrackers,100)},userLoginState:function(){if(b("#ant-user").length||b(".ant-page-summary").find("div.ant-summary").prepend('<div id="ant-user" />'),ANT&&ANT.user&&ANT.user.full_name&&b(".ant-page-summary.defaultSummaryBar").length){var a="facebook"==ANT.user.user_type?ANT.user.full_name.split(" ")[0]:ANT.user.full_name;b("#ant-user").html('Hi, <a href="'+ANT_baseUrl+"/user/"+ANT.user.user_id+'" target="_blank">'+a+"</a>")}else b("#ant-user").html('<a href="javascript:void(0);">Log in to Antenna</a>'),b("#ant-user").find("a").click(function(){ANT.session.showLoginPanel()})},objLength:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},_:{debounce:function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},throttle:function(a,b){var c={};c.debounce=ANT.util._.debounce;var d,e,f,g,h,i=c.debounce(function(){h=g=!1},b);return function(){d=this,e=arguments;var c=function(){f=null,h&&a.apply(d,e),i()};f||(f=setTimeout(c,b)),g?h=!0:a.apply(d,e),i(),g=!0}},once:function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}}},getQueryParams:function(a){for(var b,c=a||window.location.search,d={},e=/\+/g,f=/([^&=]+)=?([^&]*)/g,g=function(a){return decodeURIComponent(a.replace(e," "))},h=c.substring(1);b=f.exec(h);)d[g(b[1])]=g(b[2]);return d},getQueryStrFromUrl:function(a){var b,c,d=a.indexOf("?");return-1==d?(b=a,c=""):(b=a.slice(0,d),c=a.slice(d)),c},createGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},killSessions:function(){localStorage.removeItem("ant_sts"),localStorage.removeItem("ant_lts"),ANT.user.sts=null,ANT.user.lts=null},activeAB:function(){return!0},checkSessions:function(){var a=JSON.parse(localStorage.getItem("ant_sts")),b=localStorage.getItem("ant_lts");if(!a||(new Date).getTime()>a.expires){var c=ANT.user.sts=ANT.util.createGuid(),d=new Date,e=15;d.setTime(d.getTime()+60*e*1e3);var f={guid:c,expires:d.getTime()};localStorage.setItem("ant_sts",JSON.stringify(f))}else{ANT.user.sts=a.guid;var e=10,d=new Date;d.setTime(d.getTime()+60*e*1e3);var f={guid:ANT.user.sts,expires:d.getTime()};localStorage.setItem("ant_sts",JSON.stringify(f))}if(b)ANT.user.lts=b;else{var g=ANT.user.lts=ANT.util.createGuid();localStorage.setItem("ant_lts",g)}}},debug:function(){window.ANT=window.ANTENNAIS,window.$ANT=$ANT,window.$A=a},toggle:function(){a("body").toggleClass("no-ant")},getLastEvent:function(){return{event:ANT.events.lastEvent?ANT.events.lastEvent:"",value:ANT.events.lastValue?ANT.events.lastValue:"",supplementary:ANT.events.lastSupplementary?ANT.events.lastSupplementary:{}}},session:{alertBar:{make:function(a,c){var d,e,f;if("fromShareLink"==a&&"undefined"!=c.content){var g=unescape(b.evalJSON('"'+c.content+'"'));d=b("<h1>Shared with <span>Antenna</span></h1>"),e=b(1==b('img[ant-hash="'+c.container_hash+'"]').length?'<div><strong class="reactionText">'+ANT.t("single_reaction")+": <em>"+c.reaction+'</em></strong> <a class="ant_showSelection" href="javascript:void(0);"><img src="'+c.content+'" style="max-width:100px !important;max-height:70px !important;margin:5px 0 !important;display:block !important;" /> <strong class="seeItLinkText ant_blue">Show it on the page</strong></a></div>':'<div><strong class="reactionText">'+ANT.t("single_reaction")+": <em>"+c.reaction+'</em></strong><strong>"</strong><em>'+g.substr(0,140)+'...</em><strong>"</strong><br /><strong class="seeItLinkText"><a class="ant_showSelection" href="javascript:void(0);">Show it on the page</a></strong></div>'),e.find("a.ant_showSelection").click(function(){setTimeout(function(){ANT.session.revealSharedContent(c)},200)})}if("undefined"!=typeof d){f=b('<span class="ant-antenna-logo"></span>');var h=b('<div class="ant_alert_box ant ant_'+a+'" />');h.append(b('<div class="ant_alert_box_1" />').append(f).append(d),b('<div class="ant_alert_box_2" />').append(e),'<div class="ant ant_alert_box_x">x</div>'),b("#ant_sandbox").append(h),b("div.ant_alert_box.ant_"+a).find(".ant_alert_box_x").click(function(){ANT.session.alertBar.close(a)}),b("div.ant_alert_box.ant_"+a).animate({top:-5},1e3)}},close:function(a){b("div.ant_alert_box.ant_"+a).remove(),b("div.ant_indicator_for_media").hide(),b.postMessage("close "+a,ANT_baseUrl+"/static/xdm.html",window.frames["ant-xdm-hidden"])}},revealSharedContent:function(a){var c=a.container_hash,d=b('[ant-hash="'+c+'"]'),e=d.data("kind");if(("img"==e||"media"==e||"med"==e)&&(d.addClass("ant_shared"),ANT.actions.indicators.utils.updateContainerTracker(c)),a.location&&"None"!=a.location){var f=a.location,g=(b().selog("stack"),d.selog("save",{serialRange:f}));b().selog("hilite",g,"on"),b("div.ant_page_summary").remove()}var h=d.offset().top,i=130,j=h-i||0;b("html,body").animate({scrollTop:j},1e3)},getSharedLinkInfo:function(a){if("pag"!=ANT.util.cookies.read("content_type")){var b=a.container_hash,c=!!ANT.containers[b];if(!c)return;return ANT.session.alertBar.make("fromShareLink",a),!0}},getUser:function(a,c){c&&a?ANT.session.receiveMessage(a,c):c&&ANT.session.receiveMessage(!1,c),b.postMessage("getUser",ANT_baseUrl+"/static/xdm.html",window.frames["ant-xdm-hidden"])},handleGetUserFail:function(a,c){var d=a.response;switch(d.message){case"Error getting user!":ANT.session.killUser();break;case"Temporary user interaction limit reached":ANT.session.showLoginPanel(a,c);break;case"Container specified does not exist":break;case"Token was invalid":case"Facebook token expired":case"FB graph error - token invalid":case"Social Auth does not exist for user":case"Data to create token is missing":"undefined"!=typeof ANT.user.user_type&&"antenna"==ANT.user.user_type?ANT.session.showLoginPanel(a,c):(ANT.user.getUserAttempts=ANT.user.getUserAttempts||1,ANT.user.getUserAttempts<2?(ANT.session.receiveMessage(a,c),b.postMessage("reauthUser",ANT_baseUrl+"/static/xdm.html",window.frames["ant-xdm-hidden"])):(ANT.session.killUser(),ANT.session.showLoginPanel(a,c)))}},createXDMframe:function(){ANT.session.receiveMessage({},function(){ANT.util.userLoginState()});var a=ANT_baseUrl+"/static/xdm.html",c=window.location.href,d=window.location.protocol+"//"+window.location.host,e=ANT.engageScriptParams.bookmarklet?"bookmarklet=true":"",f=b('<iframe id="ant-xdm-hidden" name="ant-xdm-hidden" src="'+a+"?parentUrl="+c+"&parentHost="+d+"&group_id="+ANT.group.id+"&group_name="+encodeURIComponent(ANT.group.name)+"&"+e+'" width="1" height="1" style="position:absolute;top:-1000px;left:-1000px;" />');b("#ant_sandbox").append(f),$ANT.dequeue("initAjax")},receiveMessage:function(a,c){b.receiveMessage(function(d){var e=b.evalJSON(d.data);if(e.status)if("returning_user"==e.status||"got_temp_user"==e.status){for(var f in e.data)ANT.user=ANT.user||{},"user_boards"==f?ANT.user.user_boards=b.evalJSON(e.data[f]):ANT.user[f]=isNaN(e.data[f])?e.data[f]:parseInt(e.data[f],10);c&&a?(!a.kind&&a.aWindow&&(a.kind=b(a.aWindow).data("kind")),a.user=ANT.user,c(a),c=null):c&&(c(),c=null),ANT.util.userLoginState()}else if("xdm loaded"==e.status)ANT.group.xdmLoaded=!0,ANT.events.fireEventQueue();else if("board_created"==e.status)b("div.ant-board-create-div").remove();else if("board_create_cancel"==e.status)clearInterval(ANT.checkingBoardWindow),b("div.ant-board-create-div").remove();else if("getUserLoginState"==e.status)ANT.session.getUser(),b("#ant_loginPanel").remove();else if("fb_user_needs_to_login"==e.status)c&&a?ANT.session.showLoginPanel(a,c):ANT.session.showLoginPanel(a);else if("close login panel"==e.status)ANT.util.userLoginState(),b("#ant_loginPanel").remove(),b("div.ant-summary div.ant_info").html("<em>You're logged in!  Try your last reaction again.");else if("already had user"==e.status)b("#ant_loginPanel div.ant_body").html('<div style="padding: 5px 0; margin:0 8px; border-top:1px solid #ccc;"><strong>Welcome!</strong> You\'re logged in.</div>');else if(-1!=e.status.indexOf("recircClick")){var g=e.status.split("|");g[1]&&(ANT.session.referring_int_id=parseInt(g[1],10)),ANT.events.trackEventToCloud({event_type:"rc",event_value:""+ANT.session.referring_int_id,page_id:ANT.util.getPageProperty("id")})}else if(-1!=e.status.indexOf("sharedLink")){var h=e.status.split("|");h[5]&&(ANT.session.referring_int_id=parseInt(h[5],10)),ANT.session.getSharedLinkInfo({container_hash:h[1],location:h[2],reaction:h[3],content:h[4],page_hash:h[6],redirect_type:h[7]})}},ANT_baseUrl)},login:function(){},checkForMaxInteractions:function(){ANT.user=ANT.user||{};var a=!ANT.user.user_type;return a&&ANT.user.num_interactions&&ANT.user.num_interactions>=ANT.group.temp_interact?!0:!1},showLoginPanel:function(a,c){if(b(".ant_rewritable").removeClass("ant_rewritable"),b("#ant_loginPanel").length<1){var d;if(a&&a.aWindow){var e=a.aWindow;d=e.offset(),d.left=d.left?d.left-34:100,d.top=d.top?d.top-25:100}else d=[],d.left=b(window).width()/2-200,d.top=150+b(window).scrollTop();var f=ANT.aWindow.draw({coords:d,id:"ant_loginPanel",pnls:1,height:175,ignoreWindowEdges:"bt",purpose:"login"});a&&f.data("args",a),c&&f.data("callback",c);var g=ANT_baseUrl+"/static/fb_login.html",h=window.location.href,i=window.location.protocol+"//"+window.location.host,j=a&&a.response&&-1!=a.response.message.indexOf("Temporary user interaction")?"Log In to Continue Reacting":"Log In to Antenna",k=b('<iframe id="ant-xdm-login" src="'+g+"?parentUrl="+h+"&parentHost="+i+"&group_id="+ANT.group.id+"&group_name="+ANT.group.name+'" width="280" height="200" frameborder="0" style="overflow:hidden; width:280px !important;height:200px;" />');a&&a.response&&-1!=a.response.message.indexOf("organic")&&(j="Signing in is required for custom reactions");var l=ANT.aWindow.makeHeader(j);f.find(".ant_header").replaceWith(l),ANT.aWindow.hideFooter(f),f.find("div.ant_body_wrap").append('<div class="ant_body" />').append(k)}},killUser:function(){ANT.user={},ANT.util.killSessions(),b.postMessage("killUser",ANT_baseUrl+"/static/xdm.html",window.frames["ant-xdm-hidden"])},aWindowUserMessage:{show:function(a){var c=a.aWindow,d=a.interactionInfo;if(c){var e=a.msgType||null,f=null,g=45,h=c.height(),i=300,j=c.find(".ant_body_wrap"),k=c.find("div.ant_aWindow_message"),l=c.find(".ant_aWindow_message_innerwrap"),m=b("div.ant_otherTagsWrap"),n=c.find(".ant_aWindow_message_tempUserMsg");switch(k.show(),e){case"tempUser":var o=ANT.group.temp_interact-parseInt(a.num_interactions,10),p=b('<a href="javascript:void(0);">Connect with Facebook</a>.');p.click(function(){ANT.session.showLoginPanel(a)});var q="You can react or comment <strong>"+o+" more times</strong> before you must ";n.empty().append("<span>"+q+"</span>"),n.append(p);break;case"interactionSuccess":d.remove?(f="The "+d.type+" <em>"+d.body+"</em><br />has been removed.",n.empty()):(f="tag"==d.type?"You have tagged this <em>"+d.body+"</em>.":"comment"==d.type?"You have left your comment.":"",f+=" See your "+d.type+"s on this page, and at <strong><a href='"+ANT_baseUrl+"' target='_blank'>antenna.is</a></strong>");var r=a;c.find("div.ant_aWindow_message_tempUserMsg").text().length>0&&($inlineTempMsg=b("<div />"),$inlineTempMsg.html('<h4 style="font-size:17px;">You can react '+c.find("div.ant_aWindow_message_tempUserMsg strong").text()+'.</h4><br/><p><a style="font-weight:bold;color:#008be4;" href="javascript:void(0);">Connect with Facebook</a> to react as much as you want &amp; show other readers here what you think.</p><br/><p>Plus, you can share and comment in-line!</p><br/><a href="javascript:void(0);"><img src="'+ANT_staticUrl+'widget/images/fb-login_to_antenna.png" alt="Connect with Facebook" /></a>'),$inlineTempMsg.find("a").click(function(){ANT.session.showLoginPanel(r)}))}f&&k.find("span.ant_userMsg").html(f),l.hide(),c.queue("userMessage",function(){k.height()>0?(l.fadeIn(500),b(this).dequeue("userMessage")):(c.animate({height:h+g},i),m.animate({bottom:0},i),j.animate({bottom:g},i),k.animate({height:g},i,function(){l.fadeIn(500),b(this).dequeue("userMessage")}))}),c.dequeue("userMessage")}},hide:function(a){if(a){var c=b("div.ant_aWindow_message");$otherTagsWrap=b("div.ant_otherTagsWrap");var d=a.find(".ant_body_wrap"),e=c.height(),f=a.height(),g=300,h=10;a.queue("userMessage",function(){a.animate({height:f-e},g),$otherTagsWrap.animate({bottom:0-h},g),d.animate({bottom:h},g),c.animate({height:0},g,function(){c.hide(),b(this).dequeue("userMessage")})}),a.dequeue("userMessage")}}}},actions:{aboutAntenna:function(){},init:function(){var a=this;$ANT=b(ANT),window.antenna_extend_per_container=window.antenna_extend_per_container||{},$ANT.queue("initAjax",function(b){ANT.util.checkSessions(),a.initGroupData(ANT.group.short_name)}),$ANT.queue("initAjax",function(b){a.initEnvironment()}),$ANT.queue("initAjax",function(b){a.handleDeprecated()}),$ANT.queue("initAjax",function(b){a.initSeparateCtas()}),$ANT.queue("initAjax",function(b){a.initHTMLAttributes()}),$ANT.queue("initAjax",function(b){a.initPageData()}),$ANT.queue("initAjax",function(a){ANT.actions.runPostPageInit(),ANT.session.createXDMframe()}),$ANT.queue("initAjax",function(a){ANT.util.checkForSelectedTextAndLaunchAWindow(),ANT.util.initPublicEvents()}),$ANT.queue("initAjax",function(a){ANT.util.initTouchBrowserSettings()}),$ANT.dequeue("initAjax")},initGroupData:function(a){var c=window.antenna_host;b.ajax({url:ANT_baseUrl+"/api/settings/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON({host_name:c})},success:function(a,c,d){var e=a.data;"undefined"!=typeof e&&("undefined"!=typeof e.no_readr&&(e.no_ant=e.no_readr,delete e.no_readr),"undefined"!=typeof e.blessed_tags&&(e.default_reactions=e.blessed_tags.slice(),delete e.blessed_tags),"undefined"==typeof e.img_indicator_show_side||e.img_indicator_show_side||delete e.img_indicator_show_side,"undefined"==typeof e.tag_box_bg_colors||e.tag_box_bg_colors||delete e.tag_box_bg_colors,"undefined"==typeof e.tag_box_text_colors||e.tag_box_text_colors||delete e.tag_box_text_colors,"undefined"==typeof e.tag_box_bg_colors_hover||e.tag_box_bg_colors_hover||delete e.tag_box_bg_colors_hover,"undefined"==typeof e.tag_box_font_family||e.tag_box_font_family||delete e.tag_box_font_family,"undefined"==typeof e.tags_bg_css||e.tags_bg_css||delete e.tags_bg_css);var f=ANT.groupSettings?ANT.groupSettings.getCustomSettings():{};ANT.group=b.extend({},ANT.group.defaults,e,f);var g="";if(ANT.group.ab_test_impact===!0&&(g=ANT.util.activeAB()?"A":"B"),ANT.events.trackEventToCloud({event_type:"sl",event_value:g,page_id:ANT.util.getPageProperty("id"),content_attributes:ANT.util.activeAB()&&b(ANT.group.recirc_selector).first().length?"broadcast":ANT.group.content_attributes?ANT.group.content_attributes:null}),ANT.group.hideOnMobile===!0&&isTouchBrowser)return!1;ANT.group.anno_whitelist+=",div.ant_br_replaced",""==ANT.group.active_sections&&(ANT.group.active_sections="body");var h=ANT.group.active_sections.split(","),i="",j=ANT.group.anno_whitelist.split(",");b.each(h,function(a,c){c=b.trim(c),b.each(j,function(a,d){d=b.trim(d),i+=c+" "+d,a!=j.length-1&&(i+=",")}),a!=h.length-1&&(i+=",")}),ANT.group.active_sections_with_anno_whitelist=i,b("head").append(b('<style type="text/css">div.ant div.ant_body.ant_tags_list { '+ANT.group.tags_bg_css+" }div.ant div.ant_body.ant_tags_list .ant_box { "+ANT.group.tag_box_bg_colors+" }div.ant div.ant_body.ant_tags_list .ant_box:hover { "+ANT.group.tag_box_bg_colors_hover+" }div.ant div.ant_body.ant_tags_list .ant_box .ant_tag_actions * { "+ANT.group.tag_box_text_colors+" }div.ant div.ant_body.ant_tags_list .ant_box .ant_tag_body * { "+ANT.group.tag_box_text_colors+" }</style>")),
""!==ANT.group.custom_css&&b("head").append(b('<style type="text/css">'+ANT.group.custom_css+"</style>")),$ANT.dequeue("initAjax")},error:function(a){}})},initPageData:function(){var a=ANT.util.getQueryStrFromUrl(ANT.engageScriptSrc);ANT.engageScriptParams=ANT.util.getQueryParams(a),b(ANT.group.no_ant).each(function(){var a=b(this);a.addClass("no-ant"),a.find("img").addClass("no-ant")});var c,d,e,f,g,h,i=[],j=[],k={},l=0;if(""!==ANT.group.post_selector&&""!==ANT.group.post_href_selector&&""!==ANT.group.summary_widget_selector){var m=b(ANT.group.post_selector),l=m.length;m.each(function(){function a(a){var c=a.offset(),d=window,e=document,f=e.documentElement,g=e.getElementsByTagName("body")[0],h=(d.innerWidth||f.clientWidth||g.clientWidth,d.innerHeight||f.clientHeight||g.clientHeight),i=b(document).scrollTop(),j=h+i+300;return c.top<j?!0:!1}var f=b(this),h=f.find(ANT.group.post_href_selector);e="undefined"==typeof h||0===h.length||"undefined"==typeof h.attr("href")?"same"==ANT.util.getPageProperty("canonical_url")?ANT.util.getPageProperty("page_url"):ANT.util.getPageProperty("canonical_url"):ANT.actions.removeSubdomainFromPageUrl(h.attr("href"));var m=f.find(ANT.group.summary_widget_selector).eq(0);if(a(f)&&!f.hasAttr("ant-page-checked")){f.attr("ant-page-checked",!0),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),-1==e.indexOf(window.location.origin)&&1!=ANT.group.ignore_subdomain&&(e="/"==e.substr(0,1)?window.location.origin+e:window.location.origin+window.location.pathname+e);var n=ANT.util.md5.hex_md5(e);f.hasAttr("ant-page-container")||f.attr("ant-page-container","true").attr("ant-page-key",n),m.attr("ant-page-widget-key",n),j.push(e),1==l&&(g=ANT.group.image_selector&&ANT.group.image_attribute?b("html").find(ANT.group.image_selector).first().attr(ANT.group.image_attribute):""),c={group_id:parseInt(ANT.group.id,10),url:e,canonical_url:"same",title:h.text(),image:g},i.push(c),k[d]=c}})}var n=ANT.util.getPageProperty("page_url");if(0===l&&(-1==b.inArray(n,j)||0==j.length)){var o=b("body");if(!o.hasAttr("ant-page-checked")&&(f=ANT.util.getPageProperty("canonical_url"),h=ANT.util.getPageProperty("title"),g=ANT.group.image_selector&&ANT.group.image_attribute?b("html").find(ANT.group.image_selector).first().attr(ANT.group.image_attribute):"",c={group_id:parseInt(ANT.group.id,10),url:n,canonical_url:n==f?"same":f,title:h,image:g},ANT.group.thisPage=c,i.push(c),d=i.length-1,k[d]=c,!o.hasAttr("ant-page-container")))if(o.attr("ant-page-key",d).attr("ant-page-checked",!0),1==b(".ant-page-summary").length)b(".ant-page-summary").attr("ant-page-widget-key",d);else{var p=o.find(ANT.group.summary_widget_selector).eq(0);"0"!=p.attr("ant-page-widget-key")&&p.attr("ant-page-widget-key",d)}}var q={pages:i};i.length&&b.ajax({url:ANT_baseUrl+"/api/page/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(q)},success:function(a){if("success"!==a.status)return!1;ANT.status.page=!0;var c="";c=ANT.group.useDefaultSummaryBar===!0?"def":1===a.data.length?"si":a.data.length>1?"mu":"unex",b.each(a.data,function(a,b){b.url=k[d].url,b.key=ANT.util.md5.hex_md5(b.url),ANT.actions.pages.save(b.id,b),ANT.actions.pages.initPageContainer(b.id)});var e="";ANT.group.ab_test_impact===!0&&(e=ANT.util.activeAB()?"A":"B"),ANT.events.trackEventToCloud({event_type:"wl",event_value:e,page_id:ANT.util.getPageProperty("id"),content_attributes:ANT.group.content_attributes?ANT.group.content_attributes:c}),$ANT.dequeue("initAjax")},error:function(a){}})},runPostPageInit:function(){function a(a){var c=b(a),d=c.data("hash");setTimeout(function(){c.removeClass("ant_live_hover")},300),b("#ant_indicator_"+d).hide()}if(ANT.actions.indicators.utils.updateContainerTrackers(),b(ANT.group.active_sections).find("embed[ant-node], video[ant-node], iframe[ant-node], img[ant-node],"+ANT.group.anno_whitelist).each(function(){var a=b(this).attr("ant-hash");ANT.actions.indicators.init(a),ANT.actions.content_nodes.init(a,function(){})}),isTouchBrowser){if(b(ANT.group.active_sections_with_anno_whitelist).each(function(a,c){ANT.actions.indicators.init(b(c).attr("ant-hash"))}),!localStorage.getItem("hideDoubleTapMessage")&&!ANT.group.hideDoubleTapMessage){var c=ANT.group.doubleTapMessage?ANT.group.doubleTapMessage:ANT.t("doubleTapMessage")+" <a>"+ANT.t("close")+"</a>",d=ANT.group.doubleTapMessagePosition?"ant_"+ANT.group.doubleTapMessagePosition:"ant_bottom",e=b('<div class="ant ant_mobile_message">'+c+"</div>"),f=b("#ant_sandbox");e.addClass(d).on("touchend.ant",function(a){a.preventDefault(),localStorage.setItem("hideDoubleTapMessage",!0),b(this).remove()}).appendTo(f)}}else ANT.util.activeAB()&&b(ANT.group.active_sections).on("mouseenter.ant","embed, video, iframe, img",function(){ANT.actions.containers.media.disengageAll();var a=b(this);a.addClass("ant_live_hover"),ANT.actions.mediaNodeInit(a)}).on("mouseleave.ant","embed, video, iframe, img",function(c){var d=b(this),e=d.data("hash");d.parents(ANT.group.img_container_selectors).length||a(d),ANT.util.setFunctionTimer(function(){b("#ant_indicator_"+e).removeClass("ant_visible")},300,e)});ANT.util.activeAB()&&ANT.events.emit("antenna.hashed_nodes","complete",{})},mediaNodeInit:function(a){var c=a.data("hash");if(ANT.actions.indicators.utils.updateContainerTrackers(),!a.closest(".no-ant").length){var d=100;if(a.width()>=d){var e=a.hasAttr("ant-hashed"),f=a.closest(".ant, .no-ant").length;if(e||f){var c=a.data("hash");b("#ant_indicator_details_"+c).hasClass("ant_engaged")||ANT.util.setFunctionTimer(function(){b("#ant_indicator_"+c).addClass("ant_visible")},200,c),ANT.actions.content_nodes.init(c,function(){})}else{var c,g=ANT.actions.hashNodes(a);if(b.each(g,function(a,b){c=b[0]}),!c)return void ANT.safeThrow("There should always be a hash from hashNodes after hover on an unhashed image.");ANT.actions.sendHashes(g,function(){b("#ant_indicator_details_"+c).hasClass("ant_engaged")||ANT.util.setFunctionTimer(function(){b("#ant_indicator_"+c).addClass("ant_visible")},200,c),ANT.actions.content_nodes.init(c,function(){})})}}}},initEnvironment:function(){function a(a){for(var c=[],d=0;d<a.length;d++){var e=a[d];if(3!==e.nodeType){var f=b(e);0===f.closest(".ant,.ant_indicator,.ant-custom-cta-container").length&&c.push(f)}}return c}ANT.current.page_url=ANT.util.getPageProperty("page_url"),ANT.broadcast.init();var c=b('<div id="ant_sandbox" class="ant ant_sandbox"/>').appendTo("body");isTouchBrowser&&(b("#ant_sandbox").addClass("isTouchBrowser"),b("body").addClass("ant_touch_browser"));var d=["topics","author","section"];b.each(d,function(a,c){"undefined"!=ANT.group[c+"_selector"]&&"undefined"!=ANT.group[c+"_attribute"]&&b(ANT.group[c+"_selector"]).length&&(ANT.group[c]="",b(ANT.group[c+"_selector"]).each(function(){ANT.group[c]+=b(this).attr(ANT.group[c+"_attribute"])+","}),ANT.group[c]=ANT.group[c].substr(0,ANT.group[c].length-1))});var e=b(ANT.group.active_sections+":eq(0)").offset();ANT.group.active_section_top=e.top,ANT.group.active_section_bottom=e.bottom,ANT.group.active_section_height=e.bottom-e.top,ANT.group.active_section_milestones={0:ANT.group.active_section_top,20:ANT.group.active_section_height/5+ANT.group.active_section_top,40:ANT.group.active_section_height/5*2+ANT.group.active_section_top,60:ANT.group.active_section_height/5*3+ANT.group.active_section_top,80:ANT.group.active_section_height/5*4+ANT.group.active_section_top,100:ANT.group.active_section_bottom,fired:0},b(window).on("scrollstart",function(){ANT.actions.initPageData(),ANT.actions.indicators.utils.updateContainerTrackers(),ANT.actions.containers.media.disengageAll()}),b(window).on("scrollstop",function(){ANT.actions.initPageData()});var f=ANT.group.summary_widget_selector?", "+ANT.group.summary_widget_selector:"";ANT.events.recordEvents=b(".ant-page-summary"+f).length,ANT.util.fixBodyBorderOffsetIssue(),ANT.group.br_replace_scope_selector&&ANT.util.fixBrTags();var g={paddingLeft:-1!=b("body").css("padding-left").indexOf("%")?b(window).width()*(parseInt(b("body").css("padding-left"))/100):parseInt(b("body").css("padding-left")),marginLeft:-1!=b("body").css("margin-left").indexOf("%")?b(window).width()*(parseInt(b("body").css("margin-left"))/100):parseInt(b("body").css("margin-left")),left:-1!=b("body").css("left").indexOf("%")?b(window).width()*(parseInt(b("body").css("left"))/100):parseInt(b("body").css("left")),paddingLeft:-1!=b("body").css("padding-top").indexOf("%")?b(window).width()*(parseInt(b("body").css("padding-top"))/100):parseInt(b("body").css("padding-top")),marginTop:-1!=b("body").css("margin-top").indexOf("%")?b(window).width()*(parseInt(b("body").css("margin-top"))/100):parseInt(b("body").css("margin-top")),top:-1!=b("body").css("top").indexOf("%")?b(window).width()*(parseInt(b("body").css("top"))/100):parseInt(b("body").css("top"))},h=-(g.marginLeft+g.left+g.paddingLeft),i=-(g.marginTop+g.top+g.paddingTop);h=isNaN(h)?0:h,i=isNaN(i)?0:i;var j=parseInt(c.css("top"),10),k=parseInt(c.css("left"),10);ANT.util.cssSuperImportant(c,{left:k+h+"px",top:j+i+"px"},!0),c.append("<style>.ant_twtooltip { margin-left:"+h+"px !important; margin-top:"+i+"px !important;} "+ANT.group.active_sections_with_anno_whitelist+" {-webkit-user-select: text; -khtml-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text;} </style>"),b('<div id="ant_container_tracker_wrap" /><div id="ant_indicator_details_wrapper" /><div id="ant_event_pixels" />').appendTo(c),b(document).on("mouseup.ant",function(a){setTimeout(function(){ANT.actions.startSelectFromMouseUp(a)},1)}),isTouchBrowser?(b("body").on("touchend.ant",function(a){if(!ANT.util.isTouchDragging(a)){if(ANT.util.bubblingEvents.touchend===!1){var c=b(a.target);(c.closest(".ant_inline").length||!c.hasAttr("ant-cta-for")&&!c.parents().hasClass("ant")&&!b("div.ant-board-create-div").length)&&(c.closest("[ant-node]").length&&"img"!=c.get(0).nodeName.toLowerCase()||ANT.actions.UIClearState())}ANT.util.bubblingEvents.touchend=!1}}),b("body").on("touchstart.ant",function(a){ANT.util.bubblingEvents.startY=a.originalEvent.touches[0].clientY})):b(document).on("mouseup.ant",function(a){var c=b(a.target);(c.closest(".ant_inline").length||!c.hasAttr("ant-cta-for")&&!c.parents().hasClass("ant")&&!b("div.ant-board-create-div").length)&&(ANT.actions.UIClearState(),b("div.ant_indicator_details_for_media").each(function(){ANT.actions.containers.media.onDisengage(b(this).data("container"))}))}),b(document).on("keyup.ant",function(a){"27"==a.keyCode&&ANT.actions.UIClearState()}),b(window).resize(ANT.util.throttledUpdateContainerTrackers());var l=new MutationObserver(function(c){for(var d=0;d<c.length;d++){var e=a(c[d].addedNodes);if(e.length>0){ANT.actions.initSeparateCtas(),ANT.actions.hashCustomDisplayHashes(),ANT.actions.indicators.utils.updateContainerTrackers();var f=window.location.port?":"+window.location.port:"",g=(window.location.protocol+"//"+window.location.hostname+f+window.location.pathname).toLowerCase();if(ANT.current&&(2==ANT.current.page_url.split("//")[1].split("/").length||-1==g.indexOf(ANT.current.page_url))&&ANT.current.page_url!=g){b(".ant-summary").remove(),ANT.current.page_url=g;var h=0,i=setInterval(function(){if(h++<120){var a=b(ANT.group.active_sections),c=ANT.current.first_hashed_content?b('[ant-hash="'+ANT.current.first_hashed_content+'"]'):b();c.length&&ANT.actions.hashNodes(c,!0),(a.length<1||!ANT.current.first_hashed_content||!c.length)&&a.length&&a.find(ANT.group.anno_whitelist).length&&(ANT.actions.reset(),ANT.actions.indicators.utils.updateContainerTrackers(),clearInterval(i))}else clearInterval(i)},25)}}}}),m=document.body;l.observe(m,{childList:!0,attributes:!1,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}),$ANT.dequeue("initAjax")},handleDeprecated:function(){ANT.util.activeAB()&&b("[ant-custom-display]").each(function(){var a=b(this);a.attr("ant-item",a.attr("ant-custom-display")),a.removeAttr("ant-custom-display")}),$ANT.dequeue("initAjax")},initSeparateCtas:function(){if(ANT.group.separate_cta){var a=0,c=b(ANT.group.active_sections).find(ANT.group.separate_cta).not("[ant-hash]");c.length&&c.each(function(c,d){var e=b(d),f=d.nodeName.toLowerCase();if(!e.closest(ANT.group.no_ant).length){if(e.hasAttr("ant-item"))var g=e.attr("ant-item");else{var g="ant-custom-cta-"+a;e.hasAttr("ant-item")||e.attr("ant-item",g)}b('[ant-cta-for="'+g+'"]').length||e.after('<div class="ant-custom-cta-container" ant-tag-type="'+f+'"><div class="ant-custom-cta" ant-cta-for="'+g+'" ant-mode="read write"><span class="ant-antenna-logo"></span> <span ant-counter-for="'+g+'"></span> <span ant-reactions-label-for="'+g+'">'+ANT.t("your_reaction")+"</span></div> </div>"),a++}})}$ANT.dequeue("initAjax")},initHTMLAttributes:function(){b("[ant-item]").each(function(){var a=b(this),c=a.attr("ant-item"),d=a.hasAttr("ant-reactions")?a.attr("ant-reactions"):"";if(d&&"undefined"==typeof window.antenna_extend_per_container[c]){var e={};e.default_reactions=[],b.each(d.split(";"),function(a,c){e.default_reactions.push(b.trim(c))}),window.antenna_extend_per_container[c]=e}}),$ANT.dequeue("initAjax")},reInit:function(){ANT.actions.removeHashes(),ANT.actions.hashCustomDisplayHashes()},reset:function(){b("[ant-page-checked]").removeAttr("ant-page-checked"),b("[ant-page-container]").removeAttr("ant-page-container"),b(".ant-summary").remove(),$ANT.queue("initAjax",function(a){ANT.actions.initPageData()}),$ANT.queue("initAjax",function(a){ANT.actions.runPostPageInit()}),$ANT.dequeue("initAjax"),ANT.actions.removeHashes(),ANT.actions.hashCustomDisplayHashes()},UIClearState:function(a){b("div.ant_twtooltip").remove(),b(".ant_live_hover").removeClass("ant_live_hover"),ANT.aWindow.closeAll(),ANT.actionbar.closeAll(),ANT.actions.containers.media.disengageAll(),setTimeout(ANT.actions.containers.media.disengageAll,333),setTimeout(ANT.actions.containers.media.disengageAll,1e3),isTouchBrowser||b("div.ant_indicator_for_media").hide(),b().selog("hilite",!0,"off");var c=b(".ant_fromShareLink").length;c&&ANT.session.alertBar.close("fromShareLink")},catchRangyErrors:function(a){ANT.safeThrow(a)},hashNodes:function(a,c){var d;if("undefined"!=typeof a&&ANT.util.activeAB()){d=a.hasAttr("ant-item")?a:a.find(ANT.group.active_sections_with_anno_whitelist).length?a.find(ANT.group.active_sections_with_anno_whitelist):a.find(ANT.group.anno_whitelist).length?a.find(ANT.group.anno_whitelist):a;var e=b();b.each(d,function(a,d){var f=b(d);if(!(f.closest(".no-ant").length||f.hasClass("no-ant")||f.hasClass("ant")||!c&&f.hasAttr("ant-hashed"))){var g="",h="",i="";if(i=f.get(0).nodeName.toLowerCase(),f.hasAttr("ant-item-type")?h="image"==f.attr("ant-item-type")?"img":f.attr("ant-item-type"):("img"==i&&(h="img"),("iframe"==i||"video"==i||"embed"==i)&&(h="media"),f.text()&&(h="text")),"media"==h){var g=f.hasAttr("ant-item-content")?f.attr("ant-item-content"):"undefined"!=typeof this.src?this.src:"undefined"!=typeof this.data?this.data:"";0===g.indexOf("/")&&(g=window.location.origin+g),0!==g.indexOf("http")&&(g=window.location.origin+window.location.pathname+g)}if("img"==h){var g=f.hasAttr("src")?f.attr("src"):f.attr("ant-item-content");if(!g)return;0===g.indexOf("/")&&(g=window.location.origin+g),0!==g.indexOf("http")&&(g=window.location.origin+window.location.pathname+g)}"text"==h&&(g=ANT.util.getCleanText(f)),h&&g&&(f.data("body",g),f.data("kind",h),f.data("isCustom",f.hasAttr("ant-item-content")?!0:!1),e=e.add(f))}});var f={};return e.each(function(){var a,c,d,e=b(this),g=e.data("body"),h=e.data("kind"),i=e.data("isCustom"),j=e.get(0).nodeName.toLowerCase(),k=g;if("img"!=h&&"media"!=h||!g){if(!g)return;if(d="rdr-"+h+"-"+g,a=ANT.util.md5.hex_md5(d),!e.hasAttr("ant-hash"))for(var l=1;"undefined"!=typeof ANT.summaries[a];)d="rdr-"+h+"-"+g+"-"+l,a=ANT.util.md5.hex_md5(d),l++}else{d="rdr-"+h+"-"+k,c=ANT.util.md5.hex_md5(d),e.data("oldHash",c);var m=/[-\w]+\.(?:[-\w]+\.xn--[-\w]+|[-\w]{2,}|[-\w]+\.[-\w]{2})$/i,n=k.split("/");n.splice(0,2);var o=n.shift();if(!o)return;var p=o.split(":")[0],q=n.join("/"),r=m.exec(p);if(null==r)return;k=r[0]+"/"+q;var s=["soundcloud.com"];b.each(s,function(a,b){-1!=k.indexOf(b)&&(ANT.group.media_url_ignore_query=!1)}),ANT.group.media_url_ignore_query&&k.indexOf("?")&&(k=k.split("?")[0]),e.hasAttr("ant-oldhash")?a=e.data("hash"):(d="rdr-"+h+"-"+k,a=ANT.util.md5.hex_md5(d))}e.hasAttr("ant-hash")&&e.attr("ant-hash")!=a&&ANT.actions.removeHashes(e);var t=e.parents("[ant-hash]");t.length&&ANT.actions.stripAntNode(t);var u=e.get(0).nodeName.toLowerCase();if("img"==u&&t.length&&!e.siblings(ANT.group.anno_whitelist).length&&ANT.actions.stripAntNode(t),e.find(ANT.group.anno_whitelist).length){var v=!1;if(e.find(ANT.group.anno_whitelist).each(function(a,c){var d=c.nodeName.toLowerCase(),e=["img","iframe","embed"];i||-1!=b.inArray(d,e)||(v=!0)}),v===!0)return}ANT.actions.containers.save({body:g,kind:h,hash:a,HTMLkind:j,$this:e}),e.attr("ant-hash",a).attr("ant-node","true").attr("ant-hashed",!0),"body"==j||isTouchBrowser||e.on("mouseenter.ant",function(){var c=b(this);ANT.util.setFunctionTimer(function(){c.addClass("ant_live_hover")},300,a)}).on("mouseleave.ant",function(){var c=b(this);ANT.util.setFunctionTimer(function(){c.removeClass("ant_live_hover")},300,a)});var w=ANT.actions.summaries.init(a);ANT.actions.summaries.save(w);var x=ANT.util.getPageProperty("id",a);f[x]||(f[x]=[]),f[x].push(a),e.data("hash",a)}),f}},sendHashes:function(a,c){b.each(a,function(a,d){if(!a||"object"!=typeof d)return void ANT.safeThrow("No more messy hashes allowed!!");var e=b('[ant-page-container="'+a+'"]');b.each(e.find("[ant-item]"),function(a,c){var e=b(c);if("undefined"==typeof e.data("ant-hashed")){var f=e.attr("ant-hash");d=b.grep(d,function(a){return a!=f}),"undefined"!=typeof f&&d.push(f),ANT.actions.indicators.init(f),e.data("ant-hashed",!0)}}),b.each(d,function(a,b){if("string"!=typeof b)return void ANT.safeThrow("why is your hash not a string!?");var c=e.find('[ant-hash="'+b+'"]');if(1==c.length)c.attr("ant-hashed",!0);else{var f=d.indexOf(b);f>-1&&d.splice(f,1)}});var f=parseInt(a,10);isNaN(f)&&ANT.safeThrow("why is the pageID NAN ??: "+a+"-->"+f);var g=[];b.each(b('[ant-crossPageContent="true"]'),function(a,c){var e=b(c).attr("ant-hash");g.push(e),d=b.grep(d,function(a){return a!=e}),ANT.actions.indicators.init(e)}),ANT.actions.sendHashesForSinglePage({short_name:ANT.group.short_name,pageID:f,hashes:d,crossPageHashes:g},c)})},sendHashesForSinglePage:function(a,c){if(ANT.status.page===!0){var d=a.pageID;b.ajax({url:ANT_baseUrl+"/api/summary/containers/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(a)},success:function(a){if("undefined"!=typeof a&&"undefined"!=typeof a.data){"undefined"!=typeof a.data.known&&(ANT.known_hashes=a.data.known),"undefined"!=typeof a.data.crossPageKnown&&("undefined"!=typeof a.data.known&&(ANT.known_hashes=b.extend(ANT.known_hashes,a.data.crossPageKnown)),ANT.crosspage_hashes=a.data.crossPageKnown),b.each(b('[ant-crossPageContent="true"]'),function(a,c){var d=b(c).attr("ant-hash"),e={hash:d,counts:{coms:0,tags:0,interactions:0},top_interactions:{coms:[],tags:{}}};"undefined"!=typeof ANT.crosspage_hashes&&(ANT.crosspage_hashes={}),ANT.crosspage_hashes[d]=e});var e={};e[d]=a.data.known,b.each(a.data.unknown,function(a,c){if("string"!=typeof c)return void ANT.safeThrow("why would this not be a string?");var f,g=b('[ant-hash="'+c+'"]'),h=g.data("kind");h||ANT.safeThrow("node should always have data: kind"),f=ANT.util.makeEmptySummary(c,h),e[d][c]=f}),b.isEmptyObject(e)||(ANT.actions.containers.setup(e),"undefined"!=typeof c&&c());var f=[];b.each(a.data.crossPageKnown,function(a,b){-1==f.indexOf(b.hash)&&f.push(b.hash)}),b.each(b("[ant-item]"),function(a,c){-1==f.indexOf(b(c).data("hash"))&&f.push(b(c).data("hash"))}),ANT.actions.containers.initCustomDisplayHashes(f)}}})}},removeHashes:function(a){a||(a=b("[ant-item]")),a.each(function(a,c){var d=b(c);d.removeAttr("ant-hash").removeAttr("ant-hasindicator").removeAttr("ant-node").removeAttr("ant-hashed").removeAttr("ant-summary-loaded")})},removeSubdomainFromPageUrl:function(a){if(1==ANT.group.ignore_subdomain&&ANT.group.page_tld){var b=a.split("/"),c=b[0];b.splice(0,3);var d=c+"//"+ANT.group.page_tld+"/"+b.join("/");return d}return a},hashCustomDisplayHashes:function(){var a={},c=ANT.util.getPageProperty();a[c]=[],b("[ant-item]:not([ant-hash])").length&&b.each(b("[ant-item]"),function(d,e){var f=b(e);ANT.actions.hashNodes(f);var g=f.attr("ant-hash");a[c].push(g),ANT.actions.indicators.init(g),ANT.actions.mediaNodeInit(f)}),a[c].length&&ANT.actions.sendHashes(a)},comments:{makeCommentBox:function(a,c){a.content_node,a.tag,a.summary,a.hash,a.kind,a.$aWindow,a.selState;c=c||{};var d=c.helpText||ANT.t("add_comment"),e=(c.cta||ANT.t("comment"),b('<div class="ant_commentBox ant_clearfix"></div>')),f=b('<div class="ant_comment">'),g=b('<textarea class="ant_default_msg">'+d+"</textarea>"),h=b('<div class="ant_charCount">'+ANT.t("characters_left").replace("NNN",ANT.group.comment_length)+"</div>"),i=b('<button class="ant_commentSubmit">'+ANT.t("comment")+"</button>");return f.append(g,h,i),g.focus(function(){b(this).removeClass("ant_default_msg"),b(this).val()==d&&b(this).val("")}).blur(function(){var a=b(this).val();(""===a||a===d)&&(b(this).addClass("ant_default_msg"),b(this).val(d))}).keyup(function(a){var c=g.val();return"27"==a.keyCode?(b(this).blur(),!1):(c.length>ANT.group.comment_length&&(c=c.substr(0,ANT.group.comment_length),g.val(c)),void g.siblings("div.ant_charCount").text(ANT.t("characters_left").replace("NNN",ANT.group.comment_length-c.length)))}),i.click(function(c){b.extend(a,{$commentTextarea:g,helpText:d}),ANT.actions.comments.submitComment(a)}),e.append(f),e},submitComment:function(a){var c=a.$commentTextarea,d=a.helpText,e=a.content_node,f=a.summary,g=(a.kind,a.hash),h=a.tag,i=a.$aWindow,j=a.selState,k=c.val();if(k.length>ANT.group.comment_length&&(k=k.substr(0,ANT.group.comment_length),c.val(k),c.siblings("div.ant_charCount").text(ANT.t("characters_left").replace("NNN",ANT.group.comment_length-k.length))),k!=d){b.isEmptyObject(e)&&"img"==f.kind&&(e={body:b("img.ant-"+f.hash).get(0).src,kind:f.kind,hash:f.hash});var l={hash:g,content_node_data:e,comment:k,content:e.body,tag:h,aWindow:i,selState:j};ANT.actions.interactions.ajax(l,"comment","create")}else c.focus();return!1}},containers:{updateCrossPageHash:function(a){var c=b('[ant-hash="'+a+'"]').length>0;c&&ANT.actions.indicators.init(a,!0)},initCustomDisplayHashes:function(a){b.each(a,function(a,c){var d=b('[ant-hash="'+c+'"]');"undefined"!=typeof c&&"undefined"==typeof d.attr("ant_summary_loaded")&&(ANT.actions.indicators.init(c),ANT.summaries[c].crossPage=!0,ANT.actions.content_nodes.init(c))})},media:{onEngage:function(a){},onDisengage:function(a){},disengageAll:function(){var a=[];b(".ant_live_hover").each(function(){var c=b(this).data("hash");a.push(c),ANT.actions.containers.media.onDisengage(c)}),b(".ant_indicator_for_media").each(function(){var a=b(this),c=a.attr("id").substr(14),d=document.querySelectorAll('[ant-hash="'+c+'"]')[0],e=!0,f=[];for(f.push(d);d&&d.parentNode;){if(f.unshift(d.parentNode),d=d.parentNode,d.offsetParent&&null===d.offsetParent&&(e=!1),"undefined"!=typeof d.style){var g=parseFloat(d.style.opacity);!isNaN(g)&&1>g&&(e=!1)}f.unshift(d),d=d.parentNode}1!=e&&a.parent().remove()})}},save:function(a){if(ANT.containers.hasOwnProperty(a.hash))return ANT.containers[a.hash];var b="undefined"==typeof a.id||null===a.id?null:a.id,c={id:b,body:a.body||null,kind:a.kind,hash:a.hash,HTMLkind:a.HTMLkind||null,$this:a.$this||null};return ANT.containers[a.hash]=c,c},setup:function(a){var c={img:function(a,b){var c=ANT.containers[a],d=c.$this,e=d[0].src,f={body:e,kind:b.kind,container:a,hash:a};ANT.content_nodes[a]=f,ANT.aWindow.update(a),isTouchBrowser&&(ANT.actions.content_nodes.init(a,function(){}),ANT.actions.indicators.init(a))},media:function(a,b){this.img(a,b)},text:function(a,b){isTouchBrowser&&(ANT.actions.content_nodes.init(a,function(){}),ANT.actions.indicators.init(a))},custom:function(a,b){}},d=[];b.each(a,function(a,e){return!e||b.isArray(e)?void ANT.safeThrow("For godsake no. This should not be an array of hashes and it should not be the bastard cruft of some frankenpage object."):void b.each(e,function(e,f){f.hash=e;var g=ANT.containers[e];if(g){var h=(g.$this,{}),i=f.top_interactions.coms;b.each(i,function(a,b){"text"==f.kind?h[b.tag_id]=b:(h[b.tag_id]||(h[b.tag_id]=[]),h[b.tag_id].push(b))}),f.top_interactions.coms=h,ANT.actions.summaries.save(f);var j=!1;b.each(ANT.pages[a].containers,function(a,b){b.hash==e&&(j=!0)}),0==j&&ANT.pages[a].containers.push({hash:e,id:f.id});var k=f.kind;"page"!=k&&c[k](e,f),f.counts.tags>0&&d.push(e)}})}),ANT.actions.summaries.sortPopularTextContainers(),b.each(ANT.known_hashes,function(a,c){var d=b('img[ant-node="returnedHash"]');d.length&&d.data("oldHash")==a&&d.attr("ant-hash",a).attr("ant-oldhash","true").data("hash",a),ANT.actions.indicators.init(a)}),ANT.actions.indicators.show(d),ANT.actions.summaries.displayPopularIndicators()},send:function(a,c){function d(){g={},h=0,i=0}var e,f,g={},h=0,i=0,j=1400;b.each(a,function(a,c){var k=ANT.containers[c],l={HTMLkind:k.HTMLkind,body:"",hash:k.hash,id:k.id,kind:k.kind};f=encodeURIComponent(b.toJSON(l)),e=f.length,e>j?l=!1:(i+=e,i>j&&(ANT.actions.containers._ajaxSend(g),d()),g[c]=l,h+=e)}),b.isEmptyObject(g)||ANT.actions.containers._ajaxSend(g,c)},_ajaxSend:function(a,c){var d=a;b.ajax({url:ANT_baseUrl+"/api/containers/create/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(d)},success:function(a){var d=a.data,e={};b.each(d,function(a,b){if(b){var c=ANT.containers[a];c.id=b,e[a]=ANT.actions.summaries.init(a)}}),ANT.actions.containers.setup(e),"undefined"!=typeof c&&c()}})}},content_nodes:{make:function(a){var b,c=a.hash;if(b=a.location?a.container+"-"+a.location:a.container,ANT.content_nodes.hasOwnProperty(b))return ANT.content_nodes[b];var d={container:a.container,body:a.body,location:a.location,hash:c};return ANT.content_nodes[b]=d,d},quickFixReset:function(a){var b=ANT.summaries[a],c="undefined"!=typeof b?b.id:"";c&&(delete ANT.assetLoaders.content_nodes[c],ANT.actions.content_nodes.init(a))},init:function(a,c){if(ANT.status.page===!0){var d=ANT.summaries[a],e="undefined"!=typeof d?d.id:"";if(!e)return;var f=ANT.util.getPageProperty("id",a);d.pageId=f;var g={page_id:f,container_id:e,hash:a,cross_page:d.$container.hasAttr("ant-crossPageContent")?!0:!1},h=ANT.assetLoaders.content_nodes[e];h||(h=b.ajax({url:ANT_baseUrl+"/api/summary/container/content/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(g)}}),ANT.assetLoaders.content_nodes[e]=h),h.then(function(e){if("success"!==e.status)return!1;var f=e.data;b.each(f,function(c,d){var e=b('[ant-hash="'+a+'"]');try{d.selState=e.selog("save",{serialRange:d.location})}catch(f){d.selState=void 0}}),ANT.content_nodes[a]=f,d.content_nodes=f,"text"==d.kind||(d.top_interactions.coms={},b.each(f,function(a,c){var e=c.top_interactions.coms;b.each(e,function(a,b){d.top_interactions.coms[b.tag_id]=d.top_interactions.coms[b.tag_id]||[],d.top_interactions.coms[b.tag_id].push(b)})})),b('[ant-hash="'+a+'"]').attr("ant_summary_loaded","true"),ANT.actions.indicators.update(a),c&&c(),ANT.contentNodeQueue&&ANT.contentNodeQueue[a]&&ANT.contentNodeQueue[a].length&&b.each(ANT.contentNodeQueue[a],function(){var b=ANT.contentNodeQueue[a].pop();b(a)})})}},utils:{getMediaDims:function(a){var b=a.height(),c=a.width();return b&&c?{height:b,width:c}:{}},makeDictSortedByTag:function(a){var c={};return b.each(a,function(a,d){b.each(d.top_interactions.tags,function(a,b){c.hasOwnProperty(a)||(c[a]=[]),c[a].push(d)})}),c},initHiliteStates:function(a,c){b.each(c,function(b,c){c.selState&&a.data("selStates").push(c.selState)}),isTouchBrowser||a.hover(function(){var a=b(this).data("selStates"),c=a.length?a[a.length-1]:null;c&&b().selog("hilite",c,"on")},function(){var a=b(this).data("selStates"),c=a.length?a[a.length-1]:null;c&&b().selog("hilite",c,"off")})}}},interactions:{ajax:function(a,c,d){var e=a.hash,f=ANT.summaries[e];f?f.kind:"";if(d||(d="create"),!ANT.actions.interactions.hasOwnProperty(c))return!1;var g={};ANT.actions.interactions[c].preAjax(a,d),ANT.session.getUser(a,function(a){var f=ANT.actions.interactions.defaultSendData(a),h=ANT.actions.interactions[c].customSendData(a),i=b.extend({},f,h,g);a.sendData=i,a.hash=e,a.sendData.hash=e,"undefined"!=typeof a.sendData&&"undefined"!=typeof a.sendData.sendData&&(a.sendData=b.extend({},a.sendData,a.sendData.sendData),"undefined"!=typeof a.sendData.user&&"undefined"!=typeof a.sendData.user.ant_token&&(a.sendData.ant_token=a.sendData.user.ant_token)),ANT.actions.interactions.send(a,c,d)})},send:function(a,c,d){var e=b.extend(!0,{},a.sendData);e.aWindow&&delete e.aWindow,e.settings&&delete e.settings,e.selState&&delete e.selState,e.content_node&&delete e.content_node,e.response&&delete e.response,e.content_node_data&&e.content_node_data.selState&&delete e.content_node_data.selState,e.content_node_data&&e.content_node_data.counts&&delete e.content_node_data.counts,e.content_node_data&&e.content_node_data.top_interactions&&delete e.content_node_data.top_interactions,e.content_node_data&&e.content_node_data.$container&&delete e.content_node_data.$container,e.content_node_data&&e.content_node_data.$indicator&&delete e.content_node_data.$indicator,e.content_node_data&&e.content_node_data.$indicator_details&&delete e.content_node_data.$indicator_details,e.content_node_data&&e.content_node_data.$aWindow_readmode&&delete e.content_node_data.$aWindow_readmode,e.node&&delete e.node,e.uiMode&&delete e.uiMode,e.sendData&&delete e.sendData,ANT.summaries[e.hash]&&(e.container_kind=ANT.summaries[e.hash].kind),e.content_node_data&&e.content_node_data.container&&delete e.content_node_data.container;var f="react"==c?"tag":c;"undefined"!=typeof e.tag&&(e.tag.body=e.tag.body?e.tag.body:e.tag.tag_body),"page"==e.kind&&(e.hash=a.hash="page",e.container_kind="text",e.page_id=e.page_id||ANT.util.getPageProperty("id","page"),delete e.content_node_data.hash);var g=ANT_baseUrl+"/api/"+f+"/"+d+"/",h=ANT.session.checkForMaxInteractions(a);h?ANT.session.showLoginPanel(a,function(){ANT.actions.interactions.ajax(a,c,"create")}):b.ajax({url:g,type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(e)},success:function(b){if(a.response=b,"undefined"!=typeof a.sendData&&"undefined"!=typeof a.sendData.sendData&&(a.content_node_data=a.sendData.sendData.content_node_data),b.data&&b.data.container){a.container_id=b.data.container.id;a.hash=b.data.container.hash}b.data&&b.data.num_interactions&&(ANT.user.num_interactions=b.data.num_interactions),"success"==b.status?(a.response.data.deleted_interaction&&(a.deleted_interaction=a.response.data.deleted_interaction),a.scenario=a.response.data.existing?"reactionExists":a.response.data.deleted_interaction?"tagDeleted":"reactionSuccess","undefined"==typeof a.tag.id&&(a.tag.id=b.data.interaction.interaction_node.id),ANT.actions.interactions[c].onSuccess[d](a)):"react"==c?"sign in required for organic reactions"==b.message?ANT.session.showLoginPanel(a):-1!=b.message.indexOf("Temporary user interaction limit reached")?ANT.session.showLoginPanel(a):ANT.actions.interactions[c].onFail(a):(-1!=b.message.indexOf("Temporary user interaction limit reached")&&ANT.session.showLoginPanel(a),"existing interaction"==b.message?(a.msgType="existingInteraction",ANT.session.aWindowUserMessage.show(a)):ANT.session.handleGetUserFail(a,function(){ANT.actions.interactions.ajax(a,c,"create")})),ANT.util.userLoginState()}})},defaultSendData:function(a){return a.user_id=ANT.user.user_id,a.ant_token=ANT.user.ant_token,a.group_id=ANT.group.id,a.page_id=a.page_id?a.page_id:ANT.util.getPageProperty("id",a.hash),(null===ANT.user.user_id||isNaN(ANT.user.user_id))&&(delete ANT.user.user_id,
delete a.user_id),a},comment:{preAjax:function(a){var b=a.aWindow;b&&b.find("div.ant_loader").css("visibility","visible")},customSendData:function(a){},onSuccess:{create:function(a){var c=a.aWindow,d=a.hash,e=a.response,f=a.tag;if(c){c.find("div.ant_loader").css("visibility","hidden"),ANT.util.stayInWindow(c,!0),ANT.actions.content_nodes.quickFixReset(d);var g=(c.hasClass("ant_inline")||c.find(".ant_inline").length,b('<span class="success_msg" >'+ANT.t("thanks_for_comment")+" </span>")),h=b('<a class="ant_doneButton" href="#">'+ANT.t("close")+"</a>").click(function(a){a.preventDefault(),ANT.aWindow.safeClose(c)}),i=b(".ant_subheader").length;i?(b(".ant_nextActions").remove(),c.find(".ant_subheader").empty().append(g).append(h)):c.find(".ant_commentBox").empty().append(g).append(h)}var j=e.data.interaction,k=e.data.content_node?e.data.content_node:e.content_node_data?e.content_node_data:a.content_node_data,l=k&&k.id?k.id:"",m=e.data.num_interactions,n="text"==k.kind||"txt"==k.kind,o=e.data.existing;if(!n&&o){var p=ANT.content_nodes[d];b.each(p,function(a,b){a&&"undefined"!=a&&(k=b,l=k.id)})}var q=parseInt(a.tag.id,10),r={delta:1,num_interactions:m,id:j.id,body:j.interaction_node.body,content_node:k,content_id:l,tag_id:q,user:a.user,social_user:a.social_user,parent_id:null,parent_interaction_node:a.tag},s={coms:{}};s.coms[q]=r,ANT.actions.content_nodes.init(d,function(){ANT.actions.summaries.update(d,s)}),ANT.events.trackEventToCloud({event_type:"c",event_value:j.interaction_node.body,container_hash:d,container_kind:k.kind,page_id:a.page_id,reaction_body:a.tag.tag_body}),ANT.events.emit("antenna.comment",j.interaction_node.body,{reaction:f.tag_body,hash:d,kind:k.kind})},remove:function(a){var b=a.aWindow;b&&b.find("div.ant_loader").css("visibility","hidden")}},onFail:function(a){var b=a.aWindow;b&&b.find("div.ant_loader").css("visibility","hidden")}},share:{preAjax:function(){var a=args.aWindow;a&&a.find("div.ant_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:function(a){var b=a.aWindow;b&&b.find("div.ant_loader").css("visibility","hidden")},onFail:function(a){var b=a.aWindow;b&&b.find("div.ant_loader").css("visibility","hidden")}},react:{preAjax:function(a,b){var c=a.aWindow;c&&c.find("div.ant_loader").css("visibility","visible")},customSendData:function(a){var c,d,e,f=a.hash,g=ANT.summaries[f],h=b('[ant-hash="'+f+'"]'),i="page"==f||a.kind&&"page"==a.kind;if(i)c="page",d=a.tag,k={container:f,body:"",kind:c,hash:f,item_type:"page"},e={tag:d,node:null,content_node_data:k,hash:f,user_id:ANT.user.user_id,ant_token:ANT.user.ant_token,group_id:ANT.group.id,page_id:a.page_id?a.page_id:ANT.util.getPageProperty("id",f)};else{c=g.kind;var h=b('[ant-hash="'+f+'"]'),j=a.aWindow;a.tag;d="function"==typeof a.tag.data?a.tag.data("tag"):a.tag;var k={},l=a.content_node||null;if("custom"==c)k={container:j.data("container"),body:h.attr("ant-src"),kind:"media",location:h.get(0).nodeName.toLowerCase(),hash:f,item_type:h.hasAttr("ant-item-type")?h.attr("ant-item-type"):""};else if("img"==c||"media"==c||"med"==c){var m="undefined"!=typeof h[0].src?h[0].src:h.data("body");ANT.group.media_url_ignore_query&&m.indexOf("?")&&(m=m.split("?")[0]),k={container:j.data("container"),body:m,kind:c,hash:f,item_type:h.hasAttr("ant-item-type")?h.attr("ant-item-type"):""};var n=ANT.actions.content_nodes.utils.getMediaDims(h);b.extend(k,n)}else{if(l)k={container:j.data("container"),body:l.body,location:l.location,kind:c,id:l.id,item_type:h.hasAttr("ant-item-type")?h.attr("ant-item-type"):""};else if(h.hasAttr("ant-item")&&"undefined"!=typeof ANT.summaries[f].content_nodes&&ANT.summaries[f].content_nodes.length)b.each(ANT.summaries[f].content_nodes,function(a,b){"undefined"!=a&&(l=b)}),k={container:j.data("container"),body:l.body,location:l.location,kind:c,id:l.id,item_type:h.attr("ant-item-type")};else{var o=j.find("div.ant_tag_"+d.id).data("content_node_id"),p=o?g.content_nodes[o].selState:j.data("selState");if(!p)return void ANT.safeThrow("selState not found:  I cannot figure out why this happens every once in a while");k={container:j.data("container"),body:p.text,location:p.serialRange,kind:c,item_type:h.hasAttr("ant-item-type")?h.attr("ant-item-type"):""}}if(-1!=k.location.indexOf("/")){var q=k.location.split(","),r="";r=q[0].split("/")[1]+","+q[1].split("/")[1],k.location=r}}e={tag:d,node:l,content_node_data:k,hash:k.container,user_id:ANT.user.user_id,ant_token:ANT.user.ant_token,group_id:ANT.group.id,page_id:ANT.util.getPageProperty("id",f),int_id:a.int_id}}return e},onSuccess:{create:function(a){function c(a){var b={kind:"page",page_id:a.page_id,id:a.response.data.interaction.interaction_node.id,parent_id:null,parent_interaction_node:null,content_id:null,body:a.response.data.interaction.interaction_node.body,delta:1,user:a.user,social_user:a.social_user},c={tags:{}};c.tags[b.id]=b,ANT.actions.summaries.update(a.hash,c,!0,a.page_id)}var d=a.aWindow,e=(d.data("mode")||"writeMode",a.response),f=(e.interaction,e.data.interaction.interaction_node),g=e.data.container,h=a.sendData,i=h.content_node_data,j="function"==typeof a.tag.data?a.tag.data("tag"):a.tag,k=(e.data.interaction.id,j.body?j.body:j.tag_body);if(ANT.events.trackEventToCloud({event_type:"re",event_value:k,reaction_body:k,container_hash:a.hash,container_kind:a.kind,content_location:i.location,content_id:e.data.content_node?e.data.content_node.id:null,page_id:a.page_id}),ANT.events.emit("antenna.reaction",k,{hash:a.hash,kind:a.kind,"ant-item-name":b('[ant-hash="'+a.hash+'"]').attr("ant-item")}),b("#ant_loginPanel").remove(),d&&d.find("div.ant_loader").css("visibility","hidden"),b('[ant-hash="'+m+'"]').removeAttr("ant_summary_loaded"),b(".ant_twtooltip").remove(),a.kind&&"page"==a.kind){var l=a.response.data.existing;l||c(a),ANT.actions.viewReactionSuccess(a)}else{var m=a.hash,n=ANT.summaries[m];n.kind;a.settings=a.sendData.content_node_data;var o=h.content_node_data;o.hash=o.container,o.kind=h.kind,"undefined"==typeof n.content_nodes&&(n.content_nodes={});var p=ANT.containers[m];p&&g&&g.id&&(p.id=g.id),"undefined"==typeof n.content_nodes[i.id]?n.content_nodes[i.id]={body:i.body,counts:{coms:0,tags:1,interactions:1},id:i.id,kind:i.kind,location:h.content_node_data.location,selState:!1,top_interactions:{coms:{},tags:{}}}:"reactionExists"!=a.scenario&&(n.content_nodes[i.id].counts.tags++,n.content_nodes[i.id].counts.interactions++),"undefined"==typeof n.content_nodes[i.id].top_interactions.tags[j.id]?n.content_nodes[i.id].top_interactions.tags[j.id]={count:1,body:j.body,parent_id:null}:"reactionExists"!=a.scenario&&n.content_nodes[i.id].top_interactions.tags[j.id].count++,o=a.content_node||ANT.actions.content_nodes.make(o),n.id=n.id||a.container_id;var q={id:f.id,parent_id:null,parent_interaction_node:j,content_id:null,body:f.body,delta:1,user:a.user,social_user:a.social_user},r={tags:{}};r.tags[q.id]=q,"reactionExists"!=a.scenario&&ANT.actions.summaries.update(m,r),ANT.actions.viewReactionSuccess(a),ANT.actions.indicators.showOnlyInitial===!0&&(ANT.actions.indicators.showOnlyInitial=!1,ANT.actions.summaries.showLessPopularIndicators())}},remove:function(a){var b=a.sendData,c=a.response.data.deleted_interaction.interaction_node,d=a.aWindow;a.tag,a.int_id;d&&d.find("div.ant_loader").css("visibility","hidden");var e=b.hash,f={id:c.id,parent_id:null,content_id:null,body:c.body,delta:-1,user:a.user,social_user:a.social_user},g={tags:{}};g.tags[f.id]=f;var h="page"==a.kind||"page"==e;h?ANT.actions.summaries.update(e,g,h,a.page_id):ANT.actions.summaries.update(e,g);var i={msgType:"interactionSuccess",interactionInfo:{type:"tag",body:c.body,remove:!0},aWindow:d};d.queue("userMessage",function(){ANT.session.aWindowUserMessage.show(i)}),h?ANT.aWindow.updatePageTagMessage(a,"tagDeleted"):ANT.aWindow.updateTagMessage({aWindow:d,tag:a.tag,scenario:"tagDeleted",args:a})}},onFail:function(a){var b=a,c=b.aWindow,d=b.response;c&&c.find("div.ant_loader").css("visibility","hidden"),-1!=d.message.indexOf("Temporary user interaction limit reached")?(ANT.session.receiveMessage(b,function(){ANT.actions.interactions.ajax(b,"react","create")}),ANT.session.showLoginPanel(b)):"existing interaction"==d.message?(b.msgType="existingInteraction",ANT.session.aWindowUserMessage.show(b)):-1!=d.message.indexOf("blocked this tag")?alert(ANT.t("bad_language_warning")):ANT.session.handleGetUserFail(b,function(){ANT.actions.interactions.ajax(b,"react","create")})}}},indicators:{showOnlyInitial:!0,show:function(a){var c=this.fetch(a);ANT.actions.indicators.showOnlyInitial===!0?b(".ant_indicator_for_text:not(.ant_dont_show)").length<ANT.group.initial_pin_limit&&1==c.length&&c.removeClass("ant_dont_show"):1==c.length&&c.removeClass("ant_dont_show")},hide:function(a){var b=this.fetch(a);b.css({opacity:"0",visibility:"hidden"})},fetch:function(a){var c=b();if("string"==typeof a){var d=a;c=b("#ant_indicator_"+d)}else{var e=a;b.each(e,function(a,d){c=c.add(b("#ant_indicator_"+d))})}return c},init:function(a,c){function d(a){return b(a).find(":not(iframe,noscript)").andSelf().contents().filter(function(){return 3==this.nodeType})}function e(){m.$indicator_body=b('<div class="ant ant_indicator_body " />').attr("id",q).appendTo(s.find(".ant_indicator_container")).append('<span class="ant-antenna-logo"></span>','<span class="ant_count" />','<span class="ant_count_label" />');s.css("visibility","visible")}function f(){if(isTouchBrowser)s.on("touchend.ant",function(a){if(!ANT.util.isTouchDragging(a)){ANT.util.bubblingEvents.touchend=!0,g();s.hasClass("ant_helper")&&ANT.group.paragraph_helper}});else{var a=!(m.counts.tags>0);s.find(".ant_indicator_body").on("mouseenter.ant",function(){ANT.util.setFunctionTimer(function(){a?h():g()},333)}).on("mouseleave.ant",function(){ANT.util.clearFunctionTimer()})}}function g(){if(s.$aWindow){if(s.$aWindow.data("container")==a)return;s.$aWindow.remove()}var b=ANT.util.getPageProperty("id",a);ANT.events.trackEventToCloud({event_type:"rs",event_value:"undefined"!=typeof m.counts.highest_tag_count?"rd":"rd-zero",container_hash:a,container_kind:"text",page_id:b}),ANT.events.emit("antenna.reactionview","",{hash:a,kind:"text"});var c=ANT.aWindow.make("readMode",{hash:a});c&&(s.$aWindow=c)}function h(){var c=b("#ant_indicator_"+a),d={force:!0,top:c.offset().top+11,left:c.offset().left-8},e=function(){var c=b('[ant-hash="'+a+'"]'),e=c[0];b("document").selog("selectEl",e),$aWindow=ANT.aWindow.make("writeMode",{coords:d,hash:a}),c.removeClass("ant_live_hover")};ANT.actionbar.draw({coords:d,kind:"text",hash:a,clickAction:e})}function i(b){isTouchBrowser?s.hasAttr("ant-item")||ANT.actions.content_nodes.init(a,b):s.on("mouseover.contentNodeInit",function(){s.hasAttr("ant-item")||ANT.actions.content_nodes.init(a,b)})}function j(){s.off("mouseover.contentNodeInit"),isTouchBrowser?s.triggerHandler("touchend.showAWindow"):s.triggerHandler("mouseover.showAWindow")}function k(a){a.each(function(){var a=b(this);a.attr("ant-kind",n).off("mouseover.showAWindow, touchend.showAWindow").on("mouseover.showAWindow, touchend.showAWindow",function(){l(a)})})}function l(c){if(-1!=c.attr("ant-mode").indexOf("write")&&-1!=c.attr("ant-mode").indexOf("read"))var d=m.counts.tags>0?"readMode":"writeMode";else var d="write"==c.attr("ant-mode")?"writeMode":"readMode";if(s.$aWindow&&s.$aWindow.hasClass("ant_"+d.toLowerCase())){if(s.$aWindow.data("container")==a)return;s.$aWindow.remove()}if("writeMode"==d){if(o.length)el=o[0];else{var e='[ant-hash="'+a+'"]';el=b(e)[0]}b("document").selog("selectEl",el)}ANT.events.emit("antenna.reactionview","",{hash:a,kind:"custom",mode:d,"ant-item-name":c.attr("ant-cta-for")});var f=ANT.aWindow.make(d,{hash:a,$custom_cta:c});f.addClass("ant_rewritable");ANT.util.getPageProperty("id",a);f&&(s.$aWindow=f)}var m=ANT.summaries[a],c=c?c:!1;if("undefined"!=typeof m&&m.$container.hasAttr("ant-node")){var n=m.kind,o=m.$container,p="ant_indicator_"+a,q="ant_indicator_body_"+a;if(o.hasAttr("ant-page-container"))return;if(o.attr("ant-hasIndicator","true"),o.hasAttr("ant-item")){var r=o.attr("ant-item"),s=m.$indicator=o,t=b('[ant-counter-for="'+r+'"]'),u=b('[ant-cta-for="'+r+'"]');i(),t.length&&t.addClass("ant_count"),u.length&&(k(u),j()),ANT.actions.indicators.update(a)}else{if(b("#ant_indicator_"+a).remove(),b("#ant_container_tracker_"+a).remove(),b("#ant_indicator_details_"+a).remove(),b("#ant_indicator_"+a).length)return;var s=m.$indicator=b('<div class="ant_indicator"><div class="ant ant_indicator_container" /></div>').attr("id",p).data("hash",a);if("text"!=n&&ANT.group.img_indicator_show_onload===!0&&s.addClass("ant_show_on_load"),e(),!n)return;if(ANT.actions.indicators.utils.kindSpecificSetup[n](a,c),"text"==n){if(o.find("img").length&&!d(o).length)return void ANT.actions.stripAntNode(o);o.off(".ant_helper"),isTouchBrowser?(o.on("touchstart.ant",function(a){0===b(a.target).closest("a").length&&(ANT.util.timerStart=(new Date).getTime())}),o.off("touchend.ant").on("touchend.ant",function(c){if(0===b(c.target).closest("a").length){ANT.util.timerEnd=(new Date).getTime();var d=ANT.util.timerEnd-ANT.util.timerStart;if(!(ANT.util.isTouchDragging(c)||d>500)&&0==ANT.util.bubblingEvents.touchend)if(b(".ant_window").length)ANT.actions.UIClearState();else{var e=b('[ant-hash="'+a+'"]'),f=e[0];b("document").selog("selectEl",f);ANT.aWindow.make("writeMode",{hash:a})}}})):(o.on("mouseenter.ant_helper",function(){var a=s.hasClass("ant_helper")&&ANT.group.paragraph_helper;a&&ANT.actions.indicators.helpers.over(s)}),o.on("mouseleave.ant_helper",function(a){var b=s.hasClass("ant_helper")&&ANT.group.paragraph_helper;b&&ANT.actions.indicators.helpers.out(s)}));var v=!(m.counts.tags>0);s.data("isZeroCountIndicator",v),v?(s.addClass("ant_helper"),f()):(i(function(){j()}),f())}ANT.actions.indicators.update(a)}}},update:function(a,c){var d=ANT.summaries[a],e=(d.kind,d.$container),f="text"===d.kind;if(0===d.counts.tags&&"undefined"!=typeof d.content_nodes&&b.each(d.content_nodes,function(a,c){d.counts=b.extend(!0,{},c.counts),d.top_interactions=b.extend(!0,{},c.top_interactions)}),e.hasAttr("ant-item")){var g=e.attr("ant-item"),h=d.$indicator=e,i=b('[ant-counter-for="'+g+'"]'),j=b('[ant-reactions-label-for="'+g+'"]'),k=b('[ant-cta-for="'+g+'"]'),l=k.parent();if(i.length&&d.counts.tags>0&&(d.counts.tags>1?j.text("Reactions"):j.text("Reaction"),i.html(ANT.commonUtil.prettyNumber(d.counts.tags))),k.length&&d.counts.tags>0){var m=[],n=1===d.counts.tags?1:2;b.isEmptyObject(d.top_interactions.tags)||b.each(d.top_interactions.tags,function(a,b){for(var c=0;c<ANT.group.default_reactions.length;c++){var d=ANT.group.default_reactions[c];parseInt(a)===d.id&&m.length<n&&m.push(b)}});var o=!1;!isMobile||"both"!=ANT.group.separate_cta_expanded&&"mobile"!=ANT.group.separate_cta_expanded||(o=!0),isMobile||"both"!=ANT.group.separate_cta_expanded&&"desktop"!=ANT.group.separate_cta_expanded||(o=!0),o===!0&&m.length&&!l.find(".ant-top-tags").length&&k.append('<div class="ant-top-tags"><div class="ant-top-tags-wrapper">'+(m[0]?'<div class="ant-top-tag">'+m[0].body+" <span>("+m[0].count+")</span></div>":"")+(m[1]?'<div class="ant-top-tag">'+m[1].body+" <span>("+m[1].count+")</span></div>":"")+"</div></div>")}}else{if(c)return f&&e.closest("[ant-node]").find(".ant_indicator").remove(),void ANT.actions.indicators.init(a);var h=d.$indicator,p=d.$indicator_body,q=d.$indicator_details,r=p.find(".ant_count"),s=p.find(".ant_count_label"),t=q?q.find("div.ant_header h1"):!1,u=d.counts.tags>0,v=d.counts.tags>1?ANT.t("plural_reaction"):ANT.t("single_reaction");u?(f?(r.html(ANT.commonUtil.prettyNumber(d.counts.tags)),s.text(v)):r.html(ANT.commonUtil.prettyNumber(d.counts.tags)+" "),t&&t.html(ANT.commonUtil.prettyNumber(d.counts.tags)+" "+ANT.t("plural_reaction"))):(h.addClass("ant_no_reactions"),r.html('<span class="ant_react_label">'+ANT.t("main_cta")+"</span>"),f&&(ANT.group.paragraph_helper?(ANT.actions.indicators.show(a),h.addClass("ant_helper")):ANT.actions.indicators.hide(a)))}},helpers:{over:function(a){ANT.util.cssSuperImportant(a,{display:"inline"}),a.css("opacity",ANT.C.helperIndicators.opacity)},out:function(a){a&&(a.hasClass("ant_dont_show")||a.hasClass("ant_no_reactions"))&&a.css("opacity",0)}},utils:{checkTrailingWhiteSpace:function(a){var c=a.children().get().reverse(),d=null,e=!0;return b.each(c,function(a){if(e){var c=""==b(this).text();c?d=this:e=!1}}),d},kindSpecificSetup:{img:function(a,c){function d(){if(b("div.ant_media_details").not("ant_loaded").length){var c=e.$indicator_details=b("<div />").attr("id",j).addClass("ant ant_indicator_details ant_widget ant_widget_bar");b("div.ant_media_details").html(c),i.addClass("ant_inline_video"),b("div.ant_media_details").addClass("ant_sandbox")}else var c=e.$indicator_details=b("<div />").attr("id",j).addClass("ant ant_indicator_details ant_widget ant_widget_bar").appendTo("#ant_indicator_details_wrapper");c.data("container",a),c.data("hash",a),c.data("summary",e),c.addClass("ant_indicator_details_for_media").click(function(){c.addClass("ant_live_hover"),ANT.actions.containers.media.onEngage(a)}),g.addClass("ant_indicator_for_media ant_indicator_for_media_inline").find(".ant_indicator_body"),isTouchBrowser&&g.on("touchend.ant",function(){b(this).toggleClass("ant_hover")})}var e=ANT.summaries[a],f=e.$container,g=e.$indicator,h=(e.$indicator_body,b("#ant_container_tracker_wrap")),i=b('<div class="ant_container_tracker" />'),j="ant_indicator_details_"+a;ANT.util.getPageProperty("id",a);if(f.width()<100)return void ANT.safeThrow("Too small to init.");if("none"==f.css("display")||"hidden"==f.css("visibility"))return void ANT.safeThrow("not visible: ");var k=b("#ant_container_tracker_"+a);return k.length?void ANT.safeThrow("Images are not expected to get re-inited."):(i.attr("id","ant_container_tracker_"+a).appendTo(h),d(),g.appendTo(i),isTouchBrowser?g.on("touchend.ant",function(c){if(!ANT.util.isTouchDragging(c)&&0==ANT.util.bubblingEvents.touchend){if(0==e.counts.interactions){ANT.aWindow.make("writeMode",{hash:a})}else{ANT.aWindow.make("readMode",{hash:a})}b(this).addClass("ant_live_hover")}}):g.on("mouseenter.ant",function(){g.addClass("ant_visible"),ANT.util.setFunctionTimer(function(){if(0==e.counts.interactions){ANT.aWindow.make("writeMode",{hash:a})}else{ANT.aWindow.make("readMode",{hash:a})}b(this).addClass("ant_live_hover")},200)}).on("mouseleave.ant",function(){ANT.util.clearFunctionTimer(),b(this).removeClass("ant_live_hover ant_visible")}),void ANT.actions.indicators.utils.updateContainerTracker(a))},media:function(a,b){this.img(a)},text:function(a,c){var d=ANT.summaries[a],e=d.$container,f=d.$indicator;d.$indicator_body,b("ant_actionbar_"+a);c===!1?f.addClass("ant_indicator_for_text").addClass("ant_dont_show"):f.addClass("ant_indicator_for_text");var g=ANT.actions.indicators.utils.checkTrailingWhiteSpace(e);g?b(g).before(f):f.appendTo(e)}},makeDetailsContent:function(a){var c=ANT.summaries[a],d=c.$container,e=c.$indicator,f=(c.$indicator_body,c.$indicator_details);b("ant_actionbar_"+a);if("undefined"!=typeof e){f.find("div.ant_body_wrap").remove();var g=ANT.aWindow.makeDefaultPanelMessage(f),h=ANT.aWindow.makeHeader(g),i=b('<div class="ant ant_body_wrap ant_clearfix" />'),j=c.kind,k="img"==j||"image"==j||"imgage"==j||"med"==j||"media"==j;k&&!f.find("div.ant_view_success").length&&f.data("initialWidth",d.width());var l=f,m=ANT.actions.indicators.utils.makeTagsListForInline(l);i.append(m),f.empty().append(h,i)}},makeTagsListForInline:function(a,c,d){function e(a){function c(a,b){return b.tag_count-a.tag_count}b.each(a,function(a,b){b.tag_count||(b.tag_count=-101)}),a.sort(c);var d={big:[],medium:[],small:[]},e=(a[0].tag_count,a[Math.floor(a.length/2)].tag_count),f=(a[a.length-1].tag_count,function(a){var c=0;return b.each(a,function(a,b){c+=b.tag_count}),Math.floor(c/a.length)}(a)),g=e>f?e:f;return b.each(a,function(a,b){"undefined"!=typeof b.tag_body?b.tag_body:b.body;return b.tag_count>g?void d.big.push(b):void d.medium.push(b)}),d}function f(f){if(f.length){var g=e(f),h=g.big.length+g.medium.length+g.small.length,i=0,j=ANT.group.tag_box_bg_colors.length;"grid"==k&&(h>6&&!c?isTouchBrowser?ANT.aWindow.tagBox.setWidth(a,222):ANT.aWindow.tagBox.setWidth(a,222):"undefined"!=typeof d&&c?ANT.aWindow.tagBox.setWidth(a,222):f.length>1&&(g.big.length&&ANT.aWindow.tagBox.setWidth(a,222),g.medium.length&&ANT.aWindow.tagBox.setWidth(a,222),g.small.length>=3&&ANT.aWindow.tagBox.setWidth(a,222)));for(var l=0;g.big.length||g.medium.length;)if(g.big.length){var m=g.big.shift(),n=b('<div class="ant ant_tag_row row_num_'+i+'"></div>');ANT.aWindow.tagBox.make({tag:m,boxSize:"big",$aWindow:a,$tagContainer:n,isWriteMode:c,rowNum:i}),a.find("div.ant_body.ant_tags_list").append(n),i++,i==j&&(i=0)}else if(g.medium.length){var m=g.medium.shift();if(m.body||m.tag_body){l++;var o=a.find(".ant_tag_row:last");if(!o.length||o.find(".ant_box_big").length||2==o.children().length){var n=b('<div class="ant ant_tag_row row_num_'+i+'"></div>');a.find("div.ant_body.ant_tags_list").append(n)}else var n=o;ANT.aWindow.tagBox.make({tag:m,boxSize:"medium",$aWindow:a,$tagContainer:n,isWriteMode:c,rowNum:i}),l%2===0&&(i++,i==j&&(i=0))}}}}var g=a.data("hash")||a.attr("ant-hash"),h=!g||"page"==g,i=h?{}:ANT.summaries[g],j=ANT.groupSettings.getBlessedTags(g),k=a.attr("ant-view-style")||"grid";Date.now||(Date.now=function(){return(new Date).valueOf()});var l=b('<div class="ant_body ant_tags_list ant_'+k+'" style="background:'+ANT.group.tags_bg_css+'" />').data("now",Date.now()),m=a.find(".ant_tags_list");if(a.find(".ant_body_wrap").append(l),m.remove(),"undefined"!=typeof d)if(!c&&d.toptags.length)f(d.toptags),ANT.aWindow.updateFooter(a,'<span class="ant_cta_msg">'+ANT.t("main_cta")+"</span>"),a.find(".ant_footer").addClass("ant_cta").find("span.ant_cta_msg").click(function(){a.remove(),a=ANT.aWindow.make("writeMode",{hash:"page",page:d,is_page:!0})});else{var n=ANT.aWindow.makeHeader(ANT.t("main_cta")),c=!0;a.find(".ant_header").replaceWith(n),f(j);ANT.aWindow.writeCustomTag(l,a)}else c?f(j):h||(b.isEmptyObject(i.top_interactions.tags)?ANT.aWindow.updateFooter(a,'<span class="ant_no_reactions_msg ant_clearfix">No reactions yet!</span>'):(ANT.actions.summaries.sortInteractions(g),f(i.interaction_order),"text"==i.kind?(ANT.aWindow.updateFooter(a,'<span class="ant_cta_msg">'+ANT.t("main_cta")+"</span>"),a.find(".ant_footer").addClass("ant_cta").find(".ant_cta_msg").click(function(){a.remove();var c=b('[ant-hash="'+g+'"]'),d=c[0];b("document").selog("selectEl",d),a=ANT.aWindow.make("writeMode",{hash:g})})):(ANT.aWindow.updateFooter(a,'<span class="ant_cta_msg">'+ANT.t("main_cta")+"</span>"),a.find(".ant_footer").addClass("ant_cta").find(".ant_cta_msg").click(function(){var b=a.offset(),c={left:b.left,top:b.top,force:!0};a.remove(),a=ANT.aWindow.make("writeMode",{hash:g,coords:c})}))));if("undefined"==typeof d&&c){ANT.aWindow.writeCustomTag(l,a)}return isTouchBrowser||(a.on("mouseleave.ant",function(a){var c,d=b(this);c=setTimeout(function(){d.hasClass("ant_rewritable")&&(d.remove(),b(".ant_writemode").length||b().selog("hilite",!0,"off"))},300),b(this).data("timeoutCloseEvt",c)}).on("mouseenter.ant",function(){var a=b(this).data("timeoutCloseEvt");clearTimeout(a)}),"undefined"==typeof i||"text"!=i.kind||b.isEmptyObject(i.content_nodes)||a.find("div.ant_box").each(function(){b(this).hover(function(){if("undefined"!=typeof i.content_nodes[b(this).find("div.ant_tag").data("content_node_id")]){var c=i.content_nodes[b(this).find("div.ant_tag").data("content_node_id")].selState,d=!a.data("panelState")||1===a.data("panelState");d&&(b().selog("hilite",c,"on"),a.data("selState",c))}},function(){if("undefined"!=typeof i.content_nodes[b(this).find("div.ant_tag").data("content_node_id")]){var c=i.content_nodes[b(this).find("div.ant_tag").data("content_node_id")].selState,d=!a.data("panelState")||1===a.data("panelState");d&&b().selog("hilite",c,"off")}})})),l.jScrollPane({showArrows:!0}),l},updateContainerTrackers:function(){b.each(ANT.containers,function(a,b){!b.kind||"img"!=b.kind&&"media"!=b.kind&&"med"!=b.kind||ANT.actions.indicators.utils.updateContainerTracker(b.hash)})},updateContainerTracker:function(a){var c=ANT.summaries[a],d=c.$container,e=(b("#ant_container_tracker_"+a),ANT.containers[a]);if(!e.kind||"text"!=e.kind&&"txt"!=e.kind){var f=b('[ant-hash="'+a+'"]');if(!f.length)return b("#ant_indicator_details_"+a).remove(),void b("#ant_container_tracker_"+a).remove();var g={top:parseInt(d.css("padding-top"),10),right:parseInt(d.css("padding-right"),10),bottom:parseInt(d.css("padding-bottom"),10),left:parseInt(d.css("padding-left"),10)},h=parseInt(d.css("border-top-width"),10)+parseInt(d.css("border-bottom-width"),10)+parseInt(d.css("border-left-width"),10)+parseInt(d.css("border-right-width"),10),i={};i.top=h?0:g.top,i.left=h?0:g.left,this.updateMediaTracker(a)}},updateInlineIndicator:function(a){var b=ANT.summaries[a],c=b.$container,d=b.$indicator_details;"undefined"!=typeof d&&d.css({top:c.offset().bottom,left:c.offset().left,width:c.outerWidth()})},updateMediaTracker:function(a){var c=ANT.summaries[a],d=c.$container,e=c.$indicator,f=c.$indicator_body;c.$indicator_details,b("#ant_container_tracker_"+a);if(f){d.parents(ANT.group.img_container_selectors).length&&(d=d.parents(ANT.group.img_container_selectors).first());var g,h,i=d.offset(),j=parseInt(d.css("border-top-width"),10)+parseInt(d.css("border-bottom-width"),10)+parseInt(d.css("border-left-width"),10)+parseInt(d.css("border-right-width"),10);j?(g=d.outerWidth(),h=d.outerHeight()):(g=d.width(),h=d.height());var k=(f.width(),b.browser.msie&&parseInt(b.browser.version,10)<9?10:0),l="media"==c.kind?12:0,m=-1!=ANT.group.img_indicator_show_side.indexOf("top")?"top":"bottom";if("top"==m)var n=i.top+3;else var n=i.top+("media"==c.kind?h+k-12:h+k-22);var o=-1!=ANT.group.img_indicator_show_side.indexOf("right")?"right":"left",p="left"==o?i.left+l:b(window).width()-(i.left+g-l),q={};q[o]=p+"px",q.top=n+"px",ANT.util.cssSuperImportant(e,q,!0),e.data("top",n),"media"==c.kind&&e.addClass("ant_indicator_not_img");var r="text"==c.kind?!1:!0;r&&ANT.actions.indicators.utils.updateInlineIndicator(a)}}}},summaries:{init:function(a){if(ANT.util.activeAB()){if("object"==typeof ANT.summaries[a])return ANT.summaries[a];var b=ANT.containers[a],c={hash:a,kind:b.kind,id:b.id,counts:{coms:0,tags:0,interactions:0},top_interactions:{coms:{},tags:{}}};return c}},save:function(a){var c=a.hash;ANT.summaries[c]=a,a.$container=b('[ant-hash="'+c+'"]')},update:function(a,c,d,e){function f(a){var b=a.hash,c=a.summary,d=a.interaction_node_type,e=a.id,f=a.diffNode,g=c.top_interactions[d],h=g.hasOwnProperty(e)&&"undefined"!=typeof g[e];if(h){var i=g[e];i.count+=f.delta,"tags"==d&&(ANT.actions.summaries.updatePageSummaryTags(b,f),i.count<=0&&delete g[e])}else if("tags"==d)g[e]={count:f.delta,body:f.body,id:e,parent_id:f.parent_id,parent_interaction_node:f.parent_interaction_node},ANT.actions.summaries.updatePageSummaryTags(b,f);else{f.user;g[f.tag_id]={body:f.body,content_node:f.content_node,content_id:f.content_id,id:f.id,social_user:f.social_user,tag_id:f.tag_id,user:f.user,parent_id:f.parent_id,parent_interaction_node:f.parent_interaction_node}}}if(d)return void b.each(c,function(c,d){b.each(d,function(b,c){c.page_id=e,ANT.actions.summaries.updatePageSummaryTags(a,c)})});var g;g=ANT.summaries.hasOwnProperty(a)?ANT.summaries[a]:ANT.actions.summaries.init(a),b.each(c,function(c,d){b.each(d,function(b,d){f({hash:a,summary:g,interaction_node_type:c,id:b,diffNode:d}),g.counts[c]+=d.delta,g.counts.interactions+=d.delta,d.int_type=c,ANT.aWindow.update(a,d)})}),ANT.actions.summaries.sortInteractions(a)},updatePageSummaryTags:function(a,c){var d,e=c.id,f=c.page_id||ANT.util.getPageProperty("id",a),g=ANT.pages[f],h=g.toptags;b.each(h,function(){this.id==e&&(g.count+=c.delta,this.tag_count+=c.delta,d=!0)}),d||h.push({body:c.body,id:c.id,tag_count:1});var i=g.summary;b.each(i,function(a,b){"tag"==b.kind&&(b.count=b.count+c.delta)});var j=b('[ant-page-container="'+f+'"]'),k=j.find("[ant-page-widget-key]");k.antWidgetSummary("update")},sortByTags:function(a){function b(a,b){return b.tag_count-a.tag_count}return a.sort(b)},sortInteractions:function(a){function c(a,b){return b.tag_count-a.tag_count}function d(a){a>e.counts.highest_tag_count&&(e.counts.highest_tag_count=a)}var e=ANT.summaries[a];e.interaction_order=[],e.counts.highest_tag_count=0,b.isEmptyObject(e.content_nodes)&&!b.isEmptyObject(ANT.content_nodes[a])&&ANT.actions.content_nodes.init(a);var f="text"==e.kind||"txt"==e.kind;if(f)b.isEmptyObject(e.content_nodes)?b.each(e.top_interactions.tags,function(a,b){e.interaction_order.push({tag_count:b.count,tag_id:a,tag_body:b.body,content_node_id:g,parent_id:b.parent_id}),d(b.count)}):b.each(e.content_nodes,function(a,c){b.each(c.top_interactions.tags,function(b,c){e.interaction_order.push({tag_count:c.count,tag_id:b,tag_body:c.body,content_node_id:a,parent_id:c.parent_id}),d(c.count)})});else if(!b.isEmptyObject(e.top_interactions)&&!b.isEmptyObject(e.content_nodes)){var g=b.map(e.content_nodes,function(a,b){return b})[0];b.each(e.top_interactions.tags,function(a,b){e.interaction_order.push({tag_count:b.count,tag_id:a,tag_body:b.body,content_node_id:g,parent_id:b.parent_id}),d(b.count)})}e.interaction_order.sort(c)},sortPopularTextContainers:function(){function a(a,b){return b.interactions-a.interactions}ANT.text_container_popularity=[],b.each(ANT.summaries,function(a,b){"text"==b.kind&&b.counts.interactions>0&&ANT.text_container_popularity.push({hash:a,interactions:b.counts.interactions})}),ANT.text_container_popularity.sort(a)},displayPopularIndicators:function(){for(var a=0;a<ANT.group.initial_pin_limit;a++)ANT.text_container_popularity[a]&&b("#ant_indicator_"+ANT.text_container_popularity[a].hash).removeClass("ant_dont_show")},showLessPopularIndicators:function(){var a=[];if("undefined"!=typeof ANT.text_container_popularity)for(var c=ANT.group.initial_pin_limit;c<ANT.text_container_popularity.length;c++)ANT.text_container_popularity[c]&&ANT.text_container_popularity[c].interactions>0&&(b("#ant_indicator_"+ANT.text_container_popularity[c].hash).removeClass("ant_dont_show"),a.push(ANT.text_container_popularity[c].hash));ANT.actions.indicators.show(a)}},insertContainerIcon:function(a){},viewReactionSuccess:function(a){var c=(a.tag,a.aWindow);a.response.data.interaction,""==a.content_node?a.response.data.content_node:a.content_node;c.removeClass("ant_rewritable").addClass("ant_viewing_more").find(".ant_footer").hide();var d="reactionSuccess"==a.scenario?ANT.t("thanks"):ANT.t("already_done_that"),e="page"==a.kind;if(e)var f=null,g="page";else var f=a.hash,h=ANT.summaries[f],g=h.kind;var i=ANT.aWindow.makeHeader(d,a.response.data.interaction.id);c.find(".ant_header").replaceWith(i);var j=ANT.aWindow.panelCreate(c,"ant_view_more"),k=c.find("div.ant_body_wrap");k.append(j),ANT.aWindow.updateTagMessage(a),ANT.aWindow.panelShow(c,j,function(){if("text"==g&&a.selState){var d=a.selState;b().selog("hilite",d,"on")}var e=ANT.actions.indicators.utils.makeTagsListForInline(c);"reactionExists"!=a.scenario&&ANT.actions.containers.updateCrossPageHash(f),e.addClass("ant_hiddenPanel");var h="ant_tags_list";ANT.aWindow.hideFooter(c),ANT.aWindow.panelUpdate(c,h,e);b('[ant-hash="'+f+'"]').length>0})},viewCommentContent:function(a){function c(){var a=b('<div class="ant_commentBox ant_innerWrap"></div>').html('<div class="ant_commentComplete"><div><h4>Leave a comment:</h4></div></div>'),c="Add a comment or #hashtag",d=b('<div class="ant_comment ant_clearfix">'),e=b('<textarea class="commentTextArea ant_default_msg">'+c+"</textarea>"),k=b('<div class="ant_charCount">'+ANT.t("characters_left").replace("NNN",ANT.group.comment_length)+"</div>"),l=b('<button class="ant_commentSubmit">'+ANT.t("comment")+"</button>");return d.append(e,k,l),e.focus(function(){b(this).val()==c&&b(this).val("")}).blur(function(){var a=b(this).val();(""===a||a===c)&&(b(this).addClass("ant_default_msg"),b(this).val(c))}).keyup(function(a){
var c=e.val();return"27"==a.keyCode?(b(this).blur(),!1):(c.length>ANT.group.comment_length&&(c=c.substr(0,ANT.group.comment_length),e.val(c)),void e.siblings("div.ant_charCount").text(ANT.t("characters_left").replace("NNN",ANT.group.comment_length-c.length)))}),l.click(function(a){var d=e.val();if(d.length>ANT.group.comment_length&&(d=d.substr(0,ANT.group.comment_length),e.val(d),e.siblings("div.ant_charCount").text(ANT.t("characters_left").replace("NNN",ANT.group.comment_length-d.length))),d!=c){if(b.isEmptyObject(h)&&"img"==j.kind)h={body:b('img[ant-hash="'+j.hash+'"]').get(0).src,kind:j.kind,hash:j.hash};else{var k=b('[ant-hash="'+j.hash+'"]'),l=k.attr("ant-content-type");l?"media"==l?h.kind="media":"image"==l?h.kind="image":h.kind="text":h.kind="text"}var m=m||null,n={hash:i,content_node_data:h,comment:d,content:h.body,tag:f,aWindow:g,selState:m};ANT.actions.interactions.ajax(n,"comment","create")}else e.focus();return!1}),a.append(d),a}function d(){var a=b('<div class="ant_back">'+ANT.t("close")+" X</div>");return a.click(function(){ANT.aWindow.safeClose(g)}),a}function e(){var a,c=f.id?f.id:f.tag_id;a="text"==k?j.content_nodes[h.id].top_interactions.coms:j.top_interactions.coms[c];var d=0;b.isArray(a)||(a=[].push(a)),b.each(a,function(a,b){b.tag_id==c&&d++});var e=!b.isEmptyObject(a);if(e){var g=b('<div class="ant_otherCommentsBox"></div>'),i=b('<div class="ant_comment_header ant_innerWrap"><h4>(<span>'+d+"</span>) "+ANT.t("comments")+":</h4></div>");return g.append(i),b.each(a,function(a,d){if(d.tag_id==c){g.show();var e=b('<div class="ant_commentSet ant_innerWrap" />'),f=b('<div class="ant_commentBy" />'),h=b('<div class="ant_comment" />'),i=(b('<div class="ant_commentReplies" />'),b('<div class="ant_commentReply" />'),b('<a href="javascript:void(0);">Reply</a>'),d&&d.social_user&&d.social_user.img_url?d.social_user.img_url:ANT_staticUrl+"widget/images/anonymousplode.png"),j=d&&d.user&&""!==d.user.first_name?d.user.first_name+" "+d.user.last_name:"Anonymous";f.html('<a href="'+ANT_baseUrl+"/user/"+d.user.id+'" target="_blank"><img src="'+i+'" class="no-ant" /> '+j+"</a>").click(function(){}),h.html('<div class="ant_comment_body">'+d.body+"</div>"),e.append(f,h),g.append(e)}}),g.find("div.ant_commentSet:last-child").addClass("ant_lastchild"),g}}var f=a.tag,g=a.aWindow,h=a.content_node;ANT.events.trackEventToCloud({event_type:"vcom",event_value:"",container_hash:a.hash,container_kind:a.content_node.kind,page_id:ANT.util.getPageProperty("id"),reaction_body:a.tag.tag_body}),g.removeClass("ant_rewritable").addClass("ant_viewing_more"),ANT.aWindow.tagBox.setWidth(g,222),ANT.aWindow.hideFooter(g);var i=a.hash,j=ANT.summaries[i],k=(f.tag_body?f.tag_body:f.body,j.kind),l=ANT.aWindow.makeHeader(f.tag_body);g.find(".ant_header").replaceWith(l);var m=ANT.aWindow.panelCreate(g,"ant_view_more"),n=g.find("div.ant_body_wrap");n.append(m);var o=b('<div class="ant_commentsWrap"></div>'),p=d(),q=(d(),e()),r=c();o.append(p,q,r),m.append(o);ANT.aWindow.panelShow(g,m,function(){if("text"==k){var c=a.selState||j.content_nodes[h.id].selState;b().selog("hilite",c,"on"),g.data("selState",c)}})},share_getLink:function(a){var c=a.hash,d=ANT.summaries[c],e=a.kind?a.kind:d.kind;ANT.session.getUser(a,function(d){var f=(d.aWindow,d.tag),g=d.content_node_info?d.content_node_info:d.content_node;g.hash||(g.hash=g.container?g.container:d.hash),g.content||(g.content=g.body);var h={hash:c,body:g.content,location:g.location,kind:e};ANT.actions.content_nodes.make(h);b.postMessage("page_hash|"+window.location.hash,ANT_baseUrl+"/static/xdm.html",window.frames["ant-xdm-hidden"]),"undefined"==typeof f.body&&(f.body=f.tag_body);var i={tag:f,hash:h.hash,content_node_data:h,user_id:ANT.user.user_id,ant_token:ANT.user.ant_token,group_id:ANT.group.id,page_id:ANT.util.getPageProperty("id",c),referring_int_id:a.referring_int_id,container_kind:"page"==a.kind?"page":ANT.summaries[c].kind};b.ajax({url:ANT_baseUrl+"/api/share/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(i)},success:function(b){a.response=b,"fail"==b.status?-1!=b.message.indexOf("Temporary user interaction limit reached")?ANT.session.showLoginPanel(a):ANT.session.handleGetUserFail(a,function(){ANT.actions.share_getLink(a)}):ANT.actions.shareContent({sns:d.sns,content_node_info:g,short_url:b.data.short_url,reaction:f.body,container_kind:"page"==c?"page":ANT.summaries[c].kind})},error:function(a){}})})},shareContent:function(a){function b(){return ANT.group.name?ANT.group.name:document.domain.replace("www.","")}function c(a,b,c){var d=c?b?"&#124;":"|":b?"&raquo;":"»";return b?a+"&nbsp;"+d+"&nbsp;":a+" "+d}function d(a,b,c){var d="...",e=b-d.length,f=a.length<=b?a:a.substr(0,e)+d;return f=c?'"'+f+'"':f}var e=b(),f=a.content_node_info.content,g="",h="",i=300;switch(a.sns){case"facebook":var j="",k="",l="";switch(a.container_kind){case"txt":case"text":i=300,h=d(f,i,!0),l=c(a.reaction)+" "+h;break;case"img":case"image":h="[a picture on "+e+"] Check it out: ",ANT_offline&&(f=f.replace("local.antenna.is:8081","www.antenna.is"),f=f.replace("local-static.antenna.is:8081","www.antenna.is")),j="&p[images][0]="+encodeURI(f),l=c(a.reaction)+" "+h;break;case"media":case"med":case"video":h="[a video on "+e+"] Check it out: ",l=c(a.reaction)+" "+h;break;case"page":h="[an article on "+e+"] Check it out: ",l=c(a.reaction)+" "+h}g="http://www.facebook.com/sharer.php?s=100&p[title]="+encodeURI(l)+"&p[url]="+a.short_url+"&p[summary]="+encodeURI(l)+j+k;break;case"twitter":var l="",m=ANT.group.twitter?"&via="+ANT.group.twitter:"";switch(a.container_kind){case"txt":case"text":i=110-a.reaction.length,h=d(f,i,!0),l=c(a.reaction)+" "+h;break;case"img":case"image":h="[a picture on "+e+"] Check it out: ",l=c(a.reaction)+" "+h;break;case"media":case"med":case"video":h="[a video on "+e+"] Check it out: ",l=c(a.reaction)+" "+h;break;case"page":h="[an article on "+e+"] Check it out: ",l=c(a.reaction)+" "+h}g="http://twitter.com/intent/tweet?url="+a.short_url+m+"&text="+encodeURI(l)}""!==g?ANT.shareWindow&&(ANT.shareWindow.location=g):ANT.shareWindow&&ANT.shareWindow.close()},newUpdateData:function(a){var b=ANT.summaries[a];b.$aWindow_readmode,b.$aWindow_writemode},startSelect:function(a,c,d){function e(a){var c=null,d=!1;return a.parents().each(function(){if(!d){var a=b(this);h(a)&&(c=b(this),d=!0)}}),c}function f(d){var e=d.data("hash"),f=ANT.summaries[e]||"undefined";if(g(e))return!1;if("undefined"!=f){var h=f.$indicator;ANT.actions.indicators.helpers.out(h)}ANT.aWindow.close(b("div.ant.ant_window.ant.ant_rewritable"));var i=c?{top:parseInt(c.pageY,10)-7,left:parseInt(c.pageX,10)-25}:{top:a.offset().top,left:a.offset().left};return ANT.actionbar.draw({coords:i,kind:"text",content:k.text,hash:d.data("hash")})}function g(a){var b=ANT.summaries[a]||"undefined";if(!b)return!1;var c=b.$aWindow_writemode;return c&&c.filter(":visible").length?c:!1}function h(a){var b=!("block"!=a.css("display")&&"list-item"!=a.css("display")||a.closest(".ant_indicator").length||a.is("html, body"));return b}if(!a.hasAttr("ant-item")||!b('[ant-cta-for="'+a.attr("ant-item")+'"]').length){ANT.actionbar.closeAll();var i=800;if(!a.closest(".ant, .no-ant, #ant_sandbox").length||a.closest(".ant_indicator").length){var j=null;if(j=h(a)?a:e(a),null!==j){$antParent=j.closest("[ant-hashed]");var k=j.selog("save");if(k&&k.serialRange&&k.text&&!/^\s*$/g.test(k.text)&&!(k.text.length>i)){var l="text",m=k.text;if($antParent.length&&$antParent.hasAttr("ant-hashed")&&!$antParent.hasAttr("ant-page-container")){if(d){var n=$antParent.data("hash");return void d(n,l,m)}return f($antParent)}var o=ANT.actions.hashNodes(j);o&&ANT.actions.sendHashes(o,function(){if(d){var a=j.data("hash");return void d(a,l,m)}return f(j)})}}}}},startSelectFromMouseUp:function(a){var c=b(a.target);ANT.actions.startSelect(c,a)},stripAntNode:function(a){a.removeAttr("ant-node ant-hasIndicator ant-hashed ant_summary_loaded ant-hash").off("mouseenter.ant").find(".ant_indicator").remove()},pages:{save:function(a,b){ANT.pages[b.id]=b},initPageContainer:function(a){var c=ANT.pages[a],d=c.urlhash,e=b(1==b(ANT.group.post_selector+'[ant-page-key="'+d+'"]').length?ANT.group.post_selector+'[ant-page-key="'+d+'"]':"body[ant-page-key]");if(1===e.length){e.removeAttr("ant-page-key"),e.attr("ant-page-container",a);var f=ANT.util.md5.hex_md5(String(c.id));e.get(0).nodeName.toLowerCase();ANT.actions.containers.save({id:String(c.id),kind:"page",hash:f,HTMLkind:null}),e.data("page_id",String(c.id)),ANT.group.post_selector&&!b(ANT.group.post_selector).first().find(ANT.group.active_sections).length&&b(ANT.group.active_sections).length?ANT.actions.hashNodes(e.parent()):ANT.actions.hashNodes(e);var g={};if(c.containers.length>0&&(g[c.id]=[],b.each(c.containers,function(a,b){"undefined"!=typeof b.hash&&g[c.id].push(b.hash)})),c&&e.find("[ant-item]").length&&(g[c.id]=g[c.id]||[],b.each(e.find("[ant-item]"),function(a,d){ANT.actions.hashNodes(b(d));var e=b(d).attr("ant-hash");"undefined"!=typeof e&&g[c.id].push(e)})),ANT.actions.sendHashes(g),ANT.current.first_hashed_content=b(ANT.group.active_sections).find("[ant-hash]").first().attr("ant-hash"),ANT.util.activeAB()){var h=c;h.key=d,e.find(ANT.group.summary_widget_selector).length>0&&e.find(ANT.group.summary_widget_selector+'[ant-page-widget-key="'+d+'"]')?h.$anchor=e.find(ANT.group.summary_widget_selector).eq(0):1==b(".ant-page-summary").length&&(h.$anchor=b(".ant-page-summary").eq(0)),b("#ant_sandbox").append('<div id="ant_summary_tag_details" />'),h.$anchor&&h.$anchor.length&&(0===b("div.ant-summary").length||b("div.ant-summary").length<b(ANT.group.post_selector).length)&&h.$anchor.antWidgetSummary(h)}}}},users:{save:function(a,b){}}}})}function ant_loadScript(a,b){var c=document.getElementsByTagName("head")[0];if(c){var d=document.createElement("script");d.setAttribute("src",a.src),d.setAttribute("type","text/javascript"),d.readyState?d.onreadystatechange=function(){("loaded"==d.readyState||"complete"==d.readyState)&&(d.onreadystatechange=null,b())}:d.onload=function(){b()},c.appendChild(d)}}function jquery_onload(a){$A=a.noConflict(!0);var b=$A;return!function(a,b){"use strict";var c,d;if(a.uaMatch=function(a){a=a.toLowerCase();var b=/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],c=/(ipad)/.exec(a)||/(iphone)/.exec(a)||/(android)/.exec(a)||/(windows phone)/.exec(a)||/(win)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||[];return{browser:b[3]||b[1]||"",version:b[2]||"0",platform:c[0]||""}},c=a.uaMatch(b.navigator.userAgent),d={},c.browser&&(d[c.browser]=!0,d.version=c.version,d.versionNumber=parseInt(c.version)),c.platform&&(d[c.platform]=!0),(d.chrome||d.opr||d.safari)&&(d.webkit=!0),d.rv){var e="msie";c.browser=e,d[e]=!0}if(d.opr){var f="opera";c.browser=f,d[f]=!0}if(d.safari&&d.android){var g="android";c.browser=g,d[g]=!0}d.name=c.browser,d.platform=c.platform,a.browser=d}(b,window),b.browser.msie&&parseInt(b.browser.version,10)<9?!1:(b.browser.msie&&8==parseInt(b.browser.version,10)&&b("body").addClass("ant_ie"),void $AFunctions($A))}function load_mobileEvents(a){!function(a){function b(){var a=h();a!==i&&(i=a,l.trigger("orientationchange"))}function c(b,c,d,e){var f=d.type;d.type=c,a.event.dispatch.call(b,d,e),d.type=f}a.attrFn=a.attrFn||{};var d=navigator.userAgent.toLowerCase(),e=d.indexOf("chrome")>-1&&(d.indexOf("windows")>-1||d.indexOf("macintosh")>-1||d.indexOf("linux")>-1)&&d.indexOf("chrome")<0,f={swipe_h_threshold:50,swipe_v_threshold:50,taphold_threshold:750,doubletap_int:500,touch_capable:"ontouchstart"in document.documentElement&&!e,orientation_support:"orientation"in window&&"onorientationchange"in window,startevent:"ontouchstart"in document.documentElement&&!e?"touchstart":"mousedown",endevent:"ontouchstart"in document.documentElement&&!e?"touchend":"mouseup",moveevent:"ontouchstart"in document.documentElement&&!e?"touchmove":"mousemove",tapevent:"ontouchstart"in document.documentElement&&!e?"tap":"click",scrollevent:"ontouchstart"in document.documentElement&&!e?"touchmove":"scroll",hold_timer:null,tap_timer:null};a.isTouchCapable=function(){return f.touch_capable},a.getStartEvent=function(){return f.startevent},a.getEndEvent=function(){return f.endevent},a.getMoveEvent=function(){return f.moveevent},a.getTapEvent=function(){return f.tapevent},a.getScrollEvent=function(){return f.scrollevent},a.each(["tapstart","tapend","tap","singletap","doubletap","taphold","swipe","swipeup","swiperight","swipedown","swipeleft","swipeend","scrollstart","scrollend","orientationchange"],function(b,c){a.fn[c]=function(a){return a?this.bind(c,a):this.trigger(c)},a.attrFn[c]=!0}),a.event.special.tapstart={setup:function(){var b=this,d=a(b);d.bind(f.startevent,function(a){if(d.data("callee",arguments.callee),a.which&&1!==a.which)return!1;var e=a.originalEvent,g={position:{x:f.touch_capable?e.touches[0].screenX:a.screenX,y:f.touch_capable?e.touches[0].screenY:a.screenY},offset:{x:f.touch_capable?e.touches[0].pageX-e.touches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?e.touches[0].pageY-e.touches[0].target.offsetTop:a.offsetY},time:(new Date).getTime(),target:a.target};return c(b,"tapstart",a,g),!0})},remove:function(){a(this).unbind(f.startevent,a(this).data.callee)}},a.event.special.tapend={setup:function(){var b=this,d=a(b);d.bind(f.endevent,function(a){d.data("callee",arguments.callee);var e=a.originalEvent,g={position:{x:f.touch_capable?e.changedTouches[0].screenX:a.screenX,y:f.touch_capable?e.changedTouches[0].screenY:a.screenY},offset:{x:f.touch_capable?e.changedTouches[0].pageX-e.changedTouches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?e.changedTouches[0].pageY-e.changedTouches[0].target.offsetTop:a.offsetY},time:(new Date).getTime(),target:a.target};return c(b,"tapend",a,g),!0})},remove:function(){a(this).unbind(f.endevent,a(this).data.callee)}},a.event.special.taphold={setup:function(){var b,d=this,e=a(d),g={x:0,y:0};e.bind(f.startevent,function(a){if(a.which&&1!==a.which)return!1;e.data("tapheld",!1),b=a.target;var h=a.originalEvent,i=(new Date).getTime(),j={x:f.touch_capable?h.touches[0].screenX:a.screenX,y:f.touch_capable?h.touches[0].screenY:a.screenY},k={x:f.touch_capable?h.touches[0].pageX-h.touches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?h.touches[0].pageY-h.touches[0].target.offsetTop:a.offsetY};return g.x=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageX:a.pageX,g.y=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageY:a.pageY,f.hold_timer=window.setTimeout(function(){var l=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageX:a.pageX,m=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageY:a.pageY;if(a.target==b&&g.x==l&&g.y==m){e.data("tapheld",!0);var n=(new Date).getTime(),o={x:f.touch_capable?h.touches[0].screenX:a.screenX,y:f.touch_capable?h.touches[0].screenY:a.screenY},p={x:f.touch_capable?h.touches[0].pageX-h.touches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?h.touches[0].pageY-h.touches[0].target.offsetTop:a.offsetY};duration=n-i;var q={startTime:i,endTime:n,startPosition:j,startOffset:k,endPosition:o,endOffset:p,duration:duration,target:a.target};e.data("callee1",arguments.callee),c(d,"taphold",a,q)}},f.taphold_threshold),!0}).bind(f.endevent,function(){e.data("callee2",arguments.callee),e.data("tapheld",!1),window.clearTimeout(f.hold_timer)})},remove:function(){a(this).unbind(f.startevent,a(this).data.callee1).unbind(f.endevent,a(this).data.callee2)}},a.event.special.doubletap={setup:function(){var b,d,e,g,h=this,i=a(h);i.bind(f.startevent,function(a){return a.which&&1!==a.which?!1:(i.data("doubletapped",!1),b=a.target,i.data("callee1",arguments.callee),g=a.originalEvent,e={position:{x:f.touch_capable?g.touches[0].screenX:a.screenX,y:f.touch_capable?g.touches[0].screenY:a.screenY},offset:{x:f.touch_capable?g.touches[0].pageX-g.touches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?g.touches[0].pageY-g.touches[0].target.offsetTop:a.offsetY},time:(new Date).getTime(),target:a.target},!0)}).bind(f.endevent,function(a){var j=(new Date).getTime(),k=i.data("lastTouch")||j+1,l=j-k;if(window.clearTimeout(d),i.data("callee2",arguments.callee),l<f.doubletap_int&&l>0&&a.target==b&&l>100){i.data("doubletapped",!0),window.clearTimeout(f.tap_timer);var m={position:{x:f.touch_capable?g.touches[0].screenX:a.screenX,y:f.touch_capable?g.touches[0].screenY:a.screenY},offset:{x:f.touch_capable?g.touches[0].pageX-g.touches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?g.touches[0].pageY-g.touches[0].target.offsetTop:a.offsetY},time:(new Date).getTime(),target:a.target},n={firstTap:e,secondTap:m,interval:m.time-e.time};c(h,"doubletap",a,n)}else i.data("lastTouch",j),d=window.setTimeout(function(a){window.clearTimeout(d)},f.doubletap_int,[a]);i.data("lastTouch",j)})},remove:function(){a(this).unbind(f.startevent,a(this).data.callee1).unbind(f.endevent,a(this).data.callee2)}},a.event.special.singletap={setup:function(){var b=this,d=a(b),e=null,g=null,h={x:0,y:0};d.bind(f.startevent,function(a){return a.which&&1!==a.which?!1:(g=(new Date).getTime(),e=a.target,d.data("callee1",arguments.callee),h.x=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageX:a.pageX,h.y=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageY:a.pageY,!0)}).bind(f.endevent,function(a){d.data("callee2",arguments.callee),a.target==e&&(end_pos_x=a.originalEvent.changedTouches?a.originalEvent.changedTouches[0].pageX:a.pageX,end_pos_y=a.originalEvent.changedTouches?a.originalEvent.changedTouches[0].pageY:a.pageY,f.tap_timer=window.setTimeout(function(){if(!d.data("doubletapped")&&!d.data("tapheld")&&h.x==end_pos_x&&h.y==end_pos_y){var e=a.originalEvent,i={position:{x:f.touch_capable?e.changedTouches[0].screenX:a.screenX,y:f.touch_capable?e.changedTouches[0].screenY:a.screenY},offset:{x:f.touch_capable?e.changedTouches[0].pageX-e.changedTouches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?e.changedTouches[0].pageY-e.changedTouches[0].target.offsetTop:a.offsetY},time:(new Date).getTime(),target:a.target};i.time-g<f.taphold_threshold&&c(b,"singletap",a,i)}},f.doubletap_int))})},remove:function(){a(this).unbind(f.startevent,a(this).data.callee1).unbind(f.endevent,a(this).data.callee2)}},a.event.special.tap={setup:function(){var b,d=this,e=a(d),g=!1,h=null,i={x:0,y:0};e.bind(f.startevent,function(a){return e.data("callee1",arguments.callee),a.which&&1!==a.which?!1:(g=!0,i.x=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageX:a.pageX,i.y=a.originalEvent.targetTouches?a.originalEvent.targetTouches[0].pageY:a.pageY,b=(new Date).getTime(),h=a.target,!0)}).bind(f.endevent,function(a){e.data("callee2",arguments.callee);var j=a.originalEvent.targetTouches?a.originalEvent.changedTouches[0].pageX:a.pageX,k=a.originalEvent.targetTouches?a.originalEvent.changedTouches[0].pageY:a.pageY;if(h==a.target&&g&&(new Date).getTime()-b<f.taphold_threshold&&i.x==j&&i.y==k){var l=a.originalEvent,m={position:{x:f.touch_capable?l.changedTouches[0].screenX:a.screenX,y:f.touch_capable?l.changedTouches[0].screenY:a.screenY},offset:{x:f.touch_capable?l.changedTouches[0].pageX-l.changedTouches[0].target.offsetLeft:a.offsetX,y:f.touch_capable?l.changedTouches[0].pageY-l.changedTouches[0].target.offsetTop:a.offsetY},time:(new Date).getTime(),target:a.target};c(d,"tap",a,m)}})},remove:function(){a(this).unbind(f.startevent,a(this).data.callee1).unbind(f.endevent,a(this).data.callee2)}},a.event.special.swipe={setup:function(){function b(b){h=a(b.target),h.data("callee1",arguments.callee),k.x=b.originalEvent.targetTouches?b.originalEvent.targetTouches[0].pageX:b.pageX,k.y=b.originalEvent.targetTouches?b.originalEvent.targetTouches[0].pageY:b.pageY,l.x=k.x,l.y=k.y,i=!0;var c=b.originalEvent;e={position:{x:f.touch_capable?c.touches[0].screenX:b.screenX,y:f.touch_capable?c.touches[0].screenY:b.screenY},offset:{x:f.touch_capable?c.touches[0].pageX-c.touches[0].target.offsetLeft:b.offsetX,y:f.touch_capable?c.touches[0].pageY-c.touches[0].target.offsetTop:b.offsetY},time:(new Date).getTime(),target:b.target};for(var d=new Date;new Date-d<100;);}function c(b){h=a(b.target),h.data("callee2",arguments.callee),l.x=b.originalEvent.targetTouches?b.originalEvent.targetTouches[0].pageX:b.pageX,l.y=b.originalEvent.targetTouches?b.originalEvent.targetTouches[0].pageY:b.pageY,window.clearTimeout(f.hold_timer);var c,d=h.data("xthreshold"),g=h.data("ythreshold"),m="undefined"!=typeof d&&d!==!1&&parseInt(d)?parseInt(d):f.swipe_h_threshold,n="undefined"!=typeof g&&g!==!1&&parseInt(g)?parseInt(g):f.swipe_v_threshold;if(k.y>l.y&&k.y-l.y>n&&(c="swipeup"),k.x<l.x&&l.x-k.x>m&&(c="swiperight"),k.y<l.y&&l.y-k.y>n&&(c="swipedown"),k.x>l.x&&k.x-l.x>m&&(c="swipeleft"),void 0!=c&&i){k.x=0,k.y=0,l.x=0,l.y=0,i=!1;var o=b.originalEvent;endEvnt={position:{x:f.touch_capable?o.touches[0].screenX:b.screenX,y:f.touch_capable?o.touches[0].screenY:b.screenY},offset:{x:f.touch_capable?o.touches[0].pageX-o.touches[0].target.offsetLeft:b.offsetX,y:f.touch_capable?o.touches[0].pageY-o.touches[0].target.offsetTop:b.offsetY},time:(new Date).getTime(),target:b.target};var p=Math.abs(e.position.x-endEvnt.position.x),q=Math.abs(e.position.y-endEvnt.position.y),r={startEvnt:e,endEvnt:endEvnt,direction:c.replace("swipe",""),xAmount:p,yAmount:q,duration:endEvnt.time-e.time};j=!0,h.trigger("swipe",r).trigger(c,r)}}function d(b){h=a(b.target);var c="";if(h.data("callee3",arguments.callee),j){var d=h.data("xthreshold"),g=h.data("ythreshold"),k="undefined"!=typeof d&&d!==!1&&parseInt(d)?parseInt(d):f.swipe_h_threshold,l="undefined"!=typeof g&&g!==!1&&parseInt(g)?parseInt(g):f.swipe_v_threshold,m=b.originalEvent;endEvnt={position:{x:f.touch_capable?m.changedTouches[0].screenX:b.screenX,y:f.touch_capable?m.changedTouches[0].screenY:b.screenY},offset:{x:f.touch_capable?m.changedTouches[0].pageX-m.changedTouches[0].target.offsetLeft:b.offsetX,y:f.touch_capable?m.changedTouches[0].pageY-m.changedTouches[0].target.offsetTop:b.offsetY},time:(new Date).getTime(),target:b.target},e.position.y>endEvnt.position.y&&e.position.y-endEvnt.position.y>l&&(c="swipeup"),e.position.x<endEvnt.position.x&&endEvnt.position.x-e.position.x>k&&(c="swiperight"),e.position.y<endEvnt.position.y&&endEvnt.position.y-e.position.y>l&&(c="swipedown"),e.position.x>endEvnt.position.x&&e.position.x-endEvnt.position.x>k&&(c="swipeleft");var n=Math.abs(e.position.x-endEvnt.position.x),o=Math.abs(e.position.y-endEvnt.position.y),p={startEvnt:e,endEvnt:endEvnt,direction:c.replace("swipe",""),xAmount:n,yAmount:o,duration:endEvnt.time-e.time};h.trigger("swipeend",p)}i=!1,j=!1}var e,g=this,h=a(g),i=!1,j=!1,k={x:0,y:0},l={x:0,y:0};h.bind(f.startevent,b),h.bind(f.moveevent,c),h.bind(f.endevent,d)},remove:function(){a(this).unbind(f.startevent,a(this).data.callee1).unbind(f.moveevent,a(this).data.callee2).unbind(f.endevent,a(this).data.callee3)}},a.event.special.scrollstart={setup:function(){function b(a,b){d=b,c(g,d?"scrollstart":"scrollend",a)}var d,e,g=this,h=a(g);h.bind(f.scrollevent,function(a){h.data("callee",arguments.callee),d||b(a,!0),clearTimeout(e),e=setTimeout(function(){b(a,!1)},50)})},remove:function(){a(this).unbind(f.scrollevent,a(this).data.callee)}};var g,h,i,j,k,l=a(window),m={0:!0,180:!0};if(f.orientation_support){var n=window.innerWidth||a(window).width(),o=window.innerHeight||a(window).height(),p=50;j=n>o&&n-o>p,k=m[window.orientation],(j&&k||!j&&!k)&&(m={"-90":!0,90:!0})}a.event.special.orientationchange=g={setup:function(){return f.orientation_support?!1:(i=h(),l.bind("throttledresize",b),!0)},teardown:function(){return f.orientation_support?!1:(l.unbind("throttledresize",b),!0)},add:function(a){var b=a.handler;a.handler=function(a){return a.orientation=h(),b.apply(this,arguments)}}},a.event.special.orientationchange.orientation=h=function(){var a=!0,b=document.documentElement;return a=f.orientation_support?m[window.orientation]:b&&b.clientWidth/b.clientHeight<1.1,a?"portrait":"landscape"},a.event.special.throttledresize={setup:function(){a(this).bind("resize",u)},teardown:function(){a(this).unbind("resize",u)}};var q,r,s,t=250,u=function(){r=(new Date).getTime(),s=r-v,s>=t?(v=r,a(this).trigger("throttledresize")):(q&&window.clearTimeout(q),q=window.setTimeout(b,t-s))},v=0;a.each({scrollend:"scrollstart",swipeup:"swipe",swiperight:"swipe",swipedown:"swipe",swipeleft:"swipe",swipeend:"swipe"},function(b,c,d){a.event.special[b]={setup:function(){a(this).bind(c,a.noop)}}})}(a)}function $AFunctions($A){function loadCSS(a){$A.each(a,function(a,b){$A("<link>").attr({href:b,rel:"stylesheet"}).appendTo("body")})}function initCommonUtils(a){a.extend(ANT,{commonUtil:{prettyNumber:function(a){var b=parseInt(a,10);if(isNaN(b)||0>b)return!1;for(var c=["","K","M","B","T"],d=0;d<c.length;d++){var e=Math.pow(10,3*d),f=Math.pow(10,3*(d+1));if(f>b)return""+Math.floor(b/e)+c[d]}}}})}function initPlugins($A){function plugin_jquery_log(a){var b=a;a.clog=function(){window.console&&window.console.log&&window.console.log.apply&&window.console.log.apply(window.console,arguments)},a.fn.clog=function(){var b=arguments||this;return a.clog(b),this},"undefined"==typeof clog&&(clog=function(){a.clog(arguments)}),"undefined"!=typeof b&&(b.clog=a.clog,b.fn.clog=a.fn.clog)}function plugin_jquery_hasAttr(a){a.fn.hasAttr=function(a){return void 0!==this.attr(a)}}function plugin_jquery_json($){$.toJSON=function(a){var b=typeof a;if(null===a)return"null";if("undefined"==b)return void 0;if("number"==b||"boolean"==b)return a+"";if("string"==b)return $.quoteString(a);if("object"==b){if(a.constructor===Date){var c=a.getUTCMonth()+1;10>c&&(c="0"+c);var d=a.getUTCDate();10>d&&(d="0"+d);var e=a.getUTCFullYear(),f=a.getUTCHours();10>f&&(f="0"+f);var g=a.getUTCMinutes();10>g&&(g="0"+g);var h=a.getUTCSeconds();10>h&&(h="0"+h);var i=a.getUTCMilliseconds();return 100>i&&(i="0"+i),10>i&&(i="0"+i),'"'+e+"-"+c+"-"+d+"T"+f+":"+g+":"+h+"."+i+'Z"'}if(a.constructor===Array){for(var j=[],k=0;k<a.length;k++)j.push($.toJSON(a[k])||"null");return"["+j.join(",")+"]"}var l=[];for(var m in a){var n,b=typeof m;if("number"==b)n='"'+m+'"';else{if("string"!=b)continue;n=$.quoteString(m)}if("function"!=typeof a[m]){var o=$.toJSON(a[m]);"undefined"!=typeof o&&l.push(n+":"+o)}}return"{"+l.join(", ")+"}"}},$.evalJSON=function(src){return eval("("+src+")")},$.secureEvalJSON=function(src){var filtered=src;if(filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@"),filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");throw new SyntaxError("Error parsing JSON, source is not valid.")},$.quoteString=function(a){return a.match(_escapeable)?'"'+a.replace(_escapeable,function(a){var b=_meta[a];return"string"==typeof b?b:(b=a.charCodeAt(),"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16))})+'"':'"'+a+'"'};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,_meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}}function plugin_jquery_postMessage(a){var b,c,d,e,f=1,g=this,h=!1,i="postMessage",j="addEventListener",k=g[i];a[i]=function(b,c,d){c&&(b="string"==typeof b?b:a.param(b),d=d||parent,k?d[i](b,c.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):c&&(d.location=c.replace(/#.*$/,"")+"#"+ +new Date+f++ +"&"+b))},a.receiveMessage=e=function(f,i,l){k?(f&&(d&&e(),d=function(b){return"string"==typeof i&&b.origin!==i||a.isFunction(i)&&i(b.origin)===h?h:void f(b)}),g[j]?g[f?j:"removeEventListener"]("message",d,h):g[f?"attachEvent":"detachEvent"]("onmessage",d)):(b&&clearInterval(b),b=null,f&&(l="number"==typeof i?i:"number"==typeof l?l:100,b=setInterval(function(){var a=document.location.hash,b=/^#?\d+&/;a!==c&&b.test(a)&&(c=a,f({data:a.replace(b,"")}))},l)))}}function plugin_jquery_drags(a){$.fn.drags=function(a){a=$.extend({handle:""},a);var b=$(this),c=b;return c.on("mousedown.ant",function(c){if(""===a.handle||$(c.target).closest(".ant_header").length){b.removeClass("ant_rewritable");var d=b.outerHeight(),e=b.outerWidth(),f=b.offset(),g=f.top+d-c.pageY,h=f.left+e-c.pageX;$(document).on("mousemove.ant_drag",function(a){b.offset({top:a.pageY+g-d,left:a.pageX+h-e})}).on("mouseup.ant",function(){$(this).off("mousemove.ant_drag")}),c.preventDefault()}}),this}}function plugin_jquery_enhancedOffset(a){var b=a.fn.offset;a.fn.offset=function(){var c=b.call(this),d=c?c.top+this.outerHeight():0,e=c?c.left+this.outerWidth():0,f=arguments;return f.length?this.animate({top:f[0].top||f[0],left:f[0].left||f[1]},(f[0].top?f[1]:f[2])||1):a.extend(c,{bottom:d,right:e})}}function plugin_jquery_antWidgetSummary(a){function b(b){if(ANT.status.page===!0&&"none"!=ANT.group.summary_widget_selector){var d=b,e="ant-summary-key-"+d.key;a("."+e).remove();var f=a(d.parentContainer),g=a('<div class="ant ant-summary ant-summary-'+d.id+' ant-border-box" ant-page-id="'+d.id+'"></div>').addClass(e);"true"==ANT.engageScriptParams.bookmarklet&&g.addClass("ant_bookmarklet"),g.data({page_id:d.id,page_key:d.key});var h=""!=ANT.group.summary_widget_method?ANT.group.summary_widget_method:"after";f[h](g);var i=(f.hasClass("defaultSummaryBar"),"top");g.find("img.ant_tooltip_this").tooltip({placement:i}),g.append('<a href="javascript:void(0);" target="_blank" class="ant_logo"><span class="ant-antenna-logo"></span></a>'),g.find(".ant-logo").tooltip({});var j=function(){c();var b=a(this).data("page_id");ANT.aWindow.make("readMode",{is_page:!0,page:d,tags:d.toptags});ANT.events.trackEventToCloud({event_type:"sb",event_value:d.toptags.length>0?"vw":"ad",page_id:b}),ANT.events.emit("antenna.reactionview","",{kind:"page"})};isTouchBrowser?g.on("touchend.ant",function(b){ANT.util.isTouchDragging(b)||0==ANT.util.bubblingEvents.touchend&&(j.call(this),a(this).toggleClass("ant_hover"))}):g.hover(j,function(){});var k;b.summary&&a.each(b.summary,function(){"tag"==this.kind&&(k=this.count)});var l=0;k?l=k:a.each(d.toptags,function(a,b){l+=b.tag_count});var m=l>1?l+" <span>"+ANT.t("plural_reaction")+"</span>":l>0?l+" <span>"+ANT.t("single_reaction")+"</span>":"<span>"+ANT.t("plural_reaction")+"</span>";g.append('<a class="ant_reactions_label">'+m+"</a>");for(var n=[],o=d&&d.toptags&&1===d.toptags.length?1:2,p=0;p<d.toptags.length;p++){var q=d.toptags[p];if(q)for(var r=0;r<ANT.group.default_reactions.length;r++){var s=ANT.group.default_reactions[r];q.id===s.id&&n.length<o&&n.push(q)}}isMobile&&ANT.group.summary_widget_expanded_mobile===!0&&n.length>=1&&g.append('<div class="ant-top-tags"><div class="ant-top-tags-wrapper">'+(n[0]?'<div class="ant-top-tag">'+n[0].body+" <span>("+n[0].tag_count+")</span></div>":"")+(n[1]?'<div class="ant-top-tag">'+n[1].body+" <span>("+n[1].tag_count+")</span></div>":"")+"</div></div>")}}function c(b){"undefined"==typeof ANT.interaction_data&&(ANT.interaction_data={}),a.each(ANT.summaries,function(b,c){a.each(c.top_interactions.tags,function(a,c){"undefined"!=typeof c&&("undefined"!=typeof ANT.summaries[b].content_nodes?ANT.util.buildInteractionData():ANT.actions.content_nodes.init(b,function(){ANT.util.buildInteractionData()}))})})}a.fn.antWidgetSummary=function(b){return e[b]?e[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist."):e.init.apply(this,arguments)};var d={},e={init:function(c){var e,f=this[0]===document?a(".ant-summary"):this;return f.each(function(){e=c?a.extend({},d,c):d,e.parentContainer=this,a(this).data("settings",e),b(e)})},update:function(){var c=this[0]===document?a(".ant-summary"):this;return c.each(function(c){var d=a(this).data("settings"),e="undefined"!=typeof d?d.id:ANT.util.getPageProperty("id");d.summary=ANT.pages[e].summary,b(d)})}}}function plugin_jquery_selectionographer(a,b){
function c(){return b.getSelection()}function d(d){var e,g,h=n,i=d||{},j={styleName:"ant_hilite",container:document,serialRange:null,range:null},k={idx:h.length,timestamp:a.now(),interactionID:null,hiliter:null,revisionParent:null,text:""},l=a.extend({},j,i,k);if(l.range||l.serialRange)if(l.range){e=l.range;try{g=b.serializeRange(e,!0,l.container)}catch(m){g=!1}}else l.serialRange&&(g=l.serialRange,e=b.deserializeRange(g,l.container));else{var o=c();if(o.isCollapsed)return!1;e=o.getRangeAt(0);try{g=b.serializeRange(e,!0,l.container)}catch(p){g=!1}}return l.serialRange=g,l.range=e.cloneRange(),l.text=l.range.toString(),0===l.text.length?!1:(l.hiliter=f(l),l)}function e(a){if(a===!1)return!1;if("object"==typeof a)return a;var b=n,c="string"==typeof a||"number"==typeof a?a:b.length-1,d=b[c];return d?d:!1}function f(c){if(c.hiliter)return c.hiliter;var d,e=c.range,f=c.styleName,g=f+"_"+c.idx;return d=b.createCssClassApplier(g,!0),d["class"]=g,d.get$start=function(){return a(e.startContainer).closest("."+d["class"])},d.get$end=function(){return a(e.endContainer).closest("."+d["class"])},d.isActive=function(){var a=!1;try{a=d.isAppliedToRange(e)}catch(b){a=null}return a},d}function g(b,c){var d=b.range,e=b.styleName,f=b.hiliter,g=f.isActive();if(null!=g)return g||"on"!==c&&"toggle"!==c?!g||"off"!==c&&"toggle"!==c||(f.get$start().removeClass(e+"_start"),f.get$end().removeClass(e+"_end"),a("."+f["class"]).removeClass(e),f.isAppliedToRange(d)&&f.undoToRange(d)):(f.applyToRange(d),a("."+f["class"]).addClass("ant_hilite "+e),f.get$start().addClass(e+"_start"),f.get$end().addClass(e+"_end"),k.clear()),b}function h(b,c){var d={start:!0,offset:void 0,relOffset:void 0},e=a.extend({},d,c),f=e.start?b.startOffset:b.endOffset;if("undefined"==typeof e.offset){if("undefined"==typeof e.relOffset)return f;e.offset=f+e.relOffset}try{return e.start?b.setStart(b.startContainer,e.offset):b.setEnd(b.endContainer,e.offset),b}catch(g){return!1}}function i(b,c){var d=o,e={};return"undefined"==typeof c||null===c?a.each(d,function(a,b){e[a]=[]}):"string"==typeof c?e[c]=[]:a.each(c,function(a,b){if("string"==typeof b)e[b]=[];else{var c=b[0],d=b.length>1?b.slice(1):[];e[c]=d}}),a.each(e,function(a,c){var e=d[a]||function(){};b=e(b,c)}),b}a.fn.selectionographer=function(b){return k[b]?k[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist."):k.init.apply(this,arguments)},a.fn.selog=a.fn.selectionographer;var j={},k={init:function(b){var c=this;return b=b||{},c.each(function(){l=a.extend(j,b)})},save:function(a){var b,c=this,e=n,f=a||{};return f.container=f.container||c[0]||document,(b=d(f))?(e[b.idx]=b,b):!1},selectEl:function(a){var c=b.createRange();c.selectNodeContents(a);var d=b.getSelection();d.setSingleRange(c)},activate:function(a){var b=e(a);return b?(k.clear(),c().setSingleRange(b.range),b):!1},clear:function(){c().removeAllRanges()},modify:function(a,b){a instanceof Array&&(b=a,a=void 0);var c,d,f,g=e(a);return g?(d=g.range.cloneRange(),d=i(d,b),c={range:d,container:g.container},f=k.save(c)):!1},hilite:function(a,b){var c=b;"string"==typeof a&&isNaN(a)&&(c=a,a=void 0),c=c||"on";var d=e(a);return d?"undefined"!=typeof d.serialRange&&d.serialRange===!1?!1:(g(d,c),d):!1},helpers:function(a){var b=m[a];return b?b.apply(this,Array.prototype.slice.call(arguments,1)):!1},find:function(b){var c,d=this;return b?(RegExp.escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},b=RegExp.escape(b),c=new RegExp(b,"gim"),d.each(function(){for(var b=a(this).text(),d=0,e=0,f=[];(d=c.exec(b))&&5>e;)f.push(d.index),e++;return f})):!1},stack:function(){return n},data:function(a){return p[a]}},l={},m={smartHilite:function(){return k.hilite(k.modify(k.save.apply(this)))},activateRange:function(a){var b={};return a?("string"==typeof a?b.serialRange=a:b.range=a,k.activate(k.save(b))):!1}},n=[],o={filterOutANTIndicator:function(b,c){var d=b.commonAncestorContainer,e=a(d).find(".ant_indicator");if(e.length){var f=b.containsNode(e[0],!0);f&&b.setEndBefore(e[0])}return b},stripWhiteSpace:function(a){return a},firstWordSnap:function(a){var c=a.startContainer,d=a.startOffset;if(0===d)return a;var e={range:b.createRange()};return e.range.setStart(c,0),e.range.setEnd(c,d),e.str0=e.range.toString(),e.regx1=/\s*\S+$/,e.result1=e.regx1.exec(e.str0),null===e.result1?a:(e.str1=e.result1[0],e.str2=e.str1.replace(/\s*/,""),e.extraWordChars=e.str2.length,h(a,{relOffset:-e.extraWordChars}),a)},lastWordSnap:function(a){var c=a.endContainer,d=a.endOffset;if(0===d)return a;var e={range:b.createRange()};return e.range.setStart(c,d),e.range.setEnd(c,c.length),e.str0=e.range.toString(),e.regx1=/^\S+(?=(\s|$))/,e.result1=e.regx1.exec(e.str0),null===e.result1?a:(e.str1=e.result1[0],e.extraWordChars=e.str1.length,h(a,{relOffset:e.extraWordChars,start:!1}),a)}},p={stack:n};a(document).selog()}function plugin_jquery_mustache(a){var b=void 0;!function(a){!function(a,c){"object"==typeof exports&&exports?module.exports=c:"function"==typeof b&&b.amd?b(c):a.Mustache=c}(this,function(){function a(a,b){return s.call(a,b)}function b(b){return!a(o,b)}function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(a){return(a+"").replace(/[&<>"'\/]/g,function(a){return v[a]})}function e(a){this.string=a,this.tail=a,this.pos=0}function f(a,b){this.view=a,this.parent=b,this._cache={}}function g(){this.clearCache()}function h(a,b,c,d){for(var e,f,g,i="",j=0,k=a.length;k>j;++j)switch(e=a[j],f=e[1],e[0]){case"#":if(g=c.lookup(f),"object"==typeof g)if(u(g))for(var m=0,n=g.length;n>m;++m)i+=h(e[4],b,c.push(g[m]),d);else g&&(i+=h(e[4],b,c.push(g),d));else if("function"==typeof g){var o=null==d?null:d.slice(e[3],e[5]);g=g.call(c.view,o,function(a){return b.render(a,c)}),null!=g&&(i+=g)}else g&&(i+=h(e[4],b,c,d));break;case"^":g=c.lookup(f),(!g||u(g)&&0===g.length)&&(i+=h(e[4],b,c,d));break;case">":g=b.getPartial(f),"function"==typeof g&&(i+=g(c));break;case"&":g=c.lookup(f),null!=g&&(i+=g);break;case"name":g=c.lookup(f),null!=g&&(i+=l.escape(g));break;case"text":i+=f}return i}function i(a){for(var b,c=[],d=c,e=[],f=0,g=a.length;g>f;++f)switch(b=a[f],b[0]){case"#":case"^":e.push(b),d.push(b),d=b[4]=[];break;case"/":var h=e.pop();h[5]=b[2],d=e.length>0?e[e.length-1][4]:c;break;default:d.push(b)}return c}function j(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(c=b,d.push(b)));return d}function k(a){return[RegExp(c(a[0])+"\\s*"),RegExp("\\s*"+c(a[1]))]}var l={};l.name="mustache.js",l.version="0.7.2",l.tags=["{{","}}"],l.Scanner=e,l.Context=f,l.Writer=g;var m=/\s*/,n=/\s+/,o=/\S/,p=/\s*=/,q=/\s*\}/,r=/#|\^|\/|>|\{|&|=|!/,s=RegExp.prototype.test,t=Object.prototype.toString,u=Array.isArray||function(a){return"[object Array]"===t.call(a)},v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};l.escape=d,e.prototype.eos=function(){return""===this.tail},e.prototype.scan=function(a){var b=this.tail.match(a);return b&&0===b.index?(this.tail=this.tail.substring(b[0].length),this.pos+=b[0].length,b[0]):""},e.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c),this.pos+=c}return b},f.make=function(a){return a instanceof f?a:new f(a)},f.prototype.push=function(a){return new f(a,this)},f.prototype.lookup=function(a){var b=this._cache[a];if(!b){if("."==a)b=this.view;else for(var c=this;c;){if(a.indexOf(".")>0){b=c.view;for(var d=a.split("."),e=0;b&&d.length>e;)b=b[d[e++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this._cache[a]=b}return"function"==typeof b&&(b=b.call(this.view)),b},g.prototype.clearCache=function(){this._cache={},this._partialCache={}},g.prototype.compile=function(a,b){var c=this._cache[a];if(!c){var d=l.parse(a,b);c=this._cache[a]=this.compileTokens(d,a)}return c},g.prototype.compilePartial=function(a,b,c){var d=this.compile(b,c);return this._partialCache[a]=d,d},g.prototype.getPartial=function(a){return a in this._partialCache||!this._loadPartial||this.compilePartial(a,this._loadPartial(a)),this._partialCache[a]},g.prototype.compileTokens=function(a,b){var c=this;return function(d,e){if(e)if("function"==typeof e)c._loadPartial=e;else for(var g in e)c.compilePartial(g,e[g]);return h(a,c,f.make(d),b)}},g.prototype.render=function(a,b,c){return this.compile(a)(b,c)},l.parse=function(a,d){function f(){if(z&&!A)for(;y.length;)delete x[y.pop()];else y=[];z=!1,A=!1}if(a=a||"",d=d||l.tags,"string"==typeof d&&(d=d.split(n)),2!==d.length)throw Error("Invalid tags: "+d.join(", "));for(var g,h,o,s,t,u=k(d),v=new e(a),w=[],x=[],y=[],z=!1,A=!1;!v.eos();){if(g=v.pos,o=v.scanUntil(u[0]))for(var B=0,C=o.length;C>B;++B)s=o.charAt(B),b(s)?y.push(x.length):A=!0,x.push(["text",s,g,g+1]),g+=1,"\n"==s&&f();if(!v.scan(u[0]))break;if(z=!0,h=v.scan(r)||"name",v.scan(m),"="===h?(o=v.scanUntil(p),v.scan(p),v.scanUntil(u[1])):"{"===h?(o=v.scanUntil(RegExp("\\s*"+c("}"+d[1]))),v.scan(q),v.scanUntil(u[1]),h="&"):o=v.scanUntil(u[1]),!v.scan(u[1]))throw Error("Unclosed tag at "+v.pos);if(t=[h,o,g,v.pos],x.push(t),"#"===h||"^"===h)w.push(t);else if("/"===h){if(0===w.length)throw Error('Unopened section "'+o+'" at '+g);var D=w.pop();if(D[1]!==o)throw Error('Unclosed section "'+D[1]+'" at '+g)}else if("name"===h||"{"===h||"&"===h)A=!0;else if("="===h){if(d=o.split(n),2!==d.length)throw Error("Invalid tags at "+g+": "+d.join(", "));u=k(d)}}var D=w.pop();if(D)throw Error('Unclosed section "'+D[1]+'" at '+v.pos);return x=j(x),i(x)};var w=new g;return l.clearCache=function(){return w.clearCache()},l.compile=function(a,b){return w.compile(a,b)},l.compilePartial=function(a,b,c){return w.compilePartial(a,b,c)},l.compileTokens=function(a,b){return w.compileTokens(a,b)},l.render=function(a,b,c){return w.render(a,b,c)},l.to_html=function(a,b,c,d){var e=l.render(a,b,c);return"function"!=typeof d?e:void d(e)},l}()),a.mustache=function(a,b,c){return Mustache.render(a,b,c)},a.fn.mustache=function(b,c){return a(this).map(function(d,e){var f=a.trim(a(e).html()),g=a.mustache(f,b,c);return a(g).get()})}}(a)}function plugin_jquery_improvedCSS(a){a.fn.css2=a.fn.css,a.fn.css=function(){if(arguments.length)return a.fn.css2.apply(this,arguments);for(var b,c=["font-family","font-size","font-weight","font-style","color","text-transform","text-decoration","letter-spacing","word-spacing","lineHeight","text-align","vertical-align","direction","background-color","background-image","background-repeat","background-position","background-attachment","opacity","width","height","top","right","bottom","left","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","position","display","visibility","z-index","overflow-x","overflow-y","white-space","clip","float","clear","cursor","list-style-image","list-style-position","list-style-type","marker-offset"],d=c.length,e={},f=0;d>f;f++)b=c[f],e[b]=a.fn.css2.call(this,b),"lineHeight"==b&&(e[b]=a.fn.css2.call(this,"auto")),b="undefined"==typeof b?"auto":b;return e}}function plugin_jquery_mousewheel(a){function b(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=0,g=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),g=e,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(g=0,f=-1*e),void 0!==c.wheelDeltaY&&(g=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(f=-1*c.wheelDeltaX/120),d.unshift(b,e,f,g),(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=c.length;d;)a.event.fixHooks[c[--d]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}function plugin_jquery_scrollStopStart(a){!function(a){var b=a.event.dispatch||a.event.handle,c=a.event.special,d="D"+ +new Date,e="D"+(+new Date+1);c.scrollstart={setup:function(e){var f,g=a.extend({latency:c.scrollstop.latency},e),h=function(a){var c=this,d=arguments;f?clearTimeout(f):(a.type="scrollstart",b.apply(c,d)),f=setTimeout(function(){f=null},g.latency)};a(this).bind("scroll",h).data(d,h)},teardown:function(){a(this).unbind("scroll",a(this).data(d))}},c.scrollstop={latency:250,setup:function(d){var f,g=a.extend({latency:c.scrollstop.latency},d),h=function(a){var c=this,d=arguments;f&&clearTimeout(f),f=setTimeout(function(){f=null,a.type="scrollstop",b.apply(c,d)},g.latency)};a(this).bind("scroll",h).data(e,h)},teardown:function(){a(this).unbind("scroll",a(this).data(e))}}}(a)}function plugin_jquery_jScrollPane(a){var b=a,c=(window,void 0);b.fn.jScrollPane=function(a){function d(a,d){function e(d){var g,i,k,l,m,p,q=!1,r=!1;if(P=d,Q===c)m=a.scrollTop(),p=a.scrollLeft(),a.css({overflow:"hidden",padding:0}),R=a.innerWidth()+ta,S=a.innerHeight(),a.width(R),Q=b('<div class="jspPane" />').css("padding",sa).append(a.children()),T=b('<div class="jspContainer" />').css({width:R+"px",height:S+"px"}).append(Q).appendTo(a);else{if(a.css("width",""),q=P.stickToBottom&&B(),r=P.stickToRight&&C(),l=a.innerWidth()+ta!=R||a.outerHeight()!=S,l&&(R=a.innerWidth()+ta,S=a.innerHeight(),T.css({width:R+"px",height:S+"px"})),!l&&ua==U&&Q.outerHeight()==V)return void a.width(R);ua=U,Q.css("width",""),a.width(R),T.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}Q.css("overflow","auto"),U=d.contentWidth?d.contentWidth:Q[0].scrollWidth,V=Q[0].scrollHeight,Q.css("overflow",""),W=U/R,X=V/S,Y=X>1,Z=W>1,Z||Y?(a.addClass("jspScrollable"),g=P.maintainPosition&&(aa||da),g&&(i=z(),k=A()),f(),h(),j(),g&&(x(r?U-R:i,!1),w(q?V-S:k,!1)),G(),D(),N(),P.enableKeyboardNavigation&&I(),P.clickOnTrack&&n(),K(),P.hijackInternalLinks&&M()):(a.removeClass("jspScrollable"),Q.css({top:0,width:T.width()-ta}),E(),H(),J(),o(),L()),P.autoReinitialise&&!ra?ra=setInterval(function(){e(P)},P.autoReinitialiseDelay):!P.autoReinitialise&&ra&&clearInterval(ra),m&&a.scrollTop(0)&&w(m,!1),p&&a.scrollLeft(0)&&x(p,!1),a.trigger("jsp-initialised",[Z||Y])}function f(){Y&&(T.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />'))),ea=T.find(">.jspVerticalBar"),fa=ea.find(">.jspTrack"),$=fa.find(">.jspDrag"),P.showArrows&&(ja=b('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",l(0,-1)).bind("click.jsp",F),ka=b('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",l(0,1)).bind("click.jsp",F),P.arrowScrollOnHover&&(ja.bind("mouseover.jsp",l(0,-1,ja)),ka.bind("mouseover.jsp",l(0,1,ka))),k(fa,P.verticalArrowPositions,ja,ka)),ha=S,T.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ha-=b(this).outerHeight()}),$.hover(function(){$.addClass("jspHover")},function(){$.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",F),$.addClass("jspActive");var c=a.pageY-$.position().top;return b("html").bind("mousemove.jsp",function(a){q(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",p),!1}),g())}function g(){fa.height(ha+"px"),aa=0,ga=P.verticalGutter+fa.outerWidth(),Q.width(R-ga-ta);try{0===ea.position().left&&Q.css("margin-left",ga+"px")}catch(a){}}function h(){Z&&(T.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />'))),la=T.find(">.jspHorizontalBar"),ma=la.find(">.jspTrack"),ba=ma.find(">.jspDrag"),P.showArrows&&(pa=b('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",l(-1,0)).bind("click.jsp",F),qa=b('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",l(1,0)).bind("click.jsp",F),P.arrowScrollOnHover&&(pa.bind("mouseover.jsp",l(-1,0,pa)),qa.bind("mouseover.jsp",l(1,0,qa))),k(ma,P.horizontalArrowPositions,pa,qa)),ba.hover(function(){ba.addClass("jspHover")},function(){ba.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",F),ba.addClass("jspActive");var c=a.pageX-ba.position().left;return b("html").bind("mousemove.jsp",function(a){s(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",p),!1}),na=T.innerWidth(),i())}function i(){T.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){na-=b(this).outerWidth()}),ma.width(na+"px"),da=0}function j(){if(Z&&Y){var a=ma.outerHeight(),c=fa.outerWidth();ha-=a,b(la).find(">.jspCap:visible,>.jspArrow").each(function(){na+=b(this).outerWidth()}),na-=c,S-=c,R-=a,ma.parent().append(b('<div class="jspCorner" />').css("width",a+"px")),g(),i()}Z&&Q.width(T.outerWidth()-ta+"px"),V=Q.outerHeight(),X=V/S,Z&&(oa=Math.ceil(1/W*na),oa>P.horizontalDragMaxWidth?oa=P.horizontalDragMaxWidth:oa<P.horizontalDragMinWidth&&(oa=P.horizontalDragMinWidth),ba.width(oa+"px"),ca=na-oa,t(da)),Y&&(ia=Math.ceil(1/X*ha),ia>P.verticalDragMaxHeight?ia=P.verticalDragMaxHeight:ia<P.verticalDragMinHeight&&(ia=P.verticalDragMinHeight),$.height(ia+"px"),_=ha-ia,r(aa))}function k(a,b,c,d){var e,f="before",g="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==f?g=b:b==g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function l(a,b,c){return function(){return m(a,b,this,c),this.blur(),!1}}function m(a,c,d,e){d=b(d).addClass("jspActive");var f,g,h=!0,i=function(){0!==a&&va.scrollByX(a*P.arrowButtonSpeed),0!==c&&va.scrollByY(c*P.arrowButtonSpeed),g=setTimeout(i,h?P.initialDelay:P.arrowRepeatFreq),h=!1};i(),f=e?"mouseout.jsp":"mouseup.jsp",e=e||b("html"),e.bind(f,function(){d.removeClass("jspActive"),g&&clearTimeout(g),g=null,e.unbind(f)})}function n(){o(),Y&&fa.bind("mousedown.jsp",function(a){if(a.originalTarget===c||a.originalTarget==a.currentTarget){var d,e=b(this),f=e.offset(),g=a.pageY-f.top-aa,h=!0,i=function(){var b=e.offset(),c=a.pageY-b.top-ia/2,f=S*P.scrollPagePercent,k=_*f/(V-S);if(0>g)aa-k>c?va.scrollByY(-f):q(c);else{if(!(g>0))return void j();c>aa+k?va.scrollByY(f):q(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,b(document).unbind("mouseup.jsp",j)};return i(),b(document).bind("mouseup.jsp",j),!1}}),Z&&ma.bind("mousedown.jsp",function(a){if(a.originalTarget===c||a.originalTarget==a.currentTarget){var d,e=b(this),f=e.offset(),g=a.pageX-f.left-da,h=!0,i=function(){var b=e.offset(),c=a.pageX-b.left-oa/2,f=R*P.scrollPagePercent,k=ca*f/(U-R);if(0>g)da-k>c?va.scrollByX(-f):s(c);else{if(!(g>0))return void j();c>da+k?va.scrollByX(f):s(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,b(document).unbind("mouseup.jsp",j)};return i(),b(document).bind("mouseup.jsp",j),!1}})}function o(){ma&&ma.unbind("mousedown.jsp"),fa&&fa.unbind("mousedown.jsp")}function p(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),$&&$.removeClass("jspActive"),ba&&ba.removeClass("jspActive")}function q(a,b){Y&&(0>a?a=0:a>_&&(a=_),b===c&&(b=P.animateScroll),b?va.animate($,"top",a,r):($.css("top",a),r(a)))}function r(b){b===c&&(b=$.position().top),T.scrollTop(0),aa=b;var d=0===aa,e=aa==_,f=b/_,g=-f*(V-S);(wa!=d||ya!=e)&&(wa=d,ya=e,a.trigger("jsp-arrow-change",[wa,ya,xa,za])),u(d,e),Q.css("top",g),a.trigger("jsp-scroll-y",[-g,d,e]).trigger("scroll")}function s(a,b){Z&&(0>a?a=0:a>ca&&(a=ca),b===c&&(b=P.animateScroll),b?va.animate(ba,"left",a,t):(ba.css("left",a),t(a)))}function t(b){b===c&&(b=ba.position().left),T.scrollTop(0),da=b;var d=0===da,e=da==ca,f=b/ca,g=-f*(U-R);(xa!=d||za!=e)&&(xa=d,za=e,a.trigger("jsp-arrow-change",[wa,ya,xa,za])),v(d,e),Q.css("left",g),a.trigger("jsp-scroll-x",[-g,d,e]).trigger("scroll")}function u(a,b){P.showArrows&&(ja[a?"addClass":"removeClass"]("jspDisabled"),ka[b?"addClass":"removeClass"]("jspDisabled"))}function v(a,b){P.showArrows&&(pa[a?"addClass":"removeClass"]("jspDisabled"),qa[b?"addClass":"removeClass"]("jspDisabled"))}function w(a,b){var c=a/(V-S);q(c*_,b)}function x(a,b){var c=a/(U-R);s(c*ca,b)}function y(a,c,d){var e,f,g,h,i,j,k,l,m,n=0,o=0;try{e=b(a)}catch(p){return}for(f=e.outerHeight(),g=e.outerWidth(),T.scrollTop(0),T.scrollLeft(0);!e.is(".jspPane");)if(n+=e.position().top,o+=e.position().left,e=e.offsetParent(),/^body|html$/i.test(e[0].nodeName))return;h=A(),j=h+S,h>n||c?l=n-P.verticalGutter:n+f>j&&(l=n-S+f+P.verticalGutter),l&&w(l,d),i=z(),k=i+R,i>o||c?m=o-P.horizontalGutter:o+g>k&&(m=o-R+g+P.horizontalGutter),m&&x(m,d)}function z(){return-Q.position().left}function A(){return-Q.position().top}function B(){var a=V-S;return a>20&&a-A()<10}function C(){var a=U-R;return a>20&&a-z()<10}function D(){T.unbind(Ba).bind(Ba,function(a,b,c,d){var e=da,f=aa;return va.scrollBy(c*P.mouseWheelSpeed,-d*P.mouseWheelSpeed,!1),e==da&&f==aa})}function E(){T.unbind(Ba)}function F(){return!1}function G(){Q.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){y(a.target,!1)})}function H(){Q.find(":input,a").unbind("focus.jsp")}function I(){function c(){var a=da,b=aa;switch(d){case 40:va.scrollByY(P.keyboardSpeed,!1);break;case 38:va.scrollByY(-P.keyboardSpeed,!1);break;case 34:case 32:va.scrollByY(S*P.scrollPagePercent,!1);break;case 33:va.scrollByY(-S*P.scrollPagePercent,!1);break;case 39:va.scrollByX(P.keyboardSpeed,!1);break;case 37:va.scrollByX(-P.keyboardSpeed,!1)}return e=a!=da||b!=aa}var d,e,f=[];Z&&f.push(la[0]),Y&&f.push(ea[0]),Q.focus(function(){a.focus()}),a.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(a){if(a.target===this||f.length&&b(a.target).closest(f).length){var g=da,h=aa;switch(a.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:d=a.keyCode,c();break;case 35:w(V-S),d=null;break;case 36:w(0),d=null}return e=a.keyCode==d&&g!=da||h!=aa,!e}}).bind("keypress.jsp",function(a){return a.keyCode==d&&c(),!e}),P.hideFocus?(a.css("outline","none"),"hideFocus"in T[0]&&a.attr("hideFocus",!0)):(a.css("outline",""),"hideFocus"in T[0]&&a.attr("hideFocus",!1))}function J(){a.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function K(){if(location.hash&&location.hash.length>1){var a,c;try{a=b(location.hash)}catch(d){return}a.length&&Q.find(location.hash)&&(0===T.scrollTop()?c=setInterval(function(){T.scrollTop()>0&&(y(location.hash,!0),b(document).scrollTop(T.position().top),clearInterval(c))},50):(y(location.hash,!0),b(document).scrollTop(T.position().top)))}}function L(){b("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function M(){L(),b("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var a,b=this.href.split("#");return b.length>1&&(a=b[1],a.length>0&&Q.find("#"+a).length>0)?(y("#"+a,!0),!1):void 0})}function N(){var a,b,c,d,e,f=!1;T.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=z(),b=A(),c=h.pageX,d=h.pageY,e=!1,f=!0}).bind("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=da,j=aa;return va.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i==da&&j==aa}}).bind("touchend.jsp",function(a){f=!1}).bind("click.jsp-touchclick",function(a){return e?(e=!1,!1):void 0})}function O(){var b=A(),c=z();a.removeClass("jspScrollable").unbind(".jsp"),a.replaceWith(Aa.append(Q.children())),Aa.scrollTop(b),Aa.scrollLeft(c)}var P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va=this,wa=!0,xa=!0,ya=!1,za=!1,Aa=a.clone(!1,!1).empty(),Ba=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";sa=a.css("paddingTop")+" "+a.css("paddingRight")+" "+a.css("paddingBottom")+" "+a.css("paddingLeft"),ta=(parseInt(a.css("paddingLeft"),10)||0)+(parseInt(a.css("paddingRight"),10)||0),b.extend(va,{reinitialise:function(a){a=b.extend({},P,a),e(a)},scrollToElement:function(a,b,c){y(a,b,c)},scrollTo:function(a,b,c){x(a,c),w(b,c)},scrollToX:function(a,b){x(a,b)},scrollToY:function(a,b){w(a,b)},scrollToPercentX:function(a,b){x(a*(U-R),b)},scrollToPercentY:function(a,b){w(a*(V-S),b)},scrollBy:function(a,b,c){va.scrollByX(a,c),va.scrollByY(b,c)},scrollByX:function(a,b){a=a>=0?Math.max(a,1):Math.min(a,-1);var c=z()+a,d=c/(U-R);s(d*ca,b)},scrollByY:function(a,b){a=a>=0?Math.max(a,1):Math.min(a,-1);var c=A()+a,d=c/(V-S);q(d*_,b)},positionDragX:function(a,b){s(a,b)},positionDragY:function(a,b){q(a,b)},animate:function(a,b,c,d){var e={};e[b]=c,a.animate(e,{duration:P.animateDuration,ease:P.animateEase,queue:!1,step:d})},getContentPositionX:function(){return z()},getContentPositionY:function(){return A()},getContentWidth:function(){return U},getContentHeight:function(){return V},getPercentScrolledX:function(){return z()/(U-R)},getPercentScrolledY:function(){return A()/(V-S)},getIsScrollableH:function(){return Z},getIsScrollableV:function(){return Y},getContentPane:function(){return Q},scrollToBottom:function(a){q(_,a)},hijackInternalLinks:function(){M()},destroy:function(){O()}}),e(d)}return a=b.extend({},b.fn.jScrollPane.defaults,a),b.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){a[this]=a[this]||a.speed}),this.each(function(){var c=b(this),e=c.data("jsp");e?e.reinitialise(a):(e=new d(c,a),c.data("jsp",e))})},b.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}function plugin_jquery_twitterTip(a){!function(a){"use strict";var b=function(a,b){this.init("tooltip",a,b)};b.prototype={constructor:b,init:function(b,c,d){var e,f;this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,"manual"!=this.options.trigger&&(e="hover"==this.options.trigger?"mouseenter":"focus",f="hover"==this.options.trigger?"mouseleave":"blur",this.$element.bind(e,this.options.selector,a.proxy(this.enter,this)),this.$element.bind(f,this.options.selector,a.proxy(this.leave,this))),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);c.options.delay&&c.options.delay.show?(c.hoverState="in",setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show()},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);c.options.delay&&c.options.delay.hide?(c.hoverState="out",setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){switch(a=this.tip(),this.setContent(),this.options.animation&&a.addClass("ant_tw_fade"),f="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/ant_tw_in/.test(f),a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight,b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e-5,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g).addClass("ant_tw_"+f).addClass("ant_tw_in")}},setContent:function(){var a=this.tip();a.find(".ant_twtooltip-inner").html(this.getTitle()),a.removeClass("ant_tw_fade ant_tw_in ant_tw_top ant_tw_bottom ant_tw_left ant_tw_right")},hide:function(){function b(){var b=setTimeout(function(){c.off(a.support.transition.end).remove()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.remove()})}var c=this.tip();c.removeClass("ant_tw_in"),a.support.transition&&this.$tip.hasClass("ant_tw_fade")?b():c.remove(),a.support.transition&&this.$tip.hasClass("ant_tw_fade")},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title),a=(a||"").toString().replace(/(^\s*|\s*$)/,"")},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("ant_tw_in")?"hide":"show"]()}},a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("tooltip"),f="object"==typeof c&&c;e||d.data("tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.defaults={animation:!0,delay:0,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="ant ant_twtooltip"><div class="ant_twtooltip-arrow"></div><div class="ant_twtooltip-inner"></div></div>'}}(a)}function plugin_rangy(){var a="ins",b=function(){function a(a,b){var c=typeof a[b];return"function"==c||!("object"!=c||!a[b])||"unknown"==c}function b(a,b){return!("object"!=typeof a[b]||!a[b])}function c(a,b){return"undefined"!=typeof a[b]}function d(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function e(a){return a&&m(a,l)&&o(a,k)}function f(a){window.alert("Rangy not supported in your browser. Reason: "+a),p.initialized=!0,p.supported=!1}function g(){if(!p.initialized){var c,d=!1,g=!1;for(a(document,"createRange")&&(c=document.createRange(),m(c,j)&&o(c,i)&&(d=!0),c.detach()),(c=b(document,"body")?document.body:document.getElementsByTagName("body")[0])&&a(c,"createTextRange")&&(c=c.createTextRange(),e(c)&&(g=!0)),!d&&!g&&f("Neither Range nor TextRange are implemented"),p.initialized=!0,p.features={implementsDomRange:d,implementsTextRange:g},d=r.concat(q),g=0,c=d.length;c>g;++g)try{d[g](p)}catch(h){b(window,"console")&&a(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",h)}}}function h(a){this.name=a,this.supported=this.initialized=!1}var i=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],j=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],k=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],l=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint"],m=d(a),n=d(b),o=d(c),p={
version:"1.2beta2",initialized:!1,supported:!0,util:{isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:m,areHostObjects:n,areHostProperties:o,isTextRange:e},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};p.fail=f,p.warn=function(a){a="Rangy warning: "+a,p.config.alertOnWarn?window.alert(a):"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(a)},{}.hasOwnProperty?p.util.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}:f("hasOwnProperty not supported");var q=[],r=[];p.init=g,p.addInitListener=function(a){p.initialized?a(p):q.push(a)};var s=[];p.addCreateMissingNativeApiListener=function(a){s.push(a)},p.createMissingNativeApi=function(a){a=a||window,g();for(var b=0,c=s.length;c>b;++b)s[b](a)},h.prototype.fail=function(a){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+a)},h.prototype.warn=function(a){p.warn("Module "+this.name+": "+a)},h.prototype.createError=function(a){return Error("Error in Rangy "+this.name+" module: "+a)},p.createModule=function(a,b){var c=new h(a);p.modules[a]=c,r.push(function(a){b(a,c),c.initialized=!0,c.supported=!0})},p.requireModules=function(a){for(var b,c,d=0,e=a.length;e>d;++d){if(c=a[d],b=p.modules[c],!(b&&b instanceof h))throw Error("Module '"+c+"' not found");if(!b.supported)throw Error("Module '"+c+"' not supported")}};var t=!1;if(n=function(){t||(t=!0,p.initialized||g())},"undefined"==typeof window)f("No window found");else{if("undefined"!=typeof document)return a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",n,!1),a(window,"addEventListener")?window.addEventListener("load",n,!1):a(window,"attachEvent")?window.attachEvent("onload",n):f("Window does not have required addEventListener or attachEvent method"),p;f("No document found")}}();return b.createModule("DomUtil",function(a,b){function c(a){for(var b=0;a=a.previousSibling;)b++;return b}function d(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(o(d,c))return c;return null}function e(a,b,c){for(c=c?a:a.parentNode;c;){if(a=c.parentNode,a===b)return c;c=a}return null}function f(a){return a=a.nodeType,3==a||4==a||8==a}function g(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function h(a){if(9==a.nodeType)return a;if("undefined"!=typeof a.ownerDocument)return a.ownerDocument;if("undefined"!=typeof a.document)return a.document;if(a.parentNode)return h(a.parentNode);throw Error("getDocument: no document found for node")}function i(a){return a?f(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">["+a.childNodes.length+"]":a.nodeName:"[No node]"}function j(a){this._next=this.root=a}function k(a,b){this.node=a,this.offset=b}function l(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var m=a.util;m.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),m.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var n=document.createElement("div");m.areHostMethods(n,["insertBefore","appendChild","cloneNode"])||b.fail("Incomplete Element implementation"),n=document.createTextNode("test"),m.areHostMethods(n,["splitText","deleteData","insertData","appendData","cloneNode"])||b.fail("Incomplete Text Node implementation");var o=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1};j.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b=this._current=this._next;if(this._current)if(a=b.firstChild)this._next=a;else{for(a=null;b!==this.root&&!(a=b.nextSibling);)b=b.parentNode;this._next=a}return this._current},detach:function(){this._current=this._next=this.root=null}},k.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+i(this.node)+":"+this.offset+")]"}},l.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},l.prototype.toString=function(){return this.message},a.dom={arrayContains:o,getNodeIndex:c,getNodeLength:function(a){var b;return f(a)?a.length:(b=a.childNodes)?b.length:0},getCommonAncestor:d,isAncestorOf:function(a,b,c){for(b=c?b:b.parentNode;b;){if(b===a)return!0;b=b.parentNode}return!1},getClosestAncestorIn:e,isCharacterDataNode:f,insertAfter:g,splitDataNode:function(a,b){var c=a.cloneNode(!1);return c.deleteData(0,b),a.deleteData(b,a.length-b),g(c,a),c},getDocument:h,getWindow:function(a){if(a=h(a),"undefined"!=typeof a.defaultView)return a.defaultView;if("undefined"!=typeof a.parentWindow)return a.parentWindow;throw Error("Cannot get a window object for node")},getIframeWindow:function(a){if("undefined"!=typeof a.contentWindow)return a.contentWindow;if("undefined"!=typeof a.contentDocument)return a.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(a){if("undefined"!=typeof a.contentDocument)return a.contentDocument;if("undefined"!=typeof a.contentWindow)return a.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(a){return m.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},comparePoints:function(a,b,f,g){var h;if(a==f)return b===g?0:g>b?-1:1;if(h=e(f,a,!0))return b<=c(h)?-1:1;if(h=e(a,f,!0))return c(h)<g?-1:1;if(b=d(a,f),a=a===b?b:e(a,b,!0),f=f===b?b:e(f,b,!0),a===f)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(b=b.firstChild;b;){if(b===a)return-1;if(b===f)return 1;b=b.nextSibling}throw Error("Should not be here!")},inspectNode:i,createIterator:function(a){return new j(a)},DomPosition:k},a.DOMException=l}),b.createModule("DomRange",function(a){function b(a,b){return 3!=a.nodeType&&(H.isAncestorOf(a,b.startContainer,!0)||H.isAncestorOf(a,b.endContainer,!0))}function c(a){return H.getDocument(a.startContainer)}function d(a,b,c){if(b=a._listeners[b])for(var d=0,e=b.length;e>d;++d)b[d].call(a,{target:a,args:c})}function e(a){return new I(a.parentNode,H.getNodeIndex(a))}function f(a){return new I(a.parentNode,H.getNodeIndex(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return H.isCharacterDataNode(b)?c==b.length?H.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:H.splitDataNode(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a){for(var b,d,e=c(a.range).createDocumentFragment();d=a.next();){if(b=a.isPartiallySelectedSubtree(),d=d.cloneNode(!b),b&&(b=a.getSubtreeIterator(),d.appendChild(h(b)),b.detach(!0)),10==d.nodeType)throw new J("HIERARCHY_REQUEST_ERR");e.appendChild(d)}return e}function i(a,b,c){var d,e;for(c=c||{stop:!1};d=a.next();)if(a.isPartiallySelectedSubtree()){if(b(d)===!1)return void(c.stop=!0);if(d=a.getSubtreeIterator(),i(d,b,c),d.detach(!0),c.stop)return}else for(d=H.createIterator(d);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function j(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),j(b),b.detach(!0)):a.remove()}function k(a){for(var b,d,e=c(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(k(d)),d.detach(!0)):a.remove(),10==b.nodeType)throw new J("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function l(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=RegExp("^("+b.join("|")+")$"));var g=[];return i(new n(a,!1),function(a){e&&!d.test(a.nodeType)||f&&!c(a)||g.push(a)}),g}function m(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+H.inspectNode(a.startContainer)+":"+a.startOffset+", "+H.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function n(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&H.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||H.isCharacterDataNode(this.sc)?H.getClosestAncestorIn(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||H.isCharacterDataNode(this.ec)?H.getClosestAncestorIn(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function o(a){this.code=this[a],this.codeName=a,this.message="RangeException: "+this.codeName}function p(a,b,c){this.nodes=l(a,b,c),this._next=this.nodes[0],this._position=0}function q(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,H.arrayContains(a,d))return e;e=e.parentNode}return null}}function r(a,b){if(R(a,b))throw new o("INVALID_NODE_TYPE_ERR")}function s(a){if(!a.startContainer)throw new J("INVALID_STATE_ERR")}function t(a,b){if(!H.arrayContains(b,a.nodeType))throw new o("INVALID_NODE_TYPE_ERR")}function u(a,b){if(0>b||b>(H.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new J("INDEX_SIZE_ERR")}function v(a,b){if(P(a,!0)!==P(b,!0))throw new J("WRONG_DOCUMENT_ERR")}function w(a){if(Q(a,!0))throw new J("NO_MODIFICATION_ALLOWED_ERR")}function x(a,b){if(!a)throw new J(b)}function y(a){s(a),(H.arrayContains(L,a.startContainer.nodeType)||P(a.startContainer,!0))&&(H.arrayContains(L,a.endContainer.nodeType)||P(a.endContainer,!0))&&a.startOffset<=(H.isCharacterDataNode(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length)&&a.endOffset<=(H.isCharacterDataNode(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)||ANT.actions.catchRangyErrors("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")")}function z(){}function A(a){a.START_TO_START=T,a.START_TO_END=U,a.END_TO_END=V,a.END_TO_START=W,a.NODE_BEFORE=X,a.NODE_AFTER=Y,a.NODE_BEFORE_AND_AFTER=Z,a.NODE_INSIDE=$}function B(a){A(a),A(a.prototype)}function C(a,b){return function(){y(this);var c=this.startContainer,d=this.startOffset,e=this.commonAncestorContainer,g=new n(this,!0);return c!==e&&(c=H.getClosestAncestorIn(c,e,!0),d=f(c),c=d.node,d=d.offset),i(g,w),g.reset(),e=a(g),g.detach(),b(this,c,d,c,d),e}}function D(c,d,g){function h(a,b){return function(c){s(this),t(c,K),t(O(c),L),c=(a?e:f)(c),(b?i:l)(this,c.node,c.offset)}}function i(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==this.startOffset)&&((O(b)!=O(e)||1==H.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function l(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==this.endOffset)&&((O(b)!=O(e)||-1==H.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}function m(a,b,c){(b!==a.startContainer||c!==this.startOffset||b!==a.endContainer||c!==this.endOffset)&&d(a,b,c,b,c)}c.prototype=new z,a.util.extend(c.prototype,{setStart:function(a,b){s(this),r(a,!0),u(a,b),i(this,a,b)},setEnd:function(a,b){s(this),r(a,!0),u(a,b),l(this,a,b)},setStartBefore:h(!0,!0),setStartAfter:h(!1,!0),setEndBefore:h(!0,!1),setEndAfter:h(!1,!1),collapse:function(a){y(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){s(this),r(a,!0),d(this,a,0,a,H.getNodeLength(a))},selectNode:function(a){s(this),r(a,!1),t(a,K);var b=e(a);a=f(a),d(this,b.node,b.offset,a.node,a.offset)},extractContents:C(k,d),deleteContents:C(j,d),canSurroundContents:function(){y(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},detach:function(){g(this)},splitBoundaries:function(){y(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=a===c;H.isCharacterDataNode(c)&&e>0&&e<c.length&&H.splitDataNode(c,e),H.isCharacterDataNode(a)&&b>0&&b<a.length&&(a=H.splitDataNode(a,b),f?(e-=b,c=a):c==a.parentNode&&e>=H.getNodeIndex(a)&&e++,b=0),d(this,a,b,c,e)},normalizeBoundaries:function(){y(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,e=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},g=function(d){var f=d.previousSibling;if(f&&f.nodeType==d.nodeType){a=d;var g=d.length;b=f.length,d.insertData(0,f.data),f.parentNode.removeChild(f),a==c?(e+=b,c=a):c==d.parentNode&&(f=H.getNodeIndex(d),e==f?(c=d,e=g):e>f&&e--)}},h=!0;H.isCharacterDataNode(c)?c.length==e&&f(c):(e>0&&(h=c.childNodes[e-1])&&H.isCharacterDataNode(h)&&f(h),h=!this.collapsed),h?H.isCharacterDataNode(a)?0==b&&g(a):b<a.childNodes.length&&(f=a.childNodes[b])&&H.isCharacterDataNode(f)&&g(f):(a=c,b=e),d(this,a,b,c,e)},collapseToPoint:function(a,b){y(this),r(a,!0),u(a,b),m(this,a,b)}}),B(c)}function E(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:H.getCommonAncestor(a.startContainer,a.endContainer)}function F(a,b,c,e,f){var g=a.startContainer!==b||a.startOffset!==c,h=a.endContainer!==e||a.endOffset!==f;a.startContainer=b,a.startOffset=c,a.endContainer=e,a.endOffset=f,E(a),d(a,"boundarychange",{startMoved:g,endMoved:h})}function G(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},E(this)}a.requireModules(["DomUtil"]);var H=a.dom,I=H.DomPosition,J=a.DOMException;n.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,H.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!H.isCharacterDataNode(c)||c!==this.sc&&c!==this.ec?c.parentNode&&c.parentNode.removeChild(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){return b(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new G(c(this.range));var b=this._current,d=b,e=0,f=b,g=H.getNodeLength(b);H.isAncestorOf(b,this.sc,!0)&&(d=this.sc,e=this.so),H.isAncestorOf(b,this.ec,!0)&&(f=this.ec,g=this.eo),F(a,d,e,f,g)}return new n(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},o.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},o.prototype.toString=function(){return this.message},p.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var K=[1,3,4,5,7,8,10],L=[2,9,11],M=[1,3,4,5,7,8,10,11],N=[1,3,4,5,7,8],O=H.getRootContainer,P=q([9,11]),Q=q([5,6,10,12]),R=q([6,10,12]),S=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],T=0,U=1,V=2,W=3,X=0,Y=1,Z=2,$=3;z.prototype={attachListener:function(a,b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){y(this),v(this.startContainer,b.startContainer);var c=a==W||a==T?"start":"end",d=a==U||a==T?"start":"end";return H.comparePoints(this[c+"Container"],this[c+"Offset"],b[d+"Container"],b[d+"Offset"])},insertNode:function(a){if(y(this),t(a,M),w(this.startContainer),H.isAncestorOf(a,this.startContainer,!0))throw new J("HIERARCHY_REQUEST_ERR");this.setStartBefore(g(a,this.startContainer,this.startOffset))},cloneContents:function(){y(this);var a,b;return this.collapsed?c(this).createDocumentFragment():this.startContainer===this.endContainer&&H.isCharacterDataNode(this.startContainer)?(a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b):(b=new n(this,!0),a=h(b),b.detach(),a)},canSurroundContents:function(){y(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},surroundContents:function(a){if(t(a,N),!this.canSurroundContents())throw new o("BAD_BOUNDARYPOINTS_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){y(this);for(var a,b=new G(c(this)),d=S.length;d--;)a=S[d],b[a]=this[a];return b},toString:function(){y(this);var a=this.startContainer;if(a===this.endContainer&&H.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[];return a=new n(this,!0),i(a,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),a.detach(),b.join("")},compareNode:function(a){y(this);var b=a.parentNode,c=H.getNodeIndex(a);if(!b)throw new J("NOT_FOUND_ERR");return a=this.comparePoint(b,c),b=this.comparePoint(b,c+1),0>a?b>0?Z:X:b>0?Y:$},comparePoint:function(a,b){return y(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),H.comparePoints(a,b,this.startContainer,this.startOffset)<0?-1:H.comparePoints(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:function(a){s(this);var b=c(this),d=b.createElement("div");for(d.innerHTML=a,a=b.createDocumentFragment();b=d.firstChild;)a.appendChild(b);return a},toHtml:function(){y(this);var a=c(this).createElement("div");return a.appendChild(this.cloneContents()),a.innerHTML},intersectsNode:function(a,b){if(y(this),x(a,"NOT_FOUND_ERR"),H.getDocument(a)!==c(this))return!1;var d=a.parentNode,e=H.getNodeIndex(a);x(d,"NOT_FOUND_ERR");var f=H.comparePoints(d,e,this.endContainer,this.endOffset);return d=H.comparePoints(d,e+1,this.startContainer,this.startOffset),b?0>=f&&d>=0:0>f&&d>0},isPointInRange:function(a,b){return y(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),H.comparePoints(a,b,this.startContainer,this.startOffset)>=0&&H.comparePoints(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a,b){if(y(this),c(a)!=c(this))throw new J("WRONG_DOCUMENT_ERR");var d=H.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),e=H.comparePoints(this.endContainer,this.endOffset,a.startContainer,a.startOffset);return b?0>=d&&e>=0:0>d&&e>0},intersection:function(a){if(this.intersectsRange(a)){var b=H.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=H.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();return-1==H.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==H.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new o("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==$},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,H.getNodeLength(a))<=0},containsRange:function(a){return this.intersection(a).equals(a)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);return c.length>0?(b.setStart(c[0],0),a=c.pop(),b.setEnd(a,a.length),a=this.containsRange(b),b.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,b){return y(this),new p(this,a,b)},getNodes:function(a,b){return y(this),l(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){s(this),this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){s(this),this.setStartAfter(a),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return G.rangesEqual(this,a)},inspect:function(){return m(this)}},D(G,F,function(a){s(a),a.startContainer=a.startOffset=a.endContainer=a.endOffset=null,a.collapsed=a.commonAncestorContainer=null,d(a,"detach",null),a._listeners=null}),a.rangePrototype=z.prototype,G.rangeProperties=S,G.RangeIterator=n,G.copyComparisonConstants=B,G.createPrototypeRange=D,G.inspect=m,G.getRangeDocument=c,G.rangesEqual=function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset},a.DomRange=G,a.RangeException=o}),b.createModule("WrappedRange",function(b){function c(b,c,d,e){var h=b.duplicate();h.collapse(d);var i=h.parentElement();if(f.isAncestorOf(c,i,!0)||(i=c),!i.canHaveHTML)return new g(i.parentNode,f.getNodeIndex(i));c=f.getDocument(i).createElement(a);var j,k=d?"StartToStart":"StartToEnd";do i.insertBefore(c,c.previousSibling),h.moveToElementText(c);while((j=h.compareEndPoints(k,b))>0&&c.previousSibling);if(k=c.nextSibling,-1==j&&k&&f.isCharacterDataNode(k)){if(h.setEndPoint(d?"EndToStart":"EndToEnd",b),/[\r\n]/.test(k.data))for(i=h.duplicate(),d=i.text.replace(/\r\n/g,"\r").length,d=i.moveStart("character",d);-1==i.compareEndPoints("StartToEnd",i);)d++,i.moveStart("character",1);else d=h.text.length;i=new g(k,d)}else k=(e||!d)&&c.previousSibling,i=(d=(e||d)&&c.nextSibling)&&f.isCharacterDataNode(d)?new g(d,0):k&&f.isCharacterDataNode(k)?new g(k,k.length):new g(i,f.getNodeIndex(c));return c.parentNode.removeChild(c),i}function d(b,c){var d,e,g=b.offset,h=f.getDocument(b.node),i=h.body.createTextRange(),j=f.isCharacterDataNode(b.node);return j?(d=b.node,e=d.parentNode):(d=b.node.childNodes,d=g<d.length?d[g]:null,e=b.node),h=h.createElement(a),h.innerHTML="&#feff;",d?e.insertBefore(h,d):e.appendChild(h),i.moveToElementText(h),i.collapse(!c),e.removeChild(h),j&&i[c?"moveStart":"moveEnd"]("character",g),i}b.requireModules(["DomUtil","DomRange"]);var e,f=b.dom,g=f.DomPosition,h=b.DomRange;if(!b.features.implementsDomRange||b.features.implementsTextRange&&b.config.preferTextRange){if(b.features.implementsTextRange){e=function(a){this.textRange=a,this.refresh()},e.prototype=new h(document),e.prototype.refresh=function(){var a,b,d=this.textRange;a=d.parentElement();var e=d.duplicate();e.collapse(!0),b=e.parentElement(),e=d.duplicate(),e.collapse(!1),d=e.parentElement(),b=b==d?b:f.getCommonAncestor(b,d),b=b==a?b:f.getCommonAncestor(a,b),0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?b=a=c(this.textRange,b,!0,!0):(a=c(this.textRange,b,!0,!1),b=c(this.textRange,b,!1,!1)),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},e.rangeToTextRange=function(a){if(a.collapsed)return d(new g(a.startContainer,a.startOffset),!0);var b=d(new g(a.startContainer,a.startOffset),!0),c=d(new g(a.endContainer,a.endOffset),!1);return a=f.getDocument(a.startContainer).body.createTextRange(),a.setEndPoint("StartToStart",b),a.setEndPoint("EndToEnd",c),a},h.copyComparisonConstants(e);var i=function(){return this}();"undefined"==typeof i.Range&&(i.Range=e),b.createNativeRange=function(a){return a=a||document,a.body.createTextRange()}}}else!function(){function a(a){for(var b,c=g.length;c--;)b=g[c],a[b]=a.nativeRange[b]}var b,c,d,g=h.rangeProperties;e=function(b){if(!b)throw Error("Range must be specified");this.nativeRange=b,a(this)},h.createPrototypeRange(e,function(a,b,c,d,e){var f=a.endContainer!==d||a.endOffset!=e;(a.startContainer!==b||a.startOffset!=c||f)&&(a.setEnd(d,e),a.setStart(b,c))},function(a){a.nativeRange.detach(),a.detached=!0;for(var b,c=g.length;c--;)b=g[c],a[b]=null}),b=e.prototype,b.selectNode=function(b){this.nativeRange.selectNode(b),a(this)},b.deleteContents=function(){this.nativeRange.deleteContents(),a(this)},b.extractContents=function(){var b=this.nativeRange.extractContents();return a(this),b},b.cloneContents=function(){return this.nativeRange.cloneContents()},b.surroundContents=function(b){this.nativeRange.surroundContents(b),a(this)},b.collapse=function(b){this.nativeRange.collapse(b),a(this)},b.cloneRange=function(){return new e(this.nativeRange.cloneRange())},b.refresh=function(){a(this)},b.toString=function(){return this.nativeRange.toString()};var i=document.createTextNode("test");f.getBody(document).appendChild(i);var j=document.createRange();j.setStart(i,0),j.setEnd(i,0);try{j.setStart(i,1),c=!0,b.setStart=function(b,c){this.nativeRange.setStart(b,c),a(this)},b.setEnd=function(b,c){this.nativeRange.setEnd(b,c),a(this)},d=function(b){return function(c){this.nativeRange[b](c),a(this)}}}catch(k){c=!1,b.setStart=function(b,c){try{this.nativeRange.setStart(b,c)}catch(d){this.nativeRange.setEnd(b,c),this.nativeRange.setStart(b,c)}a(this)},b.setEnd=function(b,c){try{this.nativeRange.setEnd(b,c)}catch(d){this.nativeRange.setStart(b,c),this.nativeRange.setEnd(b,c)}a(this)},d=function(b,c){return function(d){try{this.nativeRange[b](d)}catch(e){this.nativeRange[c](d),this.nativeRange[b](d)}a(this)}}}b.setStartBefore=d("setStartBefore","setEndBefore"),b.setStartAfter=d("setStartAfter","setEndAfter"),b.setEndBefore=d("setEndBefore","setStartBefore"),b.setEndAfter=d("setEndAfter","setStartAfter"),j.selectNodeContents(i),b.selectNodeContents=j.startContainer==i&&j.endContainer==i&&0==j.startOffset&&j.endOffset==i.length?function(b){this.nativeRange.selectNodeContents(b),a(this)}:function(a){this.setStart(a,0),this.setEnd(a,h.getEndOffset(a))},j.selectNodeContents(i),j.setEnd(i,3),c=document.createRange(),c.selectNodeContents(i),c.setEnd(i,4),c.setStart(i,2),b.compareBoundaryPoints=-1==j.compareBoundaryPoints(j.START_TO_END,c)&1==j.compareBoundaryPoints(j.END_TO_START,c)?function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)},f.getBody(document).removeChild(i),j.detach(),c.detach()}(),b.createNativeRange=function(a){return a=a||document,a.createRange()};e.prototype.getName=function(){return"WrappedRange"},b.WrappedRange=e,b.createRange=function(a){return a=a||document,new e(b.createNativeRange(a))},b.createRangyRange=function(a){return a=a||document,new h(a)},b.createIframeRange=function(a){return b.createRange(f.getIframeDocument(a))},b.createIframeRangyRange=function(a){return b.createRangyRange(f.getIframeDocument(a))},b.addCreateMissingNativeApiListener(function(a){a=a.document,"undefined"==typeof a.createRange&&(a.createRange=function(){return b.createRange(this)}),a=a=null})}),b.createModule("WrappedSelection",function(a,b){function c(a){return(a||window).getSelection()}function d(a){return(a||window).document.selection}function e(a,b,c){var d=c?"end":"start";c=c?"start":"end",a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[c+"Container"],a.focusOffset=b[c+"Offset"]}function f(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function g(b){var c;return b instanceof t?(c=b._selectionNativeRange,c||(c=a.createNativeRange(r.getDocument(b.startContainer)),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset),b._selectionNativeRange=c,b.attachListener("detach",function(){this._selectionNativeRange=null}))):b instanceof u?c=b.nativeRange:a.features.implementsDomRange&&b instanceof r.getWindow(b.startContainer).Range&&(c=b),c}function h(a){var b,c=a.getNodes();a:if(c.length&&1==c[0].nodeType){b=1;for(var d=c.length;d>b;++b)if(!r.isAncestorOf(c[0],c[b])){b=!1;break a}b=!0}else b=!1;if(!b)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function i(a,b){var c=new u(b);a._ranges=[c],e(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function j(b){if(b._ranges.length=0,"None"==b.docSelection.type)f(b);else{var c=b.docSelection.createRange();if(c&&"undefined"!=typeof c.text)i(b,c);else{b.rangeCount=c.length;for(var d,g=r.getDocument(c.item(0)),h=0;h<b.rangeCount;++h)d=a.createRange(g),d.selectNode(c.item(h)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,e(b,b._ranges[b.rangeCount-1],!1)}}}function k(a,b){var c=a.docSelection.createRange(),d=h(b),e=r.getDocument(c.item(0));e=r.getBody(e).createControlRange();for(var f=0,g=c.length;g>f;++f)e.add(c.item(f));try{e.add(d)}catch(i){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}e.select(),j(a)}function l(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function m(a,b){var c=r.getDocument(b[0].startContainer);c=r.getBody(c).createControlRange();for(var d,e=0;e<rangeCount;++e){d=h(b[e]);try{c.add(d)}catch(f){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}c.select(),j(a)}function n(a,b){if(a.anchorNode&&r.getDocument(a.anchorNode)!==r.getDocument(b))throw new v("WRONG_DOCUMENT_ERR")}function o(a){var b=[],c=new w(a.anchorNode,a.anchorOffset),d=new w(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=t.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.requireModules(["DomUtil","DomRange","WrappedRange"]),a.config.checkSelectionRanges=!0;var p,q,r=a.dom,s=a.util,t=a.DomRange,u=a.WrappedRange,v=a.DOMException,w=r.DomPosition,x=a.util.isHostMethod(window,"getSelection"),y=a.util.isHostObject(document,"selection"),z=y&&(!x||a.config.preferTextRange);z?(p=d,a.isSelectionValid=function(a){a=(a||window).document;var b=a.selection;return"None"!=b.type||r.getDocument(b.createRange().parentElement())==a}):x?(p=c,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected."),a.getNativeSelection=p,x=p();var A=a.createNativeRange(document),B=r.getBody(document),C=s.areHostObjects(x,s.areHostProperties(x,["anchorOffset","focusOffset"]));a.features.selectionHasAnchorAndFocus=C;var D=s.isHostMethod(x,"extend");a.features.selectionHasExtend=D;var E="number"==typeof x.rangeCount;a.features.selectionHasRangeCount=E;var F=!1,G=!0;s.areHostMethods(x,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof x.rangeCount&&a.features.implementsDomRange&&function(){var a=document.createElement("iframe");B.appendChild(a);var b=r.getIframeDocument(a);b.open(),b.write("<html><head></head><body>12</body></html>"),b.close();var c=r.getIframeWindow(a).getSelection(),d=b.documentElement.lastChild.firstChild;b=b.createRange(),b.setStart(d,1),b.collapse(!0),c.addRange(b),G=1==c.rangeCount,c.removeAllRanges();var e=b.cloneRange();b.setStart(d,0),e.setEnd(d,2),c.addRange(b),c.addRange(e),F=2==c.rangeCount,b.detach(),e.detach(),B.removeChild(a)}(),a.features.selectionSupportsMultipleRanges=F,a.features.collapsedNonEditableSelectionsSupported=G;var H,I=!1;B&&s.isHostMethod(B,"createControlRange")&&(H=B.createControlRange(),s.areHostProperties(H,["item","add"])&&(I=!0)),a.features.implementsControlRange=I,q=C?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var J;if(s.isHostMethod(x,"getRangeAt")?J=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:C&&(J=function(b){var c=r.getDocument(b.anchorNode);return c=a.createRange(c),c.setStart(b.anchorNode,b.anchorOffset),c.setEnd(b.focusNode,b.focusOffset),c.collapsed!==this.isCollapsed&&(c.setStart(b.focusNode,b.focusOffset),
c.setEnd(b.anchorNode,b.anchorOffset)),c}),a.getSelection=function(a){a=a||window;var b=a._rangySelection,c=p(a),e=y?d(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh(a)):(b=new l(c,e,a),a._rangySelection=b),b},a.getIframeSelection=function(b){return a.getSelection(r.getIframeWindow(b))},H=l.prototype,!z&&C&&s.areHostMethods(x,["removeAllRanges","addRange"])){H.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),f(this)};var K=function(b,c){var d=t.getRangeDocument(c);d=a.createRange(d),d.collapseToPoint(c.endContainer,c.endOffset),b.nativeSelection.addRange(g(d)),b.nativeSelection.extend(c.startContainer,c.startOffset),b.refresh()};H.addRange=E?function(b,c){if(I&&y&&"Control"==this.docSelection.type)k(this,b);else if(c&&D)K(this,b);else{var d;F?d=this.rangeCount:(this.removeAllRanges(),d=0),this.nativeSelection.addRange(g(b)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==d+1?(a.config.checkSelectionRanges&&(d=J(this.nativeSelection,this.rangeCount-1))&&!t.rangesEqual(d,b)&&(b=new u(d)),this._ranges[this.rangeCount-1]=b,e(this,b,N(this.nativeSelection)),this.isCollapsed=q(this)):this.refresh()}}:function(a,b){b&&D?K(this,a):(this.nativeSelection.addRange(g(a)),this.refresh())},H.setRanges=function(a){if(I&&a.length>1)m(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(s.isHostMethod(x,"empty")&&s.isHostMethod(A,"select")&&I&&z))return b.fail("No means of selecting a Range or TextRange was found"),!1;H.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=r.getDocument(this.anchorNode);else if("Control"==this.docSelection.type){var b=this.docSelection.createRange();b.length&&(a=r.getDocument(b.item(0)).body.createTextRange())}a&&(a.body.createTextRange().select(),this.docSelection.empty())}}catch(c){}f(this)},H.addRange=function(a){"Control"==this.docSelection.type?k(this,a):(u.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,e(this,a,!1))},H.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?m(this,a):b&&this.addRange(a[0])}}H.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new v("INDEX_SIZE_ERR");return this._ranges[a]};var L;if(z)L=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=r.getBody(b.win.document).createTextRange(),c.collapse(!0)),"Control"==b.docSelection.type?j(b):c&&"undefined"!=typeof c.text?i(b,c):f(b)};else if(s.isHostMethod(x,"getRangeAt")&&"number"==typeof x.rangeCount)L=function(b){if(I&&y&&"Control"==b.docSelection.type)j(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));e(b,b._ranges[b.rangeCount-1],N(b.nativeSelection)),b.isCollapsed=q(b)}else f(b)};else{if(!C||"boolean"!=typeof x.isCollapsed||"boolean"!=typeof A.collapsed||!a.features.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;L=function(a){var b;b=a.nativeSelection,b.anchorNode?(b=J(b,0),a._ranges=[b],a.rangeCount=1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset,a.isCollapsed=q(a)):f(a)}}H.refresh=function(a){var b=a?this._ranges.slice(0):null;if(L(this),a){if(a=b.length,a!=this._ranges.length)return!1;for(;a--;)if(!t.rangesEqual(b[a],this._ranges[a]))return!1;return!0}};var M=function(a,b){var c=a.getAllRanges(),d=!1;a.removeAllRanges();for(var e=0,g=c.length;g>e;++e)d||b!==c[e]?a.addRange(c[e]):d=!0;a.rangeCount||f(a)};H.removeRange=I?function(a){if("Control"==this.docSelection.type){var b=this.docSelection.createRange();a=h(a);var c=r.getDocument(b.item(0));c=r.getBody(c).createControlRange();for(var d,e=!1,f=0,g=b.length;g>f;++f)d=b.item(f),d!==a||e?c.add(b.item(f)):e=!0;c.select(),j(this)}else M(this,a)}:function(a){M(this,a)};var N;!z&&C&&a.features.implementsDomRange?(N=function(a){var b=!1;return a.anchorNode&&(b=1==r.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b},H.isBackwards=function(){return N(this)}):N=H.isBackwards=function(){return!1},H.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},H.collapse=function(b,c){n(this,b);var d=a.createRange(r.getDocument(b));d.collapseToPoint(b,c),this.removeAllRanges(),this.addRange(d),this.isCollapsed=!0},H.collapseToStart=function(){if(!this.rangeCount)throw new v("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},H.collapseToEnd=function(){if(!this.rangeCount)throw new v("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},H.selectAllChildren=function(b){n(this,b);var c=a.createRange(r.getDocument(b));c.selectNodeContents(b),this.removeAllRanges(),this.addRange(c)},H.deleteFromDocument=function(){if(I&&y&&"Control"==this.docSelection.type){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),a.parentNode.removeChild(a);this.refresh()}else if(this.rangeCount){b=this.getAllRanges(),this.removeAllRanges(),a=0;for(var c=b.length;c>a;++a)b[a].deleteContents();this.addRange(b[c-1])}},H.getAllRanges=function(){return this._ranges.slice(0)},H.setSingleRange=function(a){this.setRanges([a])},H.containsNode=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(this._ranges[c].containsNode(a,b))return!0;return!1},H.toHtml=function(){var a="";if(this.rangeCount){a=t.getRangeDocument(this._ranges[0]).createElement("div");for(var b=0,c=this._ranges.length;c>b;++b)a.appendChild(this._ranges[b].cloneContents());a=a.innerHTML}return a},H.getName=function(){return"WrappedSelection"},H.inspect=function(){return o(this)},H.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null},l.inspect=o,a.Selection=l,a.selectionPrototype=H,a.addCreateMissingNativeApiListener(function(b){"undefined"==typeof b.getSelection&&(b.getSelection=function(){return a.getSelection(this)}),b=null})}),b.createModule("CssClassApplier",function(b){function c(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function d(a,b){return a.className&&RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(a.className)}function e(a,b){a.className?d(a,b)||(a.className+=" "+b):a.className=b}function f(a){return a.className.split(/\s+/).sort().join(" ")}function g(a,b){return f(a)==f(b)}function h(a){for(var b=a.parentNode;a.hasChildNodes();)b.insertBefore(a.firstChild,a);b.removeChild(a)}function i(a,b){var c=a.cloneRange();c.selectNodeContents(b);var d=c.intersection(a);return d=d?d.toString():"",c.detach(),""!=d}function j(a,b){if(a.attributes.length!=b.attributes.length)return!1;for(var c,d,e=0,f=a.attributes.length;f>e;++e)if(c=a.attributes[e],d=c.name,"class"!=d){if(d=b.attributes.getNamedItem(d),c.specified!=d.specified)return!1;if(c.specified&&c.nodeValue!==d.nodeValue)return!1}return!0}function k(a){for(var b=0,c=a.attributes.length;c>b;++b)if(a.attributes[b].specified&&"class"!=a.attributes[b].name)return!0;return!1}function l(a,b){return q.isCharacterDataNode(a)?0==b?!!a.previousSibling:b==a.length?!!a.nextSibling:!0:b>0&&b<a.childNodes.length}function m(a,b,c){var d;if(q.isCharacterDataNode(b)&&(0==c?(c=q.getNodeIndex(b),b=b.parentNode):c==b.length?(c=q.getNodeIndex(b)+1,b=b.parentNode):d=q.splitDataNode(b,c)),!d){d=b.cloneNode(!1),d.id&&d.removeAttribute("id");for(var e;e=b.childNodes[c];)d.appendChild(e);q.insertAfter(d,b)}return b==a?d:m(a,d.parentNode,q.getNodeIndex(d))}function n(a,b){var c=3==a.nodeType,d=c?a.parentNode:a,e=b?"nextSibling":"previousSibling";if(c){if((c=a[e])&&3==c.nodeType)return c}else if((c=d[e])&&a.tagName==c.tagName&&g(a,c)&&j(a,c))return c[b?"firstChild":"lastChild"];return null}function o(a){this.firstTextNode=(this.isElementMerge=1==a.nodeType)?a.lastChild:a,this.isElementMerge&&(this.sortedCssClasses=f(a)),this.textNodes=[this.firstTextNode]}function p(a,b,d){if(this.cssClass=a,this.normalize=b,this.applyToAnytagBody=!1,a=typeof d,"string"==a)"*"==d?this.applyToAnytagBody=!0:this.tagNames=c(d.toLowerCase()).split(/\s*,\s*/);else if("object"==a&&"number"==typeof d.length)for(this.tagNames=[],a=0,b=d.length;b>a;++a)"*"==d[a]?this.applyToAnytagBody=!0:this.tagNames.push(d[a].toLowerCase());else this.tagNames=[r]}b.requireModules(["WrappedSelection","WrappedRange"]);var q=b.dom,r=a,s=function(){function a(a,b,c){return b&&c?" ":""}return function(b,c){b.className&&(b.className=b.className.replace(RegExp("(?:^|\\s)"+c+"(?:\\s|$)"),a))}}();o.prototype={doMerge:function(){for(var a,b,c=[],d=0,e=this.textNodes.length;e>d;++d)a=this.textNodes[d],b=a.parentNode,c[d]=a.data,d&&(b.removeChild(a),b.hasChildNodes()||b.parentNode.removeChild(b));return this.firstTextNode.data=c=c.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;c>b;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}},p.prototype={appliesToElement:function(a){return this.applyToAnytagBody||q.arrayContains(this.tagNames,a.tagName.toLowerCase())},getAncestorWithClass:function(a){for(a=a.parentNode;a;){if(1==a.nodeType&&this.appliesToElement(a)&&d(a,this.cssClass))return a;a=a.parentNode}return!1},postApply:function(a,b){for(var c,d,e,f=a[0],g=a[a.length-1],h=[],i=f,j=g,k=0,l=g.length,m=0,p=a.length;p>m;++m)d=a[m],(e=n(d,!1))?(c||(c=new o(e),h.push(c)),c.textNodes.push(d),d===f&&(i=c.firstTextNode,k=i.length),d===g&&(j=c.firstTextNode,l=c.getLength())):c=null;if((f=n(g,!0))&&(c||(c=new o(g),h.push(c)),c.textNodes.push(f)),h.length){for(m=0,p=h.length;p>m;++m)h[m].doMerge();b.setStart(i,k),b.setEnd(j,l)}},createContainer:function(a){return a=a.createElement(r),a.className=this.cssClass,a},applyToTextNode:function(a){var b=a.parentNode;1==b.childNodes.length&&this.appliesToElement(b)?e(b,this.cssClass):(b=this.createContainer(q.getDocument(a)),a.parentNode.insertBefore(b,a),b.appendChild(a))},isRemovable:function(a){return a.tagName.toLowerCase()==r&&c(a.className)==this.cssClass&&!k(a)},undoToTextNode:function(a,b,c){b.containsNode(c)||(a=b.cloneRange(),a.selectNode(c),a.isPointInRange(b.endContainer,b.endOffset)&&l(b.endContainer,b.endOffset)&&(m(c,b.endContainer,b.endOffset),b.setEndAfter(c)),a.isPointInRange(b.startContainer,b.startOffset)&&l(b.startContainer,b.startOffset)&&(c=m(c,b.startContainer,b.startOffset))),this.isRemovable(c)?h(c):s(c,this.cssClass)},applyToRange:function(a){a.splitBoundaries();var b=a.getNodes([3],function(b){return i(a,b)});if(b.length){for(var c,d=0,e=b.length;e>d;++d)c=b[d],this.getAncestorWithClass(c)||this.applyToTextNode(c);a.setStart(b[0],0),c=b[b.length-1],a.setEnd(c,c.length),this.normalize&&this.postApply(b,a)}},applyToSelection:function(a){a=a||window,a=b.getSelection(a);var c,d=a.getAllRanges();a.removeAllRanges();for(var e=d.length;e--;)c=d[e],this.applyToRange(c),a.addRange(c)},undoToRange:function(a){a.splitBoundaries();var b,c,d=a.getNodes([3]),e=d[d.length-1];if(d.length){for(var f=0,g=d.length;g>f;++f)b=d[f],(c=this.getAncestorWithClass(b))&&this.undoToTextNode(b,a,c),a.setStart(d[0],0),a.setEnd(e,e.length);this.normalize&&this.postApply(d,a)}},undoToSelection:function(a){a=a||window,a=b.getSelection(a);var c,d=a.getAllRanges();a.removeAllRanges();for(var e=0,f=d.length;f>e;++e)c=d[e],this.undoToRange(c),a.addRange(c)},isAppliedToRange:function(a){for(var b=a.getNodes([3]),c=0,d=b.length;d>c;++c)if(i(a,b[c])&&!this.getAncestorWithClass(b[c]))return!1;return!0},isAppliedToSelection:function(a){a=a||window,a=b.getSelection(a).getAllRanges();for(var c=a.length;c--;)if(!this.isAppliedToRange(a[c]))return!1;return!0},toggleRange:function(a){this.isAppliedToRange(a)?this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},detach:function(){}},p.util={hasClass:d,addClass:e,removeClass:s,hasSameClasses:g,replaceWithOwnChildren:h,elementsHaveSameNonClassAttributes:j,elementHasNonClassAttributes:k,splitNodeAt:m},b.CssClassApplier=p,b.createCssClassApplier=function(a,b,c){return new p(a,b,c)}}),b.createModule("SaveRestore",function(b,c){function d(b,c){var d,e="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),f=h.getDocument(b.startContainer),g=b.cloneRange();return g.collapse(c),d=f.createElement(a),d.id=e,d.style.lineHeight="0",d.style.display="none",d.appendChild(f.createTextNode(i)),g.insertNode(d),g.detach(),d}function e(a,b,d,e){(a=(a||document).getElementById(d))?(b[e?"setStartBefore":"setEndBefore"](a),a.parentNode.removeChild(a)):c.warn("Marker element has been removed. Cannot restore selection.")}function f(a,b){return b.compareBoundaryPoints(a.START_TO_START,a)}function g(a,b){var c=(a||document).getElementById(b);c&&c.parentNode.removeChild(c)}b.requireModules(["DomUtil","DomRange","WrappedRange"]);var h=b.dom,i="\ufeff";b.saveSelection=function(a){a=a||window;var e=a.document;if(b.isSelectionValid(a)){var g,h,i=b.getSelection(a),j=i.getAllRanges(),k=[];j.sort(f);for(var l=0,m=j.length;m>l;++l)g=j[l],g.collapsed?(h=d(g,!1),k.push({markerId:h.id,collapsed:!0})):(h=d(g,!1),g=d(g,!0),k[l]={startMarkerId:g.id,endMarkerId:h.id,collapsed:!1,backwards:1==j.length&&i.isBackwards()});for(l=m-1;l>=0;--l)g=j[l],g.collapsed?g.collapseBefore((e||document).getElementById(k[l].markerId)):(g.setEndBefore((e||document).getElementById(k[l].endMarkerId)),g.setStartAfter((e||document).getElementById(k[l].startMarkerId)));return i.setRanges(j),{win:a,doc:e,rangeInfos:k,restored:!1}}c.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.")},b.restoreSelection=function(a,d){if(!a.restored){for(var f,g,h=a.rangeInfos,i=b.getSelection(a.win),j=[],k=h.length,l=k-1;l>=0;--l){if(f=h[l],g=b.createRange(a.doc),f.collapsed)if(f=(a.doc||document).getElementById(f.markerId)){f.style.display="inline";var m=f.previousSibling;m&&3==m.nodeType?(f.parentNode.removeChild(f),g.collapseToPoint(m,m.length)):(g.collapseBefore(f),f.parentNode.removeChild(f))}else c.warn("Marker element has been removed. Cannot restore selection.");else e(a.doc,g,f.startMarkerId,!0),e(a.doc,g,f.endMarkerId,!1);1==k&&g.normalizeBoundaries(),j[l]=g}1==k&&d&&b.features.selectionHasExtend&&h[0].backwards?(i.removeAllRanges(),i.addRange(j[0],!0)):i.setRanges(j),a.restored=!0}},b.removeMarkerElement=g,b.removeMarkers=function(a){for(var b,c=a.rangeInfos,d=0,e=c.length;e>d;++d)b=c[d],b.collapsed?g(a.doc,b.markerId):(g(a.doc,b.startMarkerId),g(a.doc,b.endMarkerId))}}),b.createModule("Serializer",function(a,c){function d(a,b){b=b||[];var c=a.nodeType,e=a.childNodes,f=e.length,g=[c,a.nodeName,f].join(":"),h="",i="";switch(c){case 3:h=a.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");break;case 8:h="<!--"+a.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"-->";break;default:h="<"+g+">",i="</>"}for(h&&b.push(h),c=0;f>c;++c)d(e[c],b);return i&&b.push(i),b}function e(a){return a=d(a).join(""),m(a).toString(16)}function f(a,b,c){var d=[],e=a;for(c=c||n.getDocument(a).documentElement;e&&e!=c;)d.push(n.getNodeIndex(e,!0)),e=e.parentNode;return d.join("/")+":"+b}function g(a,b,d){b?d||n.getDocument(b):(d=d||document,b=d.documentElement),a=a.split(":"),b=b,d=a[0]?a[0].split("/"):[];for(var e,f=d.length;f--;){if(e=parseInt(d[f],10),!(e<b.childNodes.length))throw c.createError("deserializePosition failed: node "+n.inspectNode(b)+" has no child with index "+e+", "+f);b=b.childNodes[parseInt(d[f],10)]}return new n.DomPosition(b,parseInt(a[1],10))}function h(b,c,d){if(d=d||a.DomRange.getRangeDocument(b).documentElement,!n.isAncestorOf(d,b.commonAncestorContainer,!0))throw Error("serializeRange: range is not wholly contained within specified root node");return b=f(b.startContainer,b.startOffset,d)+","+f(b.endContainer,b.endOffset,d),c||(b+="{"+e(d)+"}"),b}function i(b,c,d){c?d=d||n.getDocument(c):(d=d||document,c=d.documentElement),b=/^([^,]+),([^,\{]+)({([^}]+)})?$/.exec(b);var f=b[4],h=e(c);if(f&&f!==e(c))throw Error("deserializeRange: checksums of serialized range root node ("+f+") and target root node ("+h+") do not match");return f=g(b[1],c,d),c=g(b[2],c,d),d=a.createRange(d),d.setStart(f.node,f.offset),d.setEnd(c.node,c.offset),d}function j(a,b,c){return b?c||n.getDocument(b):(c=c||document,b=c.documentElement),a=/^([^,]+),([^,]+)({([^}]+)})?$/.exec(a)[3],!a||a===e(b)}function k(a,c,d){a=a||b.getSelection(),a=a.getAllRanges();for(var e=[],f=0,g=a.length;g>f;++f)e[f]=h(a[f],c,d);return e.join("|")}function l(b,c,d){c?d=d||n.getWindow(c):(d=d||window,c=d.document.documentElement),b=b.split("|");for(var e=a.getSelection(d),f=[],g=0,h=b.length;h>g;++g)f[g]=i(b[g],c,d.document);return e.setRanges(f),e}a.requireModules(["WrappedSelection","WrappedRange"]),("undefined"==typeof encodeURIComponent||"undefined"==typeof decodeURIComponent)&&c.fail("Global object is missing encodeURIComponent and/or decodeURIComponent method");var m=function(){var a=null;return function(b){for(var c,d=[],e=0,f=b.length;f>e;++e)c=b.charCodeAt(e),128>c?d.push(c):2048>c?d.push(c>>6|192,63&c|128):d.push(c>>12|224,c>>6&63|128,63&c|128);if(b=-1,!a){e=[],f=0;for(var g;256>f;++f){for(g=f,c=8;c--;)1==(1&g)?g=g>>>1^3988292384:g>>>=1;e[f]=g>>>0}a=e}for(e=a,f=0,c=d.length;c>f;++f)g=255&(b^d[f]),b=b>>>8^e[g];return(-1^b)>>>0}}(),n=a.dom;a.serializePosition=f,a.deserializePosition=g,a.serializeRange=h,a.deserializeRange=i,a.canDeserializeRange=j,a.serializeSelection=k,a.deserializeSelection=l,a.canDeserializeSelection=function(a,b,c){var d;b?d=c?c.document:n.getDocument(b):(c=c||window,b=c.document.documentElement),a=a.split("|"),c=0;for(var e=a.length;e>c;++c)if(!j(a[c],b,d))return!1;return!0},a.restoreSelectionFromCookie=function(a){a=a||window;var b;a:{b=a.document.cookie.split(/[;,]/);for(var c,d=0,e=b.length;e>d;++d)if(c=b[d].split("="),"rangySerializedSelection"==c[0].replace(/^\s+/,"")&&(c=c[1])){b=decodeURIComponent(c.replace(/\s+$/,""));break a}b=null}b&&l(b,a.doc)},a.saveSelectionCookie=function(a,c){a=a||window,c="object"==typeof c?c:{};var d=c.expires?";expires="+c.expires.toUTCString():"",e=c.path?";path="+c.path:"",f=c.domain?";domain="+c.domain:"",g=c.secure?";secure":"",h=k(b.getSelection(a));a.document.cookie=encodeURIComponent("rangySerializedSelection")+"="+encodeURIComponent(h)+d+e+f+g},a.getElementChecksum=e}),b}var rangy=plugin_rangy();window.rangy=rangy,rangy.init(),plugin_jquery_log($A),plugin_jquery_hasAttr($A),plugin_jquery_json($A),plugin_jquery_postMessage($A),plugin_jquery_mustache($A),plugin_jquery_enhancedOffset($A),plugin_jquery_drags($A),plugin_jquery_mousewheel($A),plugin_jquery_scrollStopStart($A),plugin_jquery_jScrollPane($A),plugin_jquery_twitterTip($A),plugin_jquery_antWidgetSummary($A),plugin_jquery_selectionographer($A,rangy),$A.expr[":"].parents=function(a,b,c){return $A(a).parents(c[3]).length<1}}var $=$A;$("body").append("<style>.ant-summary, .ant_indicator {display:none;}</style>");var css=[];(!$A.browser.msie||$A.browser.msie&&parseInt($A.browser.version,10)>8)&&css.push(ANT_staticUrl+"css/antenna-font/antenna-font.css"),$A.browser.msie&&(css.push(ANT_staticUrl+"widget/css/ie.css"),css.push(ANT_staticUrl+"widget/css/ie"+parseInt($A.browser.version,10)+".css"));var widgetCSS=ANT_offline?ANT_widgetCssStaticUrl+"widget/css/newwidget.css":ANT_widgetCssStaticUrl+"widget/css/newwidget.min.css?rv36";css.push(widgetCSS),css.push(ANT_staticUrl+"widget/css/jquery.jscrollpane.css"),loadCSS(css),initCommonUtils($A),initPlugins($A),antenna($A),ANT.actions.init(),ANT_offline&&ANT.debug()}var ANT={};if(window.ANTENNAIS&&window.ANTENNAIS.hasLoaded)return void window.ANTENNAIS.actions.reInit();window.ANTENNAIS=window.antenna=ANT,ANT.hasLoaded=!0,ANT.C={aWindowHeaderPadding:29,aWindowWidthForKindIsText:200,aWindowAnimationSpeed:333,indicatorOpacity:.4,helperIndicators:{hoverDelay:250,fadeInTime:300,opacity:.6}},ANT.engageScript=document.getElementById("antennascript")||findEngageScript(),ANT.engageScriptSrc=ANT.engageScript.src;var $ANT,$A,ANT_scriptPaths={},ANT_offline=!(-1==ANT.engageScriptSrc.indexOf("local-static.antenna.is")&&-1==ANT.engageScriptSrc.indexOf("local.antenna.is")&&-1==ANT.engageScriptSrc.indexOf("local.antenna2.is")&&"local.antenna.is"!=document.domain),ANT_baseUrl=ANT_offline?window.location.protocol+"//local.antenna.is:8081":window.location.protocol+"//www.antenna.is",ANT_staticUrl=ANT_offline?window.location.protocol+"//local.antenna.is:8081/static/":window.location.protocol+"//s3.amazonaws.com/readrboard/",ANT_widgetCssStaticUrl=ANT_offline?window.location.protocol+"//local.antenna.is:8081/static/":window.location.protocol+"//s3.amazonaws.com/readrboard/",isTouchBrowser=("ontouchstart"in window||navigator.msMaxTouchPoints)&&window.matchMedia("only screen and (max-width: 768px)").matches,isMobile=isTouchBrowser&&window.matchMedia("only screen and (max-width: 480px)").matches;ANT.safeThrow=function(a){var b=!1;ANT_offline&&b&&console.log(a)},ANT.ant_loadScript=ant_loadScript,ANT_scriptPaths.jquery=ANT_offline?ANT_staticUrl+"widget/js/jquery-1.11.1.min.js":"//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js",ant_loadScript({src:ANT_scriptPaths.jquery},function(){isTouchBrowser&&load_mobileEvents(jQuery),jquery_onload(jQuery)})}();