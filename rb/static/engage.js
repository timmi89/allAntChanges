(function(){function findEngageScript(){for(var a=document.getElementsByTagName("script"),b=0;a.length>b;b++){var c=a[b],d=c.src,e=-1!=d.indexOf("readrboard")&&-1!=d.indexOf("engage");if(e)return c}}function readrBoard(a){var b=a;b.extend(RDR,{summaries:{},current:{},content_nodes:{},containers:{},pages:{},group:{defaults:{img_selector:"img",anno_whitelist:"body p",media_selector:"embed, video, object, iframe",iframe_whitelist:["youtube.com","hulu.com","funnyordie.com","vimeo.com","mtvnservices.com","dailycandy.com","trutv.com"],comment_length:300,initial_pin_limit:300,no_readr:"",img_blacklist:"",custom_css:"",call_to_action:"What do you think?",inline_selector:"img, embed, video, object, iframe",slideshow_trigger:"#flipbook",slideshow_img_selector:"#flipbook div.image img",paragraph_helper:!0,sharebox_show:!1,sharebox_show_multipage:!1,sharebox_fade:!0,sharebox_should_own:!0,sharebox_selector:"",sharebox_readrboard:!0,sharebox_twitter:!1,sharebox_reddit:!1,sharebox_facebook:!1,sharebox_google:!1,sharebox_digg:!1,sharebox_stumble:!1}},user:{img_url:"",readr_token:"",user_id:""},known_users:{},errors:{actionbar:{rating:"",commenting:""}},styles:{},events:{track:function(a,c){var d="",e=(new Date).getTime();RDR.user&&RDR.user.user_id&&(d+="||uid::"+RDR.user.user_id),c&&RDR.util.getPageProperty("id",c)&&(d+="||pid::"+RDR.util.getPageProperty("id",c)),RDR.group&&RDR.group.id&&(d+="||gid::"+RDR.group.id),RDR.engageScriptParams.bookmarklet&&(d+="||bookmarklet");var f=a+d,g=b('<img src="'+RDR_baseUrl+"/static/widget/images/event.png?"+e+"&"+f+'" />');b("#rdr_event_pixels").append(g)},trackEventToCloud:function(a){var c=b.toJSON({category:a.category,action:a.action,opt_label:a.opt_label||null,opt_value:a.opt_value||null,opt_noninteraction:a.opt_noninteraction||null});b.postMessage("register-event::"+c,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}},rindow:{defaults:{coords:{left:100,top:100},animTime:100,defaultHeight:260,minHeight:10,maxHeight:300,minWidth:100,maxWidth:600,forceHeight:!1,rewritable:!0},makeHeader:function(a){var c=a||"",d=b('<div class="rdr_indicator_stats"><img class="no-rdr rdr_pin" src="'+RDR_staticUrl+'widget/images/blank.png">'+'<span class="rdr_count"></span>'+"</div>"+"<h1>"+c+"</h1>"),e=b('<div class="rdr rdr_header">'),f=b('<div class="rdr_loader" />');return e.append(f),e.append(d),d.find("div.rdr_indicator_stats").find("a").click(function(){RDR.events.track("click_rb_icon_rindow")}),e},makeDefaultPanelMessage:function(a,c){var g,d=a.data("hash"),e=RDR.summaries[d],f=c||(a.hasClass("rdr_indicator_details")?"media":"text");if("text"==f)g="writeMode"==a.data("mode")?"What do you think?":"text"==f?"Reactions":e.counts.tags>0?e.counts.tags+" Reactions":"Reactions";else{var h=b.browser.msie&&9>parseInt(b.browser.version,10)?20:0;g=e.counts.tags>0?e.counts.tags+" Reactions":a.width()>=175+h?"What do you think?":"React:"}return g},updateFooter:function(a,b){var c=a.find("div.rdr_footer");c.show(0),b&&c.html(b)},hideFooter:function(a){a.find("div.rdr_footer").hide(0)},panelCreate:function(a,c){if(a){var d=a.find("div.rdr_body_wrap");d.find("div.rdr_body").eq(0);var f=d.find("div."+c);f.remove();var g=b('<div class="rdr_body '+c+'"/>');return d.find("div.rdr_body").length+1,g}},panelUpdate:function(a,b,c,d){if(a){var e=a.find("div.rdr_body_wrap"),f=e.find("div."+b);return d?f.append(c):f.replaceWith(c),c}},panelShow:function(a,b,c){var d=a.find(".rdr_body_wrap"),e=a.find(".rdr_visiblePanel");e.length||(e=a.find(".rdr_body").eq(0));var f=e.width();b.show().addClass("rdr-visible").css({position:"absolute",top:0,left:f}),a.data("panelState",2),b.addClass("rdr_visiblePanel").removeClass("rdr_hiddenPanel"),e.addClass("rdr_hiddenPanel").removeClass("rdr_visiblePanel"),RDR.rindow.updateSizes(a),d.animate({left:-f},RDR.C.rindowAnimationSpeed,function(){c&&c()})},panelHide:function(a,b){var c=a.find(".rdr_body_wrap"),d=a.hasClass("rdr_indicator_details");if(d)var e=RDR.actions.indicators.utils.makeTagsListForMedia(a);else var f=a.hasClass("rdr_writemode"),e=RDR.actions.indicators.utils.makeTagsListForText(a,f);var g="rdr_tags_list",h=a.find(".rdr_visiblePanel");h.removeClass("rdr_visiblePanel").addClass("rdr_hiddenPanel");var i=RDR.rindow.panelUpdate(a,g,e);i.addClass("rdr_visiblePanel").removeClass("rdr_hiddenPanel");var j=i.width();h.css("left",j),c.css("left",-j),RDR.rindow.updateSizes(a),c.animate({left:0},RDR.C.rindowAnimationSpeed,function(){b&&b(),a.data("panelState",1)})},panelEnsureFloatWidths:function(a){var b=a.find(".rdr_body_wrap"),c=a.find(".rdr_visiblePanel"),d=a.find(".rdr_hiddenPanel"),e=d.width();b.css({left:-e}),c.css({left:e})},mediaRindowUpdateTagPanel:function(a){a.data("hash"),RDR.rindow.panelHide(a)},mediaRindowShow:function(a){var c=a.data("hash"),d=b("#rdr_indicator_details_"+c);RDR.util.cssSuperImportant(d,{display:"block"}),!a.data("hover")||d.data("hover")||d.is(":animated")||d.closest("div.rdr_media_details").length||(d.data("hover",!0),RDR.rindow.updateSizes(d)),d.addClass("rdr_engaged")},mediaRindowHide:function(a){var c=a.data("hash"),d=b("#rdr_indicator_details_"+c);a.data("hover")||d.is(":animated")||d.closest("div.rdr_media_details").length||d.data("hover",!1).animate({height:"0px"},RDR.C.rindowAnimationSpeed,function(){RDR.util.cssSuperImportant(d,{display:"none"})}),d.removeClass("rdr_engaged"),b("#rdr_indicator_"+c).hide()},updateSizes:function(a,b){var g,h,i,c=a.hasClass("rdr_indicator_details")?"media":"text",d=b||{},e=a.find(".rdr_visiblePanel"),f=a.data("initialWidth"),j=29,k={h:200,w:200,duration:RDR.C.rindowAnimationSpeed};k.w="media"==c?f:e.width(),k.h=e.height(),g=d.setWidth||k.w,h=d.setHeight||k.h,i=h+j,d.noAnimate&&a.css({width:g,height:i}),a.animate({width:g,height:i},{duration:k.duration,queue:!1}),RDR.rindow.jspUpdate(a)},updatePageTagMessage:function(a,b){if("tagDeleted"==b){var c=a.rindow;c.html('<div class="rdr_reactionMessage rdr_reactUndoSuccess"><div class="rdr_label_icon"></div><em><span>Your Reaction: </span><strong> '+a.tag.body+" </strong>"+"<span>has been undone.</span>"+"</em>"+"</div>")}},updateTagMessage:function(a){function x(a){var b=a.data.args.args?a.data.args.args:a.data.args,c=b.sendData.content_node_data,d=b.hash,e=b.page_id,f=b.rindow,g=b.tag,h=w.val();if(h.length>RDR.group.comment_length&&(h=h.substr(0,RDR.group.comment_length),w.val(h)),"Add a comment or #hashtag"!=h){var i=RDR.summaries[d];c.kind=i.kind;var j={hash:d,page_id:e,content_node_data:c,comment:h,content:c.body,tag:g,rindow:f};RDR.actions.interactions.ajax(j,"comment","create")}else w.focus()}if(a.scenario&&a.rindow){a.args&&b.each(a.args,function(c,d){a[c]="object"==typeof d?b.extend(!0,{},d):d});var c=a.hash,d=a.rindow,e=a.kind,f=a.tag,h=(RDR.summaries[c],a.sendData?a.sendData.content_node_data:{});if("tagDeleted"!=a.scenario){if("reactionSuccess"==a.scenario||"reactionExists"==a.scenario){var i=200>d.width()&&"text"!=e,j=i?"rdr_thin":"rdr_wide",k=b('<div class="rdr_view_success '+j+'"></div>'),l=b('<div class="rdr_subheader rdr_clearfix"></div>').appendTo(k),n=(b("<h1><span>You reacted:</span> "+f.body+"</h1></div>").appendTo(l),"reactionSuccess"==a.scenario?"Undo?":"Delete?"),p=(b('<div class="rdr_linkWrap"><span class="rdr_link"><a target="_blank" href="'+RDR_baseUrl+"/interaction/"+a.response.data.interaction.id+'" class="rdr_seeit_link">See it.</a>'+"</span>"+'<span class="rdr_link">'+'<a href="javascript:void(0);" class="rdr_undo_link">'+n+"</a></span>"+"</div>").appendTo(l),b('<div class="rdr_nextActions"></div>').appendTo(k));if(b('<div class="rdr_sectionWrap rdr_commentsSection rdr_clearfix"><div class="rdr_first_column"><strong>Say More:</strong></div><div class="rdr_second_column rdr_comment_input"></div><div class="rdr_last_column"><button class="rdr_add_comment">Add</button></div></div>').appendTo(p),b('<div class="rdr_sectionWrap rdr_boardsSection rdr_clearfix"><div class="rdr_first_column"><strong>Add To:</strong></div><div class="rdr_second_column rdr_select_user_board"></div></div>').appendTo(p),b('<div class="rdr_sectionWrap rdr_shareSection rdr_clearfix"><div class="rdr_first_column"><strong>Share:</strong></div><div class="rdr_second_column rdr_share_buttons"></div></div>').appendTo(p),"text"!=e){var t=b('<div class="rdr_back">&lt;&lt; Back</div>');k.prepend(t),t.click(function(){RDR.rindow.mediaRindowUpdateTagPanel(d)})}var u=!0;RDR.rindow.panelUpdate(d,"rdr_view_more",k,u);var v=b('<select class="rdr_user_boards"><option value="">Choose a board...</option></select>');RDR.user.user_boards!==void 0&&b.each(RDR.user.user_boards,function(a,b){v.append('<option value="'+b.id+'">'+b.title+"</option>")}),v.append('<option value="" class="">----------</option>'),v.append('<option value="create" class="rdr_create_board">Create a new ReadrBoard</option>'),k.find(".rdr_select_user_board").append(v),v.change(function(){var c=b(this).find(":checked");if(isNaN(parseInt(c.val()))){if("create"==c.val()){var e=RDR_baseUrl+"/board_create/?popup=widget",f=window.location.href,g=window.location.protocol+"//"+window.location.host,i=(RDR.engageScriptParams.bookmarklet?"bookmarklet=true":"",b('<div class="rdr_window rdr-board-create-div rdr_widget"><iframe id="rdr-board-create" name="rdr-board-create" src="'+e+"&parentUrl="+f+"&parentHost="+g+'" width="625" height="335" frameborder="0" /></div>'));b("#rdr_sandbox").append(i),b("div.rdr-board-create-div").length&&(RDR.checkingBoardWindow=setInterval(function(){if(!b("div.rdr-board-create-div").length){var d=a.rindow;d&&d.find("div.rdr_loader").css("visibility","hidden"),RDR.session.receiveMessage({},function(){if(RDR.user.new_board_id!==void 0){var c={hash:a.hash,board_id:RDR.user.new_board_id,board_name:RDR.user.new_board_name,int_id:a.response.data.interaction.id,tag:a.tag,rindow:a.rindow};RDR.actions.interactions.ajax(c,"boardadd","create")}}),b.postMessage("reloadXDMframe",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"]),clearInterval(RDR.checkingBoardWindow)}},250))}}else{var d={hash:a.hash,board_id:parseInt(c.val()),board_name:c.text(),int_id:a.response.data.interaction.id,tag:a.tag,rindow:a.rindow};RDR.actions.interactions.ajax(d,"boardadd","create")}}),k.find("a.rdr_undo_link").on("click.rdr",{args:a},function(a){var b=a.data.args,c={hash:b.hash,int_id:b.response.data.interaction.id,tag:b.tag,rindow:d};RDR.actions.interactions.ajax(c,"react","remove")}),k.find(".rdr_comment_input").append('<div class="rdr_commentBox rdr_inlineCommentBox"><div class="rdr_label_icon"></div><input type="text" class="rdr_add_comment_field rdr_inlineComment" value="Add a comment or #hashtag"/><div class="rdr_clear"></div></div>');var w=k.find("input.rdr_add_comment_field");w.focus(function(){RDR.events.track("start_comment_sm::"+a.response.data.interaction.id),b(this).addClass("rdr_adding_comment"),"Add a comment or #hashtag"==b(this).val()&&b(this).val("")}).blur(function(){""===b(this).val()&&(b(this).val("Add a comment or #hashtag"),b(this).removeClass("rdr_adding_comment"))}).on("keyup",{args:a},function(a){var b=w.val();"27"==a.keyCode||("13"==a.keyCode?x(a):b.length>RDR.group.comment_length&&(b=b.substr(0,RDR.group.comment_length),w.val(b)))}),k.find("button.rdr_add_comment").on("click",{args:a},function(a){x(a)});var y=b('<div class="rdr_share_social"><div class="rdr_label_icon"></div></div>'),z=b('<ul class="shareLinks"></ul>'),A=["facebook","twitter","tumblr"];b.each(A,function(e,g){var i=b('<li><a href="http://'+g+'.com" ><img class="no-rdr" src="'+RDR_staticUrl+"widget/images/social-icons-loose/social-icon-"+g+'.png" /></a></li>');z.append(i),i.click(function(){RDR.events.trackEventToCloud({category:"share",action:"share_open_attempt",opt_label:"which: "+g+", kind: "+a.kind+", hash: "+c+", tag: "+a.tag.body});var b=RDR.summaries[c],e=b.kind;return RDR.shareWindow=window.open(RDR_staticUrl+"share.html","readr_share","menubar=1,resizable=1,width=626,height=436"),RDR.actions.share_getLink({referring_int_id:a.response.data.interaction.id,hash:a.hash,kind:e,sns:g,rindow:d,tag:f,content_node:h}),!1})}),y.append(z),k.find(".rdr_share_buttons").append(y)}RDR.actions.containers.media.onEngage(c)}else{var C=RDR.rindow.makeDefaultPanelMessage(d),D=RDR.rindow.makeHeader(C);d.find(".rdr_header").replaceWith(D),d.removeClass("rdr_viewing_more").find("div.rdr_indicator_details_body").show(),RDR.rindow.panelHide(d)}RDR.rindow.updateSizes(d)}},jspUpdate:function(a){a.find("div.rdr_body").each(function(){var a=b(this);if(a.hasClass("jspScrollable")){var c=b(this).data("jsp");c.reinitialise()}else b(this).jScrollPane({showArrows:!0})})},pillTable:{make:function(a){var c=b('<table cellpadding="0" cellspacing="0" border="0" class="rdr_tags" style="max-width:'+a+'px;"><tr></tr></table>');return c},getNextCell:function(a,c,d,e){var l,f=RDR.rindow.pill.getWidth(a),g=c.find("tr"),h=g.not("tr.rdr_nextSteps").length,i=g.eq(0),j=g.not("tr.rdr_nextSteps").eq(-1),k=0;if(b.each(i.find("td"),function(a,c){l=b(c),l.hasClass("rdr_gutter")||(k+=l.width())}),k+=f,k>d&&1==h||j.find("td:not(.rdr_gutter)").length==i.find("td:not(.rdr_gutter)").length&&h>1){j.find("td.rdr_gutter").remove(),g.eq(-1).find("td:last-child:not(:first-child)").addClass("rdr-last-child");var m=b('<tr><td><div class="rdr_cell_wrapper"/></td></tr>');c.append(m),1==h&&h++}else j.append('<td><div class="rdr_cell_wrapper"/></td>');if(e&&1==h){c.find("td.rdr_gutter").remove();var n=d-k;i.append('<td class="rdr_gutter" style="width:'+n+'px;"/>')}var o=c.find("tr:not(.rdr_nextSteps)").eq(-1).find("td:not(.rdr_gutter)").eq(-1),p=o.find("div.rdr_cell_wrapper");return p.css("z-index",1e3-c.find("td").length),p}},pill:{getWidth:function(a){var c=a.count?a.count:"+",d=b('<a class="rdr_tag rdr_tag_'+a.id+'"><span class="rdr_tag_name">'+a.body+'</span><span class="rdr_tag_count">('+c+")</span></a> ");b("#rdr_sandbox").append(d);var e=d.width();return d.remove(),delete d,e},make:function(a,c,d,e){var f=a.count?a.count:"",g=d.data("container"),h=RDR.summaries[g],i=e?h.content_nodes[e]:"";if(RDR.rindow.pill.getWidth(a),""==f)var k="";else var l=1==f?"person":"people",k=f+" "+l+" had this reaction. Click to agree.",f="("+f+")";var m=b('<a class="rdr_tag rdr_tag_'+a.id+' rdr_tooltip_this" title="'+k+'"><span class="rdr_tag_name">'+a.body+'</span><span class="rdr_tag_count">'+f+"</span></a> ").data({tag_id:a.id,tag_count:f,parent_id:a.parent_id});e&&(m.data("content_node_id",e).addClass("rdr_content_node_"+e),i.id=e),m.click(function(){b(this).addClass("rdr_tagged"),d.removeClass("rdr_rewritable");var c=d.data("container");args={tag:a,hash:c,uiMode:"writeMode",kind:d.data("kind"),rindow:d,content_node:i},RDR.actions.interactions.ajax(args,"react","create")}).hover(function(){var a=b(this);if(!a.hasClass("rdr_tagged")){var c=a.find("span.rdr_tag_count");c.width(c.width()),c.text("+")}},function(){var a=b(this);a.find("span.rdr_tag_count").text(a.data("tag_count"))}),c.append(m," ");var n={},o=0;b.isEmptyObject(i)||b.isEmptyObject(i.top_interactions)||b.isEmptyObject(i.top_interactions.coms)||b.each(i.top_interactions.coms,function(c,d){d.tag_id==a.id&&(o++,b.isEmptyObject(n)&&(n=i.top_interactions.coms))});var p=b.isEmptyObject(n)&&h!==void 0&&("img"==h.kind||"media"==h.kind||"med"==h.kind)&&!b.isEmptyObject(h.top_interactions)&&!b.isEmptyObject(h.top_interactions.coms);if(p&&(n=h.top_interactions.coms[a.id],b.isEmptyObject(n)||(o=n.length)),!b.isEmptyObject(n)){var q=b('<span class="rdr_comment_hover rdr_tooltip_this" title="Click to view comments"/>');q.append('<span class="rdr_icon"></span> '+o),q.click(function(){return b(this).tooltip("hide"),RDR.actions.viewCommentContent({tag:a,hash:g,rindow:d,content_node:i,selState:i.selState}),!1}),m.append(q),q.tooltip(),m.closest("td").addClass("rdr_has_pillHover")}return m}},writeCustomTag:function(a,c,d){if(0==a.find("a.rdr_custom_tag").not("a.rdr_custom_tag.rdr_tagged").length){var d=d?d:"react",e="react"==d?"Add your own":"Add tag...",f=b('<a class="rdr_tag rdr_custom_tag rdr_tooltip_this" title="Add your own reaction. Type it in, then press Enter."><input type="text" value="'+e+'" class="rdr_default"/></a>');f.find("input").focus(function(){RDR.events.track("start_custom_reaction_rindow");var a=b(this);a.removeClass("rdr_default"),a.val()==e&&a.val("")}).blur(function(){var a=b(this);""===a.val()&&a.val(e),a.val()==e&&a.addClass("rdr_default")}).keyup(function(a){var e=b(this),f={},g=c.data("container");if("13"==a.keyCode)f.body=e.val(),e.parent().addClass("rdr_tagged"),args={tag:f,hash:g,uiMode:"writeMode",kind:c.data("kind"),rindow:c},RDR.actions.interactions.ajax(args,d,"create"),e.blur();else if("27"==a.keyCode)e.blur();else if(e.val().length>25){var h=e.val();e.val(h.substr(0,25))}}),a.append(f," "),f.closest("div.rdr_cell_wrapper").addClass("rdr_custom_tag_container"),f.tooltip()}},_rindowTypes:{tagMode:{make:function(a){var c=a.hash,d=RDR.summaries[c],e=d.$container,f=d.kind,g=0==a.rewritable?!1:!0,h={};if(a.actionType?a.actionType:"react","writeMode"==a.mode){RDR.events.track("start_react_text"),RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown",opt_label:"kind: text, hash: "+c});var j;if("text"==f){if(j=e.selog("helpers","smartHilite"),!j)return!1;if(a.content=j.text,h.left=h.left+40,h.top=h.top+35,j){var k=j.hiliter,l=k.get$end();if(l){var m=b("<span />");m.insertAfter(l);var n=m.offset().right,o=m.offset().bottom;m.remove(),h.left=n+5,h.top=o}}}else var h={top:e.offset().top,left:e.offset().right}}else{var r=(b("#rdr_indicator_"+c),b("#rdr_indicator_body_"+c)),e=b(".rdr-"+c);h={top:r.offset().top-8,left:r.offset().left-5}}var s=RDR.rindow.draw({coords:h,container:c,content:a.content,kind:f,selState:j,rewritable:g,mode:a.mode});s.data("hash",c),d["$rindow_"+a.mode.toLowerCase()]=s,s.addClass("rdr_"+a.mode.toLowerCase());var t=RDR.rindow.makeDefaultPanelMessage(s),u=RDR.rindow.makeHeader(t);if(s.find(".rdr_header").replaceWith(u),s.addClass("rdr_reactions"),!s.find("table.rdr_tags").length){var v=s.find("div.rdr_body_wrap"),x=s.find("div.rdr_body");x.length&&x.remove();var y=RDR.actions.indicators.utils.makeTagsListForText(s,"writeMode"==a.mode);v.append(y);var z=v.width(),A=v.height()+RDR.C.rindowHeaderPadding,B=RDR.util.stayInWindow({coords:h,width:z,height:A,ignoreWindowEdges:a.ignoreWindowEdges});return s.css("left",B.left+"px").css("top",B.top+"px"),s.animate({width:z,height:A},333,"swing"),s.data("initialWidth",z),s.find("div.rdr_cell_wrapper a.rdr_tag").css({width:"100%"}),s}},customOptions:{},setup:function(){}}},make:function(a,c){var d=c.hash,e=RDR.summaries[d];if(c.kind,!e){var e=RDR.util.makeEmptySummary(d);RDR.actions.containers.setup(e)}a||(a="readMode");var g=RDR.rindow.defaults,h=RDR.rindow._rindowTypes.customOptions,i=b.extend({},g,h,c,{mode:a}),j=RDR.rindow._rindowTypes.tagMode.make(i);return j},draw:function(a){a.selector&&!a.container&&(a.container=a.selector.substr(5));var c=b.extend({},this.defaults,a);60>c.minHeight?60:c.minHeight,c.maxHeight,minWidth=c.minWidth,maxWidth=c.maxWidth;var f=b("div.rdr.rdr_window.rdr_rewritable");0===f.length&&(f=b('<div class="rdr rdr_window rdr_rewritable rdr_widget"></div>'),c.id&&(b("#"+c.id).remove(),f.attr("id",c.id)),b("#rdr_sandbox").append(f)),1!=c.rewritable&&f.removeClass("rdr_rewritable"),f.data(c),0===f.find("div.rdr_header").length&&(f.html(""),f.append('<div class="rdr rdr_header rdr_brtr rdr_brtl"><div class="rdr_loader"/></div><div class="rdr rdr_body_wrap rdr_clearfix"></div><div class="rdr rdr_footer rdr_brbr rdr_brbl"></div>'),c.noHeader&&f.find("div.rdr_header").remove(),f.draggable({handle:".rdr_header",containment:"document",stack:".rdr_window",start:function(){b(this).removeClass("rdr_rewritable")}}));var g=c.coords;return f.css("left",g.left+"px"),f.css("top",g.top+"px"),c.height&&f.height(c.height),RDR.actionbar.closeAll(),f.settings=c,f.on("resizestop",function(){b(this)}),f},close:function(a){RDR.rindow.clearHilites(a),a.each(function(a,c){b(c).remove()}),b("#rdr_indicator_details_wrapper").find(".rdr_body_wrap").css({visibility:"visible"})},closeAll:function(){var a=b("div.rdr.rdr_window");RDR.rindow.close(a),b(".rdr_shared").removeClass("rdr_shared")},clearHilites:function(a){var c=[];a.each(function(a,d){var e=b(d).data("container");if(void 0!==e){var f=RDR.summaries[e],g=b(d).data("selState");g!==void 0&&""!==g&&c.push(g);var h=[];f&&f.hasOwnProperty("content_nodes")&&(h=f.content_nodes),b.each(h,function(a,b){var d=b.selState;d!==void 0&&c.push(d)})}}),b.each(c,function(a,c){try{b().selog("hilite",c,"off")}catch(d){}})},update:function(a,c){function i(a,c){var d,e;d=a.find(".rdr_tags"),e=d.find(".rdr_tag_"+c.parent_interaction_node.id).filter(function(){return b(this).hasClass("rdr_content_node_"+c.content_id)}),e.addClass("rdr_comment_indicator"),k(c,e,a),j(a),l(c,e,a)}function j(a){var c=a.find("table.rdr_tags");1==c.find("tr:eq(0)").find("td").length&&(c.addClass("rdr-one-column"),c.find("td.rdr_has_pillHover").on("mouseenter, mousemove",function(){var a=b(this),c=a.closest("div.rdr_window");thisWidth=c.data("initialWidth")}).on("mouseleave",function(){var a=b(this),c=a.closest("div.rdr_window");thisWidth=c.width()}))}function k(c,e,f){var g=d.content_nodes,h=g[c.content_id],i=h.top_interactions.coms,j=b.map(i,function(a){return a.tag_id===c.tag_id?a:null}),k=j.length,l=e,m=c.parent_interaction_node,n=c.content_node;l.find(".rdr_comment_hover").remove(),l.find(".rdr_comment_indicator").remove();var o=b('<span class="rdr_comment_hover"/>');o.append('<span class="rdr_icon"></span> '+k),o.click(function(){RDR.actions.viewCommentContent({tag:m,hash:a,rindow:f,content_node:n,selState:n.selState})}),l.append(o),l.closest("td").addClass("rdr_has_pillHover")}function l(c,d,e){var f=c.parent_interaction_node,g=c.content_node,h=b('<span class="rdr_comment_feedback"/>');h.append('<span class="linkToComment">Thanks! <a href="javascript:void(0);">See your comment</a></span> '),h.click(function(){return RDR.actions.viewCommentContent({tag:f,hash:a,rindow:e,content_node:g,selState:g.selState}),!1}),e.find("div.rdr_commentBox").empty().append(h).show(),e.find("button.rdr_add_comment").hide()}var d=RDR.summaries[a],e=d.$rindow_readmode,f=d.$rindow_writemode;if(c){if("coms"==c.int_type)if(f&&($tags=f.find(".rdr_tags").find(".rdr_tag"),$tags.addClass("rdr_content_node_"+c.content_id),i(f,c)),e)i(e,c);else{var g=b("#rdr_indicator_details_"+a);$tags=g.find(".rdr_tags").find(".rdr_tag"),$tags.addClass("rdr_content_node_"+c.content_id),i(g,c)}}else{var h=d.kind&&("img"==d.kind||"media"==d.kind||"med"==d.kind);if(!h)return;RDR.actions.indicators.utils.makeDetailsContent(a)}}},actionbar:{draw:function(a){function m(){var d=b("#rdr_container_tracker_"+c),e=d.find(".rdr_mediaHilite_top"),f={top:e.offset().top,left:e.offset().right};return f}var c=a.hash,d=a.coords,e=a.kind,f=a.content,g=a.src_with_path||void 0,h="rdr_actionbar_"+c;if(b("div.rdr_actionbar"),b("#"+h).length>0)return b("#"+h);var j={IE:{top:"add this here",left:"add this here"},img:m,text:{top:d.top-33,left:d.left+3}};d="text"==e?j.text:j.img(d),"text"==e&&(d=RDR.util.stayInWindow({coords:d,width:45,height:30,paddingY:40,paddingX:40,ignoreWindowEdges:a.ignoreWindowEdges}));var k=b('<div class="rdr rdr_actionbar rdr_widget rdr_widget_bar" id="'+h+'" />').css({top:d.top,left:d.left}).data("hash",c).append("<ul/>"),l=[{item:"reaction",tipText:"What do you think?",onclick:function(){RDR.rindow.make("writeMode",{hash:c,kind:e,content:f,src_with_path:g})}}];return RDR.events.track("show_action_bar::"+f),RDR.events.trackEventToCloud({category:"actonbar",action:"actionbar_shown",opt_label:"kind: "+e+", hash: "+c+", content: "+f}),b.each(l,function(a,c){var d=b('<li class="rdr_icon_'+c.item+'" />'),e=b('<a href="javascript:void(0);" class="rdr_tooltip_this" title="'+c.tipText+'">'+'<span class="rdr rdr_react_icon">'+c.item+"</span>"+'<span class="rdr rdr_react_label">What do you think?</span>'+'<div class="rdr_clear"></div>'+"</a>");e.click(function(){return c.onclick(),!1}),d.addClass("rdr_actionbar_first").append(e).appendTo(k.children("ul"))}),b("#rdr_sandbox").append(k),("img"==e||"media"==e||"med"==e)&&(k.addClass("rdr_actionbar_for_media"),k.append('<div style="clear:both;" />').removeClass("rdr_widget rdr_widget_bar")),k},close:function(a,c){function d(a,c){var d=a.data("timeoutCloseEvt"),e=a.data("timeoutCollapseEvt");clearTimeout(d),clearTimeout(e);var f=b(".rdr-"+c);b("#rdr_indicator_"+c),f.removeClass("rdr_engage_media"),a.remove()}a.each(function(){var a=b(this),e=a.data("hash");b("#rdr_container_tracker_"+e),c!==void 0?a.fadeOut(200):(d(a,e),b("#rdr_indicator_"+e))})},closeSuggest:function(a){var c=b();if(a)if("string"==typeof a){var d=a;c=b("#rdr_actionbar_"+d),c.data("hash",d)}else b.each(a,function(a,b){c=c.add("#rdr_actionbar_"+b),c.data("hash",b)});else c=b("div.rdr_actionbar");var e=this;c.each(function(){var a=b(this),d=c.data("hash"),f=b("#rdr_indicator_details_"+d),g=b(".rdr-"+d),h=b(this).data("timeoutCloseEvt");clearTimeout(h),h=setTimeout(function(){a.data("hover")||g.data("hover")||f.data("hover")||e.close(a,"fade")},300),b(this).data("timeoutCloseEvt",h)})},closeAll:function(){var a=b("div.rdr_actionbar");this.close(a)}},util:{checkForSelectedTextAndLaunchRindow:function(){var a=b("document").selog("save");if(a){var c=a.range.commonAncestorContainer,d=3===c.nodeType?b(c).parent():b(c);RDR.actions.startSelect(d,null,function(a,b,c){RDR.rindow.make("writeMode",{hash:a,kind:b,content:c})})}},initPublicEvents:function(){window.readrboard.public_events=b("#rdr_sandbox"),$RDR.dequeue("initAjax")},triggerPublicEvent:function(a,b){window.readrboard.public_events.trigger("event",b),window.readrboard.public_events.trigger(a,b)},makeEmptySummary:function(a,b){var c={};return c[a]={},c[a].hash=a,c[a].kind=b,c[a].top_interactions={},c[a].top_interactions.coms={},c[a].top_interactions.tags={},c[a].top_interactions.shr={},c[a].counts={},c[a].counts.tags=0,c[a].counts.interactions=0,c[a].counts.coms=0,c},getPageProperty:function(a,c){if(a||(a="id"),"object"==typeof c){if(b(c).closest(".rdr-page-container").length&&b(c).closest(".rdr-page-container").data("page_id"))return parseInt(b(c).closest(".rdr-page-container").data("page_id"))}else if(!c)return!1;if("string"==typeof c)var d=c;var e=b(".rdr-"+d).data("page_id")?b(".rdr-"+d).data("page_id"):b(".rdr-"+d).closest(".rdr-page-container").data("page_id");return b(".rdr-"+d).hasClass("rdr-page-container")&&!b(".rdr-"+d).data("page_id")&&b(".rdr-"+d).data("page_id",e),parseInt(e)},stayInWindow:function(a){var c=b(window),d=c.width(),e=c.height(),f=c.scrollTop(),g=a.width,h=a.height,i=a.coords,j=a.paddingY||10,k=a.paddingX||10,l=a.ignoreWindowEdges?a.ignoreWindowEdges:"";return-1==l.indexOf("r")&&i.left+g+16>=d-k&&(i.left=d-g-k),-1==l.indexOf("b")&&i.top+h>e+f-j&&(i.top=e+f-h-j),-1==l.indexOf("l")&&k>i.left&&(i.left=k),-1==l.indexOf("t")&&f+j>i.top&&(i.top=f+j),i},md5:{hexcase:0,b64pad:"",chrsz:8,hex_md5:function(a){return RDR.util.md5.binl2hex(RDR.util.md5.core_md5(RDR.util.md5.str2binl(a),a.length*RDR.util.md5.chrsz))},core_md5:function(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;a.length>g;g+=16){var h=c,i=d,j=e,k=f;c=RDR.util.md5.md5_ff(c,d,e,f,a[g+0],7,-680876936),f=RDR.util.md5.md5_ff(f,c,d,e,a[g+1],12,-389564586),e=RDR.util.md5.md5_ff(e,f,c,d,a[g+2],17,606105819),d=RDR.util.md5.md5_ff(d,e,f,c,a[g+3],22,-1044525330),c=RDR.util.md5.md5_ff(c,d,e,f,a[g+4],7,-176418897),f=RDR.util.md5.md5_ff(f,c,d,e,a[g+5],12,1200080426),e=RDR.util.md5.md5_ff(e,f,c,d,a[g+6],17,-1473231341),d=RDR.util.md5.md5_ff(d,e,f,c,a[g+7],22,-45705983),c=RDR.util.md5.md5_ff(c,d,e,f,a[g+8],7,1770035416),f=RDR.util.md5.md5_ff(f,c,d,e,a[g+9],12,-1958414417),e=RDR.util.md5.md5_ff(e,f,c,d,a[g+10],17,-42063),d=RDR.util.md5.md5_ff(d,e,f,c,a[g+11],22,-1990404162),c=RDR.util.md5.md5_ff(c,d,e,f,a[g+12],7,1804603682),f=RDR.util.md5.md5_ff(f,c,d,e,a[g+13],12,-40341101),e=RDR.util.md5.md5_ff(e,f,c,d,a[g+14],17,-1502002290),d=RDR.util.md5.md5_ff(d,e,f,c,a[g+15],22,1236535329),c=RDR.util.md5.md5_gg(c,d,e,f,a[g+1],5,-165796510),f=RDR.util.md5.md5_gg(f,c,d,e,a[g+6],9,-1069501632),e=RDR.util.md5.md5_gg(e,f,c,d,a[g+11],14,643717713),d=RDR.util.md5.md5_gg(d,e,f,c,a[g+0],20,-373897302),c=RDR.util.md5.md5_gg(c,d,e,f,a[g+5],5,-701558691),f=RDR.util.md5.md5_gg(f,c,d,e,a[g+10],9,38016083),e=RDR.util.md5.md5_gg(e,f,c,d,a[g+15],14,-660478335),d=RDR.util.md5.md5_gg(d,e,f,c,a[g+4],20,-405537848),c=RDR.util.md5.md5_gg(c,d,e,f,a[g+9],5,568446438),f=RDR.util.md5.md5_gg(f,c,d,e,a[g+14],9,-1019803690),e=RDR.util.md5.md5_gg(e,f,c,d,a[g+3],14,-187363961),d=RDR.util.md5.md5_gg(d,e,f,c,a[g+8],20,1163531501),c=RDR.util.md5.md5_gg(c,d,e,f,a[g+13],5,-1444681467),f=RDR.util.md5.md5_gg(f,c,d,e,a[g+2],9,-51403784),e=RDR.util.md5.md5_gg(e,f,c,d,a[g+7],14,1735328473),d=RDR.util.md5.md5_gg(d,e,f,c,a[g+12],20,-1926607734),c=RDR.util.md5.md5_hh(c,d,e,f,a[g+5],4,-378558),f=RDR.util.md5.md5_hh(f,c,d,e,a[g+8],11,-2022574463),e=RDR.util.md5.md5_hh(e,f,c,d,a[g+11],16,1839030562),d=RDR.util.md5.md5_hh(d,e,f,c,a[g+14],23,-35309556),c=RDR.util.md5.md5_hh(c,d,e,f,a[g+1],4,-1530992060),f=RDR.util.md5.md5_hh(f,c,d,e,a[g+4],11,1272893353),e=RDR.util.md5.md5_hh(e,f,c,d,a[g+7],16,-155497632),d=RDR.util.md5.md5_hh(d,e,f,c,a[g+10],23,-1094730640),c=RDR.util.md5.md5_hh(c,d,e,f,a[g+13],4,681279174),f=RDR.util.md5.md5_hh(f,c,d,e,a[g+0],11,-358537222),e=RDR.util.md5.md5_hh(e,f,c,d,a[g+3],16,-722521979),d=RDR.util.md5.md5_hh(d,e,f,c,a[g+6],23,76029189),c=RDR.util.md5.md5_hh(c,d,e,f,a[g+9],4,-640364487),f=RDR.util.md5.md5_hh(f,c,d,e,a[g+12],11,-421815835),e=RDR.util.md5.md5_hh(e,f,c,d,a[g+15],16,530742520),d=RDR.util.md5.md5_hh(d,e,f,c,a[g+2],23,-995338651),c=RDR.util.md5.md5_ii(c,d,e,f,a[g+0],6,-198630844),f=RDR.util.md5.md5_ii(f,c,d,e,a[g+7],10,1126891415),e=RDR.util.md5.md5_ii(e,f,c,d,a[g+14],15,-1416354905),d=RDR.util.md5.md5_ii(d,e,f,c,a[g+5],21,-57434055),c=RDR.util.md5.md5_ii(c,d,e,f,a[g+12],6,1700485571),f=RDR.util.md5.md5_ii(f,c,d,e,a[g+3],10,-1894986606),e=RDR.util.md5.md5_ii(e,f,c,d,a[g+10],15,-1051523),d=RDR.util.md5.md5_ii(d,e,f,c,a[g+1],21,-2054922799),c=RDR.util.md5.md5_ii(c,d,e,f,a[g+8],6,1873313359),f=RDR.util.md5.md5_ii(f,c,d,e,a[g+15],10,-30611744),e=RDR.util.md5.md5_ii(e,f,c,d,a[g+6],15,-1560198380),d=RDR.util.md5.md5_ii(d,e,f,c,a[g+13],21,1309151649),c=RDR.util.md5.md5_ii(c,d,e,f,a[g+4],6,-145523070),f=RDR.util.md5.md5_ii(f,c,d,e,a[g+11],10,-1120210379),e=RDR.util.md5.md5_ii(e,f,c,d,a[g+2],15,718787259),d=RDR.util.md5.md5_ii(d,e,f,c,a[g+9],21,-343485551),c=RDR.util.md5.safe_add(c,h),d=RDR.util.md5.safe_add(d,i),e=RDR.util.md5.safe_add(e,j),f=RDR.util.md5.safe_add(f,k)}return[c,d,e,f]},md5_cmn:function(a,b,c,d,e,f){return RDR.util.md5.safe_add(RDR.util.md5.bit_rol(RDR.util.md5.safe_add(RDR.util.md5.safe_add(b,a),RDR.util.md5.safe_add(d,f)),e),c)},md5_ff:function(a,b,c,d,e,f,g){return RDR.util.md5.md5_cmn(b&c|~b&d,a,b,e,f,g)},md5_gg:function(a,b,c,d,e,f,g){return RDR.util.md5.md5_cmn(b&d|c&~d,a,b,e,f,g)},md5_hh:function(a,b,c,d,e,f,g){return RDR.util.md5.md5_cmn(b^c^d,a,b,e,f,g)},md5_ii:function(a,b,c,d,e,f,g){return RDR.util.md5.md5_cmn(c^(b|~d),a,b,e,f,g)},safe_add:function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c},bit_rol:function(a,b){return a<<b|a>>>32-b},str2binl:function(a){for(var b=[],c=(1<<RDR.util.md5.chrsz)-1,d=0;a.length*RDR.util.md5.chrsz>d;d+=RDR.util.md5.chrsz)b[d>>5]|=(a.charCodeAt(d/RDR.util.md5.chrsz)&c)<<d%32;return b},binl2hex:function(a){for(var b=RDR.util.md5.hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;4*a.length>d;d++)c+=b.charAt(15&a[d>>2]>>8*(d%4)+4)+b.charAt(15&a[d>>2]>>8*(d%4));return c}},getCleanText:function(a){var c=b(a),d=c.find(".rdr_indicator");if(!d.length){var e=c.html().replace(/< *br *\/?>/gi,"\n"),f=b.trim(b("<div>"+e+"</div>").text().toLowerCase());return f&&"string"==typeof f&&""!==f?f.replace(/[\n\r\t]+/gi," ").replace().replace(/\s{2,}/g," "):void 0}},trimToLastWord:function(a){var b=/\w+$/.exec(a);return b?a.slice(0,a.length-b[0].length):a
},cssSuperImportant:function(a,c,d){var e="";b.each(c,function(a,d){d.replace("!important",""),b.trim(d),d+=" !important",c[a]=d});var f=a.attr("style")||"",g=d?c:b.extend(RDR.util.parseCssAttrToDict(f),c);return b.each(g,function(a,b){e+=a+":"+b+";"}),a.attr("style",e),a},parseCssAttrToDict:function(a){var c={},d=a.split(";");return b.each(d,function(a,d){var e=d.split(":"),f=b.trim(e[0]),g=b.trim(e[1]);f.length&&g.length&&(c[f]=g)}),c},fixBodyBorderOffsetIssue:function(){var a=b("body"),c=parseInt(a.css("border-top-width"),10),d=parseInt(a.css("border-left-width"),10),e=b("#rdr_sandbox");(c||d)&&RDR.util.cssSuperImportant(e,{top:c+"px",left:d+"px"})},throttledUpdateContainerTrackers:function(){return RDR.util._.throttle(RDR.actions.indicators.utils.updateContainerTrackers,100)},userLoginState:function(){if(b("#rdr-user").length||b("#rdr-page-summary").find("div.rdr-summary").prepend('<div id="rdr-user" />'),RDR&&RDR.user&&RDR.user.full_name&&b("#rdr-page-summary.defaultSummaryBar").length){var a="facebook"==RDR.user.user_type?RDR.user.full_name.split(" ")[0]:RDR.user.full_name;b("#rdr-user").html('Hi, <a href="'+RDR_baseUrl+"/user/"+RDR.user.user_id+'" target="_blank">'+a+"</a>")}else b("#rdr-user").html('<a href="javascript:void(0);">Log in to ReadrBoard</a>'),b("#rdr-user").find("a").click(function(){RDR.session.showLoginPanel()})},objLength:function(a){var c,b=0;for(c in a)a.hasOwnProperty(c)&&b++;return b},_:{debounce:function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},throttle:function(a,b){var c={};c.debounce=RDR.util._.debounce;var d,e,f,g,h,i=c.debounce(function(){h=g=!1},b);return function(){d=this,e=arguments;var c=function(){f=null,h&&a.apply(d,e),i()};f||(f=setTimeout(c,b)),g?h=!0:a.apply(d,e),i(),g=!0}},once:function(a){var c,b=!1;return function(){return b?c:(b=!0,c=a.apply(this,arguments),a=null,c)}}},getQueryParams:function(a){for(var d,b=a||window.location.search,c={},e=/\+/g,f=/([^&=]+)=?([^&]*)/g,g=function(a){return decodeURIComponent(a.replace(e," "))},h=b.substring(1);d=f.exec(h);)c[g(d[1])]=g(d[2]);return c},getQueryStrFromUrl:function(a){var c,d,b=a.indexOf("?");return-1==b?(c=a,d=""):(c=a.slice(0,b),d=a.slice(b)),d}},debug:function(){window.RDR=window.READRBOARDCOM,window.$RDR=$RDR,window.$R=a},session:{alertBar:{make:function(a,c){var d,e,f;if("fromShareLink"==a&&"undefined"!=c.content&&(d=b("<h1>Shared with <span>ReadrBoard</span></h1>"),e=1==b("img.rdr-"+c.container_hash).length?b('<div><strong class="reactionText">Reaction: <em>'+c.reaction+"</em></strong>"+' <a class="rdr_showSelection" href="javascript:void(0);"><img src="'+c.content+'" style="max-width:100px !important;max-height:70px !important;margin:5px 0 !important;display:block !important;" />'+' <strong class="seeItLinkText rdr_blue">Show it on the page</strong></a></div>'):b('<div><strong class="reactionText">Reaction: <em>'+c.reaction+"</em></strong>"+'<strong>"</strong><em>'+c.content.substr(0,140)+'...</em><strong>"</strong>'+'<br /><strong class="seeItLinkText"><a class="rdr_showSelection" href="javascript:void(0);">Show it on the page</a></strong></div>'),e.find("a.rdr_showSelection").click(function(){setTimeout(function(){RDR.session.revealSharedContent(c)},200)})),"showMorePins"==a&&(d=b("<h1>See <span>more reactions</span> on this page.</h1>"),e=b('<div>Readers like you are reacting to, sharing, and discussing content on this page.  <a class="rdr_show_more_pins" href="javascript:void(0);">Click here</a> to see what they\'re saying.<br><br><strong>Tip:</strong> Look for the <img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" /> icons.</div>'),e.find("a.rdr_show_more_pins").click(function(){RDR.actions.summaries.showLessPopularIndicators(),b(this).closest("div.rdr_alert_box").find("div.rdr_alert_box_x").click()})),d!==void 0){f=b('<img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" />');var g=b('<div class="rdr_alert_box rdr rdr_brbl rdr_brbr rdr_'+a+'" />');g.append(b('<div class="rdr_alert_box_1 rdr_brtl rdr_brtr" />').append(f).append(d),b('<div class="rdr_alert_box_2" />').append(e),'<div class="rdr rdr_alert_box_x">x</div>'),b("#rdr_sandbox").append(g),b("div.rdr_alert_box.rdr_"+a).find(".rdr_alert_box_x").click(function(){RDR.session.alertBar.close(a)}),b("div.rdr_alert_box.rdr_"+a).animate({top:-5},1e3)}},close:function(a){b("div.rdr_alert_box.rdr_"+a).remove(),b("div.rdr_indicator_for_media").hide(),b.postMessage("close "+a,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])}},revealSharedContent:function(a){var c=a.container_hash,d=b(".rdr-"+c),e=d.data("kind");if(("img"==e||"media"==e||"med"==e)&&(d.addClass("rdr_shared"),RDR.actions.indicators.utils.updateContainerTracker(c)),a.location&&"None"!=a.location){var f=a.location;b().selog("stack");var h=d.selog("save",{serialRange:f});b().selog("hilite",h,"on")}var i=d.offset().top,j=350,k=i-j||0;b("html,body").animate({scrollTop:k},1e3)},getSharedLinkInfo:function(a){if("pag"!=b.cookie("content_type")){var c=a.container_hash,d=!!RDR.containers[c];if(!d)return;return RDR.session.alertBar.make("fromShareLink",a),!0}},getUser:function(a,c){c&&a?RDR.session.receiveMessage(a,c):c&&RDR.session.receiveMessage(!1,c),b.postMessage("getUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])},handleGetUserFail:function(a,c){var d=a.response;switch(d.message){case"Error getting user!":RDR.session.killUser();break;case"Temporary user interaction limit reached":RDR.session.showLoginPanel(a,c);break;case"Container specified does not exist":break;case"Token was invalid":case"Facebook token expired":case"FB graph error - token invalid":case"Social Auth does not exist for user":case"Data to create token is missing":RDR.user.user_type!==void 0&&"readrboard"==RDR.user.user_type?RDR.session.showLoginPanel(a,c):(RDR.session.receiveMessage(a,c),b.postMessage("reauthUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"]))}},createXDMframe:function(){RDR.session.receiveMessage({},function(){RDR.util.userLoginState()});var a=RDR_baseUrl+"/static/xdm.html",c=window.location.href,d=window.location.protocol+"//"+window.location.host,e=RDR.engageScriptParams.bookmarklet?"bookmarklet=true":"",f=b('<iframe id="rdr-xdm-hidden" name="rdr-xdm-hidden" src="'+a+"?parentUrl="+c+"&parentHost="+d+"&group_id="+RDR.group.id+"&group_name="+encodeURIComponent(RDR.group.name)+"&"+e+'" width="1" height="1" style="position:absolute;top:-1000px;left:-1000px;" />');b("#rdr_sandbox").append(f),$RDR.dequeue("initAjax")},receiveMessage:function(a,c){b.receiveMessage(function(d){var e=b.evalJSON(d.data);if(e.status)if("returning_user"==e.status||"got_temp_user"==e.status){for(var f in e.data)"user_boards"==f?RDR.user.user_boards=b.evalJSON(e.data[f]):RDR.user[f]=isNaN(e.data[f])?e.data[f]:parseInt(e.data[f],10);c&&a?(a.user=RDR.user,c(a),c=null):c&&(c(),c=null),RDR.util.userLoginState()}else if("board_created"==e.status)b("div.rdr-board-create-div").remove();else if("board_create_cancel"==e.status)clearInterval(RDR.checkingBoardWindow),b("div.rdr-board-create-div").remove();else if("getUserLoginState"==e.status)RDR.session.getUser(),b("#rdr_loginPanel").remove();else if("fb_user_needs_to_login"==e.status)c&&a?RDR.session.showLoginPanel(a,c):RDR.session.showLoginPanel(a);else if("close login panel"==e.status)RDR.util.userLoginState(),b("#rdr_loginPanel").remove(),b("div.rdr-summary div.rdr_info").html("<em>You're logged in!  Try your last reaction again.");else if("already had user"==e.status)b("#rdr_loginPanel div.rdr_body").html('<div style="padding: 5px 0; margin:0 8px; border-top:1px solid #ccc;"><strong>Welcome!</strong> You\'re logged in.</div>');else if(-1!=e.status.indexOf("sharedLink")){var g=e.status.split("|");g[5]&&(RDR.session.referring_int_id=parseInt(g[5],10)),RDR.session.getSharedLinkInfo({container_hash:g[1],location:g[2],reaction:g[3],content:g[4],page_hash:g[6]})}},RDR_baseUrl)},login:function(){},checkForMaxInteractions:function(){return RDR.user.num_interactions&&""!==RDR.user.img_url&&RDR.user.num_interactions<RDR.group.temp_interact?!1:!0},showLoginPanel:function(a,c){if(b(".rdr_rewritable").removeClass("rdr_rewritable"),1>b("#rdr_loginPanel").length){var d;if(a&&a.rindow){var e=a.rindow;d=e.offset(),d.left=d.left?d.left-34:100,d.top=d.top?d.top-25:100}else d=[],d.left=b(window).width()/2-200,d.top=150+b(window).scrollTop();var f=RDR.rindow.draw({coords:d,id:"rdr_loginPanel",pnls:1,height:175,ignoreWindowEdges:"bt"});a&&f.data("args",a),c&&f.data("callback",c);var g=RDR_baseUrl+"/static/fb_login.html",h=window.location.href,i=window.location.protocol+"//"+window.location.host,j=a&&a.response&&-1!=a.response.message.indexOf("Temporary user interaction")?"Log In to Continue Reacting":"Log In to ReadrBoard",k=b('<iframe id="rdr-xdm-login" src="'+g+"?parentUrl="+h+"&parentHost="+i+"&group_id="+RDR.group.id+"&group_name="+RDR.group.name+'" width="360" height="140" frameborder="0" style="overflow:hidden; width:360px !important;" />'),l=RDR.rindow.makeHeader(j);f.find(".rdr_header").replaceWith(l),f.find("div.rdr_body_wrap").append('<div class="rdr_body" />').append(k),RDR.events.track("show_login")}},killUser:function(){RDR.user={},b.postMessage("killUser",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"])},rindowUserMessage:{show:function(a){var c=a.rindow,d=a.interactionInfo;if(c){var e=a.msgType||null,f=null,h=45,j=c.height(),k=300,l=c.find(".rdr_body_wrap"),m=c.find("div.rdr_rindow_message"),n=c.find(".rdr_rindow_message_innerwrap"),o=b("div.rdr_otherTagsWrap"),p=c.find(".rdr_rindow_message_tempUserMsg");switch(m.show(),e){case"tempUser":var q=RDR.group.temp_interact-parseInt(a.num_interactions,10),r=b('<a href="javascript:void(0);">Connect with Facebook</a>.');r.click(function(){RDR.session.showLoginPanel(a)});var s="You can react or comment <strong>"+q+" more times</strong> before you must ";p.empty().append("<span>"+s+"</span>"),p.append(r);break;case"existingInteraction":f="You have already given that reaction for this.";break;case"interactionSuccess":d.remove?(f="The "+d.type+" <em>"+d.body+"</em><br />has been removed.",p.empty()):(f="tag"==d.type?"You have tagged this <em>"+d.body+"</em>.":"bookmark"==d.type?"You have stored this <em>"+d.body+"</em>.":"comment"==d.type?"You have left your comment.":"",f+=" See your "+d.type+"s on this page, and at <strong><a href='"+RDR_baseUrl+"' target='_blank'>readrboard.com</a></strong>");var t=a;c.find("div.rdr_rindow_message_tempUserMsg").text().length>0&&($inlineTempMsg=b("<div />"),$inlineTempMsg.html('<h4 style="font-size:17px;">You can react '+c.find("div.rdr_rindow_message_tempUserMsg strong").text()+'.</h4><br/><p><a style="font-weight:bold;color:#008be4;" href="javascript:void(0);">Connect with Facebook</a> to react as much as you want &amp; show other readers here what you think.</p><br/><p>Plus, you can share and comment in-line!</p><br/><a href="javascript:void(0);"><img src="'+RDR_staticUrl+'widget/images/fb-login_to_readrboard.png" alt="Connect with Facebook" /></a>'),$inlineTempMsg.find("a").click(function(){RDR.session.showLoginPanel(t)}))}f&&m.find("span.rdr_userMsg").html(f),n.hide(),c.queue("userMessage",function(){m.height()>0?(n.fadeIn(500),b(this).dequeue("userMessage")):(c.animate({height:j+h},k),o.animate({bottom:0},k),l.animate({bottom:h},k),m.animate({height:h},k,function(){n.fadeIn(500),b(this).dequeue("userMessage")}))}),c.dequeue("userMessage")}},hide:function(a){if(a){var c=b("div.rdr_rindow_message");$otherTagsWrap=b("div.rdr_otherTagsWrap");var d=a.find(".rdr_body_wrap"),e=c.height(),f=a.height(),g=300,h=10;a.queue("userMessage",function(){a.animate({height:f-e},g),$otherTagsWrap.animate({bottom:0-h},g),d.animate({bottom:h},g),c.animate({height:0},g,function(){c.hide(),b(this).dequeue("userMessage")})}),a.dequeue("userMessage")}}}},actions:{aboutReadrBoard:function(){},init:function(){var a=this;$RDR=b(RDR),$RDR.queue("initAjax",function(){a.initGroupData(RDR.group.short_name)}),$RDR.queue("initAjax",function(){a.initEnvironment()}),$RDR.queue("initAjax",function(){a.initPageData()}),$RDR.queue("initAjax",function(){RDR.session.createXDMframe()}),$RDR.queue("initAjax",function(){RDR.util.checkForSelectedTextAndLaunchRindow(),RDR.util.initPublicEvents()}),$RDR.dequeue("initAjax"),b("#flipbook").after('<div class="rdr_media_details"></div>')},initGroupData:function(){b.ajax({url:RDR_baseUrl+"/api/settings/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON({host_name:window.location.hostname})},success:function(a){var e=a.data;RDR.group=b.extend({},RDR.group.defaults,e),b(RDR.group.no_readr).each(function(){b(this).addClass("no-rdr"),b(this).find("img").addClass("no-rdr")}),""!==RDR.group.custom_css&&b("head").append(b('<style type="text/css">'+RDR.group.custom_css+"</style>")),$RDR.dequeue("initAjax")},error:function(){}})},initPageData:function(){var a=RDR.util.getQueryStrFromUrl(RDR.engageScriptSrc);RDR.engageScriptParams=RDR.util.getQueryParams(a);var c=RDR.engageScriptParams.bookmarklet&&!b("#rdr-page-summary").length&&!b(RDR.group.post_selector).length&&!b(RDR.group.summary_widget_selector).length;c&&b('<div id="rdr-page-summary" class="rdr no-rdr defaultSummaryBar"/>').appendTo("body");var f,g,h,i,j,d=[],e=[],k={};""!==RDR.group.post_selector&&""!==RDR.group.post_href_selector&&""!==RDR.group.summary_widget_selector&&b(RDR.group.post_selector).each(function(){var a=d.length,c=b(this),g=c.find(RDR.group.post_href_selector),i=c.find(RDR.group.summary_widget_selector);g.attr("href")&&(h=g.attr("href"),e.push(h),f={group_id:parseInt(RDR.group.id,10),url:h,canonical_url:"same",title:g.text()},d.push(f),k[a]=f,c.hasClass("rdr-page-container")||c.addClass("rdr-page-container").addClass("rdr-page-key-"+a),i.addClass("rdr-page-widget-key-"+a).addClass("rdr-page-widget-key"))});var l=window.location.href;if((-1==b.inArray(l,e)||0==e.length)&&(i=b('link[rel="canonical"]').length>0?b('link[rel="canonical"]').attr("href"):l,j=b('meta[property="og:title"]').attr("content")?b('meta[property="og:title"]').attr("content"):b("title").text()?b("title").text():"",f={group_id:parseInt(RDR.group.id,10),url:l,canonical_url:l==i?"same":i,title:j},d.push(f),g=d.length-1,k[g]=f,!b("body").hasClass("rdr-page-container")))if(b("body").addClass("rdr-page-container").addClass("rdr-page-key-"+g),1==b("#rdr-page-summary").length)b("#rdr-page-summary").addClass("rdr-page-widget-key-"+g).addClass("rdr-page-widget-key");else{var m=b("body").find(RDR.group.summary_widget_selector).eq(0);m.hasClass("rdr-page-widget-key-0")||m.addClass("rdr-page-widget-key-"+g).addClass("rdr-page-widget-key")}var n={pages:d};b.ajax({url:RDR_baseUrl+"/api/page/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(n)},success:function(a){RDR.events.track("load"),b.each(a.data,function(a,b){b.key=a,b.url=k[a].url,RDR.actions.pages.save(b.id,b),RDR.actions.pages.initPageContainer(b.id)}),RDR.group._summary_widget_selector=RDR.group.summary_widget_selector,b.each(a.data,function(a,b){RDR.actions.pages.initShareBox(b.id)}),$RDR.dequeue("initAjax")},error:function(){}})},initEnvironment:function(){var a=b('<div id="rdr_sandbox" class="rdr no-rdr rdr_sandbox"/>').appendTo("body");RDR.util.fixBodyBorderOffsetIssue();var c={paddingLeft:-1!=b("body").css("padding-left").indexOf("%")?b(window).width()*(parseInt(b("body").css("padding-left"))/100):parseInt(b("body").css("padding-left")),marginLeft:-1!=b("body").css("margin-left").indexOf("%")?b(window).width()*(parseInt(b("body").css("margin-left"))/100):parseInt(b("body").css("margin-left")),left:-1!=b("body").css("left").indexOf("%")?b(window).width()*(parseInt(b("body").css("left"))/100):parseInt(b("body").css("left")),paddingLeft:-1!=b("body").css("padding-top").indexOf("%")?b(window).width()*(parseInt(b("body").css("padding-top"))/100):parseInt(b("body").css("padding-top")),marginTop:-1!=b("body").css("margin-top").indexOf("%")?b(window).width()*(parseInt(b("body").css("margin-top"))/100):parseInt(b("body").css("margin-top")),top:-1!=b("body").css("top").indexOf("%")?b(window).width()*(parseInt(b("body").css("top"))/100):parseInt(b("body").css("top"))},d=-(c.marginLeft+c.left+c.paddingLeft),e=-(c.marginTop+c.top+c.paddingTop);d=isNaN(d)?0:d,e=isNaN(e)?0:e;var f=parseInt(a.css("top"),10),g=parseInt(a.css("left"),10);RDR.util.cssSuperImportant(a,{left:g+d+"px",top:f+e+"px"},!0),a.append("<style>.rdr_twtooltip { margin-left:"+d+"px !important; margin-top:"+e+"px !important; } </style>"),b('<div id="rdr_container_tracker_wrap" />').appendTo(a),b('<div id="rdr_indicator_details_wrapper" />').appendTo(a),b('<div id="rdr_event_pixels" />').appendTo(a),b(document).on("mouseup.rdr",function(a){setTimeout(function(){RDR.actions.startSelectFromMouseUp(a)},1)}),b(document).on("click.rdr",function(a){var c=b(a.target);c.parents().hasClass("rdr")||b("div.rdr-board-create-div").length||(RDR.actions.UIClearState(),b("div.rdr_indicator_details_for_media").each(function(){RDR.actions.containers.media.onDisengage(b(this).data("container"))}))}),b(document).on("keyup.rdr",function(a){"27"==a.keyCode&&RDR.actions.UIClearState()}),b(document).on("scrollstop",function(){b(window).scrollTop()>150&&b("#rdr_sandbox")&&!b("#rdr_sandbox").data("showingAllIndicator")&&(b("#rdr_sandbox").data("showingAllIndicator",!0),RDR.text_container_popularity&&RDR.text_container_popularity.length>RDR.group.initial_pin_limit&&(RDR.session.alertBar.make("showMorePins"),b(document).unbind("scrollstop.rdr")))}),b(window).resize(RDR.util.throttledUpdateContainerTrackers());var h=RDR.group.img_blacklist&&""!=RDR.group.img_blacklist?":not("+RDR.group.img_blacklist+")":"",i=160;b("body").on("mouseenter","embed, video, object, iframe, img"+h,function(){RDR.actions.indicators.utils.updateContainerTrackers();var a=b(this);if("iframe"==a.get(0).tagName.toLowerCase()){var c=!0;if(b.each(RDR.group.iframe_whitelist,function(b,d){a.attr("src")&&-1!=a.attr("src").indexOf(d)&&(c=!1)}),1==c)return}if(a.width()>=i){var d=a.hasClass("rdr-hashed"),e=a.closest(".rdr, .no-rdr").length;if(a.addClass("rdr_live_hover"),d||e){var g=a.data("hash");a.addClass("rdr_live_hover"),b("#rdr_indicator_details_"+g).hasClass("rdr_engaged")||b("#rdr_indicator_"+g).show()}else{var g,f=RDR.actions.hashNodes(b(this));if(b.each(f,function(a,b){g=b[0]}),!g)return RDR.safeThrow("There should always be a hash from hashNodes after hover on an unhashed image."),void 0;RDR.actions.sendHashes(f,function(){a.hasClass("rdr_live_hover")&&(b("#rdr_indicator_details_"+g).hasClass("rdr_engaged")||b("#rdr_indicator_"+g).show())})}}}).on("mouseleave","embed, video, object, iframe, img"+h,function(){var c=b(this),d=c.data("hash");c.removeClass("rdr_live_hover"),b("#rdr_indicator_"+d).hide()}),RDR.actions.slideshows.setup(),$RDR.dequeue("initAjax")},UIClearState:function(){b("div.rdr_twtooltip").remove(),RDR.rindow.closeAll(),RDR.actionbar.closeAll(),RDR.actions.containers.media.disengageAll(),b("div.rdr_indicator_for_media").hide(),b("div.rdr.rdr_tag_details.rdr_sbRollover").remove(),b().selog("hilite",!0,"off");var a=b(".rdr_fromShareLink").length;a&&RDR.session.alertBar.close("fromShareLink")},hashNodes:function(a){if(void 0!==a){var d=b(),e=[{kind:"media",$group:null,whiteList:RDR.group.media_selector,filterParam:"embed, video, object, iframe",setupFunc:function(){var a=this.src;b(this).data({body:a})}},{kind:"img",$group:null,whiteList:RDR.group.img_selector,filterParam:"img",setupFunc:function(){var a=this.src;b(this).data({body:a})}},{kind:"text",$group:null,whiteList:RDR.group.anno_whitelist,filterParam:function(a,c){return b(c).text()!=b(c).parent().text()?!!b(c).text():void 0},setupFunc:function(){var a=RDR.util.getCleanText(this);b(this).data("body",a)}}];if(b.each(e,function(c,e){var f=a.filter(e.filterParam);f=f.add(a.find(e.whiteList)),f=f.not(d),f=f.not(".rdr-hashed, .no-rdr"),e.$nodes=f,f.each(function(){e.setupFunc.apply(this),b(this).data("kind",e.kind)}),d=d.add(f);var g=d.filter(RDR.group.inline_selector);g.each(function(){b(this).data("inlineIndicator",!0)})}),!d.data("body"))return!1;var f={};return d.each(function(){var a=b(this),c=a.data("body"),d=a.data("kind"),e=a.get(0).nodeName.toLowerCase(),g="rdr-"+d+"-"+c,h=RDR.util.md5.hex_md5(g);RDR.actions.containers.save({body:c,kind:d,hash:h,HTMLkind:e,$this:a}),a.addClass("rdr-"+h).addClass("rdr-node");var i=RDR.actions.summaries.init(h);RDR.actions.summaries.save(i),RDR.actions.indicators.init(h);var j=RDR.util.getPageProperty("id",h);f[j]||(f[j]=[]),f[j].push(h),a.data("hash",h)}),RDR.actions.containers.setup(f),f}},sendHashes:function(a,c){var d,e,f,g;for(var h in a){if(d=h,e=a[h],!d||"object"!=typeof e)break;for(var i in e)"string"==typeof e[i]&&e[i]&&(f=b(".rdr-"+e[i]),f&&1==f.length&&f.addClass("rdr-hashed"));g={short_name:RDR.group.short_name,pageID:parseInt(d),hashes:e},b.ajax({url:RDR_baseUrl+"/api/summary/containers/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(g)},success:function(a){var f,e={};e[d]=a.data.known;for(var g in a.data.unknown){var h=a.data.unknown[g];"string"==typeof h&&(f=1==b("img.rdr-"+h).length?RDR.util.makeEmptySummary(h,"img"):b(".rdr-"+h).text()?RDR.util.makeEmptySummary(h,"text"):RDR.util.makeEmptySummary(h,"media"),e[h]=f)}b.isEmptyObject(e)||(RDR.actions.containers.setup(e),c!==void 0&&c())}})}},slideshows:{setup:function(){RDR.group.slideshow_trigger&&b(window).hashchange(function(){RDR.rindow.closeAll();var a=RDR.actions.slideshows.findActiveHash();RDR.actions.indicators.update(a,!0)})},findActiveHash:function(){if(RDR.group.slideshow_trigger&&RDR.group.slideshow_img_selector){var a=b(RDR.group.slideshow_img_selector),c="";return b.each(a,function(a,d){var e=b(d);return e.is(":visible")&&0==e.parents(":hidden").length&&e.data("hash")?(c=e.data("hash"),!1):void 0}),c}return""}},containers:{media:{onEngage:function(a){var c=b("img.rdr-"+a+", iframe.rdr-"+a+",embed.rdr-"+a+",video.rdr-"+a+",object.rdr-"+a).eq(0);b("#rdr_indicator_"+a),b("#rdr_indicator_details_"+a),c.hasClass("rdr-hashed"),c.closest(".rdr, .no-rdr").length;var h=RDR.containers[a];if(h){var i=h.$this;i.data("hover",!0).data("hash",a),RDR.actions.indicators.utils.updateContainerTracker(a),RDR.rindow.mediaRindowShow(i)}},onDisengage:function(a){var c=b("img.rdr-"+a+", iframe.rdr-"+a+",embed.rdr-"+a+",video.rdr-"+a+",object.rdr-"+a).eq(0);b("#rdr_indicator_"+a),b("#rdr_indicator_details_"+a);var f=c.data("timeoutCloseEvt_"+a);clearTimeout(f),f=setTimeout(function(){var b=RDR.containers[a];b&&(c.data("hover",!1).data("hash",a),RDR.rindow.mediaRindowHide(c))},100),c.data("timeoutCloseEvt_"+a,f)},disengageAll:function(){var a=[];b(".rdr_live_hover").each(function(){var c=b(this).data("hash");a.push(c),RDR.actions.containers.media.onDisengage(c)})}},save:function(a){if(RDR.containers.hasOwnProperty(a.hash))return RDR.containers[a.hash];var b=a.id===void 0||null===a.id?null:a.id,c={id:b,body:a.body||null,kind:a.kind,hash:a.hash,HTMLkind:a.HTMLkind||null,$this:a.$this||null};return RDR.containers[a.hash]=c,c},setup:function(a){var c={img:function(a,b){var c=RDR.containers[a],d=c.$this,e=d[0].src,f={body:e,kind:b.kind,container:a,hash:a};RDR.content_nodes[a]=f,RDR.rindow.update(a)},media:function(a,b){this.img(a,b)},text:function(){}},d=[];for(var e in a)for(var g in a[e])if("string"==typeof g&&"object"==typeof a[e][g]){var h=g,i=a[e][g];i.hash=h;var j=RDR.containers[h];if(j){j.$this;var l={},m=i.top_interactions.coms;b.each(m,function(a,b){"text"==i.kind?l[b.tag_id]=b:(l[b.tag_id]||(l[b.tag_id]=[]),l[b.tag_id].push(b))}),i.top_interactions.coms=l,RDR.actions.summaries.save(i),RDR.actions.indicators.update(h,!0);var n=i.kind;"page"!=n&&c[n](h,i),i.counts.tags>0&&d.push(h)}}RDR.actions.summaries.sortPopularTextContainers(),RDR.actions.summaries.displayPopularIndicators(),RDR.actions.indicators.show(d)},send:function(a,c){function k(){d={},e=0,f=0}var g,h,d={},e=0,f=0,j=1400;b.each(a,function(a,c){var i=RDR.containers[c],l={HTMLkind:i.HTMLkind,body:"",hash:i.hash,id:i.id,kind:i.kind};h=encodeURIComponent(b.toJSON(l)),g=h.length,g>j?l=!1:(f+=g,f>j&&(RDR.actions.containers._ajaxSend(d),k()),d[c]=l,e+=g)}),b.isEmptyObject(d)||RDR.actions.containers._ajaxSend(d,c)},_ajaxSend:function(a,c){var d=a;b.ajax({url:RDR_baseUrl+"/api/containers/create/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(d)},success:function(a){var d=a.data,e={};b.each(d,function(a,b){if(b){var c=RDR.containers[a];c.id=b,e[a]=RDR.actions.summaries.init(a)}}),RDR.actions.containers.setup(e),c!==void 0&&c()}})}},content_nodes:{make:function(a){var c,b=a.hash;if(c=a.location?a.container+"-"+a.location:a.container,RDR.content_nodes.hasOwnProperty(c))return RDR.content_nodes[c];var d={container:a.container,body:a.body,location:a.location,hash:b};return RDR.content_nodes[c]=d,d},init:function(a,c){var d=RDR.summaries[a],e={page_id:RDR.util.getPageProperty("id",a),container_id:d.id};b.ajax({url:RDR_baseUrl+"/api/summary/container/content/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(e)},success:function(e){if("success"!==e.status)return!1;var f=e.data;b.each(f,function(c,d){var e=b(".rdr-"+a);try{d.selState=e.selog("save",{serialRange:d.location})}catch(f){d.selState=void 0}}),d.content_nodes=f,"text"==d.kind||(d.top_interactions.coms={},b.each(f,function(a,c){var e=c.top_interactions.coms;b.each(e,function(a,b){d.top_interactions.coms[b.tag_id]=d.top_interactions.coms[b.tag_id]||[],d.top_interactions.coms[b.tag_id].push(b)})})),b(RDR.containers[a].HTMLkind+".rdr-"+a).addClass("rdr_summary_loaded"),c&&c()}})},utils:{getMediaDims:function(a){var b=a.height(),c=a.width();return b&&c?{height:b,width:c}:{}},makeDictSortedByTag:function(a){var c={};return b.each(a,function(a,d){b.each(d.top_interactions.tags,function(a){c.hasOwnProperty(a)||(c[a]=[]),c[a].push(d)})}),c},initHiliteStates:function(a,c){b.each(c,function(b,c){c.selState&&a.data("selStates").push(c.selState)}),a.hover(function(){var a=b(this).data("selStates"),c=a.length?a[a.length-1]:null;c&&b().selog("hilite",c,"on")},function(){var a=b(this).data("selStates"),c=a.length?a[a.length-1]:null;c&&b().selog("hilite",c,"off")})}}},interactions:{ajax:function(a,c,d){var e=a.hash,f=RDR.summaries[e];return f?f.kind:"",d||(d="create"),RDR.actions.interactions.hasOwnProperty(c)?(RDR.actions.interactions[c].preAjax(a,d),RDR.session.getUser(a,function(a){var f=RDR.actions.interactions.defaultSendData(a),g=RDR.actions.interactions[c].customSendData(a),h=b.extend({},f,g);a.sendData=h,a.hash=e,a.sendData.hash=e,RDR.actions.interactions.send(a,c,d)}),void 0):!1},send:function(a,c,d){var e=b.extend(!0,{},a.sendData);e.rindow&&delete e.rindow,e.settings&&delete e.settings,e.selState&&delete e.selState,e.content_node&&delete e.content_node,e.content_node_data&&e.content_node_data.selState&&delete e.content_node_data.selState,e.content_node_data&&e.content_node_data.counts&&delete e.content_node_data.counts,e.content_node_data&&e.content_node_data.top_interactions&&delete e.content_node_data.top_interactions,e.content_node_data&&e.content_node_data.$container&&delete e.content_node_data.$container,e.content_node_data&&e.content_node_data.$indicator&&delete e.content_node_data.$indicator,e.content_node_data&&e.content_node_data.$indicator_details&&delete e.content_node_data.$indicator_details,e.content_node_data&&e.content_node_data.$rindow_readmode&&delete e.content_node_data.$rindow_readmode,e.node&&delete e.node,e.uiMode&&delete e.uiMode,e.sendData&&delete e.sendData,RDR.summaries[e.hash]&&(e.container_kind=RDR.summaries[e.hash].kind),e.content_node_data&&e.content_node_data.container&&delete e.content_node_data.container;var f="react"==c?"tag":c;"tag"==f&&"create"==d&&"page"==e.kind&&(e.hash="page",e.container_kind="text",delete e.content_node_data.hash);var g=RDR_baseUrl+"/api/"+f+"/"+d+"/",h=RDR.session.checkForMaxInteractions(a);h?b.ajax({url:g,type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(e)},success:function(b){a.response=b,b.data&&b.data.container&&(a.container_id=b.data.container.id),b.data&&b.data.num_interactions&&(RDR.user.num_interactions=b.data.num_interactions),"success"==b.status?(a.response.data.interaction?RDR.events.track(d+"_"+f+"::"+a.response.data.interaction.id):a.response.data.deleted_interaction&&RDR.events.track(d+"_"+f+"::"+a.response.data.deleted_interaction.interaction_node.id),a.response.data.deleted_interaction&&(a.deleted_interaction=a.response.data.deleted_interaction),a.scenario=a.response.data.existing?"reactionExists":a.response.data.deleted_interaction?"tagDeleted":"reactionSuccess",a.tag.id===void 0&&(a.tag.id=b.data.interaction.interaction_node.id),RDR.actions.interactions[c].onSuccess[d](a)):"react"==c?RDR.actions.interactions[c].onFail(a):(-1!=b.message.indexOf("Temporary user interaction limit reached")&&(RDR.events.track("temp_limit_hit_r"),RDR.session.showLoginPanel(a)),"existing interaction"==b.message?(a.msgType="existingInteraction",RDR.session.rindowUserMessage.show(a)):RDR.session.handleGetUserFail(a,function(){RDR.actions.interactions.ajax(a,c,"create")})),RDR.util.userLoginState()}}):RDR.session.showLoginPanel(a,function(){RDR.actions.interactions.ajax(a,c,"create")})},defaultSendData:function(a){return a.user_id=RDR.user.user_id,a.readr_token=RDR.user.readr_token,a.group_id=RDR.group.id,a.page_id=a.page_id?a.page_id:RDR.util.getPageProperty("id",a.hash),a},comment:{preAjax:function(a){var b=a.rindow;b&&b.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){},onSuccess:{create:function(a){var b=a.rindow,c=a.hash,d=a.response;a.tag,b&&b.find("div.rdr_loader").css("visibility","hidden");var f=d.data.interaction,g=d.data.content_node?d.data.content_node:d.content_node_data,h=g&&g.id?g.id:"",i=d.data.num_interactions,j=parseInt(a.tag.id,10),k={delta:1,num_interactions:i,id:f.id,body:f.interaction_node.body,content_node:g,content_id:h,tag_id:j,user:a.user,social_user:a.social_user,parent_id:null,parent_interaction_node:a.tag},l={coms:{}};l.coms[j]=k,RDR.actions.content_nodes.init(c,function(){RDR.actions.summaries.update(c,l)}),RDR.util.triggerPublicEvent("comment")},remove:function(a){var b=a.rindow;b&&b.find("div.rdr_loader").css("visibility","hidden")}},onFail:function(a){var b=a.rindow;b&&b.find("div.rdr_loader").css("visibility","hidden")}},share:{preAjax:function(){var a=args.rindow;a&&a.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:function(a){var b=a.rindow;b&&b.find("div.rdr_loader").css("visibility","hidden")},onFail:function(a){var b=a.rindow;b&&b.find("div.rdr_loader").css("visibility","hidden")}},boardadd:{preAjax:function(){var a=args.rindow;a&&a.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:{create:function(a){var c=a.rindow?a.rindow:b("div.rdr_tag_details.rdr_reacted.rdr_live_hover");c.find("div.rdr_loader").css("visibility","hidden");var d=a.board_name.replace(/\s/g,"_"),f=({board_id:a.board_id,int_id:a.int_id},b('<div class="rdr_success">Success!  See <a target="_blank" href="'+RDR_baseUrl+"/board/"+a.board_id+"/"+d+'" class="rdr_seeit_link">your board.</a> <a href="javascript:void(0);" class="rdr_seeit_link rdr_undo">Undo?</a></div>'));c.find(".rdr_select_user_board").append(f).find("select").hide(),f.find("a.rdr_undo").click(function(){a.rindow=c,RDR.actions.interactions.ajax(a,"boarddelete","create")})}}},boarddelete:{preAjax:function(){var a=args.rindow;a&&a.find("div.rdr_loader").css("visibility","visible")},customSendData:function(){return{}},onSuccess:{create:function(a){var b=a.rindow;b&&b.find("div.rdr_loader").css("visibility","hidden"),b.find(".rdr_select_user_board").find("select").show(),b.find(".rdr_select_user_board").find("div.rdr_success").remove();var c=b.find(".rdr_select_user_board select");
c.val(0)}}},react:{preAjax:function(a){var c=a.rindow;c&&c.find("div.rdr_loader").css("visibility","visible")},customSendData:function(a){var e,f,g,c=a.hash,d=RDR.summaries[c];if(a.kind&&"page"==a.kind)e="page",f=a.tag,k={container:c,body:"",kind:e,hash:c},g={tag:f,node:null,content_node_data:k,hash:c,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:a.page_id?a.page_id:RDR.util.getPageProperty("id",c)};else{e=d.kind;var h=b(".rdr-"+c),i=a.rindow;a.tag,f="function"==typeof a.tag.data?a.tag.data("tag"):a.tag;var k={},l=a.content_node||null;if("img"==e||"media"==e||"med"==e){var m=h[0].src;k={container:i.data("container"),body:m,kind:e,hash:c};var n=RDR.actions.content_nodes.utils.getMediaDims(h);b.extend(k,n)}else if(l)k={container:i.data("container"),body:l.body,location:l.location,kind:e,id:l.id};else{var o=i.find("a.rdr_tag_"+f.id).data("content_node_id"),p=o?d.content_nodes[o].selState:i.data("selState");if(!p)return RDR.safeThrow("selState not found:  I cannot figure out why this happens every once in a while"),void 0;k={container:i.data("container"),body:p.text,location:p.serialRange,kind:e}}g={tag:f,node:l,content_node_data:k,hash:k.container,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:RDR.util.getPageProperty("id",c),int_id:a.int_id}}return g},onSuccess:{create:function(a){function E(a){var b={hash:a.hash,kind:"page",page_id:a.page_id,int_id:a.response.data.interaction.id,tag:a.tag,rindow:a.rindow};RDR.actions.interactions.ajax(b,"react","remove")}function F(a){var b={kind:"page",page_id:a.page_id,id:a.response.data.interaction.interaction_node.id,parent_id:null,parent_interaction_node:null,content_id:null,body:a.response.data.interaction.interaction_node.body,delta:1,user:a.user,social_user:a.social_user},c={tags:{}};c.tags[b.id]=b,RDR.actions.summaries.update(a.hash,c,!0,a.page_id)}function G(a){if(RDR.user.user_type){var c=b('<div class="rdr_select_user_board"><strong class="rdr_save_it">Save It:</strong> <select class="rdr_user_boards"><option value="">Choose a board...</option></select></div>');return RDR.user.user_boards!==void 0&&b.each(RDR.user.user_boards,function(a,b){c.find("select").append('<option value="'+b.id+'">'+b.title+"</option>")}),c.find("select").append('<option value="" class="">----------</option>'),c.find("select").append('<option value="create" class="rdr_create_board">Create a new ReadrBoard</option>'),c.find("select").change(function(){var c=b(this).find(":checked");if(isNaN(parseInt(c.val()))){if("create"==c.val()){var e=RDR_baseUrl+"/board_create/?popup=widget",f=window.location.href,g=window.location.protocol+"//"+window.location.host,i=(RDR.engageScriptParams.bookmarklet?"bookmarklet=true":"",b('<div class="rdr_window rdr-board-create-div rdr_widget"><iframe id="rdr-board-create" name="rdr-board-create" src="'+e+"&parentUrl="+f+"&parentHost="+g+'" width="625" height="335" frameborder="0" /></div>'));b("#rdr_sandbox").append(i),b("div.rdr-board-create-div").length&&(RDR.checkingBoardWindow=setInterval(function(){if(!b("div.rdr-board-create-div").length){var d=a.rindow;d&&d.find("div.rdr_loader").css("visibility","hidden"),RDR.session.receiveMessage({},function(){if(RDR.user.new_board_id!==void 0){var c={hash:a.hash,board_id:RDR.user.new_board_id,board_name:RDR.user.new_board_name,int_id:a.response.data.interaction.id,tag:a.tag,rindow:a.rindow};RDR.actions.interactions.ajax(c,"boardadd","create")}}),b.postMessage("reloadXDMframe",RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"]),clearInterval(RDR.checkingBoardWindow)}},250))}}else{var d={hash:a.hash,board_id:parseInt(c.val()),board_name:c.text(),int_id:a.response.data.interaction.id,tag:a.tag,rindow:a.rindow};RDR.actions.interactions.ajax(d,"boardadd","create")}}),c}return""}function H(a){var c=["facebook","twitter","tumblr"],d=a.hash,e=b('<div class="shareWrapper" ></div>');return e.append('<strong class="rdr_share_it">Share It:</strong>'),b.each(c,function(c,f){e.append('<a href="http://'+f+'.com" class="rdr_share_link"><img class="no-rdr" src="'+RDR_staticUrl+"widget/images/social-icons-loose/social-icon-"+f+'.png" /></a>'),e.find("a.rdr_share_link:last").click(function(){RDR.events.trackEventToCloud({category:"share",action:"share_open_attempt",opt_label:"which: "+f+", kind: "+a.kind+", page: "+a.page_id+", tag: "+a.tag.body}),RDR.shareWindow=window.open(RDR_staticUrl+"share.html","readr_share","menubar=1,resizable=1,width=626,height=436");var c=b('meta[property="og:title"]').attr("content")?b('meta[property="og:title"]').attr("content"):b("title").text()?b("title").text():"";return RDR.actions.share_getLink({hash:d,kind:a.kind,sns:f,rindow:{},tag:a.tag,content_node:{content:c,kind:"page"}}),!1})}),e}if(b(".rdr_twtooltip").remove(),a.kind&&"page"==a.kind){var c=b("div.rdr_sbRollover"),d=b('<div class="rdr_info"></div>'),e=G(a),f=H(a),g=a.response.data.existing;if(g){b('<div class="rdr_reactionMessage"></div>');var i=b('<div class="feedbackMsg"><em><strong>You have already given that reaction.</em></strong><span class="pipe"> | </span><span><a href="javascript:void(0);" class="rdr_undo_link">Undo?</a></span></div>');i.find("a.rdr_undo_link").on("click.rdr",{args:a},function(a){var c=a.data.args;c.rindow=b(this).closest(".rdr_tag_details"),E(c)}),d.append(i),d.append(e),d.append(f),c.addClass("rdr_reacted").html(d)}else{b('<div class="rdr_reactSuccess rdr_reactionMessage"></div>');var i=b('<div class="feedbackMsg"><div class="rdr_label_icon"></div><em>Thanks!  You reacted <strong style="color:#008be4;font-style:italic !important;">'+a.tag.body+"</strong>.</em>"+'<span class="pipe"> | </span>'+'<span><a href="javascript:void(0);" class="rdr_undo_link">Undo?</a></span>'+"</div>");i.find("a.rdr_undo_link").on("click.rdr",{args:a},function(a){var c=a.data.args;c.rindow=b(this).closest(".rdr_tag_details"),E(c)}),d.append(i),d.append(e),d.append(f),d.append('<div class="rdr_tipReactToOtherStuff"><strong>Tip:</strong> You can <strong style="color:#008be4;">react to anything on the page</strong>. <ins>Select some text, or roll your mouse over any image or video, and look for this icon: <img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr" style="background:url('+RDR_staticUrl+'widget/images/readr_icons.png) 0px 0px no-repeat;margin:0 0 -5px 0;" /></ins></div>'),c.addClass("rdr_reacted").html(d),F(a)}}else{b("#rdr_loginPanel").remove();var j=a.rindow,k=j.find("table.rdr_tags"),l=j.data("mode")||"writeMode",m=a.response,o=(m.interaction,m.data.interaction.interaction_node),p=a.sendData,q="function"==typeof a.tag.data?a.tag.data("tag"):a.tag;if(m.data.interaction.id,j&&j.find("div.rdr_loader").css("visibility","hidden"),"writeMode"==l&&j.find("a.rdr_custom_tag").length==j.find("a.rdr_custom_tag.rdr_tagged").length){var s=j.width(),t={count:0,id:"custom",body:"Add your own"},u="text"!=a.kind?k.find("td:last-child"):RDR.rindow.pillTable.getNextCell(t,k,s,!0);RDR.rindow.writeCustomTag(u,j,"react")}var w=a.hash,x=RDR.summaries[w];x.kind,a.settings=a.sendData.content_node_data;var z=p.content_node_data;z.hash=z.container,z.kind=p.kind,z=a.content_node||RDR.actions.content_nodes.make(z),x.id=x.id||a.container_id;var A={id:o.id,parent_id:null,parent_interaction_node:q,content_id:null,body:o.body,delta:1,user:a.user,social_user:a.social_user},B={tags:{}};B.tags[A.id]=A,"reactionExists"!=a.scenario&&RDR.actions.summaries.update(w,B),RDR.actions.viewReactionSuccess(a)}RDR.util.triggerPublicEvent("tag",{body:a.tag.body,hash:a.hash,kind:a.kind})},remove:function(a){var b=a.sendData,c=a.response.data.deleted_interaction.interaction_node,d=a.rindow;a.tag,a.int_id,d&&d.find("div.rdr_loader").css("visibility","hidden");var g=b.hash,h={id:c.id,parent_id:null,content_id:null,body:c.body,delta:-1,user:a.user,social_user:a.social_user},i={tags:{}};i.tags[h.id]=h;var j="page"==a.kind;j?RDR.actions.summaries.update(g,i,j,a.page_id):RDR.actions.summaries.update(g,i);var k={msgType:"interactionSuccess",interactionInfo:{type:"tag",body:c.body,remove:!0},rindow:d};d.queue("userMessage",function(){RDR.session.rindowUserMessage.show(k)}),"page"==a.kind?RDR.rindow.updatePageTagMessage(a,"tagDeleted"):RDR.rindow.updateTagMessage({rindow:d,tag:a.tag,scenario:"tagDeleted",args:a})}},onFail:function(a){if(a.kind&&"page"==a.kind){var c='<div style="position:absolute;right:13px;">X</div>';a.response.data&&a.response.data.existing&&a.response.data.existing===!0?c=b('<em>You have already given that reaction.</em><br><br><strong>Tip:</strong> You can <strong style="color:#008be4;">react to anything on the page</strong>. <ins>Select some text, or roll your mouse over any image or video, and look for this icon: <img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr" style="background:url('+RDR_staticUrl+'widget/images/readr_icons.png) 0px 0px no-repeat;margin:0 0 -5px 0;" /></ins>'):-1!=a.response.message.indexOf("Temporary user interaction limit reached")?(RDR.events.track("temp_limit_hit_s"),c=b('<em>To continue adding reactions, please <a href="javascript:void(0);" style="color:#008be4 !important;">log in</a>.</em><br><br><strong>Why:</strong> To encourage <strong style="color:#008be4;">high-quality participation from the community</strong>, <ins>we ask that you log in with Facebook. You\'ll also have a profile where you can revisit your reactions, notes, and comments made using <strong style="color:#008be4;">ReadrBoard</strong>!</ins>'),c.find("a").click(function(){RDR.session.showLoginPanel(a)})):RDR.session.handleGetUserFail(a,function(){RDR.actions.interactions.ajax(a,"react","create")}),"object"==typeof c&&($summary_box=b(".rdr-page-container.rdr-"+a.hash+" div.rdr-summary"),$summary_box.find("div.rdr_info").html(c),$summary_box.find("div.rdr_info").show(400,RDR.actions.indicators.utils.updateContainerTrackers))}else{var d=a.rindow,e=a.response;d&&d.find("div.rdr_loader").css("visibility","hidden"),-1!=e.message.indexOf("Temporary user interaction limit reached")?(RDR.session.receiveMessage(a,function(){RDR.actions.interactions.ajax(a,"react","create")}),RDR.session.showLoginPanel(a)):"existing interaction"==e.message?(a.msgType="existingInteraction",RDR.session.rindowUserMessage.show(a)):RDR.session.handleGetUserFail(a,function(){RDR.actions.interactions.ajax(a,"react","create")})}}},bookmark:{preAjax:function(a){var b=a.rindow;b&&b.find("div.rdr_loader").css("visibility","visible")},customSendData:function(a){var e,f,g,c=a.hash,d=RDR.summaries[c];e=d.kind;var h=b(".rdr-"+c),i=a.rindow;a.tag,f="function"==typeof a.tag.data?a.tag.data("tag"):a.tag;var k={},l=a.content_node||null;if("img"==e||"media"==e||"med"==e){var m=h[0].src;k={container:i.data("container"),body:m,kind:e,hash:c}}else if(l)k={container:i.data("container"),body:l.body,location:l.location,kind:e};else{var n=i.find("a.rdr_tag_"+f.id).data("content_node_id"),o=n?d.content_nodes[n].selState:i.data("selState");k={container:i.data("container"),body:o.text,location:o.serialRange,kind:e}}return g={tag:f,node:l,content_node_data:k,hash:k.container,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:RDR.util.getPageProperty("id",c),int_id:a.int_id}},onSuccess:{create:function(a){var c=a.rindow,e=(c.data("mode")||"writeMode",a.response);e.interaction,e.data.interaction.interaction_node,a.sendData,"function"==typeof a.tag.data?a.tag.data("tag"):a.tag,e.data.interaction.id,c&&c.find("div.rdr_loader").css("visibility","hidden"),a=b.extend(a,{scenario:"bookmarkSuccess"});var k=c.find("div.rdr_bookmark_media").length?c.find("div.rdr_bookmark_media").find("table.rdr_tags"):c.find("table.rdr_tags"),l=c.width(),m={count:0,id:"custom",body:"Add your own"},n=RDR.rindow.pillTable.getNextCell(m,k,l,!0);$custom_pill=RDR.rindow.writeCustomTag(n,c,"bookmark"),RDR.rindow.updateTagMessage(a)},remove:function(a){var b=a.rindow,e=(a.tag,a.int_id,a.deleted_interaction.interaction_node);b&&b.find("div.rdr_loader").css("visibility","hidden");var f={msgType:"interactionSuccess",interactionInfo:{type:"bookmark",body:e.body,remove:!0},rindow:b};b.queue("userMessage",function(){RDR.session.rindowUserMessage.show(f)})}},onFail:function(a){var b=a.rindow;a.tag;var d=a.response;b&&b.find("div.rdr_loader").css("visibility","hidden"),-1!=d.message.indexOf("Temporary user interaction limit reached")?RDR.session.showLoginPanel(a):RDR.session.handleGetUserFail(a,function(){RDR.actions.interactions.ajax(a,"bookmark","create")})}}},indicators:{show:function(a,c){var d=this.fetch(a);1==d.length&&d.removeClass("rdr_dont_show");var e=b.browser.msie?"1":RDR.C.indicatorOpacity;if(!b.browser.msie||b.browser.msie&&parseInt(b.browser.version,10)>8){if(d.not(".rdr_dont_show").css({opacity:"0",visibility:"visible"}),c)return d.not(".rdr_dont_show").css({opacity:e}),void 0;d.filter("div.rdr_indicator_for_text").not(".rdr_dont_show").stop().fadeTo(800,e)}},hide:function(a){var b=this.fetch(a);b.css({opacity:"0",visibility:"hidden"})},fetch:function(a){var c=b();if("string"==typeof a){var d=a;c=b("#rdr_indicator_"+d)}else{var e=a;b.each(e,function(a,d){c=c.add(b("#rdr_indicator_"+d))})}return c},init:function(a){function l(){d.$indicator_body=b('<div class="rdr rdr_indicator_body " />').attr("id",h).appendTo(j).append('<img src="'+RDR_staticUrl+'widget/images/blank.png" class="no-rdr rdr_pin" />','<span class="rdr_count" />'),j.css("visibility","visible")}function m(){j.on("mouseover.showRindow",function(){n();var a=j.hasClass("rdr_helper")&&RDR.group.paragraph_helper;a&&RDR.events.track("paragraph_helper_engage")})}function n(){j.$rindow&&j.$rindow.remove();var b=RDR.rindow.make("readMode",{hash:a});b&&(j.$rindow=b,j.data("isZeroCountIndicator")?(o(),RDR.events.track("paragraph_helper_show"),RDR.events.trackEventToCloud({category:"engage",action:"indicator_helper_rindow_shown",opt_label:"kind: text, hash: "+a})):(RDR.events.track("view_node::"+a,a),RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown",opt_label:"kind: text, hash: "+a})))}function o(){var a=j.$rindow,c=RDR.rindow.makeHeader("Tell us what you think!");a.find(".rdr_header").replaceWith(c),$rindowBody=b('<div class="rdr_body rdr_visiblePanel" />'),$rindowBody.html('<div class="rdr_helper_text rdr_clearfix">Select some text and click <strong>What do you think?</strong><div class="rdr_clear"></div></div>'),a.find("div.rdr_body_wrap").append($rindowBody),RDR.rindow.updateSizes(a,{noAnimate:!0})}function p(b){j.on("mouseover.contentNodeInit",function(){RDR.actions.content_nodes.init(a,b)})}function q(){j.unbind("mouseover.contentNodeInit"),j.triggerHandler("mouseover.showRindow")}var d=RDR.summaries[a],e=d.kind,f=d.$container,g="rdr_indicator_"+a,h="rdr_indicator_body_"+a;if(!f.hasClass("rdr-page-container")){f.addClass("rdr-hasIndicator"),b("#rdr_indicator_"+a).remove(),b("#rdr_container_tracker_"+a).remove(),b("#rdr_indicator_details_"+a).remove();var j=d.$indicator=b('<div class="rdr_indicator" />').attr("id",g).data("hash",a);if(l(),e){if(RDR.actions.indicators.utils.kindSpecificSetup[e](a),"text"==e){f.unbind(".rdr_helper"),f.bind("mouseenter.rdr_helper",function(){var a=j.hasClass("rdr_helper")&&RDR.group.paragraph_helper;a&&RDR.actions.indicators.helpers.over(j)}),f.bind("mouseleave.rdr_helper",function(){var b=j.hasClass("rdr_helper")&&RDR.group.paragraph_helper;b&&RDR.actions.indicators.helpers.out(j)});var k=!(d.counts.tags>0);j.data("isZeroCountIndicator",k),k?(j.addClass("rdr_helper"),m()):p(function(){m(),q()})}RDR.actions.indicators.update(a)}}},update:function(a,b){var d=RDR.summaries[a],e="text"===d.kind;if(b)return e&&d.$container.closest(".rdr-node").find(".rdr_indicator").remove(),RDR.actions.indicators.init(a),void 0;var g=(d.$container,d.$indicator),h=d.$indicator_body,i=d.$indicator_details,j=h.find(".rdr_count"),k=i?i.find("div.rdr_header h1"):!1,l=d.counts.tags>0;l?(e?j.html(RDR.commonUtil.prettyNumber(d.counts.tags)):j.html(RDR.commonUtil.prettyNumber(d.counts.tags)+" Reactions"),k&&k.html(RDR.commonUtil.prettyNumber(d.counts.tags)+" Reactions"),RDR.actions.indicators.show(a)):(j.html('<span class="rdr_react_label">What do you think?</span>'),e&&(RDR.group.paragraph_helper?(RDR.actions.indicators.show(a),g.addClass("rdr_helper")):RDR.actions.indicators.hide(a)))},helpers:{over:function(a){var b=a.data("containerHover");if(!b){a.data("hash"),a.data("containerHover",!0);var d=setTimeout(function(){var b=a.data("containerHover");b&&(RDR.util.cssSuperImportant(a,{display:"inline"}),a.css("opacity",0).animate({opacity:RDR.C.helperIndicators.opacity},RDR.C.helperIndicators.fadeInTime))},RDR.C.helperIndicators.hoverDelay);a.data("hoverTimeout",d)}},out:function(a){var b=a.data("hash"),c=RDR.summaries[b],d=c.$rindow_readmode;if(!d||!d.is(":visible")){a.data("containerHover",!1);var e=a.data("hoverTimeout");clearTimeout(e),RDR.util.cssSuperImportant(a,{display:"none"})}}},utils:{kindSpecificSetup:{img:function(a){function k(){if(b("div.rdr_media_details").not("rdr_loaded").length){var d=c.$indicator_details=b("<div />").attr("id",i).addClass("rdr rdr_indicator_details rdr_widget rdr_widget_bar");b("div.rdr_media_details").html(d),h.addClass("rdr_inline_video"),b("div.rdr_media_details").addClass("rdr_sandbox")}else var d=c.$indicator_details=b("<div />").attr("id",i).addClass("rdr rdr_indicator_details rdr_widget rdr_widget_bar").appendTo("#rdr_indicator_details_wrapper");d.data("container",a),d.data("hash",a),d.data("summary",c),d.addClass("rdr_indicator_details_for_media").click(function(){d.addClass("rdr_live_hover"),RDR.actions.containers.media.onEngage(a)}),e.addClass("rdr_indicator_for_media rdr_indicator_for_media_inline")}var c=RDR.summaries[a],e=(c.$container,c.$indicator),g=(c.$indicator_body,b("#rdr_container_tracker_wrap")),h=b('<div class="rdr_container_tracker" />'),i="rdr_indicator_details_"+a,j=b("#rdr_container_tracker_"+a);return j.length?(RDR.safeThrow("Images are not expected to get re-inited."),void 0):(h.attr("id","rdr_container_tracker_"+a).appendTo(g),k(),e.appendTo(h).on("click",function(){10>b("#rdr_indicator_details_"+a).height()?(RDR.actions.containers.media.onEngage(a),b(this).removeClass("rdr_live_hover"),RDR.events.track("view_node::"+a,a),RDR.events.trackEventToCloud({category:"engage",action:"rindow_shown",opt_label:"kind: media, hash: "+a})):RDR.actions.containers.media.onDisengage(a)}).on("mouseenter",function(){b(this).addClass("rdr_live_hover")}).on("mouseleave",function(){b(this).removeClass("rdr_live_hover")}),RDR.actions.indicators.utils.updateContainerTracker(a),void 0)},media:function(a){this.img(a)},text:function(a){var c=RDR.summaries[a],d=c.$container,e=c.$indicator;c.$indicator_body,b("rdr_actionbar_"+a),e.addClass("rdr_indicator_for_text").addClass("rdr_dont_show"),e.appendTo(d)}},makeDetailsContent:function(a){var d=RDR.summaries[a],e=d.$container,h=(d.$indicator,d.$indicator_body,d.$indicator_details);b("rdr_actionbar_"+a);var j=h.find("div.rdr_body_wrap");j.remove();var k=RDR.rindow.makeDefaultPanelMessage(h),l=RDR.rindow.makeHeader(k),m=b('<div class="rdr rdr_body_wrap rdr_clearfix" />'),n=d.kind,o="img"==n||"imgage"==n||"med"==n||"media"==n;o&&!h.find("div.rdr_view_success").length&&h.data("initialWidth",e.width());var p=h;if(o){var q=RDR.actions.indicators.utils.makeTagsListForMedia(p);q.hasClass("rdr_hiddenPanel")||q.addClass("rdr_visiblePanel")}else var q=RDR.actions.indicators.utils.makeTagsListForText(p);m.append(q),h.empty().append(l,m)},makeTagsListForText:function(a,c){var d=a.data("hash"),e=RDR.summaries[d],f=100,g=b('<div class="rdr_body rdr_tags_list" />'),h=RDR.rindow.pillTable.make(f);if(a.append(h),c?b.each(RDR.group.blessed_tags,function(b,c){if(!h.find("a.rdr_tag_"+c.id).length){var d=RDR.rindow.pillTable.getNextCell(c,h,200);RDR.rindow.pill.make(c,d,a,!1)}}):(RDR.actions.summaries.sortInteractions(d),b.each(e.interaction_order,function(b,c){var d={id:c.tag_id,count:c.tag_count,body:c.tag_body,parent_id:c.parent_id},e=RDR.rindow.pillTable.getNextCell(d,h,200);RDR.rindow.pill.make(d,e,a,c.content_node_id)})),c){var i={count:0,id:"custom",body:"Add your own"},j=RDR.rindow.pillTable.getNextCell(i,h,200);RDR.rindow.writeCustomTag(j,a),a.removeClass("rdr_rewritable")}h.find("tr").each(function(){b(this).find("td:last-child:not(:first-child)").addClass("rdr-last-child")}),1==h.find("tr:eq(0)").find("td").length&&(h.addClass("rdr-one-column"),h.find("td.rdr_has_pillHover").on("mouseenter, mousemove",function(){var a=b(this),c=a.closest("div.rdr_window");thisWidth=c.data("initialWidth")}).on("mouseleave",function(){var a=b(this),c=a.closest("div.rdr_window");thisWidth=c.width()}));var l=1==h.find("td").length?a.width():200;return h.css("max-width","none").width(l),c||(a.on("mouseleave",function(){var c=b(this),d=setTimeout(function(){c.hasClass("rdr_rewritable")&&c.remove()},300);b(this).data("timeoutCloseEvt",d)}).on("mouseenter",function(){var a=b(this).data("timeoutCloseEvt");clearTimeout(a)}),a.find("div.rdr_cell_wrapper").each(function(){b(this).hover(function(){var c=e.content_nodes[b(this).find("a.rdr_tag").data("content_node_id")].selState,d=!a.data("panelState")||1===a.data("panelState");d&&(b().selog("hilite",c,"on"),a.data("selState",c))},function(){var c=e.content_nodes[b(this).find("a.rdr_tag").data("content_node_id")].selState,d=!a.data("panelState")||1===a.data("panelState");d&&b().selog("hilite",c,"off")})})),g.append(h),g},makeTagsListForMedia:function(a){var c=a.data("hash"),d=RDR.summaries[c],e=a.outerWidth(),f=b('<div class="rdr_body rdr_tags_list" />'),g=RDR.rindow.pillTable.make(e);if(g.find("tr").append("<td />"),d.top_interactions&&d.top_interactions.tags){b.each(d.top_interactions.tags,function(b,c){c.id=b;var d=g.find("td:last-child");RDR.rindow.pill.make(c,d,a,!1)}),b.each(RDR.group.blessed_tags,function(b,c){if(!g.find("a.rdr_tag_"+c.id).length){var d=g.find("td:last-child");RDR.rindow.pill.make(c,d,a,!1)}});var i=g.find("td:last-child");RDR.rindow.writeCustomTag(i,a),g.find("tr").each(function(){b(this).find("td:last-child:not(:first-child)").addClass("rdr-last-child")}),1==g.find("tr:eq(0)").find("td").length&&g.addClass("rdr-one-column")}return f.append(g),f},updateContainerTrackers:function(){b.each(RDR.containers,function(a,b){!b.kind||"img"!=b.kind&&"media"!=b.kind&&"med"!=b.kind||RDR.actions.indicators.utils.updateContainerTracker(b.hash)})},updateContainerTracker:function(a){var c=RDR.summaries[a],d=c.$container,e=b("#rdr_container_tracker_"+a),f=RDR.containers[a];if(!f.kind||"text"!=f.kind&&"txt"!=f.kind){var g={top:parseInt(d.css("padding-top"),10),right:parseInt(d.css("padding-right"),10),bottom:parseInt(d.css("padding-bottom"),10),left:parseInt(d.css("padding-left"),10)},h=parseInt(d.css("border-top-width"),10)+parseInt(d.css("border-bottom-width"),10)+parseInt(d.css("border-left-width"),10)+parseInt(d.css("border-right-width"),10),i={};i.top=h?0:g.top,i.left=h?0:g.left,RDR.util.cssSuperImportant(e,{top:d.offset().top+i.top+"px",left:d.offset().left+i.left+"px"},!0),this.updateMediaTracker(a)}},updateInlineIndicator:function(a){var b=RDR.summaries[a],c=b.$container,d=b.$indicator_details;d.css({top:c.offset().bottom,left:c.offset().left,width:c.outerWidth()})},updateMediaTracker:function(a){var c=RDR.summaries[a],d=c.$container,e=c.$indicator,f=c.$indicator_body;if(c.$indicator_details,b("#rdr_container_tracker_"+a),f){var i,j,k=parseInt(d.css("border-top-width"),10)+parseInt(d.css("border-bottom-width"),10)+parseInt(d.css("border-left-width"),10)+parseInt(d.css("border-right-width"),10);k?(i=d.outerWidth(),j=d.outerHeight()):(i=d.width(),j=d.height()),{top:parseInt(d.css("padding-top"),10),right:parseInt(d.css("padding-right"),10),bottom:parseInt(d.css("padding-bottom"),10),left:parseInt(d.css("padding-left"),10)};var o=(f.width(),b.browser.msie&&9>parseInt(b.browser.version,10)?10:0),p=d.height()+o-15;e.data("top",p),RDR.util.cssSuperImportant(e,{left:"4px",top:p+"px"},!0);var q="text"==c.kind?!1:!0;q&&RDR.actions.indicators.utils.updateInlineIndicator(a)}}}},summaries:{init:function(a){var b=RDR.containers[a],c={hash:a,kind:b.kind,id:b.id,counts:{coms:0,tags:0,interactions:0},top_interactions:{coms:{},tags:{}}};return c},save:function(a){var c=a.hash;RDR.summaries.hasOwnProperty(c),RDR.summaries[c]=a,a.$container=b(".rdr-"+c)},update:function(a,c,d,e){function h(a){var b=a.hash,c=a.summary,d=a.interaction_node_type,e=a.id,f=a.diffNode,g=c.top_interactions[d],h=g.hasOwnProperty(e)&&g[e]!==void 0;if(h){var i=g[e];i.count+=f.delta,"tags"==d&&(RDR.actions.summaries.updatePageSummaryTags(b,f),0>=i.count&&delete g[e])}else"tags"==d?(g[e]={count:f.delta,body:f.body,id:e,parent_id:f.parent_id,parent_interaction_node:f.parent_interaction_node},RDR.actions.summaries.updatePageSummaryTags(b,f)):(f.user,g[f.tag_id]={body:f.body,content_node:f.content_node,content_id:f.content_id,id:f.id,social_user:f.social_user,tag_id:f.tag_id,user:f.user,parent_id:f.parent_id,parent_interaction_node:f.parent_interaction_node})}if(d)return b.each(c,function(c,d){b.each(d,function(b,c){c.page_id=e,RDR.actions.summaries.updatePageSummaryTags(a,c)})}),void 0;var f;if(f=RDR.summaries.hasOwnProperty(a)?RDR.summaries[a]:RDR.actions.summaries.init(a),b.each(c,function(c,d){b.each(d,function(b,d){h({hash:a,summary:f,interaction_node_type:c,id:b,diffNode:d}),f.counts[c]+=d.delta,f.counts.interactions+=d.delta,d.int_type=c,RDR.rindow.update(a,d)})}),RDR.actions.summaries.sortInteractions(a),"pageSummary"==a)makeSummaryWidget(RDR.page);else{var g="text"==f.kind;RDR.actions.indicators.update(a,g)}},updatePageSummaryTags:function(a,c){var h,d=c.id,e=c.page_id||RDR.util.getPageProperty("id",a),f=RDR.pages[e],g=f.toptags;b.each(g,function(){this.id==d&&(f.count+=c.delta,this.tag_count+=c.delta,h=!0)}),h||g.push({body:c.body,id:c.id,tag_count:1});var i=f.summary;b.each(i,function(a,b){"tag"==b.kind&&(b.count=b.count+c.delta)});var j=b(".rdr-page-container-"+e),k=j.find(".rdr-page-widget-key");k.rdrWidgetSummary("update"),j.shareWidget("update")},sortInteractions:function(a){function c(a,b){return b.tag_count-a.tag_count}var d=RDR.summaries[a];d.interaction_order=[],b.isEmptyObject(d.content_nodes)||b.each(d.content_nodes,function(a,c){b.each(c.top_interactions.tags,function(b,c){d.interaction_order.push({tag_count:c.count,tag_id:b,tag_body:c.body,content_node_id:a,parent_id:c.parent_id})})}),d.interaction_order.sort(c)},sortPopularTextContainers:function(){function a(a,b){return b.interactions-a.interactions}RDR.text_container_popularity=[],b.each(RDR.summaries,function(a,b){"text"==b.kind&&b.counts.interactions>0&&RDR.text_container_popularity.push({hash:a,interactions:b.counts.interactions})}),RDR.text_container_popularity.sort(a)},displayPopularIndicators:function(){for(var a=0;RDR.group.initial_pin_limit>a;a++)RDR.text_container_popularity[a]&&b("#rdr_indicator_"+RDR.text_container_popularity[a].hash).removeClass("rdr_dont_show")},showLessPopularIndicators:function(){for(var a=[],c=RDR.group.initial_pin_limit;RDR.text_container_popularity.length>c;c++)RDR.text_container_popularity[c]&&RDR.text_container_popularity[c].interactions>0&&(b("#rdr_indicator_"+RDR.text_container_popularity[c].hash).removeClass("rdr_dont_show"),a.push(RDR.text_container_popularity[c].hash));RDR.actions.indicators.show(a)}},insertContainerIcon:function(){},viewContainerReactions:function(){},viewReactionSuccess:function(a){var c=a.tag,d=a.rindow,e=a.response.data.interaction;""==a.content_node?a.response.data.content_node:a.content_node,d.removeClass("rdr_rewritable").addClass("rdr_viewing_more");var g=a.hash,h=RDR.summaries[g],i=h.kind,j="reactionSuccess"==a.scenario?"Success!":"You've already done that",k=RDR.rindow.makeHeader(j);d.find(".rdr_header").replaceWith(k);var l=RDR.rindow.panelCreate(d,"rdr_view_more"),m=d.find("div.rdr_body_wrap");m.append(l),RDR.rindow.updateTagMessage(a);var n="img"==i||"imgage"==i||"med"==i||"media"==i;RDR.rindow.panelShow(d,l,function(){if("text"==i&&a.selState){var c=a.selState;b().selog("hilite",c,"on")}if(n)var e=RDR.actions.indicators.utils.makeTagsListForMedia(d);else var e=RDR.actions.indicators.utils.makeTagsListForText(d);e.addClass("rdr_hiddenPanel");var f="rdr_tags_list";RDR.rindow.panelUpdate(d,f,e),RDR.rindow.panelEnsureFloatWidths(d)}),RDR.events.track("view_reaction_success::"+e.id+"|"+c.id,g)},viewCommentContent:function(a){function r(){var a=b('<div class="rdr_commentBox rdr_innerWrap"></div>').html('<div class="rdr_commentComplete"><div><h4>Leave a comment:</h4></div></div>'),h="because...",j=b('<div class="rdr_comment">'),k=b('<textarea class="commentTextArea">'+h+"</textarea>"),l=b('<div class="rdr_charCount">'+RDR.group.comment_length+" characters left</div>"),m=b('<button id="rdr_comment_on_">Comment</button>');return j.append(k,l,m),k.focus(function(){RDR.events.track("start_comment_lg::"+e.id+"|"+c.id),b(this).val()==h&&b(this).val("")}).blur(function(){""===b(this).val()&&b(this).val(h)}).keyup(function(a){var b=k.val();"27"==a.keyCode||b.length>RDR.group.comment_length&&(b=b.substr(0,RDR.group.comment_length),k.val(b)),k.siblings("div.rdr_charCount").text(RDR.group.comment_length-b.length+" characters left")}),m.click(function(){var j=k.val();if(j.length>RDR.group.comment_length&&(j=j.substr(0,RDR.group.comment_length),k.val(j),k.siblings("div.rdr_charCount").text(RDR.group.comment_length-j.length+" characters left")),j!=h){b.isEmptyObject(e)&&"img"==g.kind?e={body:b("img.rdr-"+g.hash).get(0).src,kind:g.kind,hash:g.hash}:e.kind="text";var l={hash:f,content_node_data:e,comment:j,content:e.body,tag:c,rindow:d,selState:i};RDR.actions.interactions.ajax(l,"comment","create")}else k.focus();return!1}),a.append(j),a}function s(){var a=b('<div class="rdr_back">&lt;&lt; Back</div>');return a.click(function(){RDR.rindow.mediaRindowUpdateTagPanel(d)}),a}function t(){var a;a="text"==h?g.content_nodes[e.id].top_interactions.coms:g.top_interactions.coms[c.id];var d=0;b.isArray(a)||(a=[].push(a)),b.each(a,function(a,b){b.tag_id==c.id&&d++});var f=!b.isEmptyObject(a);if(f){var i=b('<div class="rdr_otherCommentsBox"></div>'),j=b('<div class="rdr_comment_header rdr_innerWrap"><h4>(<span>'+d+"</span>) Comments:</h4></div>");i.append(j);for(var k in a){var l=a[k];if(l.tag_id==c.id){i.show();var m=b('<div class="rdr_commentSet rdr_innerWrap" />'),n=b('<div class="rdr_commentBy" />'),o=b('<div class="rdr_comment" />');b('<div class="rdr_commentReplies" />'),b('<div class="rdr_commentReply" />'),b('<a href="javascript:void(0);">Reply</a>');var s=l&&l.social_user&&l.social_user.img_url?l.social_user.img_url:RDR_staticUrl+"widget/images/anonymousplode.png",t=l&&l.user&&""!==l.user.first_name?l.user.first_name+" "+l.user.last_name:"Anonymous";n.html('<a href="'+RDR_baseUrl+"/user/"+l.user.id+'" target="_blank"><img src="'+s+'" class="no-rdr" /> '+t+"</a>").click(function(){RDR.events.track("click_user_profile")}),o.html('<div class="rdr_comment_body">'+l.body+"</div>"),m.append(n,o),i.append(m)}}return i.find("div.rdr_commentSet:last-child").addClass("rdr_lastchild"),i}}var c=a.tag,d=a.rindow,e=a.content_node;d.removeClass("rdr_rewritable").addClass("rdr_viewing_more");var f=a.hash,g=RDR.summaries[f],h=g.kind;if(a.selState)var i=a.selState;var j=RDR.rindow.makeHeader(c.body);d.find(".rdr_header").replaceWith(j);var k=RDR.rindow.panelCreate(d,"rdr_view_more"),l=d.find("div.rdr_body_wrap");l.append(k);var m=b('<div class="rdr_commentsWrap"></div>'),n=s(),o=t(),p=r();m.append(n,o,p),k.append(m),RDR.rindow.panelShow(d,k,function(){if("text"==h){var a=g.content_nodes[e.id].selState;b().selog("hilite",a,"on"),d.data("selState",a)}}),RDR.events.track("view_comment::"+e.id+"|"+c.id,f)},share_getLink:function(a){var c=a.hash,d=RDR.summaries[c],e=a.kind?a.kind:d.kind;RDR.session.getUser(a,function(d){var g=(d.rindow,d.tag),h=d.content_node_info?d.content_node_info:d.content_node;h.hash||(h.hash=h.container?h.container:d.hash),h.content||(h.content=h.body);var i={hash:c,body:h.content,location:h.location,kind:e};RDR.actions.content_nodes.make(i),b.postMessage("page_hash|"+window.location.hash,RDR_baseUrl+"/static/xdm.html",window.frames["rdr-xdm-hidden"]);
var k={tag:g,hash:h.hash,content_node_data:i,user_id:RDR.user.user_id,readr_token:RDR.user.readr_token,group_id:RDR.group.id,page_id:RDR.util.getPageProperty("id",c),referring_int_id:a.referring_int_id,container_kind:"page"==a.kind?"page":RDR.summaries[c].kind};b.ajax({url:RDR_baseUrl+"/api/share/",type:"get",contentType:"application/json",dataType:"jsonp",data:{json:b.toJSON(k)},success:function(b){a.response=b,"fail"==b.status?-1!=b.message.indexOf("Temporary user interaction limit reached")?RDR.session.showLoginPanel(a):RDR.session.handleGetUserFail(a,function(){RDR.actions.share_getLink(a)}):RDR.actions.shareContent({sns:d.sns,content_node_info:h,short_url:b.data.short_url,reaction:g.body,container_kind:RDR.summaries[c].kind})},error:function(){}})})},shareContent:function(a){function n(){return RDR.group.name?RDR.group.name:document.domain.replace("www.","")}function o(a,b,c){var d=c?b?"&#124;":"|":b?"&raquo;":"\u00bb";return b?a+"&nbsp;"+d+"&nbsp;":a+" "+d}function p(a,b,c){var d="...",e=b-d.length,f=b>=a.length?a:a.substr(0,e)+d;return f=c?'"'+f+'"':f}var b=n(),c=a.content_node_info.content,d="",e="",f=300;switch(a.sns){case"facebook":var g="",h="",i="",j="A ReadrBoard Reaction on "+b;switch(a.container_kind){case"txt":case"text":f=300,e=p(c,f,!0),i=o(a.reaction)+" "+e;break;case"img":case"image":e="[a picture on "+b+"] Check it out: ",RDR_offline&&(c=c.replace("local.readrboard.com:8080","www.readrboard.com"),c=c.replace("localhost:8080","www.readrboard.com")),g="&p[images][0]="+encodeURI(c),i=o(a.reaction)+" "+e;break;case"media":case"med":case"video":e="[a video on "+b+"] Check it out: ",i=o(a.reaction)+" "+e;break;case"page":e="[an article on "+b+"] Check it out: ",i=o(a.reaction)+" "+e}d="http://www.facebook.com/sharer.php?s=100&p[title]="+encodeURI(i)+"&p[url]="+a.short_url+"&p[summary]="+encodeURI(j)+g+h;break;case"twitter":var i="",j="A ReadrBoard Reaction on "+b,k=RDR.group.twitter?"&via="+RDR.group.twitter:"";switch(a.container_kind){case"txt":case"text":f=110-a.reaction.length,e=p(c,f,!0),i=o(a.reaction)+" "+e;break;case"img":case"image":e="[a picture on "+b+"] Check it out: ",i=o(a.reaction)+" "+e;break;case"media":case"med":case"video":e="[a video on "+b+"] Check it out: ",i=o(a.reaction)+" "+e;break;case"page":e="[an article on "+b+"] Check it out: ",i=o(a.reaction)+" "+e}d="http://twitter.com/intent/tweet?url="+a.short_url+k+"&text="+encodeURI(i);break;case"tumblr":var i="";switch(a.container_kind){case"txt":case"text":var j=o(a.reaction,!0)+'&nbsp;[a <a href="'+a.short_url+'">quote</a> on '+b+" via ReadrBoard]";f=300,e=p(c,f),d="http://www.tumblr.com/share/quote?quote="+encodeURIComponent(e)+"&source="+encodeURIComponent(j);break;case"img":case"image":RDR_offline&&(c=c.replace("local.readrboard.com:8080","www.readrboard.com"),c=c.replace("localhost:8080","www.readrboard.com")),i=o(a.reaction,!0);var j='&nbsp;[a <a href="'+a.short_url+'">picture</a> on '+b+" via ReadrBoard]";d="http://www.tumblr.com/share/photo?source="+encodeURIComponent(c)+"&caption="+encodeURIComponent(i+j)+"&click_thru="+encodeURIComponent(a.short_url);break;case"media":case"med":case"video":var l='<iframe src=" '+a.content_node_info.body+' "></iframe>';i=o(a.reaction,!0);var j='&nbsp;[a <a href="'+a.short_url+'">video</a> on '+b+" via ReadrBoard]",m=i+j;d="http://www.tumblr.com/share/video?&embed="+encodeURIComponent(l)+"&caption="+encodeURIComponent(m);break;case"page":var j=o(a.reaction,!0)+'&nbsp;[an <a href="'+a.short_url+'">article</a> on '+b+" via ReadrBoard]";f=300,e=p(c,f),d="http://www.tumblr.com/share/link?url="+encodeURIComponent(a.short_url)+"&description="+encodeURIComponent(j)}break;case"linkedin":}""!==d?RDR.shareWindow&&(RDR.shareWindow.location=d):RDR.shareWindow&&RDR.shareWindow.close()},newUpdateData:function(a){var b=RDR.summaries[a];b.$rindow_readmode,b.$rindow_writemode},updateData:function(a){var b;if("tag"==a.kind){var d=(a.rindow,a.hash),e=a.content,f=a.tag;if(a.range,a.element){var h=a.element.parent().text();count=parseInt(h.substr(1,h.indexOf(")")-1),10)+1,b=h.substr(h.indexOf(")")+2),a.element.text("("+count+")"),a.element.addClass("rdr_tagged")}for(var i in RDR.content_nodes[d].info.content)if(RDR.content_nodes[d].info.content[i].body==e)for(var j in RDR.content_nodes[d].info.content[i].tags)if(RDR.content_nodes[d].info.content[i].tags[j].id==f.id){RDR.content_nodes[d].info.content[i].tags[j].count++;for(var k in RDR.content_nodes[d].info.tags)RDR.content_nodes[d].info.tags[k].id==f.id&&RDR.content_nodes[d].info.tags[k].content[i]&&(RDR.content_nodes[d].info.tags[k].count++,RDR.content_nodes[d].info.tags[k].content[i].count++,RDR.content_nodes[d].info.tag_count++)}}},startSelect:function(a,c,d){function k(a){var c=null,d=!1;return a.parents().each(function(){if(!d){var a=b(this);n(a)&&(c=b(this),d=!0)}}),c}function l(d){var e=d.data("hash");if(m(e))return!1;RDR.rindow.close(b("div.rdr.rdr_window.rdr.rdr_rewritable"));var f=c?{top:parseInt(c.pageY,10),left:parseInt(c.pageX,10)}:{top:a.offset().top,left:a.offset().left};return RDR.actionbar.draw({coords:f,kind:"text",content:g.text,hash:d.data("hash")})}function m(a){var b=RDR.summaries[a]||"undefined";if(!b)return!1;var c=b.$rindow_writemode;return c&&c.filter(":visible").length?c:!1}function n(a){var b=!("block"!=a.css("display")&&"list-item"!=a.css("display")||"none"!=a.css("float")||a.closest(".rdr_indicator").length||a.is("html, body"));return b}RDR.actionbar.closeAll();var e=800;if(!a.closest(".rdr, .no-rdr").length||a.closest(".rdr_indicator").length){var f=null;if(f=n(a)?a:k(a),null!==f){$rdrParent=f.closest(".rdr-hashed");var g=f.selog("save");if(g&&g.serialRange&&g.text&&!/^\s*$/g.test(g.text)&&!(g.text.length>e)){var h="text",i=g.text;if($rdrParent.length&&$rdrParent.hasClass("rdr-hashed")&&!$rdrParent.hasClass("rdr-page-container")){if(d){var j=$rdrParent.data("hash");return d(j,h,i),void 0}return l($rdrParent)}var j=RDR.actions.hashNodes(f);j&&RDR.actions.sendHashes(j,function(){if(d){var a=f.data("hash");return d(a,h,i),void 0}return l(f)})}}}},startSelectFromMouseUp:function(a){var c=b(a.target);RDR.actions.startSelect(c,a)},pages:{save:function(a,b){RDR.pages[b.id]=b},initPageContainer:function(a){var c=RDR.pages[a],d=c.key,e=1==b(RDR.group.post_selector+".rdr-page-key-"+d).length?b(RDR.group.post_selector+".rdr-page-key-"+d):b("body.rdr-page-key-"+d);if(1===e.length){e.removeClass("rdr-page-key-"+d),e.addClass("rdr-page-container-"+a);var f=RDR.util.md5.hex_md5(c.id+"");if(e.get(0).nodeName.toLowerCase(),RDR.actions.containers.save({id:c.id+"",kind:"page",hash:f,HTMLkind:null}),e.data("page_id",c.id+""),RDR.actions.hashNodes(e),c.containers.length>0){var h=[];h[c.id]=[],b.each(c.containers,function(a,b){b.hash!==void 0&&h[c.id].push(b.hash)}),RDR.actions.sendHashes(h)}var i=c;i.key=d,1==e.find(RDR.group.summary_widget_selector).length&&e.find(RDR.group.summary_widget_selector).hasClass("rdr-page-widget-key-"+d)?(i.$anchor=e.find(RDR.group.summary_widget_selector),i.jqFunc="after"):(i.$anchor=b("#rdr-page-summary"),i.jqFunc="append"),b("#rdr_sandbox").append('<div id="rdr_summary_tag_details" />'),(0===b("div.rdr-summary").length||b("div.rdr-summary").length<b(RDR.group.post_selector).length)&&i.$anchor.rdrWidgetSummary(i)}},initShareBox:function(a){var d,c=RDR.group.sharebox_selector;""===c&&(c=RDR.group._summary_widget_selector,d=!0);var e=RDR.util.objLength(RDR.pages)>1,f=e?{readrboard:RDR.group.sharebox_readrboard}:{readrboard:RDR.group.sharebox_readrboard,facebook:RDR.group.sharebox_facebook,twitter:RDR.group.sharebox_twitter,reddit:RDR.group.sharebox_reddit,google:RDR.group.sharebox_google,digg:RDR.group.sharebox_digg,stumble:RDR.group.sharebox_stumble},g=e?RDR.group.sharebox_show&&RDR.group.sharebox_show_multipage:RDR.group.sharebox_show,h={show:g,shouldOwnSummaryBar:RDR.group.sharebox_should_own,fadeInOnLoad:RDR.group.sharebox_fade,socialBrands:f,widgetKeyEl:c,locateWithSummaryWidget:d},i=b(".rdr-page-container-"+a);i.shareWidget(h)}},users:{save:function(){}}}})}function rdr_loadScript(a,b){var c=document.getElementsByTagName("head")[0];if(c){var d=document.createElement("script");d.setAttribute("src",a.src),d.setAttribute("type","text/javascript"),d.readyState?d.onreadystatechange=function(){("loaded"==d.readyState||"complete"==d.readyState)&&(d.onreadystatechange=null,b())}:d.onload=function(){b()},c.appendChild(d)}}function $RFunctions($R){function loadCSS(a){$R.each(a,function(a,b){$R("<link>").attr({href:b,rel:"stylesheet"}).appendTo("body")})}function initCommonUtils(a){a.extend(RDR,{commonUtil:{prettyNumber:function(a){var b=parseInt(a,10);if(isNaN(b)||0>b)return!1;for(var c=["","K","M","B","T"],d=0;c.length>d;d++){var e=Math.pow(10,3*d),f=Math.pow(10,3*(d+1));if(f>b)return""+Math.floor(b/e)+c[d]}}}})}function initPlugins($R){function plugin_jquery_log(a){a.log=function(){window.console&&window.console.log&&window.console.log.apply&&window.console.log.apply(window.console,arguments)},a.fn.log=function(){var b=arguments||this;return a.log(b),this},"undefined"==typeof log&&(log=function(){a.each(arguments,function(b,c){a.log(c)})}),"undefined"!=typeof jQuery&&(jQuery.log=a.log,jQuery.fn.log=a.fn.log)}function plugin_jquery_json($){$.toJSON=function(a){var b=typeof a;if(null===a)return"null";if("undefined"==b)return void 0;if("number"==b||"boolean"==b)return a+"";if("string"==b)return $.quoteString(a);if("object"==b){if(a.constructor===Date){var c=a.getUTCMonth()+1;10>c&&(c="0"+c);var d=a.getUTCDate();10>d&&(d="0"+d);var e=a.getUTCFullYear(),f=a.getUTCHours();10>f&&(f="0"+f);var g=a.getUTCMinutes();10>g&&(g="0"+g);var h=a.getUTCSeconds();10>h&&(h="0"+h);var i=a.getUTCMilliseconds();return 100>i&&(i="0"+i),10>i&&(i="0"+i),'"'+e+"-"+c+"-"+d+"T"+f+":"+g+":"+h+"."+i+'Z"'}if(a.constructor===Array){for(var j=[],k=0;a.length>k;k++)j.push($.toJSON(a[k])||"null");return"["+j.join(",")+"]"}var l=[];for(var m in a){var n,b=typeof m;if("number"==b)n='"'+m+'"';else{if("string"!=b)continue;n=$.quoteString(m)}if("function"!=typeof a[m]){var o=$.toJSON(a[m]);o!==void 0&&l.push(n+":"+o)}}return"{"+l.join(", ")+"}"}},$.evalJSON=function(src){return eval("("+src+")")},$.secureEvalJSON=function(src){var filtered=src;if(filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@"),filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");throw new SyntaxError("Error parsing JSON, source is not valid.")},$.quoteString=function(a){return a.match(_escapeable)?'"'+a.replace(_escapeable,function(a){var b=_meta[a];return"string"==typeof b?b:(b=a.charCodeAt(),"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16))})+'"':'"'+a+'"'};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,_meta={"\b":"\\b","    ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}}function plugin_jquery_cookie(a){a.cookie=function(b,c,d){if(arguments.length>1&&"[object Object]"!=c+""){if(d=a.extend({},d),(null===c||void 0===c)&&(d.expires=-1),"number"==typeof d.expires){var e=d.expires,f=d.expires=new Date;f.setDate(f.getDate()+e)}return c+="",document.cookie=[encodeURIComponent(b),"=",d.raw?c:encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}d=c||{};var g,h=d.raw?function(a){return a}:decodeURIComponent;return(g=RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)").exec(document.cookie))?h(g[1]):null}}function plugin_jquery_postMessage(a){var b,c,e,j,d=1,f=this,g=!1,h="postMessage",i="addEventListener",k=f[h]&&!a.browser.opera;a[h]=function(b,c,e){c&&(b="string"==typeof b?b:a.param(b),e=e||parent,k?e[h](b,c.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):c&&(e.location=c.replace(/#.*$/,"")+"#"+ +new Date+d++ +"&"+b))},a.receiveMessage=j=function(d,h,l){k?(d&&(e&&j(),e=function(b){return"string"==typeof h&&b.origin!==h||a.isFunction(h)&&h(b.origin)===g?g:(d(b),void 0)}),f[i]?f[d?i:"removeEventListener"]("message",e,g):f[d?"attachEvent":"detachEvent"]("onmessage",e)):(b&&clearInterval(b),b=null,d&&(l="number"==typeof h?h:"number"==typeof l?l:100,b=setInterval(function(){var a=document.location.hash,b=/^#?\d+&/;a!==c&&b.test(a)&&(c=a,d({data:a.replace(b,"")}))},l)))}}function plugin_jquery_enhancedOffset(a){var b=a.fn.offset;a.fn.offset=function(){var c=b.call(this),d=c?c.top+this.outerHeight():0,e=c?c.left+this.outerWidth():0,f=arguments;return f.length?this.animate({top:f[0].top||f[0],left:f[0].left||f[1]},(f[0].top?f[1]:f[2])||1):a.extend(c,{bottom:d,right:e})}}function plugin_jquery_rdrWidgetSummary(a){function d(b){function n(b,c){var d=b.offset(),e=b.data("tag_id"),h=(b.data("tag_body"),b.data("tag_count"),a("#rdr_tag_"+e+"_details"));if(h.length||(h=a('<div class="rdr rdr_tag_details rdr_sbRollover" id="rdr_tag_'+e+'_details" />').append("<h1>Loading...</h1>")),a("#rdr_summary_tag_details").append(h),h.hover(function(){a(this).addClass("rdr_live_hover")},function(){var b=a(this);b.hasClass("rdr_reacted")||(b.hide(),b.removeClass("rdr_live_hover"))}),RDR.engageScriptParams.bookmarklet){var i={left:0};h.addClass("rdr_boomarklet"),h.css("left",d.left+i.left+"px").show()}else{var i={top:30,left:0};h.css("top",d.top+i.top+"px").css("left",d.left+i.left+"px").show()}b.closest("div.defaultSummaryBar").length?"right":"top",RDR.interaction_data===void 0&&(RDR.interaction_data={}),c.img>0||c.text>0||c.media>0?RDR.interaction_data[e]===void 0?a.each(RDR.summaries,function(d,e){a.each(e.top_interactions.tags,function(f,g){if(g!==void 0){if(RDR.interaction_data[f]===void 0&&(RDR.interaction_data[f]={}),RDR.interaction_data[f][g.parent_id]={},RDR.interaction_data[f][g.parent_id].hash=d,RDR.interaction_data[f][g.parent_id].container_id=e.id,RDR.interaction_data[f][g.parent_id].tag={body:g.body,id:f},RDR.interaction_data[f][g.parent_id].kind=e.kind,void 0===RDR.summaries[d].content_nodes)return RDR.actions.content_nodes.init(d,function(){a.each(RDR.summaries[d].content_nodes,function(a,b){if(b.top_interactions!==void 0&&b.top_interactions.tags!==void 0&&b.top_interactions.tags[RDR.interaction_data[f][g.parent_id].tag.id]!==void 0){var c=b.top_interactions.tags[RDR.interaction_data[f][g.parent_id].tag.id];RDR.interaction_data[f][g.parent_id].interaction={id:c.parent_id,count:c.count,body:c.body},RDR.interaction_data[f][g.parent_id].content_node={body:b.body,location:b.location,selState:b.selState}}}),o(b,c)}),void 0;a.each(RDR.summaries[d].content_nodes,function(a,b){if(b.top_interactions!==void 0&&b.top_interactions.tags!==void 0&&b.top_interactions.tags[RDR.interaction_data[f][g.parent_id].tag.id]!==void 0){var c=b.top_interactions.tags[RDR.interaction_data[f][g.parent_id].tag.id];RDR.interaction_data[f][g.parent_id].interaction={id:c.parent_id,count:c.count,body:c.body},RDR.interaction_data[f][g.parent_id].content_node={body:b.body,location:b.location,selState:b.selState}}})}})}):o(b,c):o(b,c)}function o(b,c){a().selog("hilite",!0,"off");var d=b.data("tag_id"),e=b.data("tag_body"),f=b.data("tag_count"),g=a("#rdr_tag_"+d+"_details"),h=a('<tr class="rdr_page_reactions"></tr>');if(!g.find("table").length&&(g.html("<h1>"+e+" ("+f+')</h1><table cellpadding="0" cellspacing="0" border="0" />'),c&&c.page)){var i=c.page>1?"reactions":"reaction";g.find("table").append(h),h.append('<td colspan="2"><strong>('+c.page+") "+e+"</strong> "+i+" to this <strong>article</strong></td>")}(c.img>0||c.text>0||c.media>0)&&(h.addClass("has_other_reactions"),a.each(RDR.interaction_data[d],function(b){if(!g.find("tr.rdr_int_summary_"+b).length){var e=a('<tr valign="middle" class="rdr_content_reaction rdr_int_summary_'+b+'"/>'),f=RDR.interaction_data[d][b];if(f.interaction!==void 0&&f.content_node!==void 0){var h=f.interaction.count>1?"reactions":"reaction";if(e.append('<td class="rdr_count"><h4>'+f.interaction.count+"</h4><h5>"+h+"</h5></td>").data("count",f.interaction.count).data("tag_id",d).data("int_id",b),"text"==f.kind?e.append('<td class="rdr_content">'+f.content_node.body+"</td>"):"img"==f.kind?e.append('<td class="rdr_content"><img src="'+f.content_node.body+'" height="50"/></td>'):"media"==f.kind&&e.append('<td class="rdr_content"><img src="'+RDR_baseUrl+'/static/widget/images/video_icon.png" height="33" style="margin-bottom:-10px;"/> <div style="display:inline-block;margin-left:10px;">Video</div></td>'),e.click(function(a){a.preventDefault();var b={container_hash:f.hash,location:f.content_node.location};RDR.session.revealSharedContent(b)}),g.find("tr.rdr_content_reaction").length){var i=g.find("tr.rdr_content_reaction").length-1;a.each(g.find("tr.rdr_content_reaction"),function(b,c){return parseInt(f.interaction.count)>parseInt(a(c).data("count"))?(i=b,!1):void 0}),g.find("tr.rdr_content_reaction:eq("+i+")").before(e)}else g.find("table").append(e)}}}))}function p(b){function d(b,c,d,e){var f=a('<a class="rdr_tag rdr_tag_'+b.id+'" />').data({tag_id:b.id,hash:c,page_id:d.id}),g=a('<span class="rdr_tag_name">'+b.body+"</span>"),h=a('<span class="rdr_tag_count">+</span>');f.append(g,h),e.append(f),f.click(function(){var c=a(this).data("hash"),d=parseInt(a(this).data("page_id"),10);args={tag:b,page_id:d,uiMode:"writeMode",kind:"page",hash:c},RDR.actions.interactions.ajax(args,"react","create")}).hover(function(){a(this).addClass("rdr_hover")},function(){a(this).removeClass("rdr_hover")})}b.hoverIntent(function(){var b=a(this),c=b.closest(".rdr-page-container").data("hash"),e=RDR.pages[RDR.util.getPageProperty("id",c)],f=b.offset();""==RDR.group.call_to_action&&(RDR.group.call_to_action="What do you think?");var g=a('<div class="rdr rdr_tag_details rdr_sbRollover rdr_sbRollover_page" />').append("<h2>"+RDR.group.call_to_action+'<img class="rdr_ui_arrow" src="'+RDR_staticUrl+'widget/images/blank.png" /></h2><div class="rdr_sbRolloverTable"/>');a("#rdr_summary_tag_details").append(g),a.each(RDR.group.blessed_tags,function(a,b){d(b,c,e,g.find("div.rdr_sbRolloverTable"))});var i=a('<a class="rdr_tag rdr_custom_tag rdr_tooltip_this" title="Add your own reaction to this page.  Type it in, then press Enter."><input type="text" value="Add your own" class="rdr_default"/></a>');if(i.find("input").focus(function(){RDR.events.track("start_custom_reaction_summ");var b=a(this);b.removeClass("rdr_default").closest("div.rdr_sbRollover").addClass("rdr_reacted"),"Add your own"==b.val()&&b.val("")}).blur(function(){var b=a(this);""===b.val()&&b.val("Add your own"),"Add your own"==b.val()&&b.addClass("rdr_default").removeClass("rdr_reacted")}).keyup(function(b){var c=a(this),d={},f=c.closest(".rdr-page-container").data("hash");if("13"==b.keyCode)d.body=c.val(),args={tag:d,hash:f,kind:"page",page_id:e.id},RDR.actions.interactions.ajax(args,"react","create"),c.blur();else if("27"==b.keyCode)c.blur();else if(c.val().length>25){var g=c.val();c.val(g.substr(0,25))}}),i.tooltip({placement:h}),g.find("div.rdr_sbRolloverTable").append(i," "),g.hover(function(){a(this).addClass("rdr_live_hover")},function(){var b=a(this);b.hasClass("rdr_reacted")||(b.hide(),b.removeClass("rdr_live_hover"))}),RDR.engageScriptParams.bookmarklet){var j={left:0};g.addClass("rdr_boomarklet"),g.css("left",f.left+ +j.left+"px").show()}else{var j={top:30,left:0};g.css("top",f.top-32+j.top+"px").css("left",f.left+ +j.left+"px").show()}},function(){var b=a(this);b.removeClass("rdr_live_hover");var c=a("#rdr_summary_tag_details").find("div.rdr_sbRollover");c.hasClass("rdr_live_hover")||c.hide()})}function q(b){var d,e;if(0===k.find("a.rdr_tag_"+b.id).length){if(d=b.tag_count?b.tag_count:"+","+"==d)var g='<img class="rdr_ui_arrow" src="'+RDR_staticUrl+'widget/images/blank.png" />';else var g=d;var i=a('<a class="rdr_tag rdr_tag_'+b.id+'"><span class="rdr_tag_name">'+b.body+"</span></a>").data({tag_id:b.id,tag_body:b.body,tag_count:d});e=a('<span class="rdr_tag_count">('+g+")</span>"),i.append(e),k.find("div.rdr-sum-reactions").append(i," "),e.css("width",e.width()+"px"),i.hoverIntent(function(){var b=a(this),c=b.closest(".rdr-page-container").data("hash")?b.closest(".rdr-page-container").data("hash"):b,d=RDR.pages[RDR.util.getPageProperty("id",c)],f=(b.offset(),b.data("tag_id")),g=b.data("tag_body"),h=b.data("tag_count"),i={img:0,text:0,media:0,page:"+"==h?0:h};a.each(d.containers,function(a,b){RDR.summaries&&RDR.summaries[b.hash]&&RDR.summaries[b.hash].top_interactions&&RDR.summaries[b.hash].top_interactions.tags&&RDR.summaries[b.hash].top_interactions.tags[f]&&(i[RDR.summaries[b.hash].kind]+=RDR.summaries[b.hash].top_interactions.tags[f].count,i.page-=RDR.summaries[b.hash].top_interactions.tags[f].count)}),n(b,i),b.addClass("rdr_live_hover"),RDR.events.trackEventToCloud({category:"summarybar",action:"reactions_view",opt_label:"page: "+d.id+", tag: "+g})},function(){var c=a(this);if(c.data("tag_id"),c.removeClass("rdr_live_hover"),!a("#rdr_tag_"+b.id+"_details").hasClass("rdr_live_hover")){a("#rdr_tag_"+b.id+"_details").hide();var e=a(".rdr_tag_details");e.hide()}})}""===d&&e.hide()}var c=b,d="rdr-summary-key-"+c.key;a("."+d).remove();var e=a(c.parentContainer),f=a('<div class="rdr rdr-summary rdr-summary-'+c.id+' rdr-border-box"><table cellpadding="0" cellspacing="0" border="0"><tr/></table></div>').addClass(d),g=f.find("tr");"true"==RDR.engageScriptParams.bookmarklet&&f.addClass("rdr_bookmarklet"),f.data({page_id:c.id,page_key:c.key}),e[c.jqFunc](f);var h=e.hasClass("defaultSummaryBar")?"top":"top";f.find("img.rdr_tooltip_this").tooltip({placement:h});var i=0;a.each(c.summary,function(a,b){b.kind!==void 0&&"tag"==b.kind&&(i=b.count)});var j=a('<div class="rdr-this-is-readrboard"></div>');j.append('<a href="'+RDR_baseUrl+'" target="_blank">'+'<span class="no-rdr rdr-logo" title="This is <strong style=\'color:#4d92da;\'>ReadrBoard</strong>. Click to visit our site to learn more!" src="'+RDR_staticUrl+'widget/images/blank.png" ></span>'+"</a>"),j.click(function(){RDR.events.track("click_rb_icon_summ")});var k=a('<div class="rdr-sum-headline" />'),l=a('<div class="rdr-sum-reactions"/>');k.append(l),l.append(j),g.append(a("<td/>").append(k)),j.find(".rdr-logo").tooltip({placement:"right"}),f.hoverIntent(function(){var b=a(this),c=b.find("div.rdr-sum-headline"),d=c.find("div.rdr-sum-reactions");RDR.events.track("view_summary::"+b.data("page_id")),!b.hasClass("rdr-too-many-reactions")||b.hasClass("rdr_stayExpanded")||c.is(":animated")||c.height(RDR.C.summaryWidgetMaxHeight).css("max-height","none").animate({height:d.height()})},function(){var b=a(this),c=b.find("div.rdr-sum-headline");c.find("div"),!b.hasClass("rdr-too-many-reactions")||b.hasClass("rdr_stayExpanded")||c.is(":animated")||c.animate({height:RDR.C.summaryWidgetMaxHeight})}),""==RDR.group.call_to_action&&(RDR.group.call_to_action="What do you think?");var m=a('<a class="rdr_tag rdr_reactToArticle"><div class="rdr_reactToArticle_inner"><img class="rdr_logo" src="'+RDR_staticUrl+'widget/images/blank.png" />'+"<span>"+RDR.group.call_to_action+'<img class="rdr_arrow" src="'+RDR_staticUrl+'widget/images/blank.png" />'+"</span>"+"</div>"+"</a>");k.find("div.rdr-sum-reactions").append('<a class="rdr_reactions_label">Reactions: </a>'),c.toptags.length>0?(a.each(c.toptags,function(a,b){b&&b.tag_count>0&&q(b,c)}),k.find("div.rdr-sum-reactions a:last-child").addClass("rdr_lastchild")):f.addClass("rdr-summary-no-reactions"),k.find("div.rdr-sum-reactions").append(m),p(m,c),k.find("div").height()>RDR.C.summaryWidgetMaxHeight&&f.addClass("rdr-too-many-reactions"),f.append(a('<div class="rdr_info" />'))}a.fn.rdrWidgetSummary=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist."),void 0):c.init.apply(this,arguments)};var b={},c={init:function(c){var f,e=this[0]===document?a(".rdr-summary"):this;return e.each(function(){f=c?a.extend({},b,c):b,f.parentContainer=this,a(this).data("settings",f),d(f)})},update:function(){var b=this[0]===document?a(".rdr-summary"):this;return b.each(function(){var c=a(this).data("settings");c.summary=RDR.pages[c.id].summary,d(c)})}}}function plugin_jquery_shareWidget(a){function f(b,c,d){return a.each(c,function(c,f){if(f){e.loadingTrackerDict[c]=!0;var g=e.shareToolBrandCode[c](c,d),h=a("<li />").addClass("rdr_social_brand rdr_social_brand_"+c).html(g);b.append(h)}}),b}function g(b){var c=a(this);if(b.show){var g=c.data("page_id"),h=RDR.pages[g].url,i=a("<div />").addClass(e.widgetClass),j=a('<div class="rdr_summaryBarHook"></div>').appendTo(i),l=(a('<div class="rdr_summaryBarWrap"  style="display:none;"></div>').appendTo(j),a('<div class="rdr_innerWrap"></div>').appendTo(i)),m=f(a("<ul />"),b.socialBrands,h);l.append(m);var n=!!b.widgetKeyEl,o=a('<div class="rdr_socialShareWrap" />');return n?c.find(b.widgetKeyEl).prepend(o):(o.appendTo("#rdr_sandbox"),i.addClass("rdr_shareWidget_default")),b.locateWithSummaryWidget&&o.addClass("locateWithSummaryWidget"),o.append(i),d.update.call(this),b.fadeInOnLoad&&i.css({opacity:0}),i}}function h(){var b=a(this),c=b.data("page_id"),d=RDR.pages[c].summary,e=0;a.each(d,function(a,b){"tag"==b.kind&&(e=b.count)}),b.data("pageTagCount",e)}function i(b){var c=a(this);if(b.shouldOwnSummaryBar){var e=c.find(".rdr_summaryBarWrap"),f=c.closest(".rdr-page-container"),g=f.find(".rdr-summary");g.appendTo(e).addClass("rdr_stayExpanded"),RDR.group.summary_widget_selector=".rdr_summaryBarWrap";var h=c.find(".readrBoardSocialWidgetButton");h.unbind(".rbSocialWidgetButton"),h.on("mouseenter.rbSocialWidgetButton",function(){d.openOwnedSummaryWidget.call(c)}).on("mouseleave.rbSocialWidgetButton",function(){});var i=f.find(".rdr_shareWidget");i.unbind(".rbSocialWidgetButton"),i.on("mouseleave.rbSocialWidgetButton",function(a){d.closeOwnedSummaryWidget.call(c,a.relatedTarget)})}}function j(a){var b=a.closest(".rdr-page-container"),c=b.find(".rdr-page-container").length>0,d=b.data("page_id");return c&&d?!0:!1}a.fn.shareWidget=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist."),void 0):d.init.apply(this,arguments)};var b={fadeInOnLoad:!0},c=a(),d={init:function(d){var f=this;f.each(function(){var f=a(this);if(j(f))return f;c=c.add(f);var h=d?a.extend({},b,d):b;f.data("shareWidgetSettings",h),g.call(this,h),e.showIfReady()});var h=6e3;return setTimeout(function(){e.forceShow()},h),f},update:function(){var b=a(this);if(j(b))return b;var c=b.data("shareWidgetSettings");d.renderReadrBoardButton.call(this,c),i.call(this,c)},renderReadrBoardButton:function(){var b=a(this);b.data("shareWidgetSettings");var d=b.find("."+e.widgetClass);h.call(this);var f=d.find(".readrBoardSocialWidgetButton");f.empty();var g=a('<div class="rdr_shareBubble"/>').appendTo(f),i=a('<div class="rdr_bubbleTriangleWrap"/>').appendTo(g),j=a('<div class="rdr_bubbleCount"/>').appendTo(g);a('<div class="rdr_bubbleButton"/>').appendTo(f),i.append('<div class="rdr_innerTriangle"/>'),i.append('<div class="rdr_outerTriangle"/>');var l=b.data("pageTagCount");return j.append("<span>"+e.imports.prettyNumber(l)+"</span>"),b},openOwnedSummaryWidget:function(){var b=a(this),c=b.find(".readrBoardSocialWidgetButton"),d=c.closest(".rdr_shareWidget").find(".rdr_summaryBarWrap"),e=d.find(".rdr-summary"),f=d.width();d.hasClass("visible")||e.is(":animated")||(d.addClass("visible").show(),e.css({left:-f-2}).animate({left:0},function(){})),c.find(".rdr_bubbleButton").addClass("hover")},closeOwnedSummaryWidget:function(b){var c=a(this),d=a(b),e=c.find(".rdr_summaryBarWrap"),f=e.find(".rdr-summary"),g=e.width(),h=c.find(".readrBoardSocialWidgetButton");d.parents().hasClass("rdr")||f.is(":animated")||f.animate({left:-g-2},function(){e.removeClass("visible").hide()}),h.find(".rdr_bubbleButton").removeClass("hover")}},e=window.P={widgetClass:"rdr_shareWidget",loadingTrackerDict:{},isLoadedCallback:function(){c.each(function(){var b=a(this);c=c.not(b);var d=b.data("shareWidgetSettings"),f=b.find("."+e.widgetClass);d.fadeInOnLoad&&setTimeout(function(){f.animate({opacity:1},500)},1e3)})},shareWidgetBrandOnLoad:function(a){a&&delete e.loadingTrackerDict[a],e.showIfReady()},forceShow:function(){a.each(e.loadingTrackerDict,function(b){delete e.loadingTrackerDict[b],a(".rdr_social_brand_"+b).remove()}),e.showIfReady()},showIfReady:function(){var b=a.isEmptyObject(e.loadingTrackerDict);b&&e.isLoadedCallback()},shareToolBrandCode:{readrboard:function(a){var b=[];return b.push('<div class="readrBoardSocialWidgetButton"></div>'),delete e.loadingTrackerDict[a],b.join("")},facebook:function(a){var b=[];return b.push('<div id="fb-root"></div><script type="text/javascript">(function(){ window.READRBOARDCOM.rdr_loadScript(  { src:"//connect.facebook.net/en_US/all.js#xfbml=1&appId=163759626987948", id:"facebook-jssdk" }, function(){ window.READRBOARDCOM.shareWidgetBrandOnLoad("'+a+'"); '+"}) })();</script>"),b.push('<div class="fb-like" data-send="false" data-layout="box_count" data-show-faces="false"></div>'),b.join("")},twitter:function(a){var b=[];return b.push('<a href="https://twitter.com/share" class="twitter-share-button" data-count="vertical" >Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>'),delete e.loadingTrackerDict[a],b.join("")},google:function(a){var b=[];return b.push('<div class="g-plusone" data-size="tall"></div>'),b.push('<script type="text/javascript">(function(){ window.READRBOARDCOM.rdr_loadScript(  {src:"https://apis.google.com/js/plusone.js"}, function(){ gapi.plusone.go();  window.READRBOARDCOM.shareWidgetBrandOnLoad("'+a+'"); '+"}) })();</script>"),b.join("")},reddit:function(a,b){var c=[],d='window.READRBOARDCOM.shareWidgetBrandOnLoad("'+a+'")';return c.push('<iframe class="shareWidgetIframe shareWidgetIframe_reddit" onload=\''+d+"' src=\"http://www.reddit.com/static/button/button2.html?width=51&url="+b+'" height="69" width="51" scrolling="no" frameborder="0"></iframe>'),c.push(),c.join("")},stumble:function(a){var b=[];return b.push('<su:badge layout="5"></su:badge>'),b.push('<script type="text/javascript">(function() {var li = document.createElement("script"); li.type = "text/javascript"; li.async = true;li.src = "https://platform.stumbleupon.com/1/widgets.js";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(li, s);})()</script>'),delete e.loadingTrackerDict[a],b.join("")},digg:function(a){var b=[];return b.push('<div><a class="DiggThisButton DiggMedium"></a></div>'),b.push('<script type="text/javascript">(function(){ window.READRBOARDCOM.rdr_loadScript(  {src:"http://widgets.digg.com/buttons.js"}, function(){ window.READRBOARDCOM.shareWidgetBrandOnLoad("'+a+'"); '+"}) })();</script>"),b.join("")}},imports:{prettyNumber:RDR.commonUtil.prettyNumber}};window.READRBOARDCOM.shareWidgetBrandOnLoad=e.shareWidgetBrandOnLoad}function plugin_jquery_selectionographer(a,b){function j(){return b.getSelection()}function k(c){var f,h,e=g,i=c||{},k={styleName:"rdr_hilite",container:document,serialRange:null,range:null},l={idx:e.length,timestamp:a.now(),interactionID:null,hiliter:null,revisionParent:null,text:""},n=a.extend({},k,i,l);if(n.range||n.serialRange)if(n.range){f=n.range;try{h=b.serializeRange(f,!0,n.container)}catch(q){h=!1}}else n.serialRange&&(h=n.serialRange,f=b.deserializeRange(h,n.container));else{var o=j();if(o.isCollapsed)return!1;f=o.getRangeAt(0);try{h=b.serializeRange(f,!0,n.container)}catch(p){h=!1}}return n.serialRange=h,n.range=f.cloneRange(),n.text=""+n.range,0===n.text.length?!1:(n.hiliter=m(n),n)}function l(a){if(a===!1)return!1;if("object"==typeof a)return a;var b=g,c="string"==typeof a||"number"==typeof a?a:b.length-1,d=b[c];return d?d:!1}function m(c){if(c.hiliter)return c.hiliter;var f,d=c.range,e=c.styleName,g=e+"_"+c.idx;return f=b.createCssClassApplier(g,!0),f["class"]=g,f.get$start=function(){return a(d.startContainer).closest("."+f["class"])
},f.get$end=function(){return a(d.endContainer).closest("."+f["class"])},f.isActive=function(){return f.isAppliedToRange(d)},f}function n(b,c){var e=b.range,f=b.styleName,g=b.hiliter,h=g.isActive();return h||"on"!==c&&"toggle"!==c?!h||"off"!==c&&"toggle"!==c||(g.get$start().removeClass(f+"_start"),g.get$end().removeClass(f+"_end"),a("."+g["class"]).removeClass(f),g.isAppliedToRange(e)&&g.undoToRange(e)):(g.applyToRange(e),a("."+g["class"]).addClass(f),g.get$start().addClass(f+"_start"),g.get$end().addClass(f+"_end"),d.clear()),b}function o(b,c){var d={start:!0,offset:void 0,relOffset:void 0},e=a.extend({},d,c),f=e.start?b.startOffset:b.endOffset;if(e.offset===void 0){if(e.relOffset===void 0)return f;e.offset=f+e.relOffset}try{return e.start?b.setStart(b.startContainer,e.offset):b.setEnd(b.endContainer,e.offset),b}catch(g){return!1}}function p(b,c){var e=h,f={};return c===void 0||null===c?a.each(e,function(a){f[a]=[]}):"string"==typeof c?f[c]=[]:a.each(c,function(a,b){if("string"==typeof b)f[b]=[];else{var c=b[0],d=b.length>1?b.slice(1):[];f[c]=d}}),a.each(f,function(a,c){var d=e[a]||function(){};b=d(b,c)}),b}function q(){var b=a('<div id="rdr_selectionographer_tester" class="no-rdr"/>').hide(),c=[{name:"save",func:"save",attr:void 0},{name:"clear",func:"clear",attr:void 0},{name:"activate",func:"activate",attr:void 0},{name:"modify",func:"modify",attr:void 0},{name:"hilite",func:"hilite",attr:void 0},{name:"find",func:"find",attr:void 0}];a.each(c,function(c,d){var f=a('<div class="rdr_tempButton rdr_tempButton_'+this.name+'"><a href="javascript:void(0);">'+this.name+'</a><input class="input1" /></div>');f.find("a").click(function(){var b,c,f=a(this).parent().find("input").eq(0).val(),g=e.find("input").val();d.attr=""===f?void 0:f,"find"==d.name&&(b=a(g).selog(d.func,d.attr)),"hilite"==d.name?(input2=a(this).parent().find("input").eq(1).val(),c=a(g).selog(d.func,d.attr,input2)):c=a(g).selog(d.func,d.attr)}),b.append(f)});var d=a('<div id="rdr_tempOutput" />').css({"font-size":"12px"}),e=a('<div><span style="margin-left:13px;"> in: </span><input class="input2"  /></div>');b.append(e,d),b.css({position:"fixed","margin-left":"5px",top:"75px"}),b.children(".rdr_tempButton").css({margin:"4px 0"}),b.find("input").css({left:"55px",width:"60px",position:"absolute"}),b.find("input:lt(2)").remove(),b.find(".rdr_tempButton_hilite").append('<input class="" style="left: 100px; position: relative; width:50px;" value="toggle"/>'),a("#rdr_sandbox").append(b)}a.fn.selectionographer=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist."),void 0):d.init.apply(this,arguments)},a.fn.selog=a.fn.selectionographer;var c={},d={init:function(b){var d=this;return b=b||{},q(),d.each(function(){e=a.extend(c,b)})},save:function(a){var e,b=this,c=g,d=a||{};return d.container=d.container||b[0]||document,(e=k(d))?(c[e.idx]=e,e):!1},activate:function(a){var b=l(a);return b?(d.clear(),j().setSingleRange(b.range),b):!1},clear:function(){j().removeAllRanges()},modify:function(a,b){a instanceof Array&&(b=a,a=void 0);var e,f,g,c=l(a);return c?(f=c.range.cloneRange(),f=p(f,b),e={range:f,container:c.container},g=d.save(e)):!1},hilite:function(a,b){var c=b;"string"==typeof a&&isNaN(a)&&(c=a,a=void 0),c=c||"on";var d=l(a);return d?d.serialRange!==void 0&&d.serialRange===!1?!1:(n(d,c),d):!1},helpers:function(a){var b=f[a];return b?b.apply(this,Array.prototype.slice.call(arguments,1)):!1},find:function(b){var e,d=this;return b?(RegExp.escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},b=RegExp.escape(b),e=RegExp(b,"gim"),d.each(function(){for(var b=a(this).text(),c=0,d=0,f=[];(c=e.exec(b))&&5>d;)f.push(c.index),d++;return f})):!1},stack:function(){return g},data:function(a){return i[a]}},e={},f={smartHilite:function(){return d.hilite(d.modify(d.save.apply(this)))},activateRange:function(a){var b={};return a?("string"==typeof a?b.serialRange=a:b.range=a,d.activate(d.save(b))):!1}},g=[],h={filterOutRDRIndicator:function(b){var d=b.commonAncestorContainer,e=a(d).find(".rdr_indicator");if(e.length){var f=b.containsNode(e[0],!0);f&&b.setEndBefore(e[0])}return b},stripWhiteSpace:function(a){var b=""+a,c={},d={};return c.textnode=a.startContainer,c.offset=a.startOffset,c.regx=/^\s+/,c.result=c.regx.exec(b),d.textnode=a.endContainer,d.offset=a.endOffset,d.regx=/\s+$/,d.result=d.regx.exec(b),c.result&&(c.resultStrLen=c.result[0].length,o(a,{relOffset:c.resultStrLen})),d.result&&(d.resultStrLen=d.result[0].length,o(a,{relOffset:-d.resultStrLen,start:!1})),a},firstWordSnap:function(a){var c=a.startContainer,d=a.startOffset;if(0===d)return a;var f={range:b.createRange()};return f.range.setStart(c,0),f.range.setEnd(c,d),f.str0=""+f.range,f.regx1=/\s*\S+$/,f.result1=f.regx1.exec(f.str0),null===f.result1?a:(f.str1=f.result1[0],f.str2=f.str1.replace(/\s*/,""),f.extraWordChars=f.str2.length,o(a,{relOffset:-f.extraWordChars}),a)},lastWordSnap:function(a){var c=a.endContainer,d=a.endOffset;if(0===d)return a;var f={range:b.createRange()};return f.range.setStart(c,d),f.range.setEnd(c,c.length),f.str0=""+f.range,f.regx1=/^\S+(?=(\s|$))/,f.result1=f.regx1.exec(f.str0),null===f.result1?a:(f.str1=f.result1[0],f.extraWordChars=f.str1.length,o(a,{relOffset:f.extraWordChars,start:!1}),a)}},i={stack:g};a(document).selog()}function plugin_jquery_textnodes(a){a.fn.textnodes=function(b){function f(b){return a.map(b.childNodes,function(a){return 8!==a.nodeType?3!==a.nodeType?f(a):3===a.nodeType?a:void 0:void 0})}var c=a("<span/>"),d=this,e=d[0]&&d[0].ownerDocument||document;return b!==void 0&&(a.each(b,function(a,b){var d=e.createTextNode(b);c.append(d)}),d.each(function(){a(this).empty(),a(this).append(c.contents())})),d.map(function(){return f(this)})}}function plugin_jquery_superRange(a){a.fn.superRange=function(b){var c=this,d=b||{};return c.each(function(){var e=this,f=a.extend({contextNode:e,textnodes:a(e).textnodes(),start:null,end:null,startRange:null,endRange:null,text:"",hash:null},d);f=f._parse(),a.each(f.textnodes,function(a,b){f.text+=b.data}),f.hash="make hash here.."})}}function plugin_jquery_improvedCSS(a){a.fn.css2=a.fn.css,a.fn.css=function(){if(arguments.length)return a.fn.css2.apply(this,arguments);for(var e,b=["font-family","font-size","font-weight","font-style","color","text-transform","text-decoration","letter-spacing","word-spacing","lineHeight","text-align","vertical-align","direction","background-color","background-image","background-repeat","background-position","background-attachment","opacity","width","height","top","right","bottom","left","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","position","display","visibility","z-index","overflow-x","overflow-y","white-space","clip","float","clear","cursor","list-style-image","list-style-position","list-style-type","marker-offset"],c=b.length,d={},f=0;c>f;f++)e=b[f],d[e]=a.fn.css2.call(this,e),"lineHeight"==e&&(d[e]=a.fn.css2.call(this,"auto")),e=e===void 0?"auto":e;return d}}function plugin_jquery_hashChange(a){function j(a){return a=a||location.href,"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var f,b=window,c=void 0,d="hashchange",e=document,g=a.event.special,h=e.documentMode,i="on"+d in b&&(h===c||h>7);a.fn[d]=function(a){return a?this.bind(d,a):this.trigger(d)},a.fn[d].delay=50,g[d]=a.extend(g[d],{setup:function(){return i?!1:(a(f.start),void 0)},teardown:function(){return i?!1:(a(f.stop),void 0)}}),f=function(){function n(){var c=j(),e=m(h);c!==h?(l(h=c,e),a(b).trigger(d)):e!==h&&(location.href=location.href.replace(/#.*/,"")+e),g=setTimeout(n,a.fn[d].delay)}var g,f={},h=j(),k=function(a){return a},l=k,m=k;return f.start=function(){g||n()},f.stop=function(){g&&clearTimeout(g),g=c},a.browser.msie&&!i&&function(){var b,c;f.start=function(){b||(c=a.fn[d].src,c=c&&c+j(),b=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){c||l(j()),n()}).attr("src",c||"javascript:0").insertAfter("body")[0].contentWindow,e.onpropertychange=function(){try{"title"===event.propertyName&&(b.document.title=e.title)}catch(a){}})},f.stop=k,m=function(){return j(b.location.href)},l=function(c,f){var g=b.document,h=a.fn[d].domain;c!==f&&(g.title=e.title,g.open(),h&&g.write('<script>document.domain="'+h+'"</script>'),g.close(),b.location.hash=c)}}(),f}()}function plugin_jquery_mousewheel(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),void 0!==c.wheelDeltaY&&(h=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}function plugin_jquery_scrollStartAndStop(a){var b=a.event.special,c="D"+ +new Date,d="D"+(+new Date+1);b.scrollstart={setup:function(){var d,e=function(c){var e=this,f=arguments;d?clearTimeout(d):(c.type="scrollstart",a.event.handle.apply(e,f)),d=setTimeout(function(){d=null},b.scrollstop.latency)};a(this).bind("scroll",e).data(c,e)},teardown:function(){a(this).unbind("scroll",a(this).data(c))}},b.scrollstop={latency:300,setup:function(){var c,e=function(d){var e=this,f=arguments;c&&clearTimeout(c),c=setTimeout(function(){c=null,d.type="scrollstop",a.event.handle.apply(e,f)},b.scrollstop.latency)};a(this).bind("scroll",e).data(d,e)},teardown:function(){a(this).unbind("scroll",a(this).data(d))}}}function plugin_jquery_jScrollPane(a){var b=a,d=void 0;b.fn.jScrollPane=function(a){function c(a,c){function T(c){var f,q,r,t,u,w,x=!1,y=!1;if(e=c,g===d)u=a.scrollTop(),w=a.scrollLeft(),a.css({overflow:"hidden",padding:0}),h=a.innerWidth()+L,i=a.innerHeight(),a.width(h),g=b('<div class="jspPane" />').css("padding",K).append(a.children()),j=b('<div class="jspContainer" />').css({width:h+"px",height:i+"px"}).append(g).appendTo(a);else{if(a.css("width",""),x=e.stickToBottom&&ob(),y=e.stickToRight&&pb(),t=a.innerWidth()+L!=h||a.outerHeight()!=i,t&&(h=a.innerWidth()+L,i=a.innerHeight(),j.css({width:h+"px",height:i+"px"})),!t&&M==k&&g.outerHeight()==l)return a.width(h),void 0;M=k,g.css("width",""),a.width(h),j.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}g.css("overflow","auto"),k=c.contentWidth?c.contentWidth:g[0].scrollWidth,l=g[0].scrollHeight,g.css("overflow",""),m=k/h,n=l/i,o=n>1,p=m>1,p||o?(a.addClass("jspScrollable"),f=e.maintainPosition&&(s||v),f&&(q=mb(),r=nb()),U(),W(),Y(),f&&(kb(y?k-h:q,!1),jb(x?l-i:r,!1)),tb(),qb(),Ab(),e.enableKeyboardNavigation&&vb(),e.clickOnTrack&&ab(),xb(),e.hijackInternalLinks&&zb()):(a.removeClass("jspScrollable"),g.css({top:0,width:j.width()-L}),rb(),ub(),wb(),bb(),yb()),e.autoReinitialise&&!J?J=setInterval(function(){T(e)},e.autoReinitialiseDelay):!e.autoReinitialise&&J&&clearInterval(J),u&&a.scrollTop(0)&&jb(u,!1),w&&a.scrollLeft(0)&&kb(w,!1),a.trigger("jsp-initialised",[p||o])}function U(){o&&(j.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />'))),w=j.find(">.jspVerticalBar"),x=w.find(">.jspTrack"),q=x.find(">.jspDrag"),e.showArrows&&(B=b('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",$(0,-1)).bind("click.jsp",sb),C=b('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",$(0,1)).bind("click.jsp",sb),e.arrowScrollOnHover&&(B.bind("mouseover.jsp",$(0,-1,B)),C.bind("mouseover.jsp",$(0,1,C))),Z(x,e.verticalArrowPositions,B,C)),z=i,j.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){z-=b(this).outerHeight()}),q.hover(function(){q.addClass("jspHover")},function(){q.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",sb),q.addClass("jspActive");var c=a.pageY-q.position().top;return b("html").bind("mousemove.jsp",function(a){db(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",cb),!1}),V())}function V(){x.height(z+"px"),s=0,y=e.verticalGutter+x.outerWidth(),g.width(h-y-L);try{0===w.position().left&&g.css("margin-left",y+"px")}catch(a){}}function W(){p&&(j.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />'))),D=j.find(">.jspHorizontalBar"),E=D.find(">.jspTrack"),t=E.find(">.jspDrag"),e.showArrows&&(H=b('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",$(-1,0)).bind("click.jsp",sb),I=b('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",$(1,0)).bind("click.jsp",sb),e.arrowScrollOnHover&&(H.bind("mouseover.jsp",$(-1,0,H)),I.bind("mouseover.jsp",$(1,0,I))),Z(E,e.horizontalArrowPositions,H,I)),t.hover(function(){t.addClass("jspHover")},function(){t.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",sb),t.addClass("jspActive");var c=a.pageX-t.position().left;return b("html").bind("mousemove.jsp",function(a){fb(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",cb),!1}),F=j.innerWidth(),X())}function X(){j.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){F-=b(this).outerWidth()}),E.width(F+"px"),v=0}function Y(){if(p&&o){var a=E.outerHeight(),c=x.outerWidth();z-=a,b(D).find(">.jspCap:visible,>.jspArrow").each(function(){F+=b(this).outerWidth()}),F-=c,i-=c,h-=a,E.parent().append(b('<div class="jspCorner" />').css("width",a+"px")),V(),X()}p&&g.width(j.outerWidth()-L+"px"),l=g.outerHeight(),n=l/i,p&&(G=Math.ceil(1/m*F),G>e.horizontalDragMaxWidth?G=e.horizontalDragMaxWidth:e.horizontalDragMinWidth>G&&(G=e.horizontalDragMinWidth),t.width(G+"px"),u=F-G,gb(v)),o&&(A=Math.ceil(1/n*z),A>e.verticalDragMaxHeight?A=e.verticalDragMaxHeight:e.verticalDragMinHeight>A&&(A=e.verticalDragMinHeight),q.height(A+"px"),r=z-A,eb(s))}function Z(a,b,c,d){var g,e="before",f="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==e?f=b:b==f&&(e=b,g=c,c=d,d=g),a[e](c)[f](d)}function $(a,b,c){return function(){return _(a,b,this,c),this.blur(),!1}}function _(a,c,d,g){d=b(d).addClass("jspActive");var h,i,j=!0,k=function(){0!==a&&f.scrollByX(a*e.arrowButtonSpeed),0!==c&&f.scrollByY(c*e.arrowButtonSpeed),i=setTimeout(k,j?e.initialDelay:e.arrowRepeatFreq),j=!1};k(),h=g?"mouseout.jsp":"mouseup.jsp",g=g||b("html"),g.bind(h,function(){d.removeClass("jspActive"),i&&clearTimeout(i),i=null,g.unbind(h)})}function ab(){bb(),o&&x.bind("mousedown.jsp",function(a){if(a.originalTarget===d||a.originalTarget==a.currentTarget){var j,c=b(this),g=c.offset(),h=a.pageY-g.top-s,k=!0,m=function(){var b=c.offset(),d=a.pageY-b.top-A/2,g=i*e.scrollPagePercent,o=r*g/(l-i);if(0>h)s-o>d?f.scrollByY(-g):db(d);else{if(!(h>0))return n(),void 0;d>s+o?f.scrollByY(g):db(d)}j=setTimeout(m,k?e.initialDelay:e.trackClickRepeatFreq),k=!1},n=function(){j&&clearTimeout(j),j=null,b(document).unbind("mouseup.jsp",n)};return m(),b(document).bind("mouseup.jsp",n),!1}}),p&&E.bind("mousedown.jsp",function(a){if(a.originalTarget===d||a.originalTarget==a.currentTarget){var j,c=b(this),g=c.offset(),i=a.pageX-g.left-v,l=!0,m=function(){var b=c.offset(),d=a.pageX-b.left-G/2,g=h*e.scrollPagePercent,o=u*g/(k-h);if(0>i)v-o>d?f.scrollByX(-g):fb(d);else{if(!(i>0))return n(),void 0;d>v+o?f.scrollByX(g):fb(d)}j=setTimeout(m,l?e.initialDelay:e.trackClickRepeatFreq),l=!1},n=function(){j&&clearTimeout(j),j=null,b(document).unbind("mouseup.jsp",n)};return m(),b(document).bind("mouseup.jsp",n),!1}})}function bb(){E&&E.unbind("mousedown.jsp"),x&&x.unbind("mousedown.jsp")}function cb(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),q&&q.removeClass("jspActive"),t&&t.removeClass("jspActive")}function db(a,b){o&&(0>a?a=0:a>r&&(a=r),b===d&&(b=e.animateScroll),b?f.animate(q,"top",a,eb):(q.css("top",a),eb(a)))}function eb(b){b===d&&(b=q.position().top),j.scrollTop(0),s=b;var c=0===s,e=s==r,f=b/r,h=-f*(l-i);(N!=c||P!=e)&&(N=c,P=e,a.trigger("jsp-arrow-change",[N,P,O,Q])),hb(c,e),g.css("top",h),a.trigger("jsp-scroll-y",[-h,c,e]).trigger("scroll")}function fb(a,b){p&&(0>a?a=0:a>u&&(a=u),b===d&&(b=e.animateScroll),b?f.animate(t,"left",a,gb):(t.css("left",a),gb(a)))}function gb(b){b===d&&(b=t.position().left),j.scrollTop(0),v=b;var c=0===v,e=v==u,f=b/u,i=-f*(k-h);(O!=c||Q!=e)&&(O=c,Q=e,a.trigger("jsp-arrow-change",[N,P,O,Q])),ib(c,e),g.css("left",i),a.trigger("jsp-scroll-x",[-i,c,e]).trigger("scroll")}function hb(a,b){e.showArrows&&(B[a?"addClass":"removeClass"]("jspDisabled"),C[b?"addClass":"removeClass"]("jspDisabled"))}function ib(a,b){e.showArrows&&(H[a?"addClass":"removeClass"]("jspDisabled"),I[b?"addClass":"removeClass"]("jspDisabled"))}function jb(a,b){var c=a/(l-i);db(c*r,b)}function kb(a,b){var c=a/(k-h);fb(c*u,b)}function lb(a,c,d){var f,g,k,n,o,p,q,r,s,l=0,m=0;try{f=b(a)}catch(t){return}for(g=f.outerHeight(),k=f.outerWidth(),j.scrollTop(0),j.scrollLeft(0);!f.is(".jspPane");)if(l+=f.position().top,m+=f.position().left,f=f.offsetParent(),/^body|html$/i.test(f[0].nodeName))return;n=nb(),p=n+i,n>l||c?r=l-e.verticalGutter:l+g>p&&(r=l-i+g+e.verticalGutter),r&&jb(r,d),o=mb(),q=o+h,o>m||c?s=m-e.horizontalGutter:m+k>q&&(s=m-h+k+e.horizontalGutter),s&&kb(s,d)}function mb(){return-g.position().left}function nb(){return-g.position().top}function ob(){var a=l-i;return a>20&&10>a-nb()}function pb(){var a=k-h;return a>20&&10>a-mb()}function qb(){j.unbind(S).bind(S,function(a,b,c,d){var g=v,h=s;return f.scrollBy(c*e.mouseWheelSpeed,-d*e.mouseWheelSpeed,!1),g==v&&h==s})}function rb(){j.unbind(S)}function sb(){return!1}function tb(){g.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){lb(a.target,!1)})}function ub(){g.find(":input,a").unbind("focus.jsp")}function vb(){function k(){var a=v,b=s;switch(c){case 40:f.scrollByY(e.keyboardSpeed,!1);break;case 38:f.scrollByY(-e.keyboardSpeed,!1);break;case 34:case 32:f.scrollByY(i*e.scrollPagePercent,!1);break;case 33:f.scrollByY(-i*e.scrollPagePercent,!1);break;case 39:f.scrollByX(e.keyboardSpeed,!1);break;case 37:f.scrollByX(-e.keyboardSpeed,!1)}return d=a!=v||b!=s}var c,d,h=[];p&&h.push(D[0]),o&&h.push(w[0]),g.focus(function(){a.focus()}),a.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(a){if(a.target===this||h.length&&b(a.target).closest(h).length){var e=v,f=s;switch(a.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=a.keyCode,k();break;case 35:jb(l-i),c=null;break;case 36:jb(0),c=null}return d=a.keyCode==c&&e!=v||f!=s,!d}}).bind("keypress.jsp",function(a){return a.keyCode==c&&k(),!d}),e.hideFocus?(a.css("outline","none"),"hideFocus"in j[0]&&a.attr("hideFocus",!0)):(a.css("outline",""),"hideFocus"in j[0]&&a.attr("hideFocus",!1))}function wb(){a.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function xb(){if(location.hash&&location.hash.length>1){var a,c;try{a=b(location.hash)}catch(d){return}a.length&&g.find(location.hash)&&(0===j.scrollTop()?c=setInterval(function(){j.scrollTop()>0&&(lb(location.hash,!0),b(document).scrollTop(j.position().top),clearInterval(c))},50):(lb(location.hash,!0),b(document).scrollTop(j.position().top)))}}function yb(){b("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function zb(){yb(),b("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var b,a=this.href.split("#");return a.length>1&&(b=a[1],b.length>0&&g.find("#"+b).length>0)?(lb("#"+b,!0),!1):void 0})}function Ab(){var a,b,c,d,e,g=!1;j.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(f){var h=f.originalEvent.touches[0];a=mb(),b=nb(),c=h.pageX,d=h.pageY,e=!1,g=!0}).bind("touchmove.jsp",function(h){if(g){var i=h.originalEvent.touches[0],j=v,k=s;return f.scrollTo(a+c-i.pageX,b+d-i.pageY),e=e||Math.abs(c-i.pageX)>5||Math.abs(d-i.pageY)>5,j==v&&k==s}}).bind("touchend.jsp",function(){g=!1}).bind("click.jsp-touchclick",function(){return e?(e=!1,!1):void 0})}function Bb(){var b=nb(),c=mb();a.removeClass("jspScrollable").unbind(".jsp"),a.replaceWith(R.append(g.children())),R.scrollTop(b),R.scrollLeft(c)}var e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,f=this,N=!0,O=!0,P=!1,Q=!1,R=a.clone(!1,!1).empty(),S=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";K=a.css("paddingTop")+" "+a.css("paddingRight")+" "+a.css("paddingBottom")+" "+a.css("paddingLeft"),L=(parseInt(a.css("paddingLeft"),10)||0)+(parseInt(a.css("paddingRight"),10)||0),b.extend(f,{reinitialise:function(a){a=b.extend({},e,a),T(a)},scrollToElement:function(a,b,c){lb(a,b,c)},scrollTo:function(a,b,c){kb(a,c),jb(b,c)},scrollToX:function(a,b){kb(a,b)},scrollToY:function(a,b){jb(a,b)},scrollToPercentX:function(a,b){kb(a*(k-h),b)},scrollToPercentY:function(a,b){jb(a*(l-i),b)},scrollBy:function(a,b,c){f.scrollByX(a,c),f.scrollByY(b,c)},scrollByX:function(a,b){a=a>=0?Math.max(a,1):Math.min(a,-1);var c=mb()+a,d=c/(k-h);fb(d*u,b)},scrollByY:function(a,b){a=a>=0?Math.max(a,1):Math.min(a,-1);var c=nb()+a,d=c/(l-i);db(d*r,b)},positionDragX:function(a,b){fb(a,b)},positionDragY:function(a,b){db(a,b)},animate:function(a,b,c,d){var f={};f[b]=c,a.animate(f,{duration:e.animateDuration,ease:e.animateEase,queue:!1,step:d})},getContentPositionX:function(){return mb()},getContentPositionY:function(){return nb()},getContentWidth:function(){return k},getContentHeight:function(){return l},getPercentScrolledX:function(){return mb()/(k-h)},getPercentScrolledY:function(){return nb()/(l-i)},getIsScrollableH:function(){return p},getIsScrollableV:function(){return o},getContentPane:function(){return g},scrollToBottom:function(a){db(r,a)},hijackInternalLinks:function(){zb()},destroy:function(){Bb()}}),T(c)}return a=b.extend({},b.fn.jScrollPane.defaults,a),b.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){a[this]=a[this]||a.speed}),this.each(function(){var d=b(this),e=d.data("jsp");e?e.reinitialise(a):(e=new c(d,a),d.data("jsp",e))})},b.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:d,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}function plugin_jquery_hoverIntent(a){a.fn.hoverIntent=function(b,c){var d={sensitivity:7,interval:150,timeout:0};d=a.extend(d,c?{over:b,out:c}:b);var e,f,g,h,i=function(a){e=a.pageX,f=a.pageY},j=function(b,c){return c.hoverIntent_t=clearTimeout(c.hoverIntent_t),Math.abs(g-e)+Math.abs(h-f)<d.sensitivity?(a(c).unbind("mousemove",i),c.hoverIntent_s=1,d.over.apply(c,[b])):(g=e,h=f,c.hoverIntent_t=setTimeout(function(){j(b,c)},d.interval),void 0)},k=function(a,b){return b.hoverIntent_t=clearTimeout(b.hoverIntent_t),b.hoverIntent_s=0,d.out.apply(b,[a])},l=function(b){var c=a.extend({},b),e=this;e.hoverIntent_t&&(e.hoverIntent_t=clearTimeout(e.hoverIntent_t)),"mouseenter"==b.type?(g=c.pageX,h=c.pageY,a(e).bind("mousemove",i),1!=e.hoverIntent_s&&(e.hoverIntent_t=setTimeout(function(){j(c,e)},d.interval))):(a(e).unbind("mousemove",i),1==e.hoverIntent_s&&(e.hoverIntent_t=setTimeout(function(){k(c,e)},d.timeout)))};return this.bind("mouseenter",l).bind("mouseleave",l)}}function plugin_jquery_twitterTip(a){!function(a){"use strict";var b=function(a,b){this.init("tooltip",a,b)};b.prototype={constructor:b,init:function(b,c,d){var e,f;this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,"manual"!=this.options.trigger&&(e="hover"==this.options.trigger?"mouseenter":"focus",f="hover"==this.options.trigger?"mouseleave":"blur",this.$element.bind(e,this.options.selector,a.proxy(this.enter,this)),this.$element.bind(f,this.options.selector,a.proxy(this.leave,this))),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);c.options.delay&&c.options.delay.show?(c.hoverState="in",setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show()},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);c.options.delay&&c.options.delay.hide?(c.hoverState="out",setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){switch(a=this.tip(),this.setContent(),this.options.animation&&a.addClass("rdr_tw_fade"),f="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/rdr_tw_in/.test(f),a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight,b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g).addClass("rdr_tw_"+f).addClass("rdr_tw_in")}},setContent:function(){var a=this.tip();a.find(".rdr_twtooltip-inner").html(this.getTitle()),a.removeClass("rdr_tw_fade rdr_tw_in rdr_tw_top rdr_tw_bottom rdr_tw_left rdr_tw_right")},hide:function(){function d(){var b=setTimeout(function(){c.off(a.support.transition.end).remove()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.remove()})}var c=this.tip();c.removeClass("rdr_tw_in"),a.support.transition&&this.$tip.hasClass("rdr_tw_fade")?d():c.remove(),a.support.transition&&this.$tip.hasClass("rdr_tw_fade")},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title),a=(""+(a||"")).replace(/(^\s*|\s*$)/,"")},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("rdr_tw_in")?"hide":"show"]()}},a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("tooltip"),f="object"==typeof c&&c;e||d.data("tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.defaults={animation:!0,delay:0,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="rdr rdr_twtooltip"><div class="rdr_twtooltip-arrow"></div><div class="rdr_twtooltip-inner"></div></div>'}}(a)}function plugin_rangy(){var a="ins",b=function(){function a(a,b){var c=typeof a[b];return"function"==c||!("object"!=c||!a[b])||"unknown"==c}function b(a,b){return!("object"!=typeof a[b]||!a[b])}function c(a,b){return a[b]!==void 0}function d(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function e(a){return a&&m(a,l)&&o(a,k)}function f(a){window.alert("Rangy not supported in your browser. Reason: "+a),p.initialized=!0,p.supported=!1}function g(){if(!p.initialized){var c,d=!1,g=!1;for(a(document,"createRange")&&(c=document.createRange(),m(c,j)&&o(c,i)&&(d=!0),c.detach()),(c=b(document,"body")?document.body:document.getElementsByTagName("body")[0])&&a(c,"createTextRange")&&(c=c.createTextRange(),e(c)&&(g=!0)),!d&&!g&&f("Neither Range nor TextRange are implemented"),p.initialized=!0,p.features={implementsDomRange:d,implementsTextRange:g},d=r.concat(q),g=0,c=d.length;c>g;++g)try{d[g](p)}catch(h){b(window,"console")&&a(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",h)}}}function h(a){this.name=a,this.supported=this.initialized=!1}var i=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],j=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],k=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],l=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint"],m=d(a),n=d(b),o=d(c),p={version:"1.2beta2",initialized:!1,supported:!0,util:{isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:m,areHostObjects:n,areHostProperties:o,isTextRange:e},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};p.fail=f,p.warn=function(a){a="Rangy warning: "+a,p.config.alertOnWarn?window.alert(a):window.console!==void 0&&window.console.log!==void 0&&window.console.log(a)},{}.hasOwnProperty?p.util.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}:f("hasOwnProperty not supported");var q=[],r=[];p.init=g,p.addInitListener=function(a){p.initialized?a(p):q.push(a)};var s=[];p.addCreateMissingNativeApiListener=function(a){s.push(a)},p.createMissingNativeApi=function(a){a=a||window,g();for(var b=0,c=s.length;c>b;++b)s[b](a)},h.prototype.fail=function(a){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+a)},h.prototype.warn=function(a){p.warn("Module "+this.name+": "+a)},h.prototype.createError=function(a){return Error("Error in Rangy "+this.name+" module: "+a)},p.createModule=function(a,b){var c=new h(a);p.modules[a]=c,r.push(function(a){b(a,c),c.initialized=!0,c.supported=!0})},p.requireModules=function(a){for(var d,e,b=0,c=a.length;c>b;++b){if(e=a[b],d=p.modules[e],!(d&&d instanceof h))throw Error("Module '"+e+"' not found");if(!d.supported)throw Error("Module '"+e+"' not supported")}};var t=!1;if(n=function(){t||(t=!0,p.initialized||g())},"undefined"==typeof window)f("No window found");else{if("undefined"!=typeof document)return a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",n,!1),a(window,"addEventListener")?window.addEventListener("load",n,!1):a(window,"attachEvent")?window.attachEvent("onload",n):f("Window does not have required addEventListener or attachEvent method"),p;
f("No document found")}}();return b.createModule("DomUtil",function(a,b){function c(a){for(var b=0;a=a.previousSibling;)b++;return b}function d(a,b){var d,c=[];for(d=a;d;d=d.parentNode)c.push(d);for(d=b;d;d=d.parentNode)if(o(c,d))return d;return null}function e(a,b,c){for(c=c?a:a.parentNode;c;){if(a=c.parentNode,a===b)return c;c=a}return null}function f(a){return a=a.nodeType,3==a||4==a||8==a}function g(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function h(a){if(9==a.nodeType)return a;if(a.ownerDocument!==void 0)return a.ownerDocument;if(a.document!==void 0)return a.document;if(a.parentNode)return h(a.parentNode);throw Error("getDocument: no document found for node")}function i(a){return a?f(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">["+a.childNodes.length+"]":a.nodeName:"[No node]"}function j(a){this._next=this.root=a}function k(a,b){this.node=a,this.offset=b}function l(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var m=a.util;m.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),m.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var n=document.createElement("div");m.areHostMethods(n,["insertBefore","appendChild","cloneNode"])||b.fail("Incomplete Element implementation"),n=document.createTextNode("test"),m.areHostMethods(n,["splitText","deleteData","insertData","appendData","cloneNode"])||b.fail("Incomplete Text Node implementation");var o=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1};j.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var b,a=this._current=this._next;if(this._current)if(b=a.firstChild)this._next=b;else{for(b=null;a!==this.root&&!(b=a.nextSibling);)a=a.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}},k.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+i(this.node)+":"+this.offset+")]"}},l.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},l.prototype.toString=function(){return this.message},a.dom={arrayContains:o,getNodeIndex:c,getNodeLength:function(a){var b;return f(a)?a.length:(b=a.childNodes)?b.length:0},getCommonAncestor:d,isAncestorOf:function(a,b,c){for(b=c?b:b.parentNode;b;){if(b===a)return!0;b=b.parentNode}return!1},getClosestAncestorIn:e,isCharacterDataNode:f,insertAfter:g,splitDataNode:function(a,b){var c=a.cloneNode(!1);return c.deleteData(0,b),a.deleteData(b,a.length-b),g(c,a),c},getDocument:h,getWindow:function(a){if(a=h(a),a.defaultView!==void 0)return a.defaultView;if(a.parentWindow!==void 0)return a.parentWindow;throw Error("Cannot get a window object for node")},getIframeWindow:function(a){if(a.contentWindow!==void 0)return a.contentWindow;if(a.contentDocument!==void 0)return a.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(a){if(a.contentDocument!==void 0)return a.contentDocument;if(a.contentWindow!==void 0)return a.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(a){return m.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},comparePoints:function(a,b,f,g){var h;if(a==f)return b===g?0:g>b?-1:1;if(h=e(f,a,!0))return c(h)>=b?-1:1;if(h=e(a,f,!0))return g>c(h)?-1:1;if(b=d(a,f),a=a===b?b:e(a,b,!0),f=f===b?b:e(f,b,!0),a===f)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(b=b.firstChild;b;){if(b===a)return-1;if(b===f)return 1;b=b.nextSibling}throw Error("Should not be here!")},inspectNode:i,createIterator:function(a){return new j(a)},DomPosition:k},a.DOMException=l}),b.createModule("DomRange",function(a){function b(a,b){return 3!=a.nodeType&&(H.isAncestorOf(a,b.startContainer,!0)||H.isAncestorOf(a,b.endContainer,!0))}function c(a){return H.getDocument(a.startContainer)}function d(a,b,c){if(b=a._listeners[b])for(var d=0,e=b.length;e>d;++d)b[d].call(a,{target:a,args:c})}function e(a){return new I(a.parentNode,H.getNodeIndex(a))}function f(a){return new I(a.parentNode,H.getNodeIndex(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return H.isCharacterDataNode(b)?c==b.length?H.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:H.splitDataNode(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a){for(var b,d,e=c(a.range).createDocumentFragment();d=a.next();){if(b=a.isPartiallySelectedSubtree(),d=d.cloneNode(!b),b&&(b=a.getSubtreeIterator(),d.appendChild(h(b)),b.detach(!0)),10==d.nodeType)throw new J("HIERARCHY_REQUEST_ERR");e.appendChild(d)}return e}function i(a,b,c){var d,e;for(c=c||{stop:!1};d=a.next();)if(a.isPartiallySelectedSubtree()){if(b(d)===!1)return c.stop=!0,void 0;if(d=a.getSubtreeIterator(),i(d,b,c),d.detach(!0),c.stop)return}else for(d=H.createIterator(d);e=d.next();)if(b(e)===!1)return c.stop=!0,void 0}function j(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),j(b),b.detach(!0)):a.remove()}function k(a){for(var b,e,d=c(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),e=a.getSubtreeIterator(),b.appendChild(k(e)),e.detach(!0)):a.remove(),10==b.nodeType)throw new J("HIERARCHY_REQUEST_ERR");d.appendChild(b)}return d}function l(a,b,c){var e,d=!(!b||!b.length),f=!!c;d&&(e=RegExp("^("+b.join("|")+")$"));var g=[];return i(new n(a,!1),function(a){d&&!e.test(a.nodeType)||f&&!c(a)||g.push(a)}),g}function m(a){return"["+(a.getName===void 0?"Range":a.getName())+"("+H.inspectNode(a.startContainer)+":"+a.startOffset+", "+H.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function n(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&H.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||H.isCharacterDataNode(this.sc)?H.getClosestAncestorIn(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||H.isCharacterDataNode(this.ec)?H.getClosestAncestorIn(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function o(a){this.code=this[a],this.codeName=a,this.message="RangeException: "+this.codeName}function p(a,b,c){this.nodes=l(a,b,c),this._next=this.nodes[0],this._position=0}function q(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,H.arrayContains(a,d))return e;e=e.parentNode}return null}}function r(a,b){if(R(a,b))throw new o("INVALID_NODE_TYPE_ERR")}function s(a){if(!a.startContainer)throw new J("INVALID_STATE_ERR")}function t(a,b){if(!H.arrayContains(b,a.nodeType))throw new o("INVALID_NODE_TYPE_ERR")}function u(a,b){if(0>b||b>(H.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new J("INDEX_SIZE_ERR")}function v(a,b){if(P(a,!0)!==P(b,!0))throw new J("WRONG_DOCUMENT_ERR")}function w(a){if(Q(a,!0))throw new J("NO_MODIFICATION_ALLOWED_ERR")}function x(a,b){if(!a)throw new J(b)}function y(a){if(s(a),!((H.arrayContains(L,a.startContainer.nodeType)||P(a.startContainer,!0))&&(H.arrayContains(L,a.endContainer.nodeType)||P(a.endContainer,!0))&&a.startOffset<=(H.isCharacterDataNode(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length)&&a.endOffset<=(H.isCharacterDataNode(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")")}function z(){}function A(a){a.START_TO_START=T,a.START_TO_END=U,a.END_TO_END=V,a.END_TO_START=W,a.NODE_BEFORE=X,a.NODE_AFTER=Y,a.NODE_BEFORE_AND_AFTER=Z,a.NODE_INSIDE=$}function B(a){A(a),A(a.prototype)}function C(a,b){return function(){y(this);var c=this.startContainer,d=this.startOffset,e=this.commonAncestorContainer,g=new n(this,!0);return c!==e&&(c=H.getClosestAncestorIn(c,e,!0),d=f(c),c=d.node,d=d.offset),i(g,w),g.reset(),e=a(g),g.detach(),b(this,c,d,c,d),e}}function D(c,d,g){function h(a,b){return function(c){s(this),t(c,K),t(O(c),L),c=(a?e:f)(c),(b?i:l)(this,c.node,c.offset)}}function i(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==this.startOffset)&&((O(b)!=O(e)||1==H.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function l(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==this.endOffset)&&((O(b)!=O(e)||-1==H.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}function m(a,b,c){(b!==a.startContainer||c!==this.startOffset||b!==a.endContainer||c!==this.endOffset)&&d(a,b,c,b,c)}c.prototype=new z,a.util.extend(c.prototype,{setStart:function(a,b){s(this),r(a,!0),u(a,b),i(this,a,b)},setEnd:function(a,b){s(this),r(a,!0),u(a,b),l(this,a,b)},setStartBefore:h(!0,!0),setStartAfter:h(!1,!0),setEndBefore:h(!0,!1),setEndAfter:h(!1,!1),collapse:function(a){y(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){s(this),r(a,!0),d(this,a,0,a,H.getNodeLength(a))},selectNode:function(a){s(this),r(a,!1),t(a,K);var b=e(a);a=f(a),d(this,b.node,b.offset,a.node,a.offset)},extractContents:C(k,d),deleteContents:C(j,d),canSurroundContents:function(){y(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},detach:function(){g(this)},splitBoundaries:function(){y(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=a===c;H.isCharacterDataNode(c)&&e>0&&c.length>e&&H.splitDataNode(c,e),H.isCharacterDataNode(a)&&b>0&&a.length>b&&(a=H.splitDataNode(a,b),f?(e-=b,c=a):c==a.parentNode&&e>=H.getNodeIndex(a)&&e++,b=0),d(this,a,b,c,e)},normalizeBoundaries:function(){y(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,e=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},g=function(d){var f=d.previousSibling;if(f&&f.nodeType==d.nodeType){a=d;var g=d.length;b=f.length,d.insertData(0,f.data),f.parentNode.removeChild(f),a==c?(e+=b,c=a):c==d.parentNode&&(f=H.getNodeIndex(d),e==f?(c=d,e=g):e>f&&e--)}},h=!0;H.isCharacterDataNode(c)?c.length==e&&f(c):(e>0&&(h=c.childNodes[e-1])&&H.isCharacterDataNode(h)&&f(h),h=!this.collapsed),h?H.isCharacterDataNode(a)?0==b&&g(a):a.childNodes.length>b&&(f=a.childNodes[b])&&H.isCharacterDataNode(f)&&g(f):(a=c,b=e),d(this,a,b,c,e)},collapseToPoint:function(a,b){y(this),r(a,!0),u(a,b),m(this,a,b)}}),B(c)}function E(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:H.getCommonAncestor(a.startContainer,a.endContainer)}function F(a,b,c,e,f){var g=a.startContainer!==b||a.startOffset!==c,h=a.endContainer!==e||a.endOffset!==f;a.startContainer=b,a.startOffset=c,a.endContainer=e,a.endOffset=f,E(a),d(a,"boundarychange",{startMoved:g,endMoved:h})}function G(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},E(this)}a.requireModules(["DomUtil"]);var H=a.dom,I=H.DomPosition,J=a.DOMException;n.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,H.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var b,c,a=this._current;!H.isCharacterDataNode(a)||a!==this.sc&&a!==this.ec?a.parentNode&&a.parentNode.removeChild(a):(b=a===this.sc?this.so:0,c=a===this.ec?this.eo:a.length,b!=c&&a.deleteData(b,c-b))},isPartiallySelectedSubtree:function(){return b(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new G(c(this.range));var b=this._current,d=b,e=0,f=b,g=H.getNodeLength(b);H.isAncestorOf(b,this.sc,!0)&&(d=this.sc,e=this.so),H.isAncestorOf(b,this.ec,!0)&&(f=this.ec,g=this.eo),F(a,d,e,f,g)}return new n(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},o.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},o.prototype.toString=function(){return this.message},p.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var K=[1,3,4,5,7,8,10],L=[2,9,11],M=[1,3,4,5,7,8,10,11],N=[1,3,4,5,7,8],O=H.getRootContainer,P=q([9,11]),Q=q([5,6,10,12]),R=q([6,10,12]),S=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],T=0,U=1,V=2,W=3,X=0,Y=1,Z=2,$=3;z.prototype={attachListener:function(a,b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){y(this),v(this.startContainer,b.startContainer);var c=a==W||a==T?"start":"end",d=a==U||a==T?"start":"end";return H.comparePoints(this[c+"Container"],this[c+"Offset"],b[d+"Container"],b[d+"Offset"])},insertNode:function(a){if(y(this),t(a,M),w(this.startContainer),H.isAncestorOf(a,this.startContainer,!0))throw new J("HIERARCHY_REQUEST_ERR");this.setStartBefore(g(a,this.startContainer,this.startOffset))},cloneContents:function(){y(this);var a,b;return this.collapsed?c(this).createDocumentFragment():this.startContainer===this.endContainer&&H.isCharacterDataNode(this.startContainer)?(a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b):(b=new n(this,!0),a=h(b),b.detach(),a)},canSurroundContents:function(){y(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},surroundContents:function(a){if(t(a,N),!this.canSurroundContents())throw new o("BAD_BOUNDARYPOINTS_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){y(this);for(var d,a=new G(c(this)),b=S.length;b--;)d=S[b],a[d]=this[d];return a},toString:function(){y(this);var a=this.startContainer;if(a===this.endContainer&&H.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[];return a=new n(this,!0),i(a,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),a.detach(),b.join("")},compareNode:function(a){y(this);var b=a.parentNode,c=H.getNodeIndex(a);if(!b)throw new J("NOT_FOUND_ERR");return a=this.comparePoint(b,c),b=this.comparePoint(b,c+1),0>a?b>0?Z:X:b>0?Y:$},comparePoint:function(a,b){return y(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),0>H.comparePoints(a,b,this.startContainer,this.startOffset)?-1:H.comparePoints(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:function(a){s(this);var b=c(this),d=b.createElement("div");for(d.innerHTML=a,a=b.createDocumentFragment();b=d.firstChild;)a.appendChild(b);return a},toHtml:function(){y(this);var a=c(this).createElement("div");return a.appendChild(this.cloneContents()),a.innerHTML},intersectsNode:function(a,b){if(y(this),x(a,"NOT_FOUND_ERR"),H.getDocument(a)!==c(this))return!1;var d=a.parentNode,e=H.getNodeIndex(a);x(d,"NOT_FOUND_ERR");var f=H.comparePoints(d,e,this.endContainer,this.endOffset);return d=H.comparePoints(d,e+1,this.startContainer,this.startOffset),b?0>=f&&d>=0:0>f&&d>0},isPointInRange:function(a,b){return y(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),H.comparePoints(a,b,this.startContainer,this.startOffset)>=0&&0>=H.comparePoints(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a,b){if(y(this),c(a)!=c(this))throw new J("WRONG_DOCUMENT_ERR");var d=H.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),e=H.comparePoints(this.endContainer,this.endOffset,a.startContainer,a.startOffset);return b?0>=d&&e>=0:0>d&&e>0},intersection:function(a){if(this.intersectsRange(a)){var b=H.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=H.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();return-1==H.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==H.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new o("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==$},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&0>=this.comparePoint(a,H.getNodeLength(a))},containsRange:function(a){return this.intersection(a).equals(a)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);return c.length>0?(b.setStart(c[0],0),a=c.pop(),b.setEnd(a,a.length),a=this.containsRange(b),b.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,b){return y(this),new p(this,a,b)},getNodes:function(a,b){return y(this),l(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){s(this),this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){s(this),this.setStartAfter(a),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return G.rangesEqual(this,a)},inspect:function(){return m(this)}},D(G,F,function(a){s(a),a.startContainer=a.startOffset=a.endContainer=a.endOffset=null,a.collapsed=a.commonAncestorContainer=null,d(a,"detach",null),a._listeners=null}),a.rangePrototype=z.prototype,G.rangeProperties=S,G.RangeIterator=n,G.copyComparisonConstants=B,G.createPrototypeRange=D,G.inspect=m,G.getRangeDocument=c,G.rangesEqual=function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset},a.DomRange=G,a.RangeException=o}),b.createModule("WrappedRange",function(b){function c(b,c,d,e){var h=b.duplicate();h.collapse(d);var i=h.parentElement();if(f.isAncestorOf(c,i,!0)||(i=c),!i.canHaveHTML)return new g(i.parentNode,f.getNodeIndex(i));c=f.getDocument(i).createElement(a);var j,k=d?"StartToStart":"StartToEnd";do i.insertBefore(c,c.previousSibling),h.moveToElementText(c);while((j=h.compareEndPoints(k,b))>0&&c.previousSibling);if(k=c.nextSibling,-1==j&&k&&f.isCharacterDataNode(k)){if(h.setEndPoint(d?"EndToStart":"EndToEnd",b),/[\r\n]/.test(k.data))for(i=h.duplicate(),d=i.text.replace(/\r\n/g,"\r").length,d=i.moveStart("character",d);-1==i.compareEndPoints("StartToEnd",i);)d++,i.moveStart("character",1);else d=h.text.length;i=new g(k,d)}else k=(e||!d)&&c.previousSibling,i=(d=(e||d)&&c.nextSibling)&&f.isCharacterDataNode(d)?new g(d,0):k&&f.isCharacterDataNode(k)?new g(k,k.length):new g(i,f.getNodeIndex(c));return c.parentNode.removeChild(c),i}function d(b,c){var d,e,g=b.offset,h=f.getDocument(b.node),i=h.body.createTextRange(),j=f.isCharacterDataNode(b.node);return j?(d=b.node,e=d.parentNode):(d=b.node.childNodes,d=d.length>g?d[g]:null,e=b.node),h=h.createElement(a),h.innerHTML="&#feff;",d?e.insertBefore(h,d):e.appendChild(h),i.moveToElementText(h),i.collapse(!c),e.removeChild(h),j&&i[c?"moveStart":"moveEnd"]("character",g),i}b.requireModules(["DomUtil","DomRange"]);var e,f=b.dom,g=f.DomPosition,h=b.DomRange;if(!b.features.implementsDomRange||b.features.implementsTextRange&&b.config.preferTextRange){if(b.features.implementsTextRange){e=function(a){this.textRange=a,this.refresh()},e.prototype=new h(document),e.prototype.refresh=function(){var a,b,d=this.textRange;a=d.parentElement();var e=d.duplicate();e.collapse(!0),b=e.parentElement(),e=d.duplicate(),e.collapse(!1),d=e.parentElement(),b=b==d?b:f.getCommonAncestor(b,d),b=b==a?b:f.getCommonAncestor(a,b),0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?b=a=c(this.textRange,b,!0,!0):(a=c(this.textRange,b,!0,!1),b=c(this.textRange,b,!1,!1)),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},e.rangeToTextRange=function(a){if(a.collapsed)return d(new g(a.startContainer,a.startOffset),!0);var b=d(new g(a.startContainer,a.startOffset),!0),c=d(new g(a.endContainer,a.endOffset),!1);return a=f.getDocument(a.startContainer).body.createTextRange(),a.setEndPoint("StartToStart",b),a.setEndPoint("EndToEnd",c),a},h.copyComparisonConstants(e);var i=function(){return this}();i.Range===void 0&&(i.Range=e),b.createNativeRange=function(a){return a=a||document,a.body.createTextRange()}}}else(function(){function a(a){for(var d,b=c.length;b--;)d=c[b],a[d]=a.nativeRange[d]}var b,d,g,c=h.rangeProperties;e=function(b){if(!b)throw Error("Range must be specified");this.nativeRange=b,a(this)},h.createPrototypeRange(e,function(a,b,c,d,e){var f=a.endContainer!==d||a.endOffset!=e;(a.startContainer!==b||a.startOffset!=c||f)&&(a.setEnd(d,e),a.setStart(b,c))},function(a){a.nativeRange.detach(),a.detached=!0;for(var d,b=c.length;b--;)d=c[b],a[d]=null}),b=e.prototype,b.selectNode=function(b){this.nativeRange.selectNode(b),a(this)},b.deleteContents=function(){this.nativeRange.deleteContents(),a(this)},b.extractContents=function(){var b=this.nativeRange.extractContents();return a(this),b},b.cloneContents=function(){return this.nativeRange.cloneContents()},b.surroundContents=function(b){this.nativeRange.surroundContents(b),a(this)},b.collapse=function(b){this.nativeRange.collapse(b),a(this)},b.cloneRange=function(){return new e(this.nativeRange.cloneRange())},b.refresh=function(){a(this)},b.toString=function(){return""+this.nativeRange};var i=document.createTextNode("test");f.getBody(document).appendChild(i);var j=document.createRange();j.setStart(i,0),j.setEnd(i,0);try{j.setStart(i,1),d=!0,b.setStart=function(b,c){this.nativeRange.setStart(b,c),a(this)},b.setEnd=function(b,c){this.nativeRange.setEnd(b,c),a(this)},g=function(b){return function(c){this.nativeRange[b](c),a(this)}}}catch(k){d=!1,b.setStart=function(b,c){try{this.nativeRange.setStart(b,c)}catch(d){this.nativeRange.setEnd(b,c),this.nativeRange.setStart(b,c)}a(this)},b.setEnd=function(b,c){try{this.nativeRange.setEnd(b,c)}catch(d){this.nativeRange.setStart(b,c),this.nativeRange.setEnd(b,c)}a(this)},g=function(b,c){return function(d){try{this.nativeRange[b](d)}catch(e){this.nativeRange[c](d),this.nativeRange[b](d)}a(this)}}}b.setStartBefore=g("setStartBefore","setEndBefore"),b.setStartAfter=g("setStartAfter","setEndAfter"),b.setEndBefore=g("setEndBefore","setStartBefore"),b.setEndAfter=g("setEndAfter","setStartAfter"),j.selectNodeContents(i),b.selectNodeContents=j.startContainer==i&&j.endContainer==i&&0==j.startOffset&&j.endOffset==i.length?function(b){this.nativeRange.selectNodeContents(b),a(this)}:function(a){this.setStart(a,0),this.setEnd(a,h.getEndOffset(a))},j.selectNodeContents(i),j.setEnd(i,3),d=document.createRange(),d.selectNodeContents(i),d.setEnd(i,4),d.setStart(i,2),b.compareBoundaryPoints=-1==j.compareBoundaryPoints(j.START_TO_END,d)&1==j.compareBoundaryPoints(j.END_TO_START,d)?function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)},f.getBody(document).removeChild(i),j.detach(),d.detach()})(),b.createNativeRange=function(a){return a=a||document,a.createRange()};e.prototype.getName=function(){return"WrappedRange"},b.WrappedRange=e,b.createRange=function(a){return a=a||document,new e(b.createNativeRange(a))},b.createRangyRange=function(a){return a=a||document,new h(a)},b.createIframeRange=function(a){return b.createRange(f.getIframeDocument(a))},b.createIframeRangyRange=function(a){return b.createRangyRange(f.getIframeDocument(a))},b.addCreateMissingNativeApiListener(function(a){a=a.document,a.createRange===void 0&&(a.createRange=function(){return b.createRange(this)}),a=a=null})}),b.createModule("WrappedSelection",function(a,b){function c(a){return(a||window).getSelection()}function d(a){return(a||window).document.selection}function e(a,b,c){var d=c?"end":"start";c=c?"start":"end",a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[c+"Container"],a.focusOffset=b[c+"Offset"]}function f(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function g(b){var c;return b instanceof r?(c=b._selectionNativeRange,c||(c=a.createNativeRange(p.getDocument(b.startContainer)),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset),b._selectionNativeRange=c,b.attachListener("detach",function(){this._selectionNativeRange=null}))):b instanceof s?c=b.nativeRange:a.features.implementsDomRange&&b instanceof p.getWindow(b.startContainer).Range&&(c=b),c}function h(a){var c,b=a.getNodes();a:if(b.length&&1==b[0].nodeType){c=1;for(var d=b.length;d>c;++c)if(!p.isAncestorOf(b[0],b[c])){c=!1;break a}c=!0}else c=!1;if(!c)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return b[0]}function i(a,b){var c=new s(b);a._ranges=[c],e(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function j(b){if(b._ranges.length=0,"None"==b.docSelection.type)f(b);else{var c=b.docSelection.createRange();if(c&&c.text!==void 0)i(b,c);else{b.rangeCount=c.length;for(var d,g=p.getDocument(c.item(0)),h=0;b.rangeCount>h;++h)d=a.createRange(g),d.selectNode(c.item(h)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,e(b,b._ranges[b.rangeCount-1],!1)}}}function k(a,b){var c=a.docSelection.createRange(),d=h(b),e=p.getDocument(c.item(0));e=p.getBody(e).createControlRange();for(var f=0,g=c.length;g>f;++f)e.add(c.item(f));try{e.add(d)}catch(i){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}e.select(),j(a)}function l(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function m(a,b){var c=p.getDocument(b[0].startContainer);c=p.getBody(c).createControlRange();for(var e,d=0;rangeCount>d;++d){e=h(b[d]);try{c.add(e)}catch(f){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}c.select(),j(a)}function n(a,b){if(a.anchorNode&&p.getDocument(a.anchorNode)!==p.getDocument(b))throw new t("WRONG_DOCUMENT_ERR")}function o(a){var b=[],c=new u(a.anchorNode,a.anchorOffset),d=new u(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if(a.rangeCount!==void 0)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=r.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.requireModules(["DomUtil","DomRange","WrappedRange"]),a.config.checkSelectionRanges=!0;var v,w,p=a.dom,q=a.util,r=a.DomRange,s=a.WrappedRange,t=a.DOMException,u=p.DomPosition,x=a.util.isHostMethod(window,"getSelection"),y=a.util.isHostObject(document,"selection"),z=y&&(!x||a.config.preferTextRange);z?(v=d,a.isSelectionValid=function(a){a=(a||window).document;var b=a.selection;return"None"!=b.type||p.getDocument(b.createRange().parentElement())==a}):x?(v=c,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected."),a.getNativeSelection=v,x=v();var A=a.createNativeRange(document),B=p.getBody(document),C=q.areHostObjects(x,q.areHostProperties(x,["anchorOffset","focusOffset"]));a.features.selectionHasAnchorAndFocus=C;var D=q.isHostMethod(x,"extend");a.features.selectionHasExtend=D;var E="number"==typeof x.rangeCount;a.features.selectionHasRangeCount=E;var F=!1,G=!0;q.areHostMethods(x,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof x.rangeCount&&a.features.implementsDomRange&&function(){var a=document.createElement("iframe");B.appendChild(a);var b=p.getIframeDocument(a);b.open(),b.write("<html><head></head><body>12</body></html>"),b.close();var c=p.getIframeWindow(a).getSelection(),d=b.documentElement.lastChild.firstChild;b=b.createRange(),b.setStart(d,1),b.collapse(!0),c.addRange(b),G=1==c.rangeCount,c.removeAllRanges();var e=b.cloneRange();b.setStart(d,0),e.setEnd(d,2),c.addRange(b),c.addRange(e),F=2==c.rangeCount,b.detach(),e.detach(),B.removeChild(a)}(),a.features.selectionSupportsMultipleRanges=F,a.features.collapsedNonEditableSelectionsSupported=G;var I,H=!1;B&&q.isHostMethod(B,"createControlRange")&&(I=B.createControlRange(),q.areHostProperties(I,["item","add"])&&(H=!0)),a.features.implementsControlRange=H,w=C?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var J;if(q.isHostMethod(x,"getRangeAt")?J=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:C&&(J=function(b){var c=p.getDocument(b.anchorNode);return c=a.createRange(c),c.setStart(b.anchorNode,b.anchorOffset),c.setEnd(b.focusNode,b.focusOffset),c.collapsed!==this.isCollapsed&&(c.setStart(b.focusNode,b.focusOffset),c.setEnd(b.anchorNode,b.anchorOffset)),c}),a.getSelection=function(a){a=a||window;var b=a._rangySelection,c=v(a),e=y?d(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh(a)):(b=new l(c,e,a),a._rangySelection=b),b},a.getIframeSelection=function(b){return a.getSelection(p.getIframeWindow(b))},I=l.prototype,!z&&C&&q.areHostMethods(x,["removeAllRanges","addRange"])){I.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),f(this)};var K=function(b,c){var d=r.getRangeDocument(c);d=a.createRange(d),d.collapseToPoint(c.endContainer,c.endOffset),b.nativeSelection.addRange(g(d)),b.nativeSelection.extend(c.startContainer,c.startOffset),b.refresh()};I.addRange=E?function(b,c){if(H&&y&&"Control"==this.docSelection.type)k(this,b);else if(c&&D)K(this,b);else{var d;F?d=this.rangeCount:(this.removeAllRanges(),d=0),this.nativeSelection.addRange(g(b)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==d+1?(a.config.checkSelectionRanges&&(d=J(this.nativeSelection,this.rangeCount-1))&&!r.rangesEqual(d,b)&&(b=new s(d)),this._ranges[this.rangeCount-1]=b,e(this,b,N(this.nativeSelection)),this.isCollapsed=w(this)):this.refresh()}}:function(a,b){b&&D?K(this,a):(this.nativeSelection.addRange(g(a)),this.refresh())},I.setRanges=function(a){if(H&&a.length>1)m(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(q.isHostMethod(x,"empty")&&q.isHostMethod(A,"select")&&H&&z))return b.fail("No means of selecting a Range or TextRange was found"),!1;I.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=p.getDocument(this.anchorNode);else if("Control"==this.docSelection.type){var b=this.docSelection.createRange();b.length&&(a=p.getDocument(b.item(0)).body.createTextRange())}a&&(a.body.createTextRange().select(),this.docSelection.empty())}}catch(c){}f(this)},I.addRange=function(a){"Control"==this.docSelection.type?k(this,a):(s.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,e(this,a,!1))
},I.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?m(this,a):b&&this.addRange(a[0])}}I.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new t("INDEX_SIZE_ERR");return this._ranges[a]};var L;if(z)L=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=p.getBody(b.win.document).createTextRange(),c.collapse(!0)),"Control"==b.docSelection.type?j(b):c&&c.text!==void 0?i(b,c):f(b)};else if(q.isHostMethod(x,"getRangeAt")&&"number"==typeof x.rangeCount)L=function(b){if(H&&y&&"Control"==b.docSelection.type)j(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));e(b,b._ranges[b.rangeCount-1],N(b.nativeSelection)),b.isCollapsed=w(b)}else f(b)};else{if(!C||"boolean"!=typeof x.isCollapsed||"boolean"!=typeof A.collapsed||!a.features.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;L=function(a){var b;b=a.nativeSelection,b.anchorNode?(b=J(b,0),a._ranges=[b],a.rangeCount=1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset,a.isCollapsed=w(a)):f(a)}}I.refresh=function(a){var b=a?this._ranges.slice(0):null;if(L(this),a){if(a=b.length,a!=this._ranges.length)return!1;for(;a--;)if(!r.rangesEqual(b[a],this._ranges[a]))return!1;return!0}};var M=function(a,b){var c=a.getAllRanges(),d=!1;a.removeAllRanges();for(var e=0,g=c.length;g>e;++e)d||b!==c[e]?a.addRange(c[e]):d=!0;a.rangeCount||f(a)};I.removeRange=H?function(a){if("Control"==this.docSelection.type){var b=this.docSelection.createRange();a=h(a);var c=p.getDocument(b.item(0));c=p.getBody(c).createControlRange();for(var d,e=!1,f=0,g=b.length;g>f;++f)d=b.item(f),d!==a||e?c.add(b.item(f)):e=!0;c.select(),j(this)}else M(this,a)}:function(a){M(this,a)};var N;!z&&C&&a.features.implementsDomRange?(N=function(a){var b=!1;return a.anchorNode&&(b=1==p.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b},I.isBackwards=function(){return N(this)}):N=I.isBackwards=function(){return!1},I.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},I.collapse=function(b,c){n(this,b);var d=a.createRange(p.getDocument(b));d.collapseToPoint(b,c),this.removeAllRanges(),this.addRange(d),this.isCollapsed=!0},I.collapseToStart=function(){if(!this.rangeCount)throw new t("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},I.collapseToEnd=function(){if(!this.rangeCount)throw new t("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},I.selectAllChildren=function(b){n(this,b);var c=a.createRange(p.getDocument(b));c.selectNodeContents(b),this.removeAllRanges(),this.addRange(c)},I.deleteFromDocument=function(){if(H&&y&&"Control"==this.docSelection.type){for(var b,a=this.docSelection.createRange();a.length;)b=a.item(0),a.remove(b),b.parentNode.removeChild(b);this.refresh()}else if(this.rangeCount){a=this.getAllRanges(),this.removeAllRanges(),b=0;for(var c=a.length;c>b;++b)a[b].deleteContents();this.addRange(a[c-1])}},I.getAllRanges=function(){return this._ranges.slice(0)},I.setSingleRange=function(a){this.setRanges([a])},I.containsNode=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(this._ranges[c].containsNode(a,b))return!0;return!1},I.toHtml=function(){var a="";if(this.rangeCount){a=r.getRangeDocument(this._ranges[0]).createElement("div");for(var b=0,c=this._ranges.length;c>b;++b)a.appendChild(this._ranges[b].cloneContents());a=a.innerHTML}return a},I.getName=function(){return"WrappedSelection"},I.inspect=function(){return o(this)},I.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null},l.inspect=o,a.Selection=l,a.selectionPrototype=I,a.addCreateMissingNativeApiListener(function(b){b.getSelection===void 0&&(b.getSelection=function(){return a.getSelection(this)}),b=null})}),b.createModule("CssClassApplier",function(b){function c(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function d(a,b){return a.className&&RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(a.className)}function e(a,b){a.className?d(a,b)||(a.className+=" "+b):a.className=b}function f(a){return a.className.split(/\s+/).sort().join(" ")}function g(a,b){return f(a)==f(b)}function h(a){for(var b=a.parentNode;a.hasChildNodes();)b.insertBefore(a.firstChild,a);b.removeChild(a)}function i(a,b){var c=a.cloneRange();c.selectNodeContents(b);var d=c.intersection(a);return d=d?""+d:"",c.detach(),""!=d}function j(a,b){if(a.attributes.length!=b.attributes.length)return!1;for(var e,f,c=0,d=a.attributes.length;d>c;++c)if(e=a.attributes[c],f=e.name,"class"!=f){if(f=b.attributes.getNamedItem(f),e.specified!=f.specified)return!1;if(e.specified&&e.nodeValue!==f.nodeValue)return!1}return!0}function k(a){for(var b=0,c=a.attributes.length;c>b;++b)if(a.attributes[b].specified&&"class"!=a.attributes[b].name)return!0;return!1}function l(a,b){return q.isCharacterDataNode(a)?0==b?!!a.previousSibling:b==a.length?!!a.nextSibling:!0:b>0&&a.childNodes.length>b}function m(a,b,c){var d;if(q.isCharacterDataNode(b)&&(0==c?(c=q.getNodeIndex(b),b=b.parentNode):c==b.length?(c=q.getNodeIndex(b)+1,b=b.parentNode):d=q.splitDataNode(b,c)),!d){d=b.cloneNode(!1),d.id&&d.removeAttribute("id");for(var e;e=b.childNodes[c];)d.appendChild(e);q.insertAfter(d,b)}return b==a?d:m(a,d.parentNode,q.getNodeIndex(d))}function n(a,b){var c=3==a.nodeType,d=c?a.parentNode:a,e=b?"nextSibling":"previousSibling";if(c){if((c=a[e])&&3==c.nodeType)return c}else if((c=d[e])&&a.tagName==c.tagName&&g(a,c)&&j(a,c))return c[b?"firstChild":"lastChild"];return null}function o(a){this.firstTextNode=(this.isElementMerge=1==a.nodeType)?a.lastChild:a,this.isElementMerge&&(this.sortedCssClasses=f(a)),this.textNodes=[this.firstTextNode]}function p(a,b,d){if(this.cssClass=a,this.normalize=b,this.applyToAnytagBody=!1,a=typeof d,"string"==a)"*"==d?this.applyToAnytagBody=!0:this.tagNames=c(d.toLowerCase()).split(/\s*,\s*/);else if("object"==a&&"number"==typeof d.length)for(this.tagNames=[],a=0,b=d.length;b>a;++a)"*"==d[a]?this.applyToAnytagBody=!0:this.tagNames.push(d[a].toLowerCase());else this.tagNames=[r]}b.requireModules(["WrappedSelection","WrappedRange"]);var q=b.dom,r=a,s=function(){function a(a,b,c){return b&&c?" ":""}return function(b,c){b.className&&(b.className=b.className.replace(RegExp("(?:^|\\s)"+c+"(?:\\s|$)"),a))}}();o.prototype={doMerge:function(){for(var b,c,a=[],d=0,e=this.textNodes.length;e>d;++d)b=this.textNodes[d],c=b.parentNode,a[d]=b.data,d&&(c.removeChild(b),c.hasChildNodes()||c.parentNode.removeChild(c));return this.firstTextNode.data=a=a.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;c>b;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}},p.prototype={appliesToElement:function(a){return this.applyToAnytagBody||q.arrayContains(this.tagNames,a.tagName.toLowerCase())},getAncestorWithClass:function(a){for(a=a.parentNode;a;){if(1==a.nodeType&&this.appliesToElement(a)&&d(a,this.cssClass))return a;a=a.parentNode}return!1},postApply:function(a,b){for(var f,k,l,c=a[0],d=a[a.length-1],e=[],g=c,h=d,i=0,j=d.length,m=0,p=a.length;p>m;++m)k=a[m],(l=n(k,!1))?(f||(f=new o(l),e.push(f)),f.textNodes.push(k),k===c&&(g=f.firstTextNode,i=g.length),k===d&&(h=f.firstTextNode,j=f.getLength())):f=null;if((c=n(d,!0))&&(f||(f=new o(d),e.push(f)),f.textNodes.push(c)),e.length){for(m=0,p=e.length;p>m;++m)e[m].doMerge();b.setStart(g,i),b.setEnd(h,j)}},createContainer:function(a){return a=a.createElement(r),a.className=this.cssClass,a},applyToTextNode:function(a){var b=a.parentNode;1==b.childNodes.length&&this.appliesToElement(b)?e(b,this.cssClass):(b=this.createContainer(q.getDocument(a)),a.parentNode.insertBefore(b,a),b.appendChild(a))},isRemovable:function(a){return a.tagName.toLowerCase()==r&&c(a.className)==this.cssClass&&!k(a)},undoToTextNode:function(a,b,c){b.containsNode(c)||(a=b.cloneRange(),a.selectNode(c),a.isPointInRange(b.endContainer,b.endOffset)&&l(b.endContainer,b.endOffset)&&(m(c,b.endContainer,b.endOffset),b.setEndAfter(c)),a.isPointInRange(b.startContainer,b.startOffset)&&l(b.startContainer,b.startOffset)&&(c=m(c,b.startContainer,b.startOffset))),this.isRemovable(c)?h(c):s(c,this.cssClass)},applyToRange:function(a){a.splitBoundaries();var b=a.getNodes([3],function(b){return i(a,b)});if(b.length){for(var c,d=0,e=b.length;e>d;++d)c=b[d],this.getAncestorWithClass(c)||this.applyToTextNode(c);a.setStart(b[0],0),c=b[b.length-1],a.setEnd(c,c.length),this.normalize&&this.postApply(b,a)}},applyToSelection:function(a){a=a||window,a=b.getSelection(a);var c,d=a.getAllRanges();a.removeAllRanges();for(var e=d.length;e--;)c=d[e],this.applyToRange(c),a.addRange(c)},undoToRange:function(a){a.splitBoundaries();var c,d,b=a.getNodes([3]),e=b[b.length-1];if(b.length){for(var f=0,g=b.length;g>f;++f)c=b[f],(d=this.getAncestorWithClass(c))&&this.undoToTextNode(c,a,d),a.setStart(b[0],0),a.setEnd(e,e.length);this.normalize&&this.postApply(b,a)}},undoToSelection:function(a){a=a||window,a=b.getSelection(a);var d,c=a.getAllRanges();a.removeAllRanges();for(var e=0,f=c.length;f>e;++e)d=c[e],this.undoToRange(d),a.addRange(d)},isAppliedToRange:function(a){for(var b=a.getNodes([3]),c=0,d=b.length;d>c;++c)if(i(a,b[c])&&!this.getAncestorWithClass(b[c]))return!1;return!0},isAppliedToSelection:function(a){a=a||window,a=b.getSelection(a).getAllRanges();for(var c=a.length;c--;)if(!this.isAppliedToRange(a[c]))return!1;return!0},toggleRange:function(a){this.isAppliedToRange(a)?this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},detach:function(){}},p.util={hasClass:d,addClass:e,removeClass:s,hasSameClasses:g,replaceWithOwnChildren:h,elementsHaveSameNonClassAttributes:j,elementHasNonClassAttributes:k,splitNodeAt:m},b.CssClassApplier=p,b.createCssClassApplier=function(a,b,c){return new p(a,b,c)}}),b.createModule("SaveRestore",function(b,c){function d(b,c){var e,d="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),f=h.getDocument(b.startContainer),g=b.cloneRange();return g.collapse(c),e=f.createElement(a),e.id=d,e.style.lineHeight="0",e.style.display="none",e.appendChild(f.createTextNode(i)),g.insertNode(e),g.detach(),e}function e(a,b,d,e){(a=(a||document).getElementById(d))?(b[e?"setStartBefore":"setEndBefore"](a),a.parentNode.removeChild(a)):c.warn("Marker element has been removed. Cannot restore selection.")}function f(a,b){return b.compareBoundaryPoints(a.START_TO_START,a)}function g(a,b){var c=(a||document).getElementById(b);c&&c.parentNode.removeChild(c)}b.requireModules(["DomUtil","DomRange","WrappedRange"]);var h=b.dom,i="\ufeff";b.saveSelection=function(a){a=a||window;var e=a.document;if(b.isSelectionValid(a)){var j,k,g=b.getSelection(a),h=g.getAllRanges(),i=[];h.sort(f);for(var l=0,m=h.length;m>l;++l)j=h[l],j.collapsed?(k=d(j,!1),i.push({markerId:k.id,collapsed:!0})):(k=d(j,!1),j=d(j,!0),i[l]={startMarkerId:j.id,endMarkerId:k.id,collapsed:!1,backwards:1==h.length&&g.isBackwards()});for(l=m-1;l>=0;--l)j=h[l],j.collapsed?j.collapseBefore((e||document).getElementById(i[l].markerId)):(j.setEndBefore((e||document).getElementById(i[l].endMarkerId)),j.setStartAfter((e||document).getElementById(i[l].startMarkerId)));return g.setRanges(h),{win:a,doc:e,rangeInfos:i,restored:!1}}c.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.")},b.restoreSelection=function(a,d){if(!a.restored){for(var k,l,f=a.rangeInfos,g=b.getSelection(a.win),h=[],i=f.length,j=i-1;j>=0;--j){if(k=f[j],l=b.createRange(a.doc),k.collapsed)if(k=(a.doc||document).getElementById(k.markerId)){k.style.display="inline";var m=k.previousSibling;m&&3==m.nodeType?(k.parentNode.removeChild(k),l.collapseToPoint(m,m.length)):(l.collapseBefore(k),k.parentNode.removeChild(k))}else c.warn("Marker element has been removed. Cannot restore selection.");else e(a.doc,l,k.startMarkerId,!0),e(a.doc,l,k.endMarkerId,!1);1==i&&l.normalizeBoundaries(),h[j]=l}1==i&&d&&b.features.selectionHasExtend&&f[0].backwards?(g.removeAllRanges(),g.addRange(h[0],!0)):g.setRanges(h),a.restored=!0}},b.removeMarkerElement=g,b.removeMarkers=function(a){for(var e,b=a.rangeInfos,c=0,d=b.length;d>c;++c)e=b[c],e.collapsed?g(a.doc,e.markerId):(g(a.doc,e.startMarkerId),g(a.doc,e.endMarkerId))}}),b.createModule("Serializer",function(a,c){function d(a,b){b=b||[];var c=a.nodeType,e=a.childNodes,f=e.length,g=[c,a.nodeName,f].join(":"),h="",i="";switch(c){case 3:h=a.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");break;case 8:h="<!--"+a.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"-->";break;default:h="<"+g+">",i="</>"}for(h&&b.push(h),c=0;f>c;++c)d(e[c],b);return i&&b.push(i),b}function e(a){return a=d(a).join(""),m(a).toString(16)}function f(a,b,c){var d=[],e=a;for(c=c||n.getDocument(a).documentElement;e&&e!=c;)d.push(n.getNodeIndex(e,!0)),e=e.parentNode;return d.join("/")+":"+b}function g(a,b,d){b?d||n.getDocument(b):(d=d||document,b=d.documentElement),a=a.split(":"),b=b,d=a[0]?a[0].split("/"):[];for(var f,e=d.length;e--;){if(f=parseInt(d[e],10),!(b.childNodes.length>f))throw c.createError("deserializePosition failed: node "+n.inspectNode(b)+" has no child with index "+f+", "+e);b=b.childNodes[parseInt(d[e],10)]}return new n.DomPosition(b,parseInt(a[1],10))}function h(b,c,d){if(d=d||a.DomRange.getRangeDocument(b).documentElement,!n.isAncestorOf(d,b.commonAncestorContainer,!0))throw Error("serializeRange: range is not wholly contained within specified root node");return b=f(b.startContainer,b.startOffset,d)+","+f(b.endContainer,b.endOffset,d),c||(b+="{"+e(d)+"}"),b}function i(b,c,d){c?d=d||n.getDocument(c):(d=d||document,c=d.documentElement),b=/^([^,]+),([^,\{]+)({([^}]+)})?$/.exec(b);var f=b[4],h=e(c);if(f&&f!==e(c))throw Error("deserializeRange: checksums of serialized range root node ("+f+") and target root node ("+h+") do not match");return f=g(b[1],c,d),c=g(b[2],c,d),d=a.createRange(d),d.setStart(f.node,f.offset),d.setEnd(c.node,c.offset),d}function j(a,b,c){return b?c||n.getDocument(b):(c=c||document,b=c.documentElement),a=/^([^,]+),([^,]+)({([^}]+)})?$/.exec(a)[3],!a||a===e(b)}function k(a,c,d){a=a||b.getSelection(),a=a.getAllRanges();for(var e=[],f=0,g=a.length;g>f;++f)e[f]=h(a[f],c,d);return e.join("|")}function l(b,c,d){c?d=d||n.getWindow(c):(d=d||window,c=d.document.documentElement),b=b.split("|");for(var e=a.getSelection(d),f=[],g=0,h=b.length;h>g;++g)f[g]=i(b[g],c,d.document);return e.setRanges(f),e}a.requireModules(["WrappedSelection","WrappedRange"]),("undefined"==typeof encodeURIComponent||"undefined"==typeof decodeURIComponent)&&c.fail("Global object is missing encodeURIComponent and/or decodeURIComponent method");var m=function(){var a=null;return function(b){for(var f,c=[],d=0,e=b.length;e>d;++d)f=b.charCodeAt(d),128>f?c.push(f):2048>f?c.push(192|f>>6,128|63&f):c.push(224|f>>12,128|63&f>>6,128|63&f);if(b=-1,!a){d=[],e=0;for(var g;256>e;++e){for(g=e,f=8;f--;)1==(1&g)?g=3988292384^g>>>1:g>>>=1;d[e]=g>>>0}a=d}for(d=a,e=0,f=c.length;f>e;++e)g=255&(b^c[e]),b=b>>>8^d[g];return(-1^b)>>>0}}(),n=a.dom;a.serializePosition=f,a.deserializePosition=g,a.serializeRange=h,a.deserializeRange=i,a.canDeserializeRange=j,a.serializeSelection=k,a.deserializeSelection=l,a.canDeserializeSelection=function(a,b,c){var d;b?d=c?c.document:n.getDocument(b):(c=c||window,b=c.document.documentElement),a=a.split("|"),c=0;for(var e=a.length;e>c;++c)if(!j(a[c],b,d))return!1;return!0},a.restoreSelectionFromCookie=function(a){a=a||window;var b;a:{b=a.document.cookie.split(/[;,]/);for(var e,c=0,d=b.length;d>c;++c)if(e=b[c].split("="),"rangySerializedSelection"==e[0].replace(/^\s+/,"")&&(e=e[1])){b=decodeURIComponent(e.replace(/\s+$/,""));break a}b=null}b&&l(b,a.doc)},a.saveSelectionCookie=function(a,c){a=a||window,c="object"==typeof c?c:{};var d=c.expires?";expires="+c.expires.toUTCString():"",e=c.path?";path="+c.path:"",f=c.domain?";domain="+c.domain:"",g=c.secure?";secure":"",h=k(b.getSelection(a));a.document.cookie=encodeURIComponent("rangySerializedSelection")+"="+encodeURIComponent(h)+d+e+f+g},a.getElementChecksum=e}),b}var rangy=plugin_rangy();window.rangy=rangy,rangy.init(),plugin_jquery_log($R),plugin_jquery_json($R),plugin_jquery_cookie($R),plugin_jquery_postMessage($R),plugin_jquery_enhancedOffset($R),plugin_jquery_hashChange($R),plugin_jquery_mousewheel($R),plugin_jquery_scrollStartAndStop($R),plugin_jquery_jScrollPane($R),plugin_jquery_hoverIntent($R),plugin_jquery_twitterTip($R),plugin_jquery_rdrWidgetSummary($R),plugin_jquery_shareWidget($R),plugin_jquery_selectionographer($R,rangy),$R.expr[":"].parents=function(a,b,c){return 1>$R(a).parents(c[3]).length}}var $=$R,css=[];(!$R.browser.msie||$R.browser.msie&&parseInt($R.browser.version,10)>8)&&css.push(RDR_staticUrl+"global/css/helvetica.css"),$R.browser.msie&&(css.push(RDR_staticUrl+"widget/css/ie.css"),css.push(RDR_staticUrl+"widget/css/ie"+parseInt($R.browser.version,10)+".css")),css.push(RDR_widgetCssStaticUrl+"widget/css/widget.css?rv12"),css.push(RDR_scriptPaths.jqueryUI_CSS),css.push(RDR_staticUrl+"widget/css/jquery.jscrollpane.css"),loadCSS(css),initCommonUtils($R),initPlugins($R),readrBoard($R),RDR.actions.init(),RDR_offline&&RDR.debug()}var RDR={};if(!window.READRBOARDCOM||!window.READRBOARDCOM.hasLoaded){window.READRBOARDCOM=window.readrboard=RDR,RDR.hasLoaded=!0,RDR.C={summaryWidgetMaxHeight:68,rindowHeaderPadding:29,rindowWidthForKindIsText:200,rindowAnimationSpeed:333,indicatorOpacity:1,helperIndicators:{hoverDelay:250,fadeInTime:300,opacity:.6}},RDR.engageScript=document.getElementById("readrboardscript")||findEngageScript(),RDR.engageScriptSrc=RDR.engageScript.src;var $RDR,$R,RDR_scriptPaths={},RDR_offline=!(-1==RDR.engageScriptSrc.indexOf("local.readrboard.com")&&-1==RDR.engageScriptSrc.indexOf("local.readrboard2.com")&&"local.readrboard.com"!=document.domain),RDR_baseUrl=RDR_offline?"http://local.readrboard.com:8080":"http://www.readrboard.com",RDR_staticUrl=RDR_offline?"http://local.readrboard.com:8080/static/":"http://s3.amazonaws.com/readrboard/",RDR_widgetCssStaticUrl=RDR_offline?"http://local.readrboard.com:8080/static/":"http://s3.amazonaws.com/readrboard/";RDR.safeThrow=function(a){var b=!1;if(RDR_offline&&b)throw a},RDR.rdr_loadScript=rdr_loadScript,RDR_scriptPaths.jqueryWithJqueryUI=RDR_staticUrl+"global/js/jquery-1.7.1.min-with-ui-1.8.17.min.js",RDR_scriptPaths.jqueryUI_CSS=RDR_offline?RDR_staticUrl+"global/css/jquery-ui-1.8.17.base.css":"http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.17/themes/base/jquery-ui.css",rdr_loadScript({src:RDR_scriptPaths.jqueryWithJqueryUI},function(){$R=jQuery.noConflict(!0);var a=$R;return a.browser.msie&&8>parseInt(a.browser.version,10)?!1:(a.browser.msie&&8==parseInt(a.browser.version,10)&&a("body").addClass("rdr_ie"),$RFunctions($R),void 0)})}})();