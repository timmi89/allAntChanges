<html>
  <head>
    <script src="https://apis.google.com/js/client.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>

      function auth() {
        gapi.auth.authorize(config, function() {
            gapi.client.load('bigquery', 'v2');
            $('#client_initiated').html('BigQuery client authorized');
            $('#auth_button').fadeOut();
            $('#dataset_button').fadeIn();
        });
      }

      // User Submitted Variables
      var projectNumber = '774436620412';
      var clientId = '774436620412-kcqbqhs2tbjsedu06ckdbc4agmjg09e2.apps.googleusercontent.com';

      var config = {
        'client_id': clientId,
        'scope': 'https://www.googleapis.com/auth/bigquery'
      };

      function listDatasets() {
        var request = gapi.client.bigquery.datasets.list({
          'projectId':projectNumber
        });
        request.execute(function(response) {
            $('#result_box').html(JSON.stringify(response.result.datasets, null));
        });
      }

// var accessToken;
// var config = {
//     'client_id': '774436620412-kcqbqhs2tbjsedu06ckdbc4agmjg09e2.apps.googleusercontent.com',
//     'scope': 'https://www.googleapis.com/auth/userinfo.profile',
// };    
 
// function auth() {
 
//     gapi.auth.authorize(config, function() {
//         accessToken = gapi.auth.getToken().access_token;
//         console.log('We have got our token....');
//         console.log(accessToken);
//         console.log('We are now going to validate our token....');
//         validateToken();
               
//     });
// }
 
// function validateToken() {
//     $.ajax({
//         url: 'https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=' + accessToken,
//         data: null,
//         success: function(response){  
//             console.log('Our token is valid....');
//             console.log('We now want to get info about the user using our token....');
//             getUserInfo();
//         },  
//         error: function(error) {
//             console.log('Our token is not valid....');
//         },
//         dataType: "jsonp" 
//     });
// }
 
// function getUserInfo() {
//     $.ajax({
//         url: 'https://www.googleapis.com/oauth2/v1/userinfo?access_token=' + accessToken,
//         data: null,
//         success: function(response) {
//             console.log('We have gotten info back....');
//             console.log(response);
//             $('#user').html(response.name);
             
//         },
//         dataType: "jsonp"
//     });
// }          

    </script>
  </head>

  <body>
    <button id="auth_button" onclick="auth();">Authorize</button>
    <div id="client_initiated"></div>
    <button id="dataset_button" style="display:none;" onclick="listDatasets();">Show datasets</button>
    <div id="result_box"></div>
  </body>
</html>