<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US" xmlns:x2="http://www.w3.org/2002/06/xhtml2" xmlns:fb="http://www.facebook.com/2008/fbml">
   <head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript"></script>
	<script src="/static/js/jquery.ba-postmessage.min.js" type="text/javascript"></script>
	<script src="/static/js/jquery.json-2.2.min.js" type="text/javascript"></script>
	<script src="/static/js/jquery.cookie.js" type="text/javascript"></script>
	<script type="text/javascript">
	var date = new Date();
	// TODO use the following line.  it creates a cachebuster that represents the current day/week/month
	// var cachebuster = String( parseInt( date.getDate() / 7 )+1 )+String(date.getMonth()) + String(date.getYear());
	var cachebuster = date.getTime();
	document.write(
		unescape( '%3Cscript src="/static/js/readr_user_auth.js?' + cachebuster + '" type="text/javascript"%3E%3C/script%3E' )
	);
	</script>
   </head>
   <body style="padding:0;margin:0;color:#fff;background:transparent;">
	<div id="fb-root"></div>
     <script src="http://connect.facebook.net/en_US/all.js" type="text/javascript"s></script>
     <script type="text/javascript">
		RDRAuth.FBLoginResponse = function(response) {
			if (response.session) {
				//user is logged in
				$('#fb-logged-in').show();
				$('#fb-login-button').hide();
				RDRAuth.getReadrToken(response);
			} else {
				// user is not logged in
				// TODO do something.  post to parent that there was a bug logging in to FB
			}	
		}
		
		FB.init({ 
			appId:'{{ fb_client_id }}', cookie:true, 
			status:true, xfbml:true 
		});
		
		// RDRAuth.checkSocialUser();
		if ( !$.cookie('educatedUser') ) {
			RDRAuth.notifyParent({message:false}, "educate user");
		}
	</script>
   </body>
</html>