BEGIN;
DROP TABLE "rb_contentnode";
DROP TABLE "rb_tag";
DROP TABLE "rb_comment";
DROP TABLE "rb_node";
CREATE TABLE "rb_node" (
    "id" integer NOT NULL PRIMARY KEY,
    "inserted" datetime NOT NULL,
    "updated" datetime NOT NULL,
    "user_id" integer NOT NULL REFERENCES "auth_user" ("id")
)
;
CREATE TABLE "rb_edge" (
    "id" integer NOT NULL PRIMARY KEY,
    "parent_id" integer NOT NULL REFERENCES "rb_node" ("id"),
    "child_id" integer NOT NULL REFERENCES "rb_node" ("id")
)
;
CREATE TABLE "rb_comment" (
    "node_ptr_id" integer NOT NULL PRIMARY KEY REFERENCES "rb_node" ("id"),
    "content" text NOT NULL
)
;
CREATE TABLE "rb_tag" (
    "node_ptr_id" integer NOT NULL PRIMARY KEY REFERENCES "rb_node" ("id"),
    "content" varchar(64) NOT NULL
)
;
CREATE TABLE "rb_contentnode" (
    "node_ptr_id" integer NOT NULL PRIMARY KEY REFERENCES "rb_node" ("id"),
    "content_type" varchar(3) NOT NULL,
    "content" text NOT NULL,
    "rb_page_id" integer NOT NULL REFERENCES "rb_rbpage" ("id"),
    "hash" varchar(32) NOT NULL
)
;
CREATE INDEX "rb_node_fbfc09f1" ON "rb_node" ("user_id");
CREATE INDEX "rb_edge_63f17a16" ON "rb_edge" ("parent_id");
CREATE INDEX "rb_edge_da61a3df" ON "rb_edge" ("child_id");
CREATE INDEX "rb_feature_c0ae08ac" ON "rb_feature" ("rb_group_id");
CREATE INDEX "rb_rbsite_c0ae08ac" ON "rb_rbsite" ("rb_group_id");
CREATE INDEX "rb_rbpage_8a71f3d1" ON "rb_rbpage" ("rb_site_id");
CREATE INDEX "rb_contentnode_d54525a9" ON "rb_contentnode" ("rb_page_id");
COMMIT;
